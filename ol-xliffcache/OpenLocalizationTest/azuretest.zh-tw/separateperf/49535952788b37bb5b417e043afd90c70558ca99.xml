{
  "nodes": [
    {
      "content": "Azure Conditional Access Preview for SaaS Apps| Microsoft Azure",
      "pos": [
        27,
        90
      ]
    },
    {
      "content": "Conditional access in Azure AD allows you to configure per-application multi-factor authentication access rules and the ability to block access for users not on a trusted network.",
      "pos": [
        109,
        288
      ]
    },
    {
      "content": "Azure Conditional Access Preview for SaaS Apps",
      "pos": [
        597,
        643
      ]
    },
    {
      "content": "The Azure Conditional Access for SaaS apps is available for public preview.",
      "pos": [
        645,
        720
      ]
    },
    {
      "content": "The preview allows you to configure per-application multi-factor authentication access rules and the ability to block access for users not on a trusted network.",
      "pos": [
        721,
        881
      ]
    },
    {
      "content": "You can apply the multi-factor authentication rules to all users that are assigned to the application, or only for users within specified security groups.",
      "pos": [
        884,
        1038
      ]
    },
    {
      "content": "Users may be excluded from the multi-factor authentication requirement if they are accessing the application from an IP address that in inside the organization’s network.",
      "pos": [
        1039,
        1209
      ]
    },
    {
      "content": "These capabilities will be available to customers that have purchased an Azure Active Directory Premium license.",
      "pos": [
        1210,
        1322
      ]
    },
    {
      "content": "Scenario prerequisites",
      "pos": [
        1327,
        1349
      ]
    },
    {
      "content": "Subscription to Azure Active Directory Premium",
      "pos": [
        1352,
        1398
      ]
    },
    {
      "content": "Federated or Managed Azure Active Directory tenant",
      "pos": [
        1402,
        1452
      ]
    },
    {
      "content": "Federated tenants require that multi-factor authentication (MFA) be enabled.",
      "pos": [
        1456,
        1532
      ]
    },
    {
      "content": "Known issues in this Preview release",
      "pos": [
        1537,
        1573
      ]
    },
    {
      "content": "This preview applies to pre-integrated federated SaaS applications, applications that use password single-sign on, registered developed and line of business applications and Azure AD Application Proxy.",
      "pos": [
        1574,
        1775
      ]
    },
    {
      "content": "Some additional applications are still being enabled..",
      "pos": [
        1776,
        1830
      ]
    },
    {
      "content": "Configure per-application access rules",
      "pos": [
        1834,
        1872
      ]
    },
    {
      "content": "This section describes how to configure per-application access rules.",
      "pos": [
        1874,
        1943
      ]
    },
    {
      "content": "Log on to the Microsoft Azure Portal as Administrator.",
      "pos": [
        1948,
        2002
      ]
    },
    {
      "pos": [
        2006,
        2052
      ],
      "content": "On the left pane, select <bpt id=\"p1\">**</bpt>Active Directory<ept id=\"p1\">**</ept>."
    },
    {
      "content": "On the Directory tab, select your directory.",
      "pos": [
        2056,
        2100
      ]
    },
    {
      "pos": [
        2104,
        2136
      ],
      "content": "Select the <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> tab."
    },
    {
      "content": "Select the application that the rule will be set for.",
      "pos": [
        2140,
        2193
      ]
    },
    {
      "pos": [
        2197,
        2226
      ],
      "content": "Select the <bpt id=\"p1\">**</bpt>Configure<ept id=\"p1\">**</ept> tab."
    },
    {
      "content": "Scroll down to the access rules section.",
      "pos": [
        2230,
        2270
      ]
    },
    {
      "content": "Select the desired access rule.",
      "pos": [
        2271,
        2302
      ]
    },
    {
      "content": "Specify the users the rule will apply to..",
      "pos": [
        2306,
        2348
      ]
    },
    {
      "pos": [
        2352,
        2404
      ],
      "content": "Enable the policy by selecting <bpt id=\"p1\">**</bpt>Enabled to be On<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Understanding access rules",
      "pos": [
        2408,
        2434
      ]
    },
    {
      "content": "This section gives a detailed description of the access rules supported in the Azure Conditional Application Access Preview.",
      "pos": [
        2436,
        2560
      ]
    },
    {
      "content": "Specifying the users the access rules apply to",
      "pos": [
        2565,
        2611
      ]
    },
    {
      "content": "By default the policy will apply to all users that have access to the application.",
      "pos": [
        2613,
        2695
      ]
    },
    {
      "content": "However you can also restrict the policy to users that are members of the specified security groups.",
      "pos": [
        2696,
        2796
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Add Group<ept id=\"p1\">**</ept> button is used to select one or more groups from the group selection dialog that the access rule will apply to.",
      "pos": [
        2797,
        2926
      ]
    },
    {
      "content": "This dialog can also be used to remove selected groups.",
      "pos": [
        2927,
        2982
      ]
    },
    {
      "content": "When the rules are selected to apply to Groups, the access rules will only be enforced for users that belong to one of the specified security groups.",
      "pos": [
        2983,
        3132
      ]
    },
    {
      "content": "Security groups can also be explicitly excluded from the policy by selecting the Except option and specifying one or more groups.",
      "pos": [
        3134,
        3263
      ]
    },
    {
      "content": "Users that are a member of a group in the Except list will not be subject to the multi-factor authentication requirement, even if they are a member of a group that the access rule applies to.",
      "pos": [
        3264,
        3455
      ]
    },
    {
      "content": "The access rule shown in the below will require all users in the Managers group to use multi-factor authentication when accessing the application.",
      "pos": [
        3456,
        3602
      ]
    },
    {
      "content": "Setting conditional access rules with MFA",
      "pos": [
        3606,
        3647
      ]
    },
    {
      "content": "Conditional Access Rules with MFA",
      "pos": [
        3729,
        3762
      ]
    },
    {
      "content": "If a user has been configured using the per-user multi-factor authentication feature, this setting on the user will take precedence over the app multi-factor authentication rules.",
      "pos": [
        3763,
        3942
      ]
    },
    {
      "content": "This means a user that has been configured for per-user multi-factor authentication will be required to perform multi-factor authentication even if they have been exempted from the application multi-factor authentication rules.",
      "pos": [
        3943,
        4170
      ]
    },
    {
      "content": "Learn more about multi-factor authentication and per-user settings.",
      "pos": [
        4171,
        4238
      ]
    },
    {
      "content": "Access rule options",
      "pos": [
        4243,
        4262
      ]
    },
    {
      "content": "The current preview supports the following options:",
      "pos": [
        4263,
        4314
      ]
    },
    {
      "pos": [
        4318,
        4529
      ],
      "content": "<bpt id=\"p1\">**</bpt>Require Multi-factor authentication<ept id=\"p1\">**</ept>: With this option the users that the access rules apply to will be required to complete multi-factor authentication before accessing the application the policy applies to."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Require Multi-factor authentication when not at work<ept id=\"p1\">**</ept>: With this option a user that is coming from a trusted IP will not be required to perform multi-factor authentication.",
      "pos": [
        4533,
        4708
      ]
    },
    {
      "content": "The trusted IP ranges can be configured on the multi-factor authentication settings page",
      "pos": [
        4709,
        4797
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Block access when not at work<ept id=\"p1\">**</ept>: With this option a user that is not coming from a trusted IP will be blocked.",
      "pos": [
        4801,
        4913
      ]
    },
    {
      "content": "The trusted IP ranges can be configured on the multi-factor authentication settings page.",
      "pos": [
        4914,
        5003
      ]
    },
    {
      "content": "Setting rule status",
      "pos": [
        5008,
        5027
      ]
    },
    {
      "content": "Access rule status allows turning the rules on or off.",
      "pos": [
        5028,
        5082
      ]
    },
    {
      "content": "When the access rules are off the multi-factor authentication requirement will not be enforced.",
      "pos": [
        5083,
        5178
      ]
    },
    {
      "content": "Access rule evaluation",
      "pos": [
        5184,
        5206
      ]
    },
    {
      "content": "Access rules are evaluated when a user accesses a federated application that uses OAuth 2.0, OpenID Connect, SAML or WS-Federation.",
      "pos": [
        5208,
        5339
      ]
    },
    {
      "content": "In addition access rules are evaluated when the OAuth 2.0 and OpenID Connect when a refresh token is used to acquire an access token.",
      "pos": [
        5340,
        5473
      ]
    },
    {
      "content": "If policy evaluation fails when a refresh token is used, the error invalid_grant will be returned, this indicates the user needs to re-authenticate to the client.",
      "pos": [
        5474,
        5636
      ]
    },
    {
      "content": "Configure federation services to provide multi-factor authentication",
      "pos": [
        5637,
        5705
      ]
    },
    {
      "content": "For federated tenants, multi-factor authentication (MFA) may performed by Azure Active Directory or by the on-premises AD FS server.",
      "pos": [
        5707,
        5839
      ]
    },
    {
      "content": "By default, MFA will occur at a page hosted by Azure Active Directory.",
      "pos": [
        5841,
        5911
      ]
    },
    {
      "content": "In order to configure MFA on-premises, the –SupportsMFA property must be set to true in Azure Active Directory, by using the Azure AD module for Windows PowerShell.",
      "pos": [
        5912,
        6076
      ]
    },
    {
      "pos": [
        6078,
        6273
      ],
      "content": "The following example shows how to enable on-premises MFA by using the <bpt id=\"p1\">[</bpt>Set-MsolDomainFederationSettings cmdlet<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/dn194088.aspx)</ept> on the contoso.com tenant:"
    },
    {
      "content": "In addition to setting this flag, the federated tenant AD FS instance must be configured to perform multi-factor authentication.",
      "pos": [
        6356,
        6484
      ]
    },
    {
      "content": "Follow the instructions for deploying Azure Multi-Factor Authentication on-premises.",
      "pos": [
        6485,
        6569
      ]
    },
    {
      "content": "test",
      "pos": [
        6572,
        6576
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Azure Conditional Access Preview for SaaS Apps| Microsoft Azure\"\n    description=\"Conditional access in Azure AD allows you to configure per-application multi-factor authentication access rules and the ability to block access for users not on a trusted network. \"\n    services=\"active-directory\"\n    documentationCenter=\"\"\n    authors=\"femila\"\n    manager=\"stevenpo\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"active-directory\"\n    ms.workload=\"identity\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"08/12/2015\"\n    ms.author=\"femila\"/>\n\n# Azure Conditional Access Preview for SaaS Apps\n\nThe Azure Conditional Access for SaaS apps is available for public preview. The preview allows you to configure per-application multi-factor authentication access rules and the ability to block access for users not on a trusted network. \n\nYou can apply the multi-factor authentication rules to all users that are assigned to the application, or only for users within specified security groups. Users may be excluded from the multi-factor authentication requirement if they are accessing the application from an IP address that in inside the organization’s network.\nThese capabilities will be available to customers that have purchased an Azure Active Directory Premium license.\n\n## Scenario prerequisites\n* Subscription to Azure Active Directory Premium\n\n* Federated or Managed Azure Active Directory tenant\n\n* Federated tenants require that multi-factor authentication (MFA) be enabled.\n\n## Known issues in this Preview release\nThis preview applies to pre-integrated federated SaaS applications, applications that use password single-sign on, registered developed and line of business applications and Azure AD Application Proxy. Some additional applications are still being enabled..\n\n##Configure per-application access rules\n\nThis section describes how to configure per-application access rules.\n\n1. Log on to the Microsoft Azure Portal as Administrator.\n2. On the left pane, select **Active Directory**.\n3. On the Directory tab, select your directory.\n4. Select the **Applications** tab.\n5. Select the application that the rule will be set for.\n6. Select the **Configure** tab.\n7. Scroll down to the access rules section. Select the desired access rule.\n8. Specify the users the rule will apply to..\n9. Enable the policy by selecting **Enabled to be On**.\n\n##Understanding access rules\n\nThis section gives a detailed description of the access rules supported in the Azure Conditional Application Access Preview.\n### Specifying the users the access rules apply to\n\nBy default the policy will apply to all users that have access to the application. However you can also restrict the policy to users that are members of the specified security groups. The **Add Group** button is used to select one or more groups from the group selection dialog that the access rule will apply to. This dialog can also be used to remove selected groups. When the rules are selected to apply to Groups, the access rules will only be enforced for users that belong to one of the specified security groups.\n\nSecurity groups can also be explicitly excluded from the policy by selecting the Except option and specifying one or more groups. Users that are a member of a group in the Except list will not be subject to the multi-factor authentication requirement, even if they are a member of a group that the access rule applies to.\nThe access rule shown in the below will require all users in the Managers group to use multi-factor authentication when accessing the application.\n\n![Setting conditional access rules with MFA](./media/active-directory-conditional-access/conditionalaccess-saas-apps.jpg)\n\n##Conditional Access Rules with MFA\nIf a user has been configured using the per-user multi-factor authentication feature, this setting on the user will take precedence over the app multi-factor authentication rules. This means a user that has been configured for per-user multi-factor authentication will be required to perform multi-factor authentication even if they have been exempted from the application multi-factor authentication rules. Learn more about multi-factor authentication and per-user settings.\n\n###Access rule options\nThe current preview supports the following options:\n\n* **Require Multi-factor authentication**: With this option the users that the access rules apply to will be required to complete multi-factor authentication before accessing the application the policy applies to.\n\n* **Require Multi-factor authentication when not at work**: With this option a user that is coming from a trusted IP will not be required to perform multi-factor authentication. The trusted IP ranges can be configured on the multi-factor authentication settings page\n\n* **Block access when not at work**: With this option a user that is not coming from a trusted IP will be blocked. The trusted IP ranges can be configured on the multi-factor authentication settings page.\n\n###Setting rule status\nAccess rule status allows turning the rules on or off. When the access rules are off the multi-factor authentication requirement will not be enforced.\n\n### Access rule evaluation\n\nAccess rules are evaluated when a user accesses a federated application that uses OAuth 2.0, OpenID Connect, SAML or WS-Federation. In addition access rules are evaluated when the OAuth 2.0 and OpenID Connect when a refresh token is used to acquire an access token. If policy evaluation fails when a refresh token is used, the error invalid_grant will be returned, this indicates the user needs to re-authenticate to the client.\nConfigure federation services to provide multi-factor authentication\n\nFor federated tenants, multi-factor authentication (MFA) may performed by Azure Active Directory or by the on-premises AD FS server.\n\nBy default, MFA will occur at a page hosted by Azure Active Directory. In order to configure MFA on-premises, the –SupportsMFA property must be set to true in Azure Active Directory, by using the Azure AD module for Windows PowerShell.\n\nThe following example shows how to enable on-premises MFA by using the [Set-MsolDomainFederationSettings cmdlet](https://msdn.microsoft.com/library/azure/dn194088.aspx) on the contoso.com tenant:\n\n    Set-MsolDomainFederationSettings -DomainName contoso.com -SupportsMFA $true\n\nIn addition to setting this flag, the federated tenant AD FS instance must be configured to perform multi-factor authentication. Follow the instructions for deploying Azure Multi-Factor Authentication on-premises.\n\n\ntest\n"
}