{
  "nodes": [
    {
      "content": "Stage a cloud service deployment (Node.js) | Microsoft Azure",
      "pos": [
        28,
        88
      ]
    },
    {
      "content": "Learn how to deploy your Azure application to a staging environment, then deploy to a production environment using Virtual IP (VIP) swap.",
      "pos": [
        108,
        245
      ]
    },
    {
      "content": "Staging an Application in Azure",
      "pos": [
        573,
        604
      ]
    },
    {
      "content": "A packaged application can be deployed to the staging environment in",
      "pos": [
        606,
        674
      ]
    },
    {
      "content": "Azure to be tested before you move it to the production",
      "pos": [
        675,
        730
      ]
    },
    {
      "content": "environment in which the application is accessible on the Internet.",
      "pos": [
        731,
        798
      ]
    },
    {
      "content": "The",
      "pos": [
        799,
        802
      ]
    },
    {
      "content": "staging environment is exactly like the production environment, except",
      "pos": [
        803,
        873
      ]
    },
    {
      "content": "that you can only access the staged application with an obfuscated URL",
      "pos": [
        874,
        944
      ]
    },
    {
      "content": "that is generated by Azure.",
      "pos": [
        945,
        972
      ]
    },
    {
      "content": "After you have verified that your",
      "pos": [
        973,
        1006
      ]
    },
    {
      "content": "application is working correctly, it can be deployed to the production",
      "pos": [
        1007,
        1077
      ]
    },
    {
      "content": "environment by performing a Virtual IP (VIP) swap.",
      "pos": [
        1078,
        1128
      ]
    },
    {
      "pos": [
        1132,
        1236
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> The steps in this article only apply to node applications hosted as an Azure Cloud Service."
    },
    {
      "content": "This task includes the following steps:",
      "pos": [
        1238,
        1277
      ]
    },
    {
      "content": "Step 1: Stage an Application",
      "pos": [
        1284,
        1312
      ]
    },
    {
      "content": "Step 2: Deploy an Application to Production by Swapping VIPs",
      "pos": [
        1319,
        1379
      ]
    },
    {
      "content": "Step 1: Stage an Application",
      "pos": [
        1385,
        1413
      ]
    },
    {
      "pos": [
        1415,
        1502
      ],
      "content": "This task covers how to stage an application by using the <bpt id=\"p1\">**</bpt>Windows\nAzure PowerShell<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        1508,
        1621
      ],
      "content": "When publishing a service, simply pass the **-Slot** parameter to\nthe **Publish-AzureServiceProject** cmdlet.",
      "leadings": [
        "",
        "    "
      ],
      "nodes": [
        {
          "content": "When publishing a service, simply pass the <bpt id=\"p1\">**</bpt>-Slot<ept id=\"p1\">**</ept> parameter to",
          "pos": [
            0,
            65
          ]
        },
        {
          "content": "the <bpt id=\"p1\">**</bpt>Publish-AzureServiceProject<ept id=\"p1\">**</ept> cmdlet.",
          "pos": [
            66,
            109
          ]
        }
      ]
    },
    {
      "content": "Publish-AzureServiceProject -Slot staging",
      "pos": [
        1629,
        1670
      ]
    },
    {
      "content": "Log on to the <bpt id=\"p1\">[</bpt><ept id=\"p1\">Azure Management Portal]</ept> and select <bpt id=\"p2\">**</bpt>Cloud Services<ept id=\"p2\">**</ept>.",
      "pos": [
        1678,
        1748
      ]
    },
    {
      "content": "After the cloud service is created and the <bpt id=\"p1\">**</bpt>Staging<ept id=\"p1\">**</ept> column status has been updated to <bpt id=\"p2\">**</bpt>Running<ept id=\"p2\">**</ept>, click on the service name.",
      "pos": [
        1749,
        1877
      ]
    },
    {
      "content": "portal displaying a running service",
      "pos": [
        1885,
        1920
      ]
    },
    {
      "pos": [
        1942,
        1996
      ],
      "content": "Select the <bpt id=\"p1\">**</bpt>Dashboard<ept id=\"p1\">**</ept>, and then select <bpt id=\"p2\">**</bpt>Staging<ept id=\"p2\">**</ept>."
    },
    {
      "content": "cloud service dashboard",
      "pos": [
        2004,
        2027
      ]
    },
    {
      "content": "Note the value in the <bpt id=\"p1\">**</bpt>Site URL<ept id=\"p1\">**</ept> entry to the right.",
      "pos": [
        2058,
        2112
      ]
    },
    {
      "content": "The DNS name is an obfuscated internal ID that Azure generated.",
      "pos": [
        2113,
        2176
      ]
    },
    {
      "content": "site url",
      "pos": [
        2184,
        2192
      ]
    },
    {
      "content": "Now you can verify that the application is working correctly in the staging environment by using the staging site URL.",
      "pos": [
        2222,
        2340
      ]
    },
    {
      "content": "For an upgrade scenario, in which the staged application is an upgraded",
      "pos": [
        2342,
        2413
      ]
    },
    {
      "content": "version of one that has already been deployed to production, you can",
      "pos": [
        2414,
        2482
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>upgrade the application in the production environment by swapping the\nVIPs<ept id=\"p1\">][Step 2: Deploy an Application to Production by Swapping VIPs]</ept>.",
      "pos": [
        2483,
        2622
      ]
    },
    {
      "content": "Step 2: Upgrade an Application in Production by Swapping VIPs",
      "pos": [
        2627,
        2688
      ]
    },
    {
      "content": "After you have verified the upgraded version of an application in the",
      "pos": [
        2690,
        2759
      ]
    },
    {
      "content": "staging environment, you can quickly make it available in production by",
      "pos": [
        2760,
        2831
      ]
    },
    {
      "content": "swapping the virtual IPs (VIPs) of the staging and production",
      "pos": [
        2832,
        2893
      ]
    },
    {
      "content": "environments.",
      "pos": [
        2894,
        2907
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> This step assumes that you have already deployed an",
      "pos": [
        2911,
        2975
      ]
    },
    {
      "content": "application to production and staged the upgraded version of the",
      "pos": [
        2976,
        3040
      ]
    },
    {
      "content": "application.",
      "pos": [
        3041,
        3053
      ]
    },
    {
      "pos": [
        3059,
        3161
      ],
      "content": "Log into the [Azure Management Portal],\nclick **Cloud Services** and then select the service name.",
      "leadings": [
        "",
        "    "
      ],
      "nodes": [
        {
          "content": "Log into the <bpt id=\"p1\">[</bpt><ept id=\"p1\">Azure Management Portal]</ept>,",
          "pos": [
            0,
            39
          ]
        },
        {
          "content": "click <bpt id=\"p1\">**</bpt>Cloud Services<ept id=\"p1\">**</ept> and then select the service name.",
          "pos": [
            40,
            98
          ]
        }
      ]
    },
    {
      "pos": [
        3167,
        3297
      ],
      "content": "From the **Dashboard**, select **Staging**, and then click **Swap** at the bottom of the page. This opens the VIP Swap\ndialog.",
      "leadings": [
        "",
        "    "
      ],
      "nodes": [
        {
          "content": "From the **Dashboard**, select **Staging**, and then click **Swap** at the bottom of the page. This opens the VIP Swap",
          "pos": [
            0,
            118
          ],
          "nodes": [
            {
              "content": "From the <bpt id=\"p1\">**</bpt>Dashboard<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Staging<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Swap<ept id=\"p3\">**</ept> at the bottom of the page.",
              "pos": [
                0,
                94
              ]
            },
            {
              "content": "This opens the VIP Swap",
              "pos": [
                95,
                118
              ]
            }
          ]
        },
        {
          "content": "dialog.",
          "pos": [
            119,
            126
          ]
        }
      ]
    },
    {
      "content": "vip swap dialog",
      "pos": [
        3305,
        3320
      ]
    },
    {
      "pos": [
        3344,
        3533
      ],
      "content": "Review the information, and then click **OK**. The two deployments\nbegin updating as the staging deployment switches to production and\nthe production deployment switches to staging.",
      "leadings": [
        "",
        "    ",
        "    "
      ],
      "nodes": [
        {
          "content": "Review the information, and then click **OK**. The two deployments",
          "pos": [
            0,
            66
          ],
          "nodes": [
            {
              "content": "Review the information, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.",
              "pos": [
                0,
                46
              ]
            },
            {
              "content": "The two deployments",
              "pos": [
                47,
                66
              ]
            }
          ]
        },
        {
          "content": "begin updating as the staging deployment switches to production and",
          "pos": [
            67,
            134
          ]
        },
        {
          "content": "the production deployment switches to staging.",
          "pos": [
            135,
            181
          ]
        }
      ]
    },
    {
      "content": "You have successfully staged a deployment and upgraded a production",
      "pos": [
        3535,
        3602
      ]
    },
    {
      "content": "deployment by swapping VIPs with the deployment in staging.",
      "pos": [
        3603,
        3662
      ]
    },
    {
      "content": "Additional Resources",
      "pos": [
        3667,
        3687
      ]
    },
    {
      "content": "How to Deploy a Service Upgrade to Production by Swapping VIPs in Azure",
      "pos": [
        3692,
        3763
      ]
    },
    {
      "content": "Overview of Managing Deployments in Azure",
      "pos": [
        3768,
        3809
      ]
    },
    {
      "content": "test",
      "pos": [
        4643,
        4647
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Stage a cloud service deployment (Node.js) | Microsoft Azure\" \n    description=\"Learn how to deploy your Azure application to a staging environment, then deploy to a production environment using Virtual IP (VIP) swap.\" \n    services=\"cloud-services\" \n    documentationCenter=\"nodejs\" \n    authors=\"MikeWasson\" \n    manager=\"wpickett\" \n    editor=\"\"/>\n\n<tags \n    ms.service=\"cloud-services\" \n    ms.workload=\"tbd\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"nodejs\" \n    ms.topic=\"article\" \n    ms.date=\"02/25/2015\" \n    ms.author=\"mwasson\"/>\n\n\n\n# Staging an Application in Azure\n\nA packaged application can be deployed to the staging environment in\nAzure to be tested before you move it to the production\nenvironment in which the application is accessible on the Internet. The\nstaging environment is exactly like the production environment, except\nthat you can only access the staged application with an obfuscated URL\nthat is generated by Azure. After you have verified that your\napplication is working correctly, it can be deployed to the production\nenvironment by performing a Virtual IP (VIP) swap.\n\n> [AZURE.NOTE] The steps in this article only apply to node applications hosted as an Azure Cloud Service.\n\nThis task includes the following steps:\n\n-   [Step 1: Stage an Application]\n-   [Step 2: Deploy an Application to Production by Swapping VIPs]\n\n## Step 1: Stage an Application\n\nThis task covers how to stage an application by using the **Windows\nAzure PowerShell**.\n\n1.  When publishing a service, simply pass the **-Slot** parameter to\n    the **Publish-AzureServiceProject** cmdlet.\n\n    **Publish-AzureServiceProject -Slot staging**\n\n2.  Log on to the [Azure Management Portal] and select **Cloud Services**. After the cloud service is created and the **Staging** column status has been updated to **Running**, click on the service name.\n\n    ![portal displaying a running service][cloud-service]\n\n3.  Select the **Dashboard**, and then select **Staging**.\n\n    ![cloud service dashboard][cloud-service-dashboard]\n\n4. Note the value in the **Site URL** entry to the right. The DNS name is an obfuscated internal ID that Azure generated.\n\n    ![site url][cloud-service-staging-url]\n\nNow you can verify that the application is working correctly in the staging environment by using the staging site URL.\n\nFor an upgrade scenario, in which the staged application is an upgraded\nversion of one that has already been deployed to production, you can\n[upgrade the application in the production environment by swapping the\nVIPs][Step 2: Deploy an Application to Production by Swapping VIPs].\n\n## Step 2: Upgrade an Application in Production by Swapping VIPs\n\nAfter you have verified the upgraded version of an application in the\nstaging environment, you can quickly make it available in production by\nswapping the virtual IPs (VIPs) of the staging and production\nenvironments.\n\n> [AZURE.NOTE] This step assumes that you have already deployed an\napplication to production and staged the upgraded version of the\napplication.\n\n1.  Log into the [Azure Management Portal],\n    click **Cloud Services** and then select the service name.\n\n2.  From the **Dashboard**, select **Staging**, and then click **Swap** at the bottom of the page. This opens the VIP Swap\n    dialog.\n\n    ![vip swap dialog][vip-swap-dialog]\n\n3.  Review the information, and then click **OK**. The two deployments\n    begin updating as the staging deployment switches to production and\n    the production deployment switches to staging.\n\nYou have successfully staged a deployment and upgraded a production\ndeployment by swapping VIPs with the deployment in staging.\n\n## Additional Resources\n\n- [How to Deploy a Service Upgrade to Production by Swapping VIPs in Azure]\n- [Overview of Managing Deployments in Azure]\n\n  [Step 1: Stage an Application]: #step1\n  [Step 2: Deploy an Application to Production by Swapping VIPs]: #step2\n  [Azure Management Portal]: http://manage.windowsazure.com\n[cloud-service]: ./media/cloud-services-nodejs-stage-application/staging-cloud-service-running.png\n[cloud-service-dashboard]: ./media/cloud-services-nodejs-stage-application/cloud-service-dashboard-staging.png\n  [cloud-service-staging-url]: ./media/cloud-services-nodejs-stage-application/cloud-service-staging-url.png\n  [vip-swap-dialog]: ./media/cloud-services-nodejs-stage-application/vip-swap-dialog.png\n  [How to Deploy a Service Upgrade to Production by Swapping VIPs in Azure]: http://msdn.microsoft.com/library/windowsazure/ee517253.aspx\n  [Overview of Managing Deployments in Azure]: http://msdn.microsoft.com/library/windowsazure/hh386336.aspx\n \n\ntest\n"
}