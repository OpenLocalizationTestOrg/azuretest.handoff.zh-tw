{
  "nodes": [
    {
      "content": "Call a custom API from an HTML client - Mobile Services",
      "pos": [
        27,
        82
      ]
    },
    {
      "content": "Learn how to define a custom API and then call it from an HTML app that uses Azure Mobile Services.",
      "pos": [
        101,
        200
      ]
    },
    {
      "content": "Call a custom API from an HTML application",
      "pos": [
        526,
        568
      ]
    },
    {
      "content": "This topic shows you how to call a custom API from an HTML application.",
      "pos": [
        690,
        761
      ]
    },
    {
      "content": "A custom API enables you to define custom endpoints that expose server functionality that does not map to an insert, update, delete, or read operation.",
      "pos": [
        762,
        913
      ]
    },
    {
      "content": "By using a custom API, you can have more control over messaging, including reading and setting HTTP message headers and defining a message body format other than JSON.",
      "pos": [
        914,
        1081
      ]
    },
    {
      "content": "The custom API created in this topic gives you the ability to send a single POST request that sets the completed flag to <ph id=\"ph1\">`true`</ph> for all the todo items in the table.",
      "pos": [
        1083,
        1247
      ]
    },
    {
      "content": "Without this custom API, the client would have to send individual requests to update the flag for each todo item in the table.",
      "pos": [
        1248,
        1374
      ]
    },
    {
      "content": "This tutorial is based on the Mobile Services quickstart.",
      "pos": [
        1376,
        1433
      ]
    },
    {
      "content": "Before you start this tutorial, you must first complete <bpt id=\"p1\">[</bpt><ept id=\"p1\">Get started with Mobile Services]</ept> or <bpt id=\"p2\">[</bpt><ept id=\"p2\">Add Mobile Services to an existing app]</ept>.",
      "pos": [
        1434,
        1569
      ]
    },
    {
      "pos": [
        1574,
        1627
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"define-custom-api\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Define the custom API"
    },
    {
      "pos": [
        1737,
        1799
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"update-app\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Update the app to call the custom API"
    },
    {
      "pos": [
        1804,
        1956
      ],
      "content": "Using your text editor, open the index.html file, locate the <bpt id=\"p1\">**</bpt>button<ept id=\"p1\">**</ept> element named <ph id=\"ph1\">`buttonRefresh`</ph>, and add the following new element right after it:"
    },
    {
      "content": "This adds a new button to the page.",
      "pos": [
        2024,
        2059
      ]
    },
    {
      "pos": [
        2064,
        2144
      ],
      "content": "In page.js, and after the <bpt id=\"p1\">**</bpt>refreshTodoItems<ept id=\"p1\">**</ept> function, add the following code:"
    },
    {
      "content": "This method handles the <bpt id=\"p1\">**</bpt>Click<ept id=\"p1\">**</ept> event for the new button.",
      "pos": [
        2771,
        2830
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>invokeApi<ept id=\"p1\">**</ept> method is called on the client, which sends a POST request to the new custom API.",
      "pos": [
        2831,
        2930
      ]
    },
    {
      "content": "The result returned by the custom API is displayed in a message dialog, as are any errors.",
      "pos": [
        2931,
        3021
      ]
    },
    {
      "pos": [
        3026,
        3061
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"test-app\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Test the app"
    },
    {
      "content": "Refresh your browser.",
      "pos": [
        3066,
        3087
      ]
    },
    {
      "pos": [
        3092,
        3165
      ],
      "content": "In the app, type some text in <bpt id=\"p1\">**</bpt>Insert a TodoItem<ept id=\"p1\">**</ept>, then click <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Repeat the previous step until you have added several todo items to the list.",
      "pos": [
        3170,
        3247
      ]
    },
    {
      "content": "Click the <bpt id=\"p1\">**</bpt>Complete All<ept id=\"p1\">**</ept> button.",
      "pos": [
        3252,
        3286
      ]
    },
    {
      "content": "A message dialog is displayed that indicates the number of items marked complete and the filtered query is executed again, which clears all items from the list.",
      "pos": [
        3287,
        3447
      ]
    },
    {
      "content": "Next steps",
      "pos": [
        3452,
        3462
      ]
    },
    {
      "content": "This topic showed how to use the <bpt id=\"p1\">**</bpt>invokeApi<ept id=\"p1\">**</ept> function to call a fairly simple custom API from your HTML/JavaScript app.",
      "pos": [
        3464,
        3585
      ]
    },
    {
      "content": "To learn more about using the <bpt id=\"p1\">**</bpt>invokeApi<ept id=\"p1\">**</ept> function, see the post <bpt id=\"p2\">[</bpt>Custom API in Azure Mobile Services<ept id=\"p2\">](http://blogs.msdn.com/b/carlosfigueira/archive/2013/06/19/custom-api-in-azure-mobile-services-client-sdks.aspx)</ept>.",
      "pos": [
        3586,
        3803
      ]
    },
    {
      "content": "Also, consider finding out more about the following Mobile Services topics:",
      "pos": [
        3807,
        3882
      ]
    },
    {
      "pos": [
        3886,
        3973
      ],
      "content": "[Mobile Services server script reference]\n<br/>Learn more about creating custom APIs.",
      "leadings": [
        "",
        "  "
      ],
      "nodes": [
        {
          "content": "Learn more about creating custom APIs.",
          "pos": [
            47,
            85
          ]
        }
      ]
    },
    {
      "pos": [
        3977,
        4141
      ],
      "content": "[Store server scripts in source control]\n<br/> Learn how to use the source control feature to more easily and securely develop and publish custom API script code.",
      "leadings": [
        "",
        "  "
      ],
      "nodes": [
        {
          "content": "Learn how to use the source control feature to more easily and securely develop and publish custom API script code.",
          "pos": [
            47,
            162
          ]
        }
      ]
    },
    {
      "content": "test",
      "pos": [
        4661,
        4665
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Call a custom API from an HTML client - Mobile Services\"\n    description=\"Learn how to define a custom API and then call it from an HTML app that uses Azure Mobile Services.\"\n    services=\"mobile-services\"\n    documentationCenter=\"\"\n    authors=\"ggailey777\"  \n    manager=\"dwrede\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"mobile-services\"\n    ms.workload=\"mobile\"\n    ms.tgt_pltfrm=\"mobile-html\" \n    ms.devlang=\"javascript\"\n    ms.topic=\"article\"\n    ms.date=\"06/16/2015\"\n    ms.author=\"glenga\"/>\n\n# Call a custom API from an HTML application\n\n[AZURE.INCLUDE [mobile-services-selector-call-custom-api](../../includes/mobile-services-selector-call-custom-api.md)]\n\nThis topic shows you how to call a custom API from an HTML application. A custom API enables you to define custom endpoints that expose server functionality that does not map to an insert, update, delete, or read operation. By using a custom API, you can have more control over messaging, including reading and setting HTTP message headers and defining a message body format other than JSON.\n\nThe custom API created in this topic gives you the ability to send a single POST request that sets the completed flag to `true` for all the todo items in the table. Without this custom API, the client would have to send individual requests to update the flag for each todo item in the table.\n\nThis tutorial is based on the Mobile Services quickstart. Before you start this tutorial, you must first complete [Get started with Mobile Services] or [Add Mobile Services to an existing app].\n\n## <a name=\"define-custom-api\"></a>Define the custom API\n\n[AZURE.INCLUDE [mobile-services-create-custom-api](../../includes/mobile-services-create-custom-api.md)]\n\n##<a name=\"update-app\"></a>Update the app to call the custom API\n\n1. Using your text editor, open the index.html file, locate the **button** element named `buttonRefresh`, and add the following new element right after it:\n\n        <button id=\"buttonCompleteAll\">Complete All</button>\n\n    This adds a new button to the page.\n\n2. In page.js, and after the **refreshTodoItems** function, add the following code:\n\n        var completeAllTodoItems = function () {\n            // Asynchronously call the custom API using the POST method.\n            client.invokeApi(\"completeall\", {\n                body: null,\n                method: \"post\"\n            }).done(function (results) {\n                var message = results.result.count + \" item(s) marked as complete.\";\n                alert(message);\n                refreshTodoItems();\n            }, function(error) {\n                alert(error.message);\n            });\n        };\n\n        $('#buttonCompleteAll').click(function () {\n            completeAllTodoItems();\n        });\n\n    This method handles the **Click** event for the new button. The **invokeApi** method is called on the client, which sends a POST request to the new custom API. The result returned by the custom API is displayed in a message dialog, as are any errors.\n\n## <a name=\"test-app\"></a>Test the app\n\n1. Refresh your browser.\n\n2. In the app, type some text in **Insert a TodoItem**, then click **Save**.\n\n3. Repeat the previous step until you have added several todo items to the list.\n\n4. Click the **Complete All** button. A message dialog is displayed that indicates the number of items marked complete and the filtered query is executed again, which clears all items from the list.\n\n## Next steps\n\nThis topic showed how to use the **invokeApi** function to call a fairly simple custom API from your HTML/JavaScript app. To learn more about using the **invokeApi** function, see the post [Custom API in Azure Mobile Services](http://blogs.msdn.com/b/carlosfigueira/archive/2013/06/19/custom-api-in-azure-mobile-services-client-sdks.aspx).  \n\nAlso, consider finding out more about the following Mobile Services topics:\n\n* [Mobile Services server script reference]\n  <br/>Learn more about creating custom APIs.\n\n* [Store server scripts in source control]\n  <br/> Learn how to use the source control feature to more easily and securely develop and publish custom API script code.\n\n<!-- Anchors. -->\n[Define the custom API]: #define-custom-api\n[Update the app to call the custom API]: #update-app\n[Test the app]: #test-app\n[Next Steps]: #next-steps\n\n<!-- URLs. -->\n[Mobile Services server script reference]: http://go.microsoft.com/fwlink/?LinkId=262293\n[Get started with Mobile Services]: mobile-services-html-get-started.md\n[Add Mobile Services to an existing app]: mobile-services-html-get-started-data.md\n[Store server scripts in source control]: mobile-services-store-scripts-source-control.md\n\ntest\n"
}