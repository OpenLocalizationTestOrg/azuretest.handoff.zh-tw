{
  "nodes": [
    {
      "content": "Log in from the Azure Command-Line Interface (Azure CLI) | Microsoft Azure",
      "pos": [
        27,
        101
      ]
    },
    {
      "content": "Connect to Azure subscription from the Azure Command-Line Interface (Azure CLI)",
      "pos": [
        120,
        199
      ]
    },
    {
      "content": "Connect to an Azure subscription from the Azure Command-Line Interface (Azure CLI)",
      "pos": [
        506,
        588
      ]
    },
    {
      "content": "The Azure CLI is a set of open source, cross-platform commands for working with the Azure Platform.",
      "pos": [
        590,
        689
      ]
    },
    {
      "content": "This document describes how to connect to your Azure subscription from the Azure CLI.",
      "pos": [
        690,
        775
      ]
    },
    {
      "content": "For installation instructions, see <bpt id=\"p1\">[</bpt>Install Azure CLI<ept id=\"p1\">](xplat-cli-install.md)</ept>.",
      "pos": [
        776,
        853
      ]
    },
    {
      "content": "How to connect to your Azure subscription",
      "pos": [
        881,
        922
      ]
    },
    {
      "content": "Most commands provided by the Azure CLI require a connection to an Azure account.",
      "pos": [
        924,
        1005
      ]
    },
    {
      "content": "There are two ways to configure the Azure CLI to work with your subscription:",
      "pos": [
        1006,
        1083
      ]
    },
    {
      "content": "Log in to Azure using a work or school account (also called an organizational account).",
      "pos": [
        1087,
        1174
      ]
    },
    {
      "content": "This uses Azure Active Directory to authenticate the credentials.",
      "pos": [
        1175,
        1240
      ]
    },
    {
      "content": "or",
      "pos": [
        1242,
        1244
      ]
    },
    {
      "content": "Download and use a publish settings file.",
      "pos": [
        1248,
        1289
      ]
    },
    {
      "content": "This installs a certificate that allows you to perform management tasks for as long as the subscription and the certificate are valid.",
      "pos": [
        1290,
        1424
      ]
    },
    {
      "pos": [
        1426,
        1613
      ],
      "content": "For more information about authentication and subscription management, see <bpt id=\"p1\">[</bpt>\"What's the difference between account-based authentication and certificate-based authentication\"<ept id=\"p1\">][authandsub]</ept>."
    },
    {
      "content": "If you don't have an account, you can create a free trial account in just a couple of minutes.",
      "pos": [
        1615,
        1709
      ]
    },
    {
      "content": "For details, see <bpt id=\"p1\">[</bpt>Azure Free Trial<ept id=\"p1\">][free-trial]</ept>.",
      "pos": [
        1710,
        1758
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> The most flexible and advanced Azure services use the Azure Resource Manager or the <bpt id=\"p1\">[</bpt>ARM mode<ept id=\"p1\">](xplat-cli-azure-resource-manager.md)</ept>.",
      "pos": [
        1762,
        1907
      ]
    },
    {
      "content": "The ARM mode requires connecting to Azure using a work or school account, with the log in method described below.",
      "pos": [
        1908,
        2021
      ]
    },
    {
      "content": "Use the log in method",
      "pos": [
        2027,
        2048
      ]
    },
    {
      "content": "The login method only works with a work or school account.",
      "pos": [
        2050,
        2108
      ]
    },
    {
      "content": "This account is managed by your organization, and defined in your organization's Azure Active Directory.",
      "pos": [
        2109,
        2213
      ]
    },
    {
      "pos": [
        2217,
        2408
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If you do not currently have a work or school account, and are using a personal account to log in to your Azure subscription, you can easily create one using the following steps."
    },
    {
      "pos": [
        2416,
        2485
      ],
      "content": "Login to the <bpt id=\"p1\">[</bpt>Azure Portal<ept id=\"p1\">][portal]</ept>, and select <bpt id=\"p2\">**</bpt>Active Directory<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        2493,
        2588
      ],
      "content": "If no directory exists, select <bpt id=\"p1\">**</bpt>Create your directory<ept id=\"p1\">**</ept> and provide the requested information."
    },
    {
      "content": "Select your directory and add a new user.",
      "pos": [
        2596,
        2637
      ]
    },
    {
      "content": "This new user is a work or school account.",
      "pos": [
        2638,
        2680
      ]
    },
    {
      "content": "During the creation of the user, you will be supplied with both an e-mail address for the user and a temporary password.",
      "pos": [
        2689,
        2809
      ]
    },
    {
      "content": "Save this information as it is needed later.",
      "pos": [
        2810,
        2854
      ]
    },
    {
      "content": "From the Azure portal, select <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Administrators<ept id=\"p2\">**</ept>.",
      "pos": [
        2862,
        2940
      ]
    },
    {
      "content": "Select <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, and add the new user as a co-administrator.",
      "pos": [
        2941,
        3000
      ]
    },
    {
      "content": "This allows the work or school account to manage your Azure subscription.",
      "pos": [
        3001,
        3074
      ]
    },
    {
      "content": "Finally, log out of the Azure portal and then log back in using the new work or school account.",
      "pos": [
        3082,
        3177
      ]
    },
    {
      "content": "If this is the first time logging in with this account, you will be prompted to change the password.",
      "pos": [
        3178,
        3278
      ]
    },
    {
      "content": "Make sure you see your subscriptions when you log in as the work or school account.",
      "pos": [
        3286,
        3369
      ]
    },
    {
      "pos": [
        3373,
        3486
      ],
      "content": "For more information on work or school accounts, see <bpt id=\"p1\">[</bpt>Sign up for Microsoft Azure as an Organization<ept id=\"p1\">][signuporg]</ept>."
    },
    {
      "content": "To log in from the Azure CLI using a work or school account, use the following command:",
      "pos": [
        3488,
        3575
      ]
    },
    {
      "content": "and enter your password when prompted for.",
      "pos": [
        3608,
        3650
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If this is the first time you have logged in with these credentials, you will receive a prompt asking you to verify that you wish to cache an authentication token.",
      "pos": [
        3654,
        3830
      ]
    },
    {
      "content": "This prompt will also occur if you have previously used the <ph id=\"ph1\">`azure logout`</ph> command described below.",
      "pos": [
        3831,
        3930
      ]
    },
    {
      "content": "To bypass this prompt for automation scenarios, use the <ph id=\"ph1\">`-q`</ph> parameter with the <ph id=\"ph2\">`azure login`</ph> command.",
      "pos": [
        3931,
        4033
      ]
    },
    {
      "content": "To log out, use the following command:",
      "pos": [
        4035,
        4073
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If the subscriptions associated with the account were only authenticated with Active Directory, logging out will delete the subscription information from the local profile.",
      "pos": [
        4109,
        4294
      ]
    },
    {
      "content": "However, if a publish settings file had also been imported for the subscriptions, logging out will only delete the Active Directory related information from the local profile.",
      "pos": [
        4295,
        4470
      ]
    },
    {
      "content": "Use the publish settings file method",
      "pos": [
        4476,
        4512
      ]
    },
    {
      "pos": [
        4516,
        4636
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If you connect using this method, you can only use the Azure Service Management (or the ASM mode) commands."
    },
    {
      "content": "To download the publish settings for your account, use the following command:",
      "pos": [
        4638,
        4715
      ]
    },
    {
      "content": "This will open your default browser and prompt you to sign in to the <bpt id=\"p1\">[</bpt>Azure Portal<ept id=\"p1\">][portal]</ept>.",
      "pos": [
        4745,
        4837
      ]
    },
    {
      "content": "After signing in, a <ph id=\"ph1\">`.publishsettings`</ph> file will be downloaded.",
      "pos": [
        4838,
        4901
      ]
    },
    {
      "content": "Make note of where this file is saved.",
      "pos": [
        4902,
        4940
      ]
    },
    {
      "pos": [
        4944,
        5135
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If your account is associated with multiple Azure Active Directory tenants, you may be prompted to select which Active Directory you wish to download a publish settings file for."
    },
    {
      "content": "Once selected using the download page, or by visiting the Azure Portal, the selected Active Directory becomes the default used by the portal and download page.",
      "pos": [
        5140,
        5299
      ]
    },
    {
      "content": "Once a default has been established, you will see the text '<bpt id=\"p1\">__</bpt>click here to return to the selection page<ept id=\"p1\">__</ept>' at the top of the download page.",
      "pos": [
        5300,
        5440
      ]
    },
    {
      "content": "Use the provided link to return to the selection page.",
      "pos": [
        5441,
        5495
      ]
    },
    {
      "pos": [
        5497,
        5571
      ],
      "content": "Next, import the <ph id=\"ph1\">`.publishsettings`</ph> file by running the following command:"
    },
    {
      "pos": [
        5636,
        5850
      ],
      "content": "After importing your publish settings, you should delete the <ph id=\"ph1\">`.publishsettings`</ph> file, as it is no longer required by the Azure CLI and presents a security risk as it can be used to gain access to your subscription."
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Whether you login with a work or school account or import publish settings, the information for accessing your Azure subscription is stored in a <ph id=\"ph2\">`.azure`</ph> directory located in your <ph id=\"ph3\">`user`</ph> directory.",
      "pos": [
        5854,
        6064
      ]
    },
    {
      "content": "Your <ph id=\"ph1\">`user`</ph> directory is protected by your operating system; however, it is recommended that you take additional steps to encrypt your <ph id=\"ph2\">`user`</ph> directory.",
      "pos": [
        6065,
        6217
      ]
    },
    {
      "content": "You can do so in the following ways:",
      "pos": [
        6218,
        6254
      ]
    },
    {
      "content": "On Windows, modify the directory properties or use BitLocker.",
      "pos": [
        6261,
        6322
      ]
    },
    {
      "content": "On Mac, turn on FileVault for the directory.",
      "pos": [
        6327,
        6371
      ]
    },
    {
      "content": "On Ubuntu, use the Encrypted Home directory feature.",
      "pos": [
        6376,
        6428
      ]
    },
    {
      "content": "Other Linux distributions offer equivalent features.",
      "pos": [
        6429,
        6481
      ]
    },
    {
      "content": "Multiple subscriptions",
      "pos": [
        6487,
        6509
      ]
    },
    {
      "content": "If you have multiple Azure subscriptions, connecting to Azure will grant access to all subscriptions associated with your credentials.",
      "pos": [
        6511,
        6645
      ]
    },
    {
      "content": "One subscription will be selected as the default, and used by the Azure CLI when performing operations.",
      "pos": [
        6646,
        6749
      ]
    },
    {
      "content": "You can view the subscriptions, as well as which one is the default, using the <ph id=\"ph1\">`azure account list`</ph> command.",
      "pos": [
        6750,
        6858
      ]
    },
    {
      "content": "This command will return information similar to the following:",
      "pos": [
        6859,
        6921
      ]
    },
    {
      "content": "In the above list, the <bpt id=\"p1\">**</bpt>Current<ept id=\"p1\">**</ept> column indicates the current default subscription as Azure-sub-1.",
      "pos": [
        7271,
        7371
      ]
    },
    {
      "content": "To change the default subscription, use the <ph id=\"ph1\">`azure account set`</ph> command, and specify the subscription that you wish to be the default.",
      "pos": [
        7372,
        7506
      ]
    },
    {
      "content": "For example:",
      "pos": [
        7507,
        7519
      ]
    },
    {
      "content": "This will change the default subscription to Azure-sub-2.",
      "pos": [
        7556,
        7613
      ]
    },
    {
      "pos": [
        7617,
        7858
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Changing the default subscription takes effect immediately, and is a global change; new Azure CLI commands, whether you run them from the same command-line instance or a different instance, will use the new default subscription."
    },
    {
      "pos": [
        7860,
        8103
      ],
      "content": "If you wish to use a non-default subscription with the Azure CLI, but don't want to change the current default, you can use the <ph id=\"ph1\">`--subscription`</ph> option for the command and provide the name of the subscription you wish to use for the operation."
    },
    {
      "content": "Once you are connected to your Azure subscription, you can start using the Azure CLI commands.",
      "pos": [
        8105,
        8199
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>How to use the Azure CLI<ept id=\"p1\">](xplat-cli.md)</ept>.",
      "pos": [
        8200,
        8267
      ]
    },
    {
      "content": "Additional resources",
      "pos": [
        8306,
        8326
      ]
    },
    {
      "content": "Using the Azure CLI with the Service Management (or ASM mode) commands",
      "pos": [
        8331,
        8401
      ]
    },
    {
      "content": "Using the Azure CLI with the Resource Management (or ARM mode) commands",
      "pos": [
        8415,
        8486
      ]
    },
    {
      "pos": [
        8499,
        8700
      ],
      "content": "For more information on the Azure CLI, to download source code, report problems, or contribute to the project, visit the <bpt id=\"p1\">[</bpt>GitHub repository for the Azure CLI<ept id=\"p1\">](https://github.com/azure/azure-xplat-cli)</ept>."
    },
    {
      "pos": [
        8704,
        8845
      ],
      "content": "If you encounter problems using the Azure CLI, or Azure, visit the <bpt id=\"p1\">[</bpt>Azure Forums<ept id=\"p1\">](http://social.msdn.microsoft.com/Forums/windowsazure/home)</ept>."
    },
    {
      "pos": [
        8849,
        8942
      ],
      "content": "For more information on Azure, see <bpt id=\"p1\">[</bpt>http://azure.microsoft.com/<ept id=\"p1\">](http://azure.microsoft.com)</ept>."
    },
    {
      "content": "test",
      "pos": [
        9371,
        9375
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Log in from the Azure Command-Line Interface (Azure CLI) | Microsoft Azure\"\n    description=\"Connect to Azure subscription from the Azure Command-Line Interface (Azure CLI)\"\n    editor=\"tysonn\"\n    manager=\"timlt\"\n    documentationCenter=\"\"\n    authors=\"dlepow\"\n    services=\"\"/>\n\n<tags\n    ms.service=\"multiple\"\n    ms.workload=\"multiple\"\n    ms.tgt_pltfrm=\"command-line-interface\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"06/09/2015\"\n    ms.author=\"danlep\"/>\n\n# Connect to an Azure subscription from the Azure Command-Line Interface (Azure CLI)\n\nThe Azure CLI is a set of open source, cross-platform commands for working with the Azure Platform. This document describes how to connect to your Azure subscription from the Azure CLI. For installation instructions, see [Install Azure CLI](xplat-cli-install.md).\n\n<a id=\"configure\"></a>\n## How to connect to your Azure subscription\n\nMost commands provided by the Azure CLI require a connection to an Azure account. There are two ways to configure the Azure CLI to work with your subscription:\n\n* Log in to Azure using a work or school account (also called an organizational account). This uses Azure Active Directory to authenticate the credentials.\n\nor\n\n* Download and use a publish settings file. This installs a certificate that allows you to perform management tasks for as long as the subscription and the certificate are valid.\n\nFor more information about authentication and subscription management, see [\"What's the difference between account-based authentication and certificate-based authentication\"][authandsub].\n\nIf you don't have an account, you can create a free trial account in just a couple of minutes. For details, see [Azure Free Trial][free-trial].\n\n> [AZURE.NOTE] The most flexible and advanced Azure services use the Azure Resource Manager or the [ARM mode](xplat-cli-azure-resource-manager.md). The ARM mode requires connecting to Azure using a work or school account, with the log in method described below.\n\n### Use the log in method\n\nThe login method only works with a work or school account. This account is managed by your organization, and defined in your organization's Azure Active Directory.\n\n> [AZURE.NOTE] If you do not currently have a work or school account, and are using a personal account to log in to your Azure subscription, you can easily create one using the following steps.\n>\n> 1. Login to the [Azure Portal][portal], and select **Active Directory**.\n>\n> 2. If no directory exists, select **Create your directory** and provide the requested information.\n>\n> 3. Select your directory and add a new user. This new user is a work or school account.\n>\n>     During the creation of the user, you will be supplied with both an e-mail address for the user and a temporary password. Save this information as it is needed later.\n>\n> 4. From the Azure portal, select **Settings** and then select **Administrators**. Select **Add**, and add the new user as a co-administrator. This allows the work or school account to manage your Azure subscription.\n>\n> 5. Finally, log out of the Azure portal and then log back in using the new work or school account. If this is the first time logging in with this account, you will be prompted to change the password.\n>\n> 6. Make sure you see your subscriptions when you log in as the work or school account.\n>\n>For more information on work or school accounts, see [Sign up for Microsoft Azure as an Organization][signuporg].\n\nTo log in from the Azure CLI using a work or school account, use the following command:\n\n    azure login -u <username>\n\nand enter your password when prompted for.\n\n> [AZURE.NOTE] If this is the first time you have logged in with these credentials, you will receive a prompt asking you to verify that you wish to cache an authentication token. This prompt will also occur if you have previously used the `azure logout` command described below. To bypass this prompt for automation scenarios, use the `-q` parameter with the `azure login` command.\n\nTo log out, use the following command:\n\n    azure logout -u <username>\n\n> [AZURE.NOTE] If the subscriptions associated with the account were only authenticated with Active Directory, logging out will delete the subscription information from the local profile. However, if a publish settings file had also been imported for the subscriptions, logging out will only delete the Active Directory related information from the local profile.\n\n### Use the publish settings file method\n\n> [AZURE.NOTE] If you connect using this method, you can only use the Azure Service Management (or the ASM mode) commands.\n\nTo download the publish settings for your account, use the following command:\n\n    azure account download\n\nThis will open your default browser and prompt you to sign in to the [Azure Portal][portal]. After signing in, a `.publishsettings` file will be downloaded. Make note of where this file is saved.\n\n> [AZURE.NOTE] If your account is associated with multiple Azure Active Directory tenants, you may be prompted to select which Active Directory you wish to download a publish settings file for.\n>\n> Once selected using the download page, or by visiting the Azure Portal, the selected Active Directory becomes the default used by the portal and download page. Once a default has been established, you will see the text '__click here to return to the selection page__' at the top of the download page. Use the provided link to return to the selection page.\n\nNext, import the `.publishsettings` file by running the following command:\n\n    azure account import <path to your .publishsettings file>\n\nAfter importing your publish settings, you should delete the `.publishsettings` file, as it is no longer required by the Azure CLI and presents a security risk as it can be used to gain access to your subscription.\n\n> [AZURE.NOTE] Whether you login with a work or school account or import publish settings, the information for accessing your Azure subscription is stored in a `.azure` directory located in your `user` directory. Your `user` directory is protected by your operating system; however, it is recommended that you take additional steps to encrypt your `user` directory. You can do so in the following ways:\n>\n> * On Windows, modify the directory properties or use BitLocker.\n> * On Mac, turn on FileVault for the directory.\n> * On Ubuntu, use the Encrypted Home directory feature. Other Linux distributions offer equivalent features.\n\n### Multiple subscriptions\n\nIf you have multiple Azure subscriptions, connecting to Azure will grant access to all subscriptions associated with your credentials. One subscription will be selected as the default, and used by the Azure CLI when performing operations. You can view the subscriptions, as well as which one is the default, using the `azure account list` command. This command will return information similar to the following:\n\n    info:    Executing command account list\n    data:    Name              Id                                    Current\n    data:    ----------------  ------------------------------------  -------\n    data:    Azure-sub-1       ####################################  true\n    data:    Azure-sub-2       ####################################  false\n\nIn the above list, the **Current** column indicates the current default subscription as Azure-sub-1. To change the default subscription, use the `azure account set` command, and specify the subscription that you wish to be the default. For example:\n\n    azure account set Azure-sub-2\n\nThis will change the default subscription to Azure-sub-2.\n\n> [AZURE.NOTE] Changing the default subscription takes effect immediately, and is a global change; new Azure CLI commands, whether you run them from the same command-line instance or a different instance, will use the new default subscription.\n\nIf you wish to use a non-default subscription with the Azure CLI, but don't want to change the current default, you can use the `--subscription` option for the command and provide the name of the subscription you wish to use for the operation.\n\nOnce you are connected to your Azure subscription, you can start using the Azure CLI commands. For more information, see [How to use the Azure CLI](xplat-cli.md).\n\n<a id=\"additional-resources\"></a>\n## Additional resources\n\n* [Using the Azure CLI with the Service Management (or ASM mode) commands][cliasm]\n\n* [Using the Azure CLI with the Resource Management (or ARM mode) commands][cliarm]\n\n* For more information on the Azure CLI, to download source code, report problems, or contribute to the project, visit the [GitHub repository for the Azure CLI](https://github.com/azure/azure-xplat-cli).\n\n* If you encounter problems using the Azure CLI, or Azure, visit the [Azure Forums](http://social.msdn.microsoft.com/Forums/windowsazure/home).\n\n* For more information on Azure, see [http://azure.microsoft.com/](http://azure.microsoft.com).\n\n\n\n\n\n[authandsub]: http://msdn.microsoft.com/library/windowsazure/hh531793.aspx#BKMK_AccountVCert\n[free-trial]: http://azure.microsoft.com/en-us/pricing/free-trial/\n[portal]: https://manage.windowsazure.com\n[signuporg]: http://azure.microsoft.com/en-us/documentation/articles/sign-up-organization/\n[cliasm]: virtual-machines/virtual-machines-command-line-tools.md\n[cliarm]: virtual-machines/xplat-cli-azure-resource-manager.md\n\ntest\n"
}