{
  "nodes": [
    {
      "content": "Set up a Hybrid Compute Cluster with Microsoft HPC Pack",
      "pos": [
        27,
        82
      ]
    },
    {
      "content": "Learn how to use Microsoft HPC Pack and Azure to set up a small, hybrid high performance computing (HPC) cluster",
      "pos": [
        101,
        213
      ]
    },
    {
      "content": "Set up a Hybrid Compute Cluster with Microsoft HPC Pack",
      "pos": [
        519,
        574
      ]
    },
    {
      "content": "This tutorial shows you how to use Microsoft HPC Pack 2012 R2 and Azure to set up a small, hybrid high performance computing (HPC) cluster.",
      "pos": [
        575,
        714
      ]
    },
    {
      "content": "The cluster will consist of an on-premises head node (a computer running the Windows Server operating system and HPC Pack) and some compute nodes you deploy on-demand as worker role instances in an Azure cloud service.",
      "pos": [
        715,
        933
      ]
    },
    {
      "content": "You can then run compute jobs on the hybrid cluster.",
      "pos": [
        934,
        986
      ]
    },
    {
      "content": "Hybrid HPC cluster",
      "pos": [
        990,
        1008
      ]
    },
    {
      "content": "This tutorial shows one approach, sometimes called cluster \"burst to the cloud,\" to use scalable, on-demand compute resources in Azure to run compute intensive applications.",
      "pos": [
        1021,
        1194
      ]
    },
    {
      "content": "This tutorial assumes no prior experience with compute clusters or HPC Pack.",
      "pos": [
        1196,
        1272
      ]
    },
    {
      "content": "It is intended only to help you deploy a hybrid compute cluster quickly for demonstration purposes.",
      "pos": [
        1273,
        1372
      ]
    },
    {
      "content": "For considerations and steps to deploy a hybrid HPC Pack cluster at greater scale in a production environment, see the <bpt id=\"p1\">[</bpt>detailed guidance<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=200493)</ept>.",
      "pos": [
        1373,
        1561
      ]
    },
    {
      "content": "If you want to set up an HPC Pack cluster entirely in Azure, see <bpt id=\"p1\">[</bpt>Microsoft HPC Pack in Azure VMs<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=330375)</ept>.",
      "pos": [
        1562,
        1710
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Azure offers a <bpt id=\"p1\">[</bpt>range of sizes<ept id=\"p1\">](../virtual-machines/virtual-machines-size-specs.md)</ept> for your compute resources, suitable for different workloads.",
      "pos": [
        1713,
        1871
      ]
    },
    {
      "content": "For example, the A8 and A9 instances combine high performance and access to a low latency, high throughput application network needed for certain HPC applications.",
      "pos": [
        1872,
        2035
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>About the A8, A9, A10, and A11 Compute Intensive Instances<ept id=\"p1\">](../virtual-machines/virtual-machines-a8-a9-a10-a11-specs.md)</ept>.",
      "pos": [
        2036,
        2162
      ]
    },
    {
      "content": "Prerequisites",
      "pos": [
        2167,
        2180
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>To complete this tutorial, you need an Azure account.",
      "pos": [
        2183,
        2248
      ]
    },
    {
      "content": "If you don't have an account, you can create a free trial account in just a couple of minutes.",
      "pos": [
        2249,
        2343
      ]
    },
    {
      "content": "For details, see <bpt id=\"p1\">[</bpt>Create an Azure account<ept id=\"p1\">](http://azure.microsoft.com/develop/php/tutorials/create-a-windows-azure-account/)</ept>.",
      "pos": [
        2344,
        2469
      ]
    },
    {
      "content": "In addition, you need the following for this tutorial.",
      "pos": [
        2471,
        2525
      ]
    },
    {
      "content": "An on-premises computer that is running an edition of Windows Server 2012 R2 or Windows Server 2012.",
      "pos": [
        2529,
        2629
      ]
    },
    {
      "content": "This computer will be the head node of the HPC cluster.",
      "pos": [
        2630,
        2685
      ]
    },
    {
      "content": "If you are not already running Windows Server, you can download and install an <bpt id=\"p1\">[</bpt>evaluation version<ept id=\"p1\">](http://technet.microsoft.com/evalcenter/dn205286.aspx)</ept>.",
      "pos": [
        2686,
        2841
      ]
    },
    {
      "content": "The computer must be joined to an Active Directory domain.",
      "pos": [
        2849,
        2907
      ]
    },
    {
      "content": "Ensure that no additional server roles or role services are installed.",
      "pos": [
        2915,
        2985
      ]
    },
    {
      "content": "To support HPC Pack, the operating system must be installed in one of these languages: English, Japanese, or Chinese (Simplified).",
      "pos": [
        2993,
        3123
      ]
    },
    {
      "content": "Verify that important and critical updates are installed.",
      "pos": [
        3131,
        3188
      ]
    },
    {
      "content": "Installation files for HPC Pack 2012 R2, which is available free of charge.",
      "pos": [
        3192,
        3267
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>Download<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=328024)</ept> the latest version and copy the files to the head node computer or to a network location.",
      "pos": [
        3268,
        3417
      ]
    },
    {
      "content": "Choose installation files in the same language as your installation of Windows Server.",
      "pos": [
        3418,
        3504
      ]
    },
    {
      "content": "A domain account with local Administrator permissions on the head node.",
      "pos": [
        3508,
        3579
      ]
    },
    {
      "content": "TCP connectivity on port 443 from the head node to Azure.",
      "pos": [
        3583,
        3640
      ]
    },
    {
      "content": "Install HPC Pack on the head node",
      "pos": [
        3645,
        3678
      ]
    },
    {
      "content": "You first install Microsoft HPC Pack on an on-premises computer running Windows Server that will be the head node of the cluster.",
      "pos": [
        3680,
        3809
      ]
    },
    {
      "content": "Log on to the head node by using a domain account that has local Administrator permissions.",
      "pos": [
        3814,
        3905
      ]
    },
    {
      "content": "Start the HPC Pack Installation Wizard by running Setup.exe from the HPC Pack installation files.",
      "pos": [
        3910,
        4007
      ]
    },
    {
      "pos": [
        4012,
        4129
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>HPC Pack 2012 R2 Setup<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>New installation or add new features to an existing installation<ept id=\"p2\">**</ept>."
    },
    {
      "content": "HPC Pack 2012 Setup",
      "pos": [
        4137,
        4156
      ]
    },
    {
      "pos": [
        4176,
        4242
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Microsoft Software User Agreement page<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        4247,
        4373
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Select Installation Type<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Create a new HPC cluster by creating a head node<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Select Installation Type",
      "pos": [
        4381,
        4405
      ]
    },
    {
      "content": "The wizard runs several pre-installation tests.",
      "pos": [
        4425,
        4472
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Installation Rules<ept id=\"p2\">**</ept> page if all tests pass.",
      "pos": [
        4473,
        4541
      ]
    },
    {
      "content": "Otherwise, review the information provided and make any necessary changes in your environment.",
      "pos": [
        4542,
        4636
      ]
    },
    {
      "content": "Then run the tests again or if necessary start the Installation Wizard again.",
      "pos": [
        4637,
        4714
      ]
    },
    {
      "content": "Installation Rules",
      "pos": [
        4722,
        4740
      ]
    },
    {
      "pos": [
        4760,
        4881
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>HPC DB Configuration<ept id=\"p1\">**</ept> page, make sure <bpt id=\"p2\">**</bpt>Head Node<ept id=\"p2\">**</ept> is selected for all HPC databases, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."
    },
    {
      "content": "DB Configuration",
      "pos": [
        4889,
        4905
      ]
    },
    {
      "content": "Accept default selections on the remaining pages of the wizard.",
      "pos": [
        4925,
        4988
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Install Required Components<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Install<ept id=\"p2\">**</ept>.",
      "pos": [
        4989,
        5052
      ]
    },
    {
      "content": "Install",
      "pos": [
        5060,
        5067
      ]
    },
    {
      "content": "After the installation completes, uncheck <bpt id=\"p1\">**</bpt>Start HPC Cluster Manager<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>.",
      "pos": [
        5087,
        5185
      ]
    },
    {
      "content": "(You will start HPC Cluster Manager in a later step to complete the configuration of the head node.)",
      "pos": [
        5186,
        5286
      ]
    },
    {
      "content": "Finish",
      "pos": [
        5294,
        5300
      ]
    },
    {
      "content": "Prepare the Azure subscription",
      "pos": [
        5320,
        5350
      ]
    },
    {
      "content": "Use the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept> to perform the following steps with your Azure subscription.",
      "pos": [
        5351,
        5478
      ]
    },
    {
      "content": "These are needed so you can later deploy Azure nodes from the on-premises head node.",
      "pos": [
        5479,
        5563
      ]
    },
    {
      "content": "Upload a management certificate (needed for secure connections between the head node and the Azure services)",
      "pos": [
        5567,
        5675
      ]
    },
    {
      "content": "Create an Azure cloud service in which Azure nodes (worker role instances) will run",
      "pos": [
        5679,
        5762
      ]
    },
    {
      "content": "Create an Azure storage account",
      "pos": [
        5766,
        5797
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>Also make a note of your Azure subscription ID, which you will need later.",
      "pos": [
        5804,
        5890
      ]
    },
    {
      "content": "Find this in your Azure <ph id=\"ph1\">&lt;a href=\"[https://account.windowsazure.com/Subscriptions\"&gt;</ph>account information<ph id=\"ph2\">&lt;/a&gt;</ph>.",
      "pos": [
        5891,
        5997
      ]
    },
    {
      "pos": [
        6003,
        6051
      ],
      "content": "<ph id=\"ph1\">&lt;a&gt;</ph>Upload the default management certificate<ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "HPC Pack installs a self-signed certificate on the head node, called the Default Microsoft HPC Azure Management certificate, that you can upload as an Azure management certificate.",
      "pos": [
        6052,
        6232
      ]
    },
    {
      "content": "This certificate is provided for testing purposes and proof-of-concept deployments.",
      "pos": [
        6233,
        6316
      ]
    },
    {
      "pos": [
        6321,
        6413
      ],
      "content": "From the head node computer, sign in to the <bpt id=\"p1\">[</bpt>Azure portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        6418,
        6481
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Management Certificates<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        6486,
        6523
      ],
      "content": "On the command bar, click <bpt id=\"p1\">**</bpt>Upload<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Certificate Settings",
      "pos": [
        6531,
        6551
      ]
    },
    {
      "content": "Browse on the head node for the file C:\\Program Files\\Microsoft HPC Pack 2012\\Bin\\hpccert.cer.",
      "pos": [
        6571,
        6665
      ]
    },
    {
      "content": "Then, click the <bpt id=\"p1\">**</bpt>Check<ept id=\"p1\">**</ept> button.",
      "pos": [
        6666,
        6699
      ]
    },
    {
      "content": "Upload Certificate",
      "pos": [
        6707,
        6725
      ]
    },
    {
      "pos": [
        6743,
        6828
      ],
      "content": "You will see <bpt id=\"p1\">**</bpt>Default HPC Azure Management<ept id=\"p1\">**</ept> in the list of management certificates."
    },
    {
      "pos": [
        6834,
        6870
      ],
      "content": "<ph id=\"ph1\">&lt;a&gt;</ph>Create an Azure cloud service<ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "pos": [
        6873,
        6986
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>For best performance, create the cloud service and the storage account in the same geographic region."
    },
    {
      "pos": [
        6991,
        7040
      ],
      "content": "In the portal, on the command bar, click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        7045,
        7121
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Compute<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Cloud Service<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Quick Create<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        7126,
        7200
      ],
      "content": "Type a URL for the cloud service, and then click <bpt id=\"p1\">**</bpt>Create Cloud Service<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Create Service",
      "pos": [
        7208,
        7222
      ]
    },
    {
      "pos": [
        7245,
        7283
      ],
      "content": "<ph id=\"ph1\">&lt;a&gt;</ph>Create an Azure storage account<ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "pos": [
        7288,
        7337
      ],
      "content": "In the portal, on the command bar, click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        7342,
        7418
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Data Services<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Storage<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Quick Create<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        7423,
        7493
      ],
      "content": "Type a URL for the account, and then click <bpt id=\"p1\">**</bpt>Create Storage Account<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Create Storage",
      "pos": [
        7501,
        7515
      ]
    },
    {
      "content": "Configure the head node",
      "pos": [
        7537,
        7560
      ]
    },
    {
      "content": "To use HPC Cluster Manager to deploy Azure nodes and to submit jobs, first perform some required cluster configuration steps.",
      "pos": [
        7562,
        7687
      ]
    },
    {
      "content": "On the head node, start HPC Cluster Manager.",
      "pos": [
        7692,
        7736
      ]
    },
    {
      "content": "If the <bpt id=\"p1\">**</bpt>Select Head Node<ept id=\"p1\">**</ept> dialog box appears, click <bpt id=\"p2\">**</bpt>Local Computer<ept id=\"p2\">**</ept>.",
      "pos": [
        7737,
        7810
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Deployment To-do List<ept id=\"p1\">**</ept> appears.",
      "pos": [
        7811,
        7849
      ]
    },
    {
      "pos": [
        7854,
        7924
      ],
      "content": "Under <bpt id=\"p1\">**</bpt>Required deployment tasks<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Configure your network<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Configure Network",
      "pos": [
        7932,
        7949
      ]
    },
    {
      "pos": [
        7968,
        8069
      ],
      "content": "In the Network Configuration Wizard, select <bpt id=\"p1\">**</bpt>All nodes only on an enterprise network<ept id=\"p1\">**</ept> (Topology 5)."
    },
    {
      "content": "Topology 5",
      "pos": [
        8077,
        8087
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>This is the simplest configuration for demonstration purposes, because the head node only needs a single network adapter to connect to Active Directory and the Internet.",
      "pos": [
        8108,
        8289
      ]
    },
    {
      "content": "This tutorial does not cover cluster scenarios that require additional networks.",
      "pos": [
        8290,
        8370
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to accept default values on the remaining pages of the wizard.",
      "pos": [
        8375,
        8452
      ]
    },
    {
      "content": "Then, on the <bpt id=\"p1\">**</bpt>Review<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Configure<ept id=\"p2\">**</ept> to complete the network configuration.",
      "pos": [
        8453,
        8540
      ]
    },
    {
      "pos": [
        8545,
        8622
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Deployment To-do List<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Provide installation credentials<ept id=\"p2\">**</ept>."
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Installation Credentials<ept id=\"p1\">**</ept> dialog box, type the credentials of the domain account that you used to install HPC Pack.",
      "pos": [
        8627,
        8752
      ]
    },
    {
      "content": "Then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.",
      "pos": [
        8753,
        8771
      ]
    },
    {
      "content": "Installation Credentials",
      "pos": [
        8779,
        8803
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>HPC Pack services only use installation credentials to deploy domain-joined compute nodes.",
      "pos": [
        8824,
        8926
      ]
    },
    {
      "content": "The Azure nodes you add in this tutorial are not domain-joined.",
      "pos": [
        8927,
        8990
      ]
    },
    {
      "pos": [
        8995,
        9073
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Deployment To-do List<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Configure the naming of new nodes<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        9078,
        9178
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Specify Node Naming Series<ept id=\"p1\">**</ept> dialog box, accept the default naming series and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Node Naming",
      "pos": [
        9186,
        9197
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>The naming series only generates names for domain-joined compute nodes.",
      "pos": [
        9218,
        9301
      ]
    },
    {
      "content": "Azure nodes are named automatically.",
      "pos": [
        9302,
        9338
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Deployment To-do List<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Create a node template<ept id=\"p2\">**</ept>.",
      "pos": [
        9343,
        9410
      ]
    },
    {
      "content": "You will use the node template to add Azure nodes to the cluster.",
      "pos": [
        9411,
        9476
      ]
    },
    {
      "content": "In the Create Node Template Wizard, do the following:",
      "pos": [
        9482,
        9535
      ]
    },
    {
      "content": "a.",
      "pos": [
        9541,
        9543
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Choose Node Template Type<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Azure node template<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.",
      "pos": [
        9544,
        9642
      ]
    },
    {
      "content": "Node Template",
      "pos": [
        9650,
        9663
      ]
    },
    {
      "content": "b.",
      "pos": [
        9684,
        9686
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to accept the default template name.",
      "pos": [
        9687,
        9738
      ]
    },
    {
      "content": "c.",
      "pos": [
        9744,
        9746
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Provide Subscription Information<ept id=\"p1\">**</ept> page, enter your Azure subscription ID (available in your Azure <ph id=\"ph1\">&lt;a href=\"[https://account.windowsazure.com/Subscriptions\"&gt;</ph>account information<ph id=\"ph2\">&lt;/a&gt;</ph>).",
      "pos": [
        9747,
        9938
      ]
    },
    {
      "content": "Then, in <bpt id=\"p1\">**</bpt>Management certificate<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Default HPC Azure Management.<ept id=\"p3\">**</ept> Then click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>.",
      "pos": [
        9939,
        10058
      ]
    },
    {
      "content": "Node Template",
      "pos": [
        10066,
        10079
      ]
    },
    {
      "content": "d.",
      "pos": [
        10100,
        10102
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Provide Service Information<ept id=\"p1\">**</ept> page, select the cloud service and the storage account that you created in a previous step.",
      "pos": [
        10103,
        10233
      ]
    },
    {
      "content": "Then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.",
      "pos": [
        10234,
        10254
      ]
    },
    {
      "content": "Node Template",
      "pos": [
        10262,
        10275
      ]
    },
    {
      "content": "e.",
      "pos": [
        10296,
        10298
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to accept default values on the remaining pages of the wizard.",
      "pos": [
        10299,
        10376
      ]
    },
    {
      "content": "Then, on the <bpt id=\"p1\">**</bpt>Review<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> to create the node template.",
      "pos": [
        10377,
        10451
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>By default, the Azure node template includes settings for you to start (provision) and stop the nodes manually.",
      "pos": [
        10458,
        10581
      ]
    },
    {
      "content": "You can also configure a schedule to start and stop the Azure nodes automatically.",
      "pos": [
        10582,
        10664
      ]
    },
    {
      "content": "Add Azure nodes to the cluster",
      "pos": [
        10669,
        10699
      ]
    },
    {
      "content": "You now use the node template to add Azure nodes to the cluster.",
      "pos": [
        10701,
        10765
      ]
    },
    {
      "content": "Adding the nodes to the cluster stores their configuration information so that you can start (provision) them at any time as role instances in the cloud service.",
      "pos": [
        10766,
        10927
      ]
    },
    {
      "content": "Your subscription only gets charged for Azure nodes after the role instances are running in the cloud service.",
      "pos": [
        10928,
        11038
      ]
    },
    {
      "content": "For this tutorial you will add two Small nodes.",
      "pos": [
        11040,
        11087
      ]
    },
    {
      "pos": [
        11092,
        11184
      ],
      "content": "In HPC Cluster Manager, in <bpt id=\"p1\">**</bpt>Node Management<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>Actions<ept id=\"p2\">**</ept> pane, click <bpt id=\"p3\">**</bpt>Add Node<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Add Node",
      "pos": [
        11192,
        11200
      ]
    },
    {
      "pos": [
        11217,
        11334
      ],
      "content": "In the Add Node Wizard, on the <bpt id=\"p1\">**</bpt>Select Deployment Method<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Add Azure nodes<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Add Azure Node",
      "pos": [
        11342,
        11356
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Specify New Nodes<ept id=\"p1\">**</ept> page, select the Azure node template you created previously (called by default <bpt id=\"p2\">**</bpt>Default AzureNode Template<ept id=\"p2\">**</ept>).",
      "pos": [
        11375,
        11515
      ]
    },
    {
      "content": "Then specify <bpt id=\"p1\">**</bpt>2<ept id=\"p1\">**</ept> nodes of size <bpt id=\"p2\">**</bpt>Small<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.",
      "pos": [
        11516,
        11584
      ]
    },
    {
      "content": "Specify Nodes",
      "pos": [
        11592,
        11605
      ]
    },
    {
      "pos": [
        11623,
        11790
      ],
      "content": "For details about the available virtual machine sizes, see <bpt id=\"p1\">[</bpt>Virtual Machine and Cloud Service Sizes for Azure<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/dn197896.aspx)</ept>."
    },
    {
      "pos": [
        11795,
        11860
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Completing the Add Node Wizard<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Two Azure nodes, named <bpt id=\"p1\">**</bpt>AzureCN-0001<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AzureCN-0002<ept id=\"p2\">**</ept>, now appear in HPC Cluster Manager.",
      "pos": [
        11867,
        11963
      ]
    },
    {
      "content": "They are both in the <bpt id=\"p1\">**</bpt>Not-Deployed<ept id=\"p1\">**</ept> state.",
      "pos": [
        11964,
        12008
      ]
    },
    {
      "content": "Added Nodes",
      "pos": [
        12016,
        12027
      ]
    },
    {
      "content": "the Azure nodes",
      "pos": [
        12044,
        12059
      ]
    },
    {
      "content": "When you want to use the cluster resources in Azure, use HPC Cluster Manager to start (provision) the Azure nodes and bring them online.",
      "pos": [
        12060,
        12196
      ]
    },
    {
      "pos": [
        12202,
        12325
      ],
      "content": "In HPC Cluster Manager, in <bpt id=\"p1\">**</bpt>Node Management<ept id=\"p1\">**</ept>, click one or both nodes and then, in the <bpt id=\"p2\">**</bpt>Actions<ept id=\"p2\">**</ept> pane, click <bpt id=\"p3\">**</bpt>Start<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Start Nodes",
      "pos": [
        12333,
        12344
      ]
    },
    {
      "pos": [
        12361,
        12418
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Start Azure Nodes<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Start<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Start Nodes",
      "pos": [
        12426,
        12437
      ]
    },
    {
      "content": "The nodes transition to the <bpt id=\"p1\">**</bpt>Provisioning<ept id=\"p1\">**</ept> state.",
      "pos": [
        12455,
        12506
      ]
    },
    {
      "content": "You can view the provisioning log to track the provisioning progress.",
      "pos": [
        12507,
        12576
      ]
    },
    {
      "content": "Provision Nodes",
      "pos": [
        12584,
        12599
      ]
    },
    {
      "content": "After a few minutes, the Azure nodes finish provisioning and are in the <bpt id=\"p1\">**</bpt>Offline<ept id=\"p1\">**</ept> state.",
      "pos": [
        12616,
        12706
      ]
    },
    {
      "content": "In this state the role instances are running but will not yet accept cluster jobs.",
      "pos": [
        12707,
        12789
      ]
    },
    {
      "pos": [
        12794,
        12985
      ],
      "content": "To confirm that the role instances are running, in the <bpt id=\"p1\">[</bpt>portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>, click <bpt id=\"p2\">**</bpt>Cloud Services<ept id=\"p2\">**</ept>, click the name of your cloud service, and then click <bpt id=\"p3\">**</bpt>Instances<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Running Instances",
      "pos": [
        12993,
        13010
      ]
    },
    {
      "content": "You will see two worker role instances are running in the service.",
      "pos": [
        13034,
        13100
      ]
    },
    {
      "content": "HPC Pack also automatically deploys two <bpt id=\"p1\">**</bpt>HpcProxy<ept id=\"p1\">**</ept> instances (size Medium) to handle communication between the head node and Azure.",
      "pos": [
        13101,
        13234
      ]
    },
    {
      "pos": [
        13239,
        13355
      ],
      "content": "To bring the Azure nodes online to run cluster jobs, select the nodes, right-click, and then click <bpt id=\"p1\">**</bpt>Bring Online<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Offline Nodes",
      "pos": [
        13363,
        13376
      ]
    },
    {
      "pos": [
        13394,
        13467
      ],
      "content": "HPC Cluster Manager indicates that the nodes are in the <bpt id=\"p1\">**</bpt>Online<ept id=\"p1\">**</ept> state."
    },
    {
      "content": "Run a command across the cluster",
      "pos": [
        13472,
        13504
      ]
    },
    {
      "content": "You can use the HPC Pack <bpt id=\"p1\">**</bpt>clusrun<ept id=\"p1\">**</ept> command to run a command or application on one or more cluster nodes.",
      "pos": [
        13505,
        13611
      ]
    },
    {
      "content": "As a simple example, use <bpt id=\"p1\">**</bpt>clusrun<ept id=\"p1\">**</ept> to get the IP configuration of the Azure nodes.",
      "pos": [
        13612,
        13696
      ]
    },
    {
      "content": "On the head node, open a command prompt.",
      "pos": [
        13701,
        13741
      ]
    },
    {
      "content": "Type the following command:",
      "pos": [
        13746,
        13773
      ]
    },
    {
      "content": "You will see output similar to the following.",
      "pos": [
        13818,
        13863
      ]
    },
    {
      "content": "Clusrun",
      "pos": [
        13871,
        13878
      ]
    },
    {
      "content": "Run a test job",
      "pos": [
        13894,
        13908
      ]
    },
    {
      "content": "You can submit a test job that runs on the hybrid cluster.",
      "pos": [
        13910,
        13968
      ]
    },
    {
      "content": "This example is a simple \"parametric sweep\" job (a type of intrinsically parallel computation) which runs subtasks that add an integer to itself by using the <bpt id=\"p1\">**</bpt>set /a<ept id=\"p1\">**</ept> command.",
      "pos": [
        13969,
        14146
      ]
    },
    {
      "content": "All the nodes in the cluster contribute to finishing the subtasks for integers from 1 to 100.",
      "pos": [
        14147,
        14240
      ]
    },
    {
      "pos": [
        14245,
        14352
      ],
      "content": "In HPC Cluster Manager, in <bpt id=\"p1\">**</bpt>Job Management<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>Actions<ept id=\"p2\">**</ept> pane, click <bpt id=\"p3\">**</bpt>New Parametric Sweep Job<ept id=\"p3\">**</ept>."
    },
    {
      "content": "New Job",
      "pos": [
        14360,
        14367
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>New Parametric Sweep Job<ept id=\"p1\">**</ept> dialog box, in <bpt id=\"p2\">**</bpt>Command line<ept id=\"p2\">**</ept>, type <ph id=\"ph1\">`set /a *+*`</ph> (overwriting the default command line that appears).",
      "pos": [
        14384,
        14523
      ]
    },
    {
      "content": "Leave default values for the remaining settings, and then click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept> to submit the job.",
      "pos": [
        14524,
        14617
      ]
    },
    {
      "content": "Parametric Sweep",
      "pos": [
        14625,
        14641
      ]
    },
    {
      "pos": [
        14661,
        14726
      ],
      "content": "When the job is finished, double-click the <bpt id=\"p1\">**</bpt>My Sweep Task<ept id=\"p1\">**</ept> job."
    },
    {
      "pos": [
        14731,
        14824
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>View Tasks<ept id=\"p1\">**</ept>, and then click a subtask to view the calculated output of that subtask."
    },
    {
      "content": "Task Results",
      "pos": [
        14832,
        14844
      ]
    },
    {
      "content": "To see which node performed the calculation for that subtask, click <bpt id=\"p1\">**</bpt>Allocated Nodes<ept id=\"p1\">**</ept>.",
      "pos": [
        14863,
        14951
      ]
    },
    {
      "content": "(Your cluster might show a different node name.)",
      "pos": [
        14952,
        15000
      ]
    },
    {
      "content": "Task Results",
      "pos": [
        15008,
        15020
      ]
    },
    {
      "content": "Stop the Azure nodes",
      "pos": [
        15039,
        15059
      ]
    },
    {
      "content": "After you try out the cluster, you can use HPC Cluster Manager to stop the Azure nodes to avoid unnecessary charges to your account.",
      "pos": [
        15061,
        15193
      ]
    },
    {
      "content": "This stops the cloud service and removes the Azure role instances.",
      "pos": [
        15194,
        15260
      ]
    },
    {
      "content": "In HPC Cluster Manager, in <bpt id=\"p1\">**</bpt>Node Management,<ept id=\"p1\">**</ept> select both Azure nodes.",
      "pos": [
        15265,
        15337
      ]
    },
    {
      "content": "Then, in the <bpt id=\"p1\">**</bpt>Actions<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Stop<ept id=\"p2\">**</ept>.",
      "pos": [
        15338,
        15384
      ]
    },
    {
      "content": "Stop Nodes",
      "pos": [
        15392,
        15402
      ]
    },
    {
      "pos": [
        15420,
        15475
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Stop Azure Nodes<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Stop<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Stop Nodes",
      "pos": [
        15483,
        15493
      ]
    },
    {
      "content": "The nodes transition to the <bpt id=\"p1\">**</bpt>Stopping<ept id=\"p1\">**</ept> state.",
      "pos": [
        15511,
        15558
      ]
    },
    {
      "content": "After a few minutes, HPC Cluster Manager shows that the nodes are <bpt id=\"p1\">**</bpt>Not-Deployed<ept id=\"p1\">**</ept>.",
      "pos": [
        15559,
        15642
      ]
    },
    {
      "content": "Not Deployed Nodes",
      "pos": [
        15650,
        15668
      ]
    },
    {
      "content": "To confirm that the role instances are no longer running in Azure, in the <bpt id=\"p1\">[</bpt>classic portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>, click <bpt id=\"p2\">**</bpt>Cloud Services<ept id=\"p2\">**</ept>, click the name of your cloud service, and then click <bpt id=\"p3\">**</bpt>Instances<ept id=\"p3\">**</ept>.",
      "pos": [
        15686,
        15904
      ]
    },
    {
      "content": "No instances will be deployed in the production environment.",
      "pos": [
        15905,
        15965
      ]
    },
    {
      "content": "No Instances",
      "pos": [
        15973,
        15985
      ]
    },
    {
      "content": "This completes the tutorial.",
      "pos": [
        16009,
        16037
      ]
    },
    {
      "content": "Related resources",
      "pos": [
        16042,
        16059
      ]
    },
    {
      "content": "HPC Pack 2012 R2 and HPC Pack 2012",
      "pos": [
        16064,
        16098
      ]
    },
    {
      "content": "Burst to Azure with Microsoft HPC Pack",
      "pos": [
        16152,
        16190
      ]
    },
    {
      "content": "Microsoft HPC Pack in Azure VMs",
      "pos": [
        16244,
        16275
      ]
    },
    {
      "content": "Big Compute in Azure: Technical Resources for Batch and High Performance Computing (HPC)",
      "pos": [
        16329,
        16417
      ]
    },
    {
      "content": "test",
      "pos": [
        19455,
        19459
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Set up a Hybrid Compute Cluster with Microsoft HPC Pack\"\n    description=\"Learn how to use Microsoft HPC Pack and Azure to set up a small, hybrid high performance computing (HPC) cluster\"\n    services=\"cloud-services\"\n    documentationCenter=\"\"\n    authors=\"dlepow\"\n    manager=\"timlt\"\n    editor=\"\"f/>\n\n<tags\n    ms.service=\"cloud-services\"\n    ms.workload=\"big-compute\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"06/24/2015\"\n    ms.author=\"danlep\"/>\n\n\n# Set up a Hybrid Compute Cluster with Microsoft HPC Pack\nThis tutorial shows you how to use Microsoft HPC Pack 2012 R2 and Azure to set up a small, hybrid high performance computing (HPC) cluster. The cluster will consist of an on-premises head node (a computer running the Windows Server operating system and HPC Pack) and some compute nodes you deploy on-demand as worker role instances in an Azure cloud service. You can then run compute jobs on the hybrid cluster.\n\n![Hybrid HPC cluster][Overview]\n\nThis tutorial shows one approach, sometimes called cluster \"burst to the cloud,\" to use scalable, on-demand compute resources in Azure to run compute intensive applications.\n\nThis tutorial assumes no prior experience with compute clusters or HPC Pack. It is intended only to help you deploy a hybrid compute cluster quickly for demonstration purposes. For considerations and steps to deploy a hybrid HPC Pack cluster at greater scale in a production environment, see the [detailed guidance](http://go.microsoft.com/fwlink/p/?LinkID=200493). If you want to set up an HPC Pack cluster entirely in Azure, see [Microsoft HPC Pack in Azure VMs](http://go.microsoft.com/fwlink/p/?linkid=330375).\n\n>[AZURE.NOTE] Azure offers a [range of sizes](../virtual-machines/virtual-machines-size-specs.md) for your compute resources, suitable for different workloads. For example, the A8 and A9 instances combine high performance and access to a low latency, high throughput application network needed for certain HPC applications. See [About the A8, A9, A10, and A11 Compute Intensive Instances](../virtual-machines/virtual-machines-a8-a9-a10-a11-specs.md).\n\n## Prerequisites\n\n>[AZURE.NOTE]To complete this tutorial, you need an Azure account. If you don't have an account, you can create a free trial account in just a couple of minutes. For details, see [Create an Azure account](http://azure.microsoft.com/develop/php/tutorials/create-a-windows-azure-account/).\n\nIn addition, you need the following for this tutorial.\n\n* An on-premises computer that is running an edition of Windows Server 2012 R2 or Windows Server 2012. This computer will be the head node of the HPC cluster. If you are not already running Windows Server, you can download and install an [evaluation version](http://technet.microsoft.com/evalcenter/dn205286.aspx).\n\n    * The computer must be joined to an Active Directory domain.\n\n    * Ensure that no additional server roles or role services are installed.\n\n    * To support HPC Pack, the operating system must be installed in one of these languages: English, Japanese, or Chinese (Simplified).\n\n    * Verify that important and critical updates are installed.\n\n* Installation files for HPC Pack 2012 R2, which is available free of charge. [Download](http://go.microsoft.com/fwlink/p/?linkid=328024) the latest version and copy the files to the head node computer or to a network location. Choose installation files in the same language as your installation of Windows Server.\n\n* A domain account with local Administrator permissions on the head node.\n\n* TCP connectivity on port 443 from the head node to Azure.\n\n## Install HPC Pack on the head node\n\nYou first install Microsoft HPC Pack on an on-premises computer running Windows Server that will be the head node of the cluster.\n\n1. Log on to the head node by using a domain account that has local Administrator permissions.\n\n2. Start the HPC Pack Installation Wizard by running Setup.exe from the HPC Pack installation files.\n\n3. On the **HPC Pack 2012 R2 Setup** screen, click **New installation or add new features to an existing installation**.\n\n    ![HPC Pack 2012 Setup][install_hpc1]\n\n4. On the **Microsoft Software User Agreement page**, click **Next**.\n\n5. On the **Select Installation Type** page, click **Create a new HPC cluster by creating a head node**, and then click **Next**.\n\n    ![Select Installation Type][install_hpc2]\n\n6. The wizard runs several pre-installation tests. Click **Next** on the **Installation Rules** page if all tests pass. Otherwise, review the information provided and make any necessary changes in your environment. Then run the tests again or if necessary start the Installation Wizard again.\n\n    ![Installation Rules][install_hpc3]\n\n7. On the **HPC DB Configuration** page, make sure **Head Node** is selected for all HPC databases, and then click **Next**.\n\n    ![DB Configuration][install_hpc4]\n\n8. Accept default selections on the remaining pages of the wizard. On the **Install Required Components** page, click **Install**.\n\n    ![Install][install_hpc6]\n\n9. After the installation completes, uncheck **Start HPC Cluster Manager** and then click **Finish**. (You will start HPC Cluster Manager in a later step to complete the configuration of the head node.)\n\n    ![Finish][install_hpc7]\n\n## Prepare the Azure subscription\nUse the [Azure Management Portal](https://manage.windowsazure.com) to perform the following steps with your Azure subscription. These are needed so you can later deploy Azure nodes from the on-premises head node.\n\n- Upload a management certificate (needed for secure connections between the head node and the Azure services)\n\n- Create an Azure cloud service in which Azure nodes (worker role instances) will run\n\n- Create an Azure storage account\n\n    >[AZURE.NOTE]Also make a note of your Azure subscription ID, which you will need later. Find this in your Azure <a href=\"[https://account.windowsazure.com/Subscriptions\">account information</a>.\n\n### <a>Upload the default management certificate</a>\nHPC Pack installs a self-signed certificate on the head node, called the Default Microsoft HPC Azure Management certificate, that you can upload as an Azure management certificate. This certificate is provided for testing purposes and proof-of-concept deployments.\n\n1. From the head node computer, sign in to the [Azure portal](https://manage.windowsazure.com).\n\n2. Click **Settings**, and then click **Management Certificates**.\n\n3. On the command bar, click **Upload**.\n\n    ![Certificate Settings][upload_cert1]\n\n4. Browse on the head node for the file C:\\Program Files\\Microsoft HPC Pack 2012\\Bin\\hpccert.cer. Then, click the **Check** button.\n\n    ![Upload Certificate][install_hpc10]\n\nYou will see **Default HPC Azure Management** in the list of management certificates.\n\n### <a>Create an Azure cloud service</a>\n\n>[AZURE.NOTE]For best performance, create the cloud service and the storage account in the same geographic region.\n\n1. In the portal, on the command bar, click **New**.\n\n2. Click **Compute**, click **Cloud Service**, and then click **Quick Create**.\n\n3. Type a URL for the cloud service, and then click **Create Cloud Service**.\n\n    ![Create Service][createservice1]\n\n### <a>Create an Azure storage account</a>\n\n1. In the portal, on the command bar, click **New**.\n\n2. Click **Data Services**, click **Storage**, and then click **Quick Create**.\n\n3. Type a URL for the account, and then click **Create Storage Account**.\n\n    ![Create Storage][createstorage1]\n\n## Configure the head node\n\nTo use HPC Cluster Manager to deploy Azure nodes and to submit jobs, first perform some required cluster configuration steps.\n\n1. On the head node, start HPC Cluster Manager. If the **Select Head Node** dialog box appears, click **Local Computer**. The **Deployment To-do List** appears.\n\n2. Under **Required deployment tasks**, click **Configure your network**.\n\n    ![Configure Network][config_hpc2]\n\n3. In the Network Configuration Wizard, select **All nodes only on an enterprise network** (Topology 5).\n\n    ![Topology 5][config_hpc3]\n\n    >[AZURE.NOTE]This is the simplest configuration for demonstration purposes, because the head node only needs a single network adapter to connect to Active Directory and the Internet. This tutorial does not cover cluster scenarios that require additional networks.\n\n4. Click **Next** to accept default values on the remaining pages of the wizard. Then, on the **Review** tab, click **Configure** to complete the network configuration.\n\n5. In the **Deployment To-do List**, click **Provide installation credentials**.\n\n6. In the **Installation Credentials** dialog box, type the credentials of the domain account that you used to install HPC Pack. Then click **OK**.\n\n    ![Installation Credentials][config_hpc6]\n\n    >[AZURE.NOTE]HPC Pack services only use installation credentials to deploy domain-joined compute nodes. The Azure nodes you add in this tutorial are not domain-joined.\n\n7. In the **Deployment To-do List**, click **Configure the naming of new nodes**.\n\n8. In the **Specify Node Naming Series** dialog box, accept the default naming series and click **OK**.\n\n    ![Node Naming][config_hpc8]\n\n    >[AZURE.NOTE]The naming series only generates names for domain-joined compute nodes. Azure nodes are named automatically.\n\n9. In the **Deployment To-do List**, click **Create a node template**. You will use the node template to add Azure nodes to the cluster.\n\n10. In the Create Node Template Wizard, do the following:\n\n    a. On the **Choose Node Template Type** page, click **Azure node template**, and then click **Next**.\n\n    ![Node Template][config_hpc10]\n\n    b. Click **Next** to accept the default template name.\n\n    c. On the **Provide Subscription Information** page, enter your Azure subscription ID (available in your Azure <a href=\"[https://account.windowsazure.com/Subscriptions\">account information</a>). Then, in **Management certificate**, click **Browse** and select **Default HPC Azure Management.** Then click **Next**.\n\n    ![Node Template][config_hpc12]\n\n    d. On the **Provide Service Information** page, select the cloud service and the storage account that you created in a previous step. Then click **Next**.\n\n    ![Node Template][config_hpc13]\n\n    e. Click **Next** to accept default values on the remaining pages of the wizard. Then, on the **Review** tab, click **Create** to create the node template.\n\n    >[AZURE.NOTE]By default, the Azure node template includes settings for you to start (provision) and stop the nodes manually. You can also configure a schedule to start and stop the Azure nodes automatically.\n\n## Add Azure nodes to the cluster\n\nYou now use the node template to add Azure nodes to the cluster. Adding the nodes to the cluster stores their configuration information so that you can start (provision) them at any time as role instances in the cloud service. Your subscription only gets charged for Azure nodes after the role instances are running in the cloud service.\n\nFor this tutorial you will add two Small nodes.\n\n1. In HPC Cluster Manager, in **Node Management**, in the **Actions** pane, click **Add Node**.\n\n    ![Add Node][add_node1]\n\n2. In the Add Node Wizard, on the **Select Deployment Method** page, click **Add Azure nodes**, and then click **Next**.\n\n    ![Add Azure Node][add_node1_1]\n\n3. On the **Specify New Nodes** page, select the Azure node template you created previously (called by default **Default AzureNode Template**). Then specify **2** nodes of size **Small**, and then click **Next**.\n\n    ![Specify Nodes][add_node2]\n\n    For details about the available virtual machine sizes, see [Virtual Machine and Cloud Service Sizes for Azure](https://msdn.microsoft.com/library/azure/dn197896.aspx).\n\n4. On the **Completing the Add Node Wizard** page, click **Finish**.\n\n     Two Azure nodes, named **AzureCN-0001** and **AzureCN-0002**, now appear in HPC Cluster Manager. They are both in the **Not-Deployed** state.\n\n    ![Added Nodes][add_node3]\n\n## the Azure nodes\nWhen you want to use the cluster resources in Azure, use HPC Cluster Manager to start (provision) the Azure nodes and bring them online.\n\n1.  In HPC Cluster Manager, in **Node Management**, click one or both nodes and then, in the **Actions** pane, click **Start**.\n\n    ![Start Nodes][add_node4]\n\n2. In the **Start Azure Nodes** dialog box, click **Start**.\n\n    ![Start Nodes][add_node5]\n\n    The nodes transition to the **Provisioning** state. You can view the provisioning log to track the provisioning progress.\n\n    ![Provision Nodes][add_node6]\n\n3. After a few minutes, the Azure nodes finish provisioning and are in the **Offline** state. In this state the role instances are running but will not yet accept cluster jobs.\n\n4. To confirm that the role instances are running, in the [portal](https://manage.windowsazure.com), click **Cloud Services**, click the name of your cloud service, and then click **Instances**.\n\n    ![Running Instances][view_instances1]\n\n    You will see two worker role instances are running in the service. HPC Pack also automatically deploys two **HpcProxy** instances (size Medium) to handle communication between the head node and Azure.\n\n5. To bring the Azure nodes online to run cluster jobs, select the nodes, right-click, and then click **Bring Online**.\n\n    ![Offline Nodes][add_node7]\n\n    HPC Cluster Manager indicates that the nodes are in the **Online** state.\n\n## Run a command across the cluster\nYou can use the HPC Pack **clusrun** command to run a command or application on one or more cluster nodes. As a simple example, use **clusrun** to get the IP configuration of the Azure nodes.\n\n1. On the head node, open a command prompt.\n\n2. Type the following command:\n\n    `clusrun /nodes:azurecn* ipconfig`\n\n3. You will see output similar to the following.\n\n    ![Clusrun][clusrun1]\n\n## Run a test job\n\nYou can submit a test job that runs on the hybrid cluster. This example is a simple \"parametric sweep\" job (a type of intrinsically parallel computation) which runs subtasks that add an integer to itself by using the **set /a** command. All the nodes in the cluster contribute to finishing the subtasks for integers from 1 to 100.\n\n1. In HPC Cluster Manager, in **Job Management**, in the **Actions** pane, click **New Parametric Sweep Job**.\n\n    ![New Job][test_job1]\n\n2. In the **New Parametric Sweep Job** dialog box, in **Command line**, type `set /a *+*` (overwriting the default command line that appears). Leave default values for the remaining settings, and then click **Submit** to submit the job.\n\n    ![Parametric Sweep][param_sweep1]\n\n3. When the job is finished, double-click the **My Sweep Task** job.\n\n4. Click **View Tasks**, and then click a subtask to view the calculated output of that subtask.\n\n    ![Task Results][view_job361]\n\n5. To see which node performed the calculation for that subtask, click **Allocated Nodes**. (Your cluster might show a different node name.)\n\n    ![Task Results][view_job362]\n\n## Stop the Azure nodes\n\nAfter you try out the cluster, you can use HPC Cluster Manager to stop the Azure nodes to avoid unnecessary charges to your account. This stops the cloud service and removes the Azure role instances.\n\n1. In HPC Cluster Manager, in **Node Management,** select both Azure nodes. Then, in the **Actions** pane, click **Stop**.\n\n    ![Stop Nodes][stop_node1]\n\n2. In the **Stop Azure Nodes** dialog box, click **Stop**.\n\n    ![Stop Nodes][stop_node2]\n\n3. The nodes transition to the **Stopping** state. After a few minutes, HPC Cluster Manager shows that the nodes are **Not-Deployed**.\n\n    ![Not Deployed Nodes][stop_node4]\n\n4. To confirm that the role instances are no longer running in Azure, in the [classic portal](https://manage.windowsazure.com), click **Cloud Services**, click the name of your cloud service, and then click **Instances**. No instances will be deployed in the production environment.\n\n    ![No Instances][view_instances2]\n\n    This completes the tutorial.\n\n## Related resources\n\n* [HPC Pack 2012 R2 and HPC Pack 2012](http://go.microsoft.com/fwlink/p/?LinkID=263697)\n* [Burst to Azure with Microsoft HPC Pack](http://go.microsoft.com/fwlink/p/?LinkID=200493)\n* [Microsoft HPC Pack in Azure VMs](http://go.microsoft.com/fwlink/p/?linkid=330375)\n* [Big Compute in Azure: Technical Resources for Batch and High Performance Computing (HPC)](big-compute-resources.md)\n\n\n[Overview]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/hybrid_cluster_overview.png\n[install_hpc1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc1.png\n[install_hpc2]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc2.png\n[install_hpc3]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc3.png\n[install_hpc4]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc4.png\n[install_hpc6]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc6.png\n[install_hpc7]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc7.png\n[install_hpc10]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/install_hpc10.png\n[upload_cert1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/upload_cert1.png\n[createstorage1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/createstorage1.png\n[createservice1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/createservice1.png\n[config_hpc2]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc2.png\n[config_hpc3]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc3.png\n[config_hpc6]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc6.png\n[config_hpc8]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc8.png\n[config_hpc10]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc10.png\n[config_hpc12]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc12.png\n[config_hpc13]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/config_hpc13.png\n[add_node1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node1.png\n[add_node1_1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node1_1.png\n[add_node2]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node2.png\n[add_node3]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node3.png\n[add_node4]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node4.png\n[add_node5]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node5.png\n[add_node6]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node6.png\n[add_node7]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/add_node7.png\n[view_instances1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/view_instances1.png\n[clusrun1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/clusrun1.png\n[test_job1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/test_job1.png\n[param_sweep1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/param_sweep1.png\n[view_job361]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/view_job361.png\n[view_job362]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/view_job362.png\n[stop_node1]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/stop_node1.png\n[stop_node2]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/stop_node2.png\n[stop_node4]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/stop_node4.png\n[view_instances2]: ./media/cloud-services-setup-hybrid-hpcpack-cluster/view_instances2.png\n\ntest\n"
}