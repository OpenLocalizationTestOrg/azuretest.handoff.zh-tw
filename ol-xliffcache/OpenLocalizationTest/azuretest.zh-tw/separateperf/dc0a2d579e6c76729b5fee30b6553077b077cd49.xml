{
  "nodes": [
    {
      "content": "Continuous delivery with Git and Visual Studio Online in Azure",
      "pos": [
        27,
        89
      ]
    },
    {
      "content": "Learn how to configure your Visual Studio Online team projects to use Git to automatically build and deploy to the Web App feature in Azure App Service or cloud services.",
      "pos": [
        109,
        279
      ]
    },
    {
      "content": "Continuous delivery to Azure using Visual Studio Online and Git",
      "pos": [
        581,
        644
      ]
    },
    {
      "content": "You can use Visual Studio Online team projects to host a Git repository for your source code, and automatically build and deploy to Azure web apps or cloud services whenever you push a commit to the repository.",
      "pos": [
        646,
        856
      ]
    },
    {
      "content": "You'll need Visual Studio 2013 and the Azure SDK installed.",
      "pos": [
        858,
        917
      ]
    },
    {
      "content": "If you don't already have Visual Studio 2013, download it by choosing the <bpt id=\"p1\">**</bpt>Get started for free<ept id=\"p1\">**</ept> link at <bpt id=\"p2\">[</bpt>www.visualstudio.com<ept id=\"p2\">](http://www.visualstudio.com)</ept>.",
      "pos": [
        918,
        1077
      ]
    },
    {
      "content": "Install the Azure SDK from <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=239540)</ept>.",
      "pos": [
        1078,
        1159
      ]
    },
    {
      "pos": [
        1164,
        1351
      ],
      "content": "[AZURE.NOTE] You need an Visual Studio online account to complete this tutorial:\nYou can [open a Visual Studio Online account for free](http://go.microsoft.com/fwlink/p/?LinkId=512979).",
      "leadings": [
        "",
        "> "
      ],
      "nodes": [
        {
          "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You need an Visual Studio online account to complete this tutorial:",
          "pos": [
            0,
            80
          ]
        },
        {
          "content": "You can <bpt id=\"p1\">[</bpt>open a Visual Studio Online account for free<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=512979)</ept>.",
          "pos": [
            81,
            185
          ]
        }
      ]
    },
    {
      "content": "To set up a cloud service to automatically build and deploy to Azure by using Visual Studio Online, follow these steps.",
      "pos": [
        1353,
        1472
      ]
    },
    {
      "content": "Step 1: Create a Git repository",
      "pos": [
        1477,
        1508
      ]
    },
    {
      "content": "If you donâ€™t already have a Visual Studio Online account, you can get one  <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=397665)</ept>.",
      "pos": [
        1513,
        1642
      ]
    },
    {
      "content": "When you create your team project, choose Git as your source control system.",
      "pos": [
        1643,
        1719
      ]
    },
    {
      "content": "Follow the instructions to connect Visual Studio to your team project.",
      "pos": [
        1720,
        1790
      ]
    },
    {
      "pos": [
        1795,
        1859
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Team Explorer<ept id=\"p1\">**</ept>, choose the <bpt id=\"p2\">**</bpt>Clone this repository<ept id=\"p2\">**</ept> link."
    },
    {
      "pos": [
        1876,
        1952
      ],
      "content": "Specify the location of the local copy and then choose the <bpt id=\"p1\">**</bpt>Clone<ept id=\"p1\">**</ept> button."
    },
    {
      "content": "Step 2: Create a project and commit it to the repository",
      "pos": [
        1957,
        2013
      ]
    },
    {
      "pos": [
        2018,
        2142
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Team Explorer<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>Solutions<ept id=\"p2\">**</ept> section, choose the <bpt id=\"p3\">**</bpt>New<ept id=\"p3\">**</ept> link to create a new project in the local repository."
    },
    {
      "content": "You can deploy a web app or a cloud service (Azure Application) by following the steps in this walkthrough.",
      "pos": [
        2159,
        2266
      ]
    },
    {
      "content": "Create a new Azure Cloud Service project,",
      "pos": [
        2267,
        2308
      ]
    },
    {
      "content": "or a new ASP.NET MVC project.",
      "pos": [
        2309,
        2338
      ]
    },
    {
      "content": "Make sure that the project targets the .NET Framework 4 or later.",
      "pos": [
        2339,
        2404
      ]
    },
    {
      "content": "If you are creating a cloud service project, add an ASP.NET MVC web role and a worker role.",
      "pos": [
        2405,
        2496
      ]
    },
    {
      "content": "If you want to create a web app, choose the <bpt id=\"p1\">**</bpt>ASP.NET Web Application<ept id=\"p1\">**</ept> project template, and then choose <bpt id=\"p2\">**</bpt>MVC<ept id=\"p2\">**</ept>.",
      "pos": [
        2497,
        2611
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>Create an ASP.NET web app in Azure App Service<ept id=\"p1\">](../web-sites-dotnet-get-started.md)</ept> for more information.",
      "pos": [
        2612,
        2722
      ]
    },
    {
      "pos": [
        2727,
        2790
      ],
      "content": "Open the shortcut menu for the solution, and choose <bpt id=\"p1\">**</bpt>Commit<ept id=\"p1\">**</ept>."
    },
    {
      "content": "If this is the first time you've used Git in Visual Studio Online, you'll need to provide some information to identify yourself in Git.",
      "pos": [
        2807,
        2942
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Pending Changes<ept id=\"p1\">**</ept> area of <bpt id=\"p2\">**</bpt>Team Explorer<ept id=\"p2\">**</ept>, enter your username and email address.",
      "pos": [
        2943,
        3035
      ]
    },
    {
      "content": "Enter a comment for the commit and then choose the <bpt id=\"p1\">**</bpt>Commit<ept id=\"p1\">**</ept> button.",
      "pos": [
        3036,
        3105
      ]
    },
    {
      "content": "Note the options to include or exclude specific changes when you check in.",
      "pos": [
        3122,
        3196
      ]
    },
    {
      "content": "If the changes you want are excluded, choose <bpt id=\"p1\">**</bpt>Include All<ept id=\"p1\">**</ept>.",
      "pos": [
        3197,
        3258
      ]
    },
    {
      "content": "You've now committed the changes in your local copy of the repository.",
      "pos": [
        3263,
        3333
      ]
    },
    {
      "content": "Next, sync those changes with the server by choosing the <bpt id=\"p1\">**</bpt>Sync<ept id=\"p1\">**</ept> link.",
      "pos": [
        3334,
        3405
      ]
    },
    {
      "content": "Step 3: Connect the project to Azure",
      "pos": [
        3410,
        3446
      ]
    },
    {
      "content": "Now that you have a Git repository in Visual Studio Online with some source code in it, you are ready to connect your git repository to Azure.",
      "pos": [
        3451,
        3593
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](http://manage.windowsazure.com)</ept>, select your cloud service or web app, or create a new one by choosing the + icon at the bottom left and choosing <bpt id=\"p2\">**</bpt>Cloud Service<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Web App<ept id=\"p3\">**</ept> and then <bpt id=\"p4\">**</bpt>Quick Create<ept id=\"p4\">**</ept>.",
      "pos": [
        3595,
        3833
      ]
    },
    {
      "content": "For cloud services, choose the <bpt id=\"p1\">**</bpt>Set up publishing with Visual Studio Online<ept id=\"p1\">**</ept> link.",
      "pos": [
        3850,
        3934
      ]
    },
    {
      "content": "For web apps, choose the <bpt id=\"p1\">**</bpt>Set up deployment from source control<ept id=\"p1\">**</ept> link.",
      "pos": [
        3935,
        4007
      ]
    },
    {
      "content": "In the wizard, type the name of your Visual Studio Online account in the textbox and choose the <bpt id=\"p1\">**</bpt>Authorize Now<ept id=\"p1\">**</ept> link.",
      "pos": [
        4025,
        4144
      ]
    },
    {
      "content": "You might be asked to sign in.",
      "pos": [
        4145,
        4175
      ]
    },
    {
      "pos": [
        4193,
        4330
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Connection Request<ept id=\"p1\">**</ept> pop-up dialog, choose <bpt id=\"p2\">**</bpt>Accept<ept id=\"p2\">**</ept> to authorize Azure to configure your team project in Visual Studio Online."
    },
    {
      "content": "After authorization succeeds, you see a dropdown list that contains your Visual Studio Online team projects.",
      "pos": [
        4348,
        4456
      ]
    },
    {
      "content": "Select the name of team project that you created in the previous steps, and choose the wizard's checkmark button.",
      "pos": [
        4458,
        4571
      ]
    },
    {
      "content": "The next time you push a commit to your repository, Visual Studio Online will build and deploy your project to Azure.",
      "pos": [
        4590,
        4707
      ]
    },
    {
      "content": "Step 4: Trigger a rebuild and redeploy your project",
      "pos": [
        4712,
        4763
      ]
    },
    {
      "content": "In Visual Studio, open up a file and change it.",
      "pos": [
        4768,
        4815
      ]
    },
    {
      "content": "For example, change the file <ph id=\"ph1\">`_Layout.cshtml`</ph> under the Views\\\\Shared folder in an MVC web role.",
      "pos": [
        4816,
        4912
      ]
    },
    {
      "content": "Edit the footer text for the site and save the file.",
      "pos": [
        4930,
        4982
      ]
    },
    {
      "pos": [
        5000,
        5138
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, open the shortcut menu for the solution node, project node, or the file you changed, and then choose <bpt id=\"p2\">**</bpt>Commit<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        5143,
        5183
      ],
      "content": "Type in a comment and choose <bpt id=\"p1\">**</bpt>Commit<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        5201,
        5226
      ],
      "content": "Choose the <bpt id=\"p1\">**</bpt>Sync<ept id=\"p1\">**</ept> link."
    },
    {
      "content": "Choose the <bpt id=\"p1\">**</bpt>Push<ept id=\"p1\">**</ept> link to push your commit to the repository in Visual Studio Online.",
      "pos": [
        5244,
        5331
      ]
    },
    {
      "content": "(You can also use the <bpt id=\"p1\">**</bpt>Sync<ept id=\"p1\">**</ept> button to copy your commits to the repository.",
      "pos": [
        5332,
        5409
      ]
    },
    {
      "content": "The difference is that <bpt id=\"p1\">**</bpt>Sync<ept id=\"p1\">**</ept> also pulls the latest changes from the repository.)",
      "pos": [
        5410,
        5493
      ]
    },
    {
      "pos": [
        5511,
        5583
      ],
      "content": "Choose the <bpt id=\"p1\">**</bpt>Home<ept id=\"p1\">**</ept> button to return to the <bpt id=\"p2\">**</bpt>Team Explorer<ept id=\"p2\">**</ept> home page."
    },
    {
      "pos": [
        5601,
        5650
      ],
      "content": "Choose <bpt id=\"p1\">**</bpt>Builds<ept id=\"p1\">**</ept> to view the builds in progress."
    },
    {
      "pos": [
        5669,
        5743
      ],
      "content": "<bpt id=\"p1\">**</bpt>Team Explorer<ept id=\"p1\">**</ept> shows that a build has been triggered for your check-in."
    },
    {
      "content": "To view a detailed log as the build progresses, double-click the name of the build in progress.",
      "pos": [
        5761,
        5856
      ]
    },
    {
      "content": "While the build is in-progress, take a look at the build definition that was created when you used the wizard to link to Azure.",
      "pos": [
        5862,
        5989
      ]
    },
    {
      "content": "Open the shortcut menu for the build definition and choose <bpt id=\"p1\">**</bpt>Edit Build Definition<ept id=\"p1\">**</ept>.",
      "pos": [
        5991,
        6076
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Trigger<ept id=\"p1\">**</ept> tab, you will see that the build definition is set to build on every check-in, by default.",
      "pos": [
        6095,
        6204
      ]
    },
    {
      "content": "(For a cloud service, Visual Studio Online builds and deploys the master branch to the staging environment automatically.",
      "pos": [
        6205,
        6326
      ]
    },
    {
      "content": "You still have to do a manual step to deploy to the live site.",
      "pos": [
        6327,
        6389
      ]
    },
    {
      "content": "For a web app that doesn't have staging environment, it deploys the master branch directly to the live site.",
      "pos": [
        6390,
        6498
      ]
    },
    {
      "pos": [
        6516,
        6631
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Process<ept id=\"p1\">**</ept> tab, you can see the deployment environment is set to the name of your cloud service or web app."
    },
    {
      "content": "Specify values for the properties if you want different values than the defaults.",
      "pos": [
        6649,
        6730
      ]
    },
    {
      "content": "The properties for Azure publishing are in the <bpt id=\"p1\">**</bpt>Deployment<ept id=\"p1\">**</ept> section, and you might also need to set MSBuild parameters.",
      "pos": [
        6731,
        6852
      ]
    },
    {
      "content": "For example, in a cloud service project, to specify a service configuration other than \"Cloud\", set the MSbuild parameters to <ph id=\"ph1\">`/p:TargetProfile=[YourProfile]`</ph> where <bpt id=\"p1\">*</bpt>[YourProfile]<ept id=\"p1\">*</ept> matches a service configuration file with a name like ServiceConfiguration.<bpt id=\"p2\">*</bpt>YourProfile<ept id=\"p2\">*</ept>.cscfg.",
      "pos": [
        6853,
        7129
      ]
    },
    {
      "pos": [
        7135,
        7216
      ],
      "content": "The following table shows the available properties in the <bpt id=\"p1\">**</bpt>Deployment<ept id=\"p1\">**</ept> section:"
    },
    {
      "content": "Property",
      "pos": [
        7223,
        7231
      ]
    },
    {
      "content": "Default Value",
      "pos": [
        7232,
        7245
      ]
    },
    {
      "content": "Allow Untrusted Certificates",
      "pos": [
        7266,
        7294
      ]
    },
    {
      "content": "If false, SSL certificates must be signed by a root authority.",
      "pos": [
        7295,
        7357
      ]
    },
    {
      "content": "Allow Upgrade",
      "pos": [
        7364,
        7377
      ]
    },
    {
      "content": "Allows the deployment to update an existing deployment instead of creating a new one.",
      "pos": [
        7378,
        7463
      ]
    },
    {
      "content": "Preserves the IP address.",
      "pos": [
        7464,
        7489
      ]
    },
    {
      "content": "Do Not Delete",
      "pos": [
        7496,
        7509
      ]
    },
    {
      "content": "If true, do not overwrite an existing unrelated deployment (upgrade is allowed).",
      "pos": [
        7510,
        7590
      ]
    },
    {
      "content": "Path to Deployment Settings",
      "pos": [
        7597,
        7624
      ]
    },
    {
      "content": "The path to your .pubxml file for a web app, relative to the root folder of the repo.",
      "pos": [
        7625,
        7710
      ]
    },
    {
      "content": "Ignored for cloud services.",
      "pos": [
        7711,
        7738
      ]
    },
    {
      "content": "Sharepoint Deployment Environment",
      "pos": [
        7745,
        7778
      ]
    },
    {
      "content": "The same as the service name.",
      "pos": [
        7779,
        7808
      ]
    },
    {
      "content": "Azure Deployment Environment",
      "pos": [
        7815,
        7843
      ]
    },
    {
      "content": "The web app or cloud service name.",
      "pos": [
        7844,
        7878
      ]
    },
    {
      "content": "By this time, your build should be completed successfully.",
      "pos": [
        7884,
        7942
      ]
    },
    {
      "pos": [
        7960,
        8099
      ],
      "content": "If you double-click the build name, Visual Studio shows a <bpt id=\"p1\">**</bpt>Build Summary<ept id=\"p1\">**</ept>, including any test results from associated unit test projects."
    },
    {
      "pos": [
        8117,
        8290
      ],
      "content": "In the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](http://manage.windowsazure.com)</ept>, you can view the associated deployment on the <bpt id=\"p2\">**</bpt>Deployments<ept id=\"p2\">**</ept> tab when the staging environment is selected."
    },
    {
      "content": "Browse to your site's URL.",
      "pos": [
        8309,
        8335
      ]
    },
    {
      "content": "For a web app, just choose  the <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept> button in the portal.",
      "pos": [
        8336,
        8400
      ]
    },
    {
      "content": "For a cloud service, choose the URL in the <bpt id=\"p1\">**</bpt>Quick Glance<ept id=\"p1\">**</ept> section of the <bpt id=\"p2\">**</bpt>Dashboard<ept id=\"p2\">**</ept> page that shows the Staging environment.",
      "pos": [
        8401,
        8530
      ]
    },
    {
      "content": "Deployments from continuous integration for cloud services are published to the Staging environment by default.",
      "pos": [
        8536,
        8647
      ]
    },
    {
      "content": "You can change this by setting the <bpt id=\"p1\">**</bpt>Alternate Cloud Service Environment<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>Production<ept id=\"p2\">**</ept>.",
      "pos": [
        8648,
        8750
      ]
    },
    {
      "content": "Here's where the site URL is on the cloud service's dashboard page.",
      "pos": [
        8751,
        8818
      ]
    },
    {
      "content": "A new browser tab will open to reveal your running site.",
      "pos": [
        8837,
        8893
      ]
    },
    {
      "content": "If you make other changes to your project, you trigger more builds, and you will accumulate multiple deployments.",
      "pos": [
        8912,
        9025
      ]
    },
    {
      "content": "The latest one is marked as Active.",
      "pos": [
        9026,
        9061
      ]
    },
    {
      "content": "Step 5: Redeploy an earlier build",
      "pos": [
        9079,
        9112
      ]
    },
    {
      "content": "This step is optional.",
      "pos": [
        9114,
        9136
      ]
    },
    {
      "content": "In the Azure management portal, choose an earlier deployment and choose <bpt id=\"p1\">**</bpt>Redeploy<ept id=\"p1\">**</ept> to rewind your site to an earlier check-in.",
      "pos": [
        9137,
        9265
      ]
    },
    {
      "content": "Note that this will trigger a new build in TFS and create a new entry in your deployment history.",
      "pos": [
        9266,
        9363
      ]
    },
    {
      "content": "Step 6: Change the Production deployment",
      "pos": [
        9377,
        9417
      ]
    },
    {
      "content": "When you are ready, you can promote the Staging environment to the Production environment by choosing <bpt id=\"p1\">**</bpt>Swap<ept id=\"p1\">**</ept> in the Azure management portal.",
      "pos": [
        9419,
        9561
      ]
    },
    {
      "content": "The newly deployed Staging environment is promoted to Production, and the previous Production environment, if any, becomes a Staging environment.",
      "pos": [
        9562,
        9707
      ]
    },
    {
      "content": "The Active deployment may be different for the Production and Staging environments, but the deployment history of recent builds is the same regardless of environment.",
      "pos": [
        9708,
        9874
      ]
    },
    {
      "content": "Step 6: Deploy from a working branch.",
      "pos": [
        9888,
        9925
      ]
    },
    {
      "content": "When you use Git, you usually make changes in a working branch and integrate into the master branch when your development reaches a finished state.",
      "pos": [
        9927,
        10074
      ]
    },
    {
      "content": "During the development phase of a project, you'll want to build and deploy the working branch to Azure.",
      "pos": [
        10075,
        10178
      ]
    },
    {
      "pos": [
        10183,
        10272
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Team Explorer<ept id=\"p1\">**</ept>, choose the <bpt id=\"p2\">**</bpt>Home<ept id=\"p2\">**</ept> button and then choose the <bpt id=\"p3\">**</bpt>Branches<ept id=\"p3\">**</ept> button."
    },
    {
      "pos": [
        10290,
        10321
      ],
      "content": "Choose the <bpt id=\"p1\">**</bpt>New Branch<ept id=\"p1\">**</ept> link."
    },
    {
      "content": "Enter the name of the branch, such as \"working,\" and choose <bpt id=\"p1\">**</bpt>Create Branch<ept id=\"p1\">**</ept>.",
      "pos": [
        10339,
        10417
      ]
    },
    {
      "content": "This creates a new local branch.",
      "pos": [
        10418,
        10450
      ]
    },
    {
      "content": "Publish the branch.",
      "pos": [
        10468,
        10487
      ]
    },
    {
      "content": "Choose the branch name in <bpt id=\"p1\">**</bpt>Unpublished branches<ept id=\"p1\">**</ept>, and choose <bpt id=\"p2\">**</bpt>Publish<ept id=\"p2\">**</ept>.",
      "pos": [
        10488,
        10563
      ]
    },
    {
      "content": "By default, only changes to the master branch trigger a continuous build.",
      "pos": [
        10581,
        10654
      ]
    },
    {
      "content": "To set up continuous build for a working branch, choose the <bpt id=\"p1\">**</bpt>Builds<ept id=\"p1\">**</ept> page in <bpt id=\"p2\">**</bpt>Team Explorer<ept id=\"p2\">**</ept>, and choose <bpt id=\"p3\">**</bpt>Edit Build Definition<ept id=\"p3\">**</ept>.",
      "pos": [
        10655,
        10790
      ]
    },
    {
      "content": "Open the <bpt id=\"p1\">**</bpt>Source Settings<ept id=\"p1\">**</ept> tab.",
      "pos": [
        10795,
        10828
      ]
    },
    {
      "content": "Under <bpt id=\"p1\">**</bpt>Monitored branches for continuous integration and build<ept id=\"p1\">**</ept>, choose <bpt id=\"p2\">**</bpt>Click here to add a new row<ept id=\"p2\">**</ept>.",
      "pos": [
        10829,
        10935
      ]
    },
    {
      "content": "Specify the branch you created, such as refs/heads/working.",
      "pos": [
        10953,
        11012
      ]
    },
    {
      "pos": [
        11030,
        11129
      ],
      "content": "Make a change in the code, open the shortcut menu for the changed file, and then choose <bpt id=\"p1\">**</bpt>Commit<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        11148,
        11317
      ],
      "content": "Choose the <bpt id=\"p1\">**</bpt>Unsynced Commits<ept id=\"p1\">**</ept> link, and choose  the <bpt id=\"p2\">**</bpt>Sync<ept id=\"p2\">**</ept> button or the <bpt id=\"p3\">**</bpt>Push<ept id=\"p3\">**</ept> link to copy the changes to the copy of the working branch in Visual Studio Online."
    },
    {
      "pos": [
        11336,
        11434
      ],
      "content": "Navigate to the <bpt id=\"p1\">**</bpt>Builds<ept id=\"p1\">**</ept> view and find the build that just got triggered for the working branch."
    },
    {
      "content": "Next steps",
      "pos": [
        11439,
        11449
      ]
    },
    {
      "content": "To learn more tips on using Git with Visual Studio Online, see <bpt id=\"p1\">[</bpt>Develop and share your code in Git using Visual Studio<ept id=\"p1\">](http://www.visualstudio.com/get-started/share-your-code-in-git-vs.aspx)</ept> and for information about using a Git repository that's not managed by Visual Studio Online to publish to Azure, see <bpt id=\"p2\">[</bpt>Continuous deployment using GIT in Azure App Service<ept id=\"p2\">](../web-sites-publish-source-control.md)</ept>.",
      "pos": [
        11451,
        11855
      ]
    },
    {
      "content": "For more information on Visual Studio Online, see <bpt id=\"p1\">[</bpt>Visual Studio Online<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=253861)</ept>.",
      "pos": [
        11856,
        11976
      ]
    },
    {
      "content": "test",
      "pos": [
        15438,
        15442
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Continuous delivery with Git and Visual Studio Online in Azure\" \n    description=\"Learn how to configure your Visual Studio Online team projects to use Git to automatically build and deploy to the Web App feature in Azure App Service or cloud services.\"\n    services=\"cloud-services\"\n    documentationCenter=\".net\"\n    authors=\"kempb\"\n    manager=\"douge\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"cloud-services\"\n    ms.workload=\"tbd\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"dotnet\"\n    ms.topic=\"article\"\n    ms.date=\"09/02/2015\"\n    ms.author=\"kempb\"/>\n\n# Continuous delivery to Azure using Visual Studio Online and Git\n\nYou can use Visual Studio Online team projects to host a Git repository for your source code, and automatically build and deploy to Azure web apps or cloud services whenever you push a commit to the repository.\n\nYou'll need Visual Studio 2013 and the Azure SDK installed. If you don't already have Visual Studio 2013, download it by choosing the **Get started for free** link at [www.visualstudio.com](http://www.visualstudio.com). Install the Azure SDK from [here](http://go.microsoft.com/fwlink/?LinkId=239540).\n\n\n> [AZURE.NOTE] You need an Visual Studio online account to complete this tutorial:\n> You can [open a Visual Studio Online account for free](http://go.microsoft.com/fwlink/p/?LinkId=512979).\n\nTo set up a cloud service to automatically build and deploy to Azure by using Visual Studio Online, follow these steps.\n\n## Step 1: Create a Git repository\n\n1. If you donâ€™t already have a Visual Studio Online account, you can get one  [here](http://go.microsoft.com/fwlink/?LinkId=397665). When you create your team project, choose Git as your source control system. Follow the instructions to connect Visual Studio to your team project.\n\n2. In **Team Explorer**, choose the **Clone this repository** link.\n\n    ![][3]\n\n3. Specify the location of the local copy and then choose the **Clone** button.\n\n## Step 2: Create a project and commit it to the repository\n\n1. In **Team Explorer**, in the **Solutions** section, choose the **New** link to create a new project in the local repository.\n\n    ![][4]\n\n2. You can deploy a web app or a cloud service (Azure Application) by following the steps in this walkthrough. Create a new Azure Cloud Service project,\nor a new ASP.NET MVC project. Make sure that the project targets the .NET Framework 4 or later. If you are creating a cloud service project, add an ASP.NET MVC web role and a worker role.\nIf you want to create a web app, choose the **ASP.NET Web Application** project template, and then choose **MVC**. See [Create an ASP.NET web app in Azure App Service](../web-sites-dotnet-get-started.md) for more information.\n\n3. Open the shortcut menu for the solution, and choose **Commit**.\n\n    ![][7]\n\n4. If this is the first time you've used Git in Visual Studio Online, you'll need to provide some information to identify yourself in Git. In the **Pending Changes** area of **Team Explorer**, enter your username and email address. Enter a comment for the commit and then choose the **Commit** button.\n\n    ![][8]\n\n5. Note the options to include or exclude specific changes when you check in. If the changes you want are excluded, choose **Include All**.\n\n6. You've now committed the changes in your local copy of the repository. Next, sync those changes with the server by choosing the **Sync** link.\n\n## Step 3: Connect the project to Azure\n\n1. Now that you have a Git repository in Visual Studio Online with some source code in it, you are ready to connect your git repository to Azure.  In the [Azure Management Portal](http://manage.windowsazure.com), select your cloud service or web app, or create a new one by choosing the + icon at the bottom left and choosing **Cloud Service** or **Web App** and then **Quick Create**.\n\n    ![][9]\n\n3. For cloud services, choose the **Set up publishing with Visual Studio Online** link. For web apps, choose the **Set up deployment from source control** link.\n\n    ![][10]\n\n2. In the wizard, type the name of your Visual Studio Online account in the textbox and choose the **Authorize Now** link. You might be asked to sign in.\n\n    ![][11]\n\n3. In the **Connection Request** pop-up dialog, choose **Accept** to authorize Azure to configure your team project in Visual Studio Online.\n\n    ![][12]\n\n4. After authorization succeeds, you see a dropdown list that contains your Visual Studio Online team projects.  Select the name of team project that you created in the previous steps, and choose the wizard's checkmark button.\n\n    ![][13]\n\n    The next time you push a commit to your repository, Visual Studio Online will build and deploy your project to Azure.\n\n## Step 4: Trigger a rebuild and redeploy your project\n\n1. In Visual Studio, open up a file and change it. For example, change the file `_Layout.cshtml` under the Views\\\\Shared folder in an MVC web role.\n\n    ![][17]\n\n2. Edit the footer text for the site and save the file.\n\n    ![][18]\n\n3. In **Solution Explorer**, open the shortcut menu for the solution node, project node, or the file you changed, and then choose **Commit**.\n\n4. Type in a comment and choose **Commit**.\n\n    ![][20]\n\n5. Choose the **Sync** link.\n\n    ![][38]\n\n6. Choose the **Push** link to push your commit to the repository in Visual Studio Online. (You can also use the **Sync** button to copy your commits to the repository. The difference is that **Sync** also pulls the latest changes from the repository.)\n\n    ![][39]\n\n7. Choose the **Home** button to return to the **Team Explorer** home page.\n\n    ![][21]\n\n8. Choose **Builds** to view the builds in progress.\n\n    ![][22]\n\n    **Team Explorer** shows that a build has been triggered for your check-in.\n\n    ![][23]\n\n9. To view a detailed log as the build progresses, double-click the name of the build in progress.\n\n10. While the build is in-progress, take a look at the build definition that was created when you used the wizard to link to Azure.  Open the shortcut menu for the build definition and choose **Edit Build Definition**.\n\n    ![][25]\n\n11. In the **Trigger** tab, you will see that the build definition is set to build on every check-in, by default. (For a cloud service, Visual Studio Online builds and deploys the master branch to the staging environment automatically. You still have to do a manual step to deploy to the live site. For a web app that doesn't have staging environment, it deploys the master branch directly to the live site.\n\n    ![][26]\n\n1. In the **Process** tab, you can see the deployment environment is set to the name of your cloud service or web app.\n\n    ![][27]\n\n1. Specify values for the properties if you want different values than the defaults. The properties for Azure publishing are in the **Deployment** section, and you might also need to set MSBuild parameters. For example, in a cloud service project, to specify a service configuration other than \"Cloud\", set the MSbuild parameters to `/p:TargetProfile=[YourProfile]` where *[YourProfile]* matches a service configuration file with a name like ServiceConfiguration.*YourProfile*.cscfg.\n\n    The following table shows the available properties in the **Deployment** section:\n\n    |Property|Default Value|\n    |---|---|\n    |Allow Untrusted Certificates|If false, SSL certificates must be signed by a root authority.|\n    |Allow Upgrade|Allows the deployment to update an existing deployment instead of creating a new one. Preserves the IP address.|\n    |Do Not Delete|If true, do not overwrite an existing unrelated deployment (upgrade is allowed).|\n    |Path to Deployment Settings|The path to your .pubxml file for a web app, relative to the root folder of the repo. Ignored for cloud services.|\n    |Sharepoint Deployment Environment|The same as the service name.|\n    |Azure Deployment Environment|The web app or cloud service name.|\n\n1. By this time, your build should be completed successfully.\n\n    ![][28]\n\n1. If you double-click the build name, Visual Studio shows a **Build Summary**, including any test results from associated unit test projects.\n\n    ![][29]\n\n1. In the [Azure Management Portal](http://manage.windowsazure.com), you can view the associated deployment on the **Deployments** tab when the staging environment is selected.\n\n    ![][30]\n\n1.  Browse to your site's URL. For a web app, just choose  the **Browse** button in the portal. For a cloud service, choose the URL in the **Quick Glance** section of the **Dashboard** page that shows the Staging environment.\n\n    Deployments from continuous integration for cloud services are published to the Staging environment by default. You can change this by setting the **Alternate Cloud Service Environment** property to **Production**. Here's where the site URL is on the cloud service's dashboard page.\n\n    ![][31]\n\n    A new browser tab will open to reveal your running site.\n\n    ![][32]\n\n1.  If you make other changes to your project, you trigger more builds, and you will accumulate multiple deployments. The latest one is marked as Active.\n\n    ![][33]\n\n## Step 5: Redeploy an earlier build\n\nThis step is optional. In the Azure management portal, choose an earlier deployment and choose **Redeploy** to rewind your site to an earlier check-in. Note that this will trigger a new build in TFS and create a new entry in your deployment history.\n\n![][34]\n\n## Step 6: Change the Production deployment\n\nWhen you are ready, you can promote the Staging environment to the Production environment by choosing **Swap** in the Azure management portal. The newly deployed Staging environment is promoted to Production, and the previous Production environment, if any, becomes a Staging environment. The Active deployment may be different for the Production and Staging environments, but the deployment history of recent builds is the same regardless of environment.\n\n![][35]\n\n## Step 6: Deploy from a working branch.\n\nWhen you use Git, you usually make changes in a working branch and integrate into the master branch when your development reaches a finished state. During the development phase of a project, you'll want to build and deploy the working branch to Azure.\n\n1. In **Team Explorer**, choose the **Home** button and then choose the **Branches** button.\n\n    ![][40]\n\n2. Choose the **New Branch** link.\n\n    ![][41]\n\n3. Enter the name of the branch, such as \"working,\" and choose **Create Branch**. This creates a new local branch.\n\n    ![][42]\n\n4. Publish the branch. Choose the branch name in **Unpublished branches**, and choose **Publish**.\n\n    ![][44]\n\n6. By default, only changes to the master branch trigger a continuous build. To set up continuous build for a working branch, choose the **Builds** page in **Team Explorer**, and choose **Edit Build Definition**.\n\n7. Open the **Source Settings** tab. Under **Monitored branches for continuous integration and build**, choose **Click here to add a new row**.\n\n    ![][47]\n\n8. Specify the branch you created, such as refs/heads/working.\n\n    ![][48]\n\n9. Make a change in the code, open the shortcut menu for the changed file, and then choose **Commit**.\n\n    ![][43]\n\n10. Choose the **Unsynced Commits** link, and choose  the **Sync** button or the **Push** link to copy the changes to the copy of the working branch in Visual Studio Online.\n\n    ![][45]\n\n11. Navigate to the **Builds** view and find the build that just got triggered for the working branch.\n\n## Next steps\n\nTo learn more tips on using Git with Visual Studio Online, see [Develop and share your code in Git using Visual Studio](http://www.visualstudio.com/get-started/share-your-code-in-git-vs.aspx) and for information about using a Git repository that's not managed by Visual Studio Online to publish to Azure, see [Continuous deployment using GIT in Azure App Service](../web-sites-publish-source-control.md). For more information on Visual Studio Online, see [Visual Studio Online](http://go.microsoft.com/fwlink/?LinkId=253861).\n\n[0]: ./media/cloud-services-continuous-delivery-use-vso/tfs0.PNG\n[1]: ./media/cloud-services-continuous-delivery-use-vso-git/CreateTeamProjectInGit.PNG\n[2]: ./media/cloud-services-continuous-delivery-use-vso/tfs2.png\n[3]: ./media/cloud-services-continuous-delivery-use-vso-git/CloneThisRepository.PNG\n[4]: ./media/cloud-services-continuous-delivery-use-vso-git/CreateNewSolutionInClonedRepo.PNG\n[7]: ./media/cloud-services-continuous-delivery-use-vso-git/CommitMenuItem.PNG\n[8]: ./media/cloud-services-continuous-delivery-use-vso-git/CommitAChange2.PNG\n[9]: ./media/cloud-services-continuous-delivery-use-vso-git/CreateCloudService.PNG\n[10]: ./media/cloud-services-continuous-delivery-use-vso-git/SetUpPublishingWithVSO.PNG\n[11]: ./media/cloud-services-continuous-delivery-use-vso-git/AuthorizeConnection.PNG\n[12]: ./media/cloud-services-continuous-delivery-use-vso-git/ConnectionRequest.PNG\n[13]: ./media/cloud-services-continuous-delivery-use-vso-git/ChooseARepo3.PNG\n[14]: ./media/cloud-services-continuous-delivery-use-vso/tfs14.png\n[15]: ./media/cloud-services-continuous-delivery-use-vso/tfs15.png\n[16]: ./media/cloud-services-continuous-delivery-use-vso/tfs16.png\n[17]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs17.png\n[18]: ./media/cloud-services-continuous-delivery-use-vso-git/MakeACodeChange.PNG\n[20]: ./media/cloud-services-continuous-delivery-use-vso-git/CommitAChange2.PNG\n[21]: ./media/cloud-services-continuous-delivery-use-vso-git/TeamExplorerHome.png\n[22]: ./media/cloud-services-continuous-delivery-use-vso-git/TeamExplorerBuilds.PNG\n[23]: ./media/cloud-services-continuous-delivery-use-vso-git/BuildInQueue.png\n[24]: ./media/cloud-services-continuous-delivery-use-vso/tfs24.png\n[25]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs25.png\n[26]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs26.png\n[27]: ./media/cloud-services-continuous-delivery-use-vso-git/ProcessTab.PNG\n[28]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs28.png\n[29]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs29.png\n[30]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs30.png\n[31]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs31.png\n[32]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs32.png\n[33]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs33.png\n[34]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs34.png\n[35]: ./media/cloud-services-continuous-delivery-use-vso-git/tfs35.png\n[36]: ./media/cloud-services-continuous-delivery-use-vso/tfs36.PNG\n[37]: ./media/cloud-services-continuous-delivery-use-vso-git/CreateANewAccount.PNG\n[38]: ./media/cloud-services-continuous-delivery-use-vso-git/SyncChanges2.PNG\n[39]: ./media/cloud-services-continuous-delivery-use-vso-git/PushCurrentBranch.PNG\n[40]: ./media/cloud-services-continuous-delivery-use-vso-git/BranchesInTeamExplorer.PNG\n[41]: ./media/cloud-services-continuous-delivery-use-vso-git/NewBranch.PNG\n[42]: ./media/cloud-services-continuous-delivery-use-vso-git/CreateBranch.PNG\n[43]: ./media/cloud-services-continuous-delivery-use-vso-git/CommitAChange2.PNG\n[44]: ./media/cloud-services-continuous-delivery-use-vso-git/PublishBranch.PNG\n[45]: ./media/cloud-services-continuous-delivery-use-vso-git/SyncChanges2.PNG\n[47]: ./media/cloud-services-continuous-delivery-use-vso-git/SourceSettingsPage.PNG\n[48]: ./media/cloud-services-continuous-delivery-use-vso-git/IncludeWorkingBranch.PNG\n\ntest\n"
}