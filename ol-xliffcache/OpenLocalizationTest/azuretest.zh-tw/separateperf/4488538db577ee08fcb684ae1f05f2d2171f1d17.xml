{
  "nodes": [
    {
      "content": "StorSimple virtual device in Azure | Microsoft Azure",
      "pos": [
        26,
        78
      ]
    },
    {
      "content": "Learn how to create, deploy, and manage a StorSimple virtual device in a Microsoft Azure virtual network.",
      "pos": [
        96,
        201
      ]
    },
    {
      "content": "(Applies to StorSimple version .3 and earlier.)",
      "pos": [
        202,
        249
      ]
    },
    {
      "content": "Deploy and manage a StorSimple virtual device in Azure",
      "pos": [
        533,
        587
      ]
    },
    {
      "content": "Overview",
      "pos": [
        694,
        702
      ]
    },
    {
      "content": "The StorSimple virtual device is an additional capability that comes with your Microsoft Azure StorSimple solution.",
      "pos": [
        704,
        819
      ]
    },
    {
      "content": "The StorSimple virtual device runs on a virtual machine in a Microsoft Azure virtual network, and you can use it to back up and clone data from your hosts.",
      "pos": [
        820,
        975
      ]
    },
    {
      "content": "The following topics in this article will help you learn about, configure, and use the StorSimple virtual device.",
      "pos": [
        976,
        1089
      ]
    },
    {
      "content": "How the virtual device differs from the physical device.",
      "pos": [
        1093,
        1149
      ]
    },
    {
      "content": "Security considerations for using a virtual device.",
      "pos": [
        1153,
        1204
      ]
    },
    {
      "content": "Prerequisites for the virtual device.",
      "pos": [
        1208,
        1245
      ]
    },
    {
      "content": "Create and configure the virtual device.",
      "pos": [
        1249,
        1289
      ]
    },
    {
      "content": "Work with the virtual device.",
      "pos": [
        1293,
        1322
      ]
    },
    {
      "content": "Failover to the virtual device.",
      "pos": [
        1326,
        1357
      ]
    },
    {
      "content": "Shut down or delete the virtual device.",
      "pos": [
        1361,
        1400
      ]
    },
    {
      "content": "How the virtual device differs from the physical device",
      "pos": [
        1406,
        1461
      ]
    },
    {
      "content": "The StorSimple virtual device is a software-only version of StorSimple that runs on a single node in a Microsoft Azure virtual machine.",
      "pos": [
        1463,
        1598
      ]
    },
    {
      "content": "The virtual device supports disaster recovery scenarios in which your physical device is not available, and is appropriate for use in cloud dev and test scenarios.",
      "pos": [
        1599,
        1762
      ]
    },
    {
      "content": "The following are some key differences between the StorSimple virtual device and the physical StorSimple device:",
      "pos": [
        1764,
        1876
      ]
    },
    {
      "content": "The virtual device has only one network interface: DATA 0.",
      "pos": [
        1880,
        1938
      ]
    },
    {
      "content": "The physical device has six network interfaces: DATA 0 through DATA 5.",
      "pos": [
        1939,
        2009
      ]
    },
    {
      "content": "The virtual device is registered during the configuration step instead of as a separate task.",
      "pos": [
        2012,
        2105
      ]
    },
    {
      "content": "The service data encryption key cannot be regenerated from the virtual device.",
      "pos": [
        2108,
        2186
      ]
    },
    {
      "content": "During key rollover, you will regenerate the key on the physical device and then update the virtual device with the new key.",
      "pos": [
        2187,
        2311
      ]
    },
    {
      "content": "If updates need to be applied to the virtual device, it will experience some down time, whereas the physical device will not.",
      "pos": [
        2314,
        2439
      ]
    },
    {
      "content": "Security considerations for using a virtual device",
      "pos": [
        2444,
        2494
      ]
    },
    {
      "content": "Keep the following security considerations in mind when you use the StorSimple virtual device:",
      "pos": [
        2496,
        2590
      ]
    },
    {
      "content": "The virtual device is secured through your Microsoft Azure subscription.",
      "pos": [
        2594,
        2666
      ]
    },
    {
      "content": "This means that if you are using the virtual device and your Azure subscription is compromised, the data stored on your virtual device is also susceptible.",
      "pos": [
        2667,
        2822
      ]
    },
    {
      "content": "The public key of the certificate used to encrypt data stored in Azure StorSimple is securely made available to the Azure portal, and the private key is retained with the StorSimple device.",
      "pos": [
        2826,
        3015
      ]
    },
    {
      "content": "On the StorSimple virtual device, both the public and private keys are stored in Azure.",
      "pos": [
        3016,
        3103
      ]
    },
    {
      "content": "The virtual device is hosted in the Microsoft Azure datacenter.",
      "pos": [
        3107,
        3170
      ]
    },
    {
      "content": "Prerequisites for the virtual device",
      "pos": [
        3176,
        3212
      ]
    },
    {
      "content": "The following sections will help you prepare to use the StorSimple virtual device.",
      "pos": [
        3214,
        3296
      ]
    },
    {
      "content": "Azure requirements",
      "pos": [
        3302,
        3320
      ]
    },
    {
      "content": "Before you provision the virtual device, you need to make the following preparations in your Azure environment:",
      "pos": [
        3322,
        3433
      ]
    },
    {
      "pos": [
        3437,
        3533
      ],
      "content": "For the virtual device, <bpt id=\"p1\">[</bpt>configure a virtual network on Azure<ept id=\"p1\">](virtual-networks-create-vnet.md)</ept>."
    },
    {
      "content": "It is advisable to use the default DNS server provided by Azure instead of specifying your own DNS server name.",
      "pos": [
        3536,
        3647
      ]
    },
    {
      "content": "If your DNS server name is not valid, the creation of the virtual device will fail.",
      "pos": [
        3648,
        3731
      ]
    },
    {
      "content": "Point-to-site and site-to-site are optional, but not required.",
      "pos": [
        3734,
        3796
      ]
    },
    {
      "content": "If you wish, you can configure these options for more advanced scenarios.",
      "pos": [
        3797,
        3870
      ]
    },
    {
      "content": "Make sure that the virtual network is in the same region as the cloud storage accounts that you are going to be using with the virtual device.",
      "pos": [
        3893,
        4035
      ]
    },
    {
      "content": "**",
      "pos": [
        4035,
        4037
      ]
    },
    {
      "content": "You can create <bpt id=\"p1\">[</bpt>Azure Virtual Machines<ept id=\"p1\">](../virtual-machines/virtual-machines-about.md)</ept> (host servers) in the virtual network that can use the volumes exposed by the virtual device.",
      "pos": [
        4041,
        4221
      ]
    },
    {
      "content": "These servers must meet the following requirements:",
      "pos": [
        4222,
        4273
      ]
    },
    {
      "content": "Be Windows or Linux VMs with iSCSI Initiator software installed.",
      "pos": [
        4280,
        4344
      ]
    },
    {
      "content": "Be running in the same virtual network as the virtual device.",
      "pos": [
        4351,
        4412
      ]
    },
    {
      "content": "Be able to connect to the iSCSI target of the virtual device through the internal IP address of the virtual device.",
      "pos": [
        4419,
        4534
      ]
    },
    {
      "content": "Make sure you have configured support for iSCSI and cloud traffic on the same virtual network.",
      "pos": [
        4538,
        4632
      ]
    },
    {
      "content": "StorSimple requirements",
      "pos": [
        4638,
        4661
      ]
    },
    {
      "content": "Make the following updates to your Azure StorSimple service before you create a virtual device:",
      "pos": [
        4663,
        4758
      ]
    },
    {
      "pos": [
        4763,
        4889
      ],
      "content": "Add <bpt id=\"p1\">[</bpt>access control records<ept id=\"p1\">](storsimple-manage-acrs.md)</ept> for the VMs that are going to be host servers for your virtual device."
    },
    {
      "content": "Make sure that you have a <bpt id=\"p1\">[</bpt>storage account<ept id=\"p1\">](storsimple-manage-storage-accounts.md#add-a-storage-account)</ept> in the same region as the virtual device.",
      "pos": [
        4893,
        5039
      ]
    },
    {
      "content": "Storage accounts in different regions may result in poor performance.",
      "pos": [
        5040,
        5109
      ]
    },
    {
      "content": "Make sure that you use a different storage account for virtual device creation from the one used for your data.",
      "pos": [
        5113,
        5224
      ]
    },
    {
      "content": "Using the same storage account may result in poor performance.",
      "pos": [
        5225,
        5287
      ]
    },
    {
      "content": "Make sure that you have the following information before you begin:",
      "pos": [
        5289,
        5356
      ]
    },
    {
      "content": "You have your Azure portal account with access credentials.",
      "pos": [
        5360,
        5419
      ]
    },
    {
      "content": "You have your Azure storage account access credentials.",
      "pos": [
        5423,
        5478
      ]
    },
    {
      "content": "You have a copy of the service data encryption key from your physical device.",
      "pos": [
        5482,
        5559
      ]
    },
    {
      "content": "You have a copy of the cloud service encryption key for each volume container.",
      "pos": [
        5563,
        5641
      ]
    },
    {
      "content": "Create and configure the virtual device",
      "pos": [
        5647,
        5686
      ]
    },
    {
      "pos": [
        5688,
        5834
      ],
      "content": "Before performing these procedures, make sure that you have met the <bpt id=\"p1\">[</bpt>Prerequisites for the virtual device<ept id=\"p1\">](#prerequisites-for-the-virtual-device)</ept>."
    },
    {
      "pos": [
        5836,
        5961
      ],
      "content": "After completing these procedures, you are ready to <bpt id=\"p1\">[</bpt>Work with the virtual device<ept id=\"p1\">](#work-with-the-storsimple-virtual-device)</ept>."
    },
    {
      "content": "Create the virtual device",
      "pos": [
        5967,
        5992
      ]
    },
    {
      "content": "After you have created a virtual network, configured a StorSimple Manager service, and registered your physical StorSimple device with the service, you can use the following steps to create a StorSimple virtual device.",
      "pos": [
        5994,
        6212
      ]
    },
    {
      "content": "Perform the following steps to create the StorSimple virtual device.",
      "pos": [
        6214,
        6282
      ]
    },
    {
      "pos": [
        6290,
        6352
      ],
      "content": "In the Azure portal, go to the <bpt id=\"p1\">**</bpt>StorSimple Manager<ept id=\"p1\">**</ept> service."
    },
    {
      "pos": [
        6357,
        6384
      ],
      "content": "Go to the <bpt id=\"p1\">**</bpt>Devices<ept id=\"p1\">**</ept> page."
    },
    {
      "pos": [
        6389,
        6464
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Create Virtual Device<ept id=\"p1\">**</ept> dialog box, specify the following details."
    },
    {
      "content": "StorSimple create virtual device",
      "pos": [
        6472,
        6504
      ]
    },
    {
      "pos": [
        6585,
        6634
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> – A unique name for your virtual device."
    },
    {
      "pos": [
        6643,
        6743
      ],
      "content": "<bpt id=\"p1\">**</bpt>Virtual Network<ept id=\"p1\">**</ept> – The name of the virtual network that you want to use with this virtual device."
    },
    {
      "pos": [
        6752,
        6831
      ],
      "content": "<bpt id=\"p1\">**</bpt>Subnet<ept id=\"p1\">**</ept> – The subnet on the virtual network for use with the virtual device."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Storage Account for Virtual Device Creation<ept id=\"p1\">**</ept> – The storage account that will be used to hold the image of the virtual device during provisioning.",
      "pos": [
        6840,
        6988
      ]
    },
    {
      "content": "This storage account should be in the same region as the virtual device and virtual network.",
      "pos": [
        6989,
        7081
      ]
    },
    {
      "content": "It should not be used for data storage by either the physical device or the virtual device.",
      "pos": [
        7082,
        7173
      ]
    },
    {
      "content": "By default, a new storage account will be created for this purpose.",
      "pos": [
        7174,
        7241
      ]
    },
    {
      "content": "However, if you know that you already have a storage account that is suitable for this use, you can select it from the list.",
      "pos": [
        7242,
        7366
      ]
    },
    {
      "pos": [
        7371,
        7735
      ],
      "content": "Click the check mark to indicate that you understand that the data stored on the virtual device will be hosted in a Microsoft datacenter. A virtual device will now be created. It may take up to 45 minutes to 1 hour to create a virtual device.\n ![StorSimple virtual device creating stage](./media/storsimple-virtual-device/StorSimple_VirtualDeviceCreating1M.png)",
      "leadings": [
        "",
        "   "
      ],
      "nodes": [
        {
          "content": "Click the check mark to indicate that you understand that the data stored on the virtual device will be hosted in a Microsoft datacenter. A virtual device will now be created. It may take up to 45 minutes to 1 hour to create a virtual device.",
          "pos": [
            0,
            242
          ],
          "nodes": [
            {
              "content": "Click the check mark to indicate that you understand that the data stored on the virtual device will be hosted in a Microsoft datacenter.",
              "pos": [
                0,
                137
              ]
            },
            {
              "content": "A virtual device will now be created.",
              "pos": [
                138,
                175
              ]
            },
            {
              "content": "It may take up to 45 minutes to 1 hour to create a virtual device.",
              "pos": [
                176,
                242
              ]
            }
          ]
        },
        {
          "content": "StorSimple virtual device creating stage",
          "pos": [
            246,
            286
          ]
        }
      ]
    },
    {
      "content": "When you use only a physical device, your encryption key is kept with your device; therefore, Microsoft cannot decrypt it.",
      "pos": [
        7737,
        7859
      ]
    },
    {
      "content": "When you use a virtual device, both the encryption key and the decryption key are stored in Microsoft Azure.",
      "pos": [
        7860,
        7968
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Security considerations for using a virtual device<ept id=\"p1\">](#security-considerations-for-using-a-virtual-device)</ept>.",
      "pos": [
        7969,
        8101
      ]
    },
    {
      "content": "Configure and register the virtual device",
      "pos": [
        8107,
        8148
      ]
    },
    {
      "content": "Before starting this procedure, make sure that you have a copy of the service data encryption key.",
      "pos": [
        8150,
        8248
      ]
    },
    {
      "content": "The service data encryption key was created when you configured your first StorSimple physical device and you were instructed to save it in a secure location.",
      "pos": [
        8249,
        8407
      ]
    },
    {
      "content": "If you do not have a copy of the service data encryption key, you must <bpt id=\"p1\">[</bpt>contact Microsoft Support<ept id=\"p1\">](storsimple-contact-microsoft-support.md)</ept> for assistance.",
      "pos": [
        8408,
        8563
      ]
    },
    {
      "content": "Perform the following steps to configure and register your StorSimple virtual device.",
      "pos": [
        8565,
        8650
      ]
    },
    {
      "pos": [
        8656,
        8738
      ],
      "content": "Select the <bpt id=\"p1\">**</bpt>StorSimple virtual device<ept id=\"p1\">**</ept> you just created on the <bpt id=\"p2\">**</bpt>Devices<ept id=\"p2\">**</ept> page."
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Complete Device Configuration<ept id=\"p1\">**</ept>.",
      "pos": [
        8743,
        8783
      ]
    },
    {
      "content": "This starts the Configure device wizard.",
      "pos": [
        8784,
        8824
      ]
    },
    {
      "content": "StorSimple complete device setup in Devices page",
      "pos": [
        8832,
        8880
      ]
    },
    {
      "content": "In the Configure device wizard:",
      "pos": [
        8961,
        8992
      ]
    },
    {
      "pos": [
        9001,
        9065
      ],
      "content": "Enter the <bpt id=\"p1\">**</bpt>Service Data Encryption Key<ept id=\"p1\">**</ept> in the space provided."
    },
    {
      "content": "Enter the <bpt id=\"p1\">**</bpt>Snapshot Manager password<ept id=\"p1\">**</ept>.",
      "pos": [
        9073,
        9113
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Snapshot Manager password<ept id=\"p1\">**</ept> must be 14 or 15 characters in length and must contain a combination of lowercase, uppercase, numeric, and special characters.",
      "pos": [
        9114,
        9274
      ]
    },
    {
      "content": "Enter the <bpt id=\"p1\">**</bpt>device administrator password<ept id=\"p1\">**</ept>.",
      "pos": [
        9282,
        9326
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>device administrator password<ept id=\"p1\">**</ept> must be between 8 to 15 characters and must contain a combination of lowercase, uppercase, numeric, and special characters.",
      "pos": [
        9327,
        9488
      ]
    },
    {
      "content": "Click the check icon to finish the initial configuration and registration of the virtual device.",
      "pos": [
        9496,
        9592
      ]
    },
    {
      "content": "StorSimple virtual device settings",
      "pos": [
        9604,
        9638
      ]
    },
    {
      "content": "After the configuration and registration is complete, the device will come online.",
      "pos": [
        9714,
        9796
      ]
    },
    {
      "content": "It may take several minutes for the device to come online.",
      "pos": [
        9797,
        9855
      ]
    },
    {
      "content": "StorSimple virtual device online stage",
      "pos": [
        9859,
        9897
      ]
    },
    {
      "content": "Modify the device configuration settings",
      "pos": [
        9976,
        10016
      ]
    },
    {
      "content": "The following section describes the device configuration settings that you may want to configure for the StorSimple virtual device.",
      "pos": [
        10018,
        10149
      ]
    },
    {
      "content": "These settings include those of CHAP, StorSimple Snapshot Manager password, or device administrator password.",
      "pos": [
        10150,
        10259
      ]
    },
    {
      "content": "Configure the CHAP initiator (optional)",
      "pos": [
        10266,
        10305
      ]
    },
    {
      "content": "This parameter contains the credentials that your virtual device (target) expects from the initiators (servers) that are attempting to access the volumes.",
      "pos": [
        10307,
        10461
      ]
    },
    {
      "content": "The initiators will provide a CHAP user name and a CHAP password to identify themselves to your device during this authentication.",
      "pos": [
        10462,
        10592
      ]
    },
    {
      "content": "Configure the CHAP target (optional)",
      "pos": [
        10599,
        10635
      ]
    },
    {
      "content": "This parameter contains the credentials that your virtual device uses when a CHAP-enabled initiator requests mutual or bi-directional authentication.",
      "pos": [
        10637,
        10786
      ]
    },
    {
      "content": "Your virtual device will use a Reverse CHAP user name and Reverse CHAP password to identify itself to the initiator during this authentication process.",
      "pos": [
        10787,
        10938
      ]
    },
    {
      "content": "Note that CHAP target settings are global settings.",
      "pos": [
        10939,
        10990
      ]
    },
    {
      "content": "When these are applied, all the volumes connected to the storage virtual device will use CHAP authentication.",
      "pos": [
        10991,
        11100
      ]
    },
    {
      "content": "Configure the StorSimple Snapshot Manager (optional)",
      "pos": [
        11107,
        11159
      ]
    },
    {
      "content": "StorSimple Snapshot Manager software resides on your Windows host and allows administrators to manage backups of your StorSimple device in the form of local and cloud snapshots.",
      "pos": [
        11161,
        11338
      ]
    },
    {
      "pos": [
        11341,
        11411
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> For the virtual device, your Windows host is an Azure VM."
    },
    {
      "content": "When configuring a device in the StorSimple Snapshot Manager, you will be prompted to provide the StorSimple device IP address and password to authenticate your storage device.",
      "pos": [
        11413,
        11589
      ]
    },
    {
      "content": "This password is first configured through the Windows PowerShell interface.",
      "pos": [
        11590,
        11665
      ]
    },
    {
      "content": "Perform the following steps to change StorSimple Snapshot Manager when using it with your StorSimple virtual device.",
      "pos": [
        11667,
        11783
      ]
    },
    {
      "pos": [
        11788,
        11842
      ],
      "content": "On your virtual device, go to <bpt id=\"p1\">**</bpt>Devices &gt; Configure<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Scroll down to the <bpt id=\"p1\">**</bpt>Snapshot Manager<ept id=\"p1\">**</ept> section.",
      "pos": [
        11846,
        11894
      ]
    },
    {
      "content": "Enter a password that is 14 or 15 characters.",
      "pos": [
        11895,
        11940
      ]
    },
    {
      "content": "Make sure that the password contains a combination of uppercase, lowercase, numeric, and special characters.",
      "pos": [
        11941,
        12049
      ]
    },
    {
      "content": "Confirm the password.",
      "pos": [
        12053,
        12074
      ]
    },
    {
      "pos": [
        12078,
        12119
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "The StorSimple Snapshot Manager password is now updated and can be used when you authenticate your Windows hosts.",
      "pos": [
        12121,
        12234
      ]
    },
    {
      "content": "Configure the device administrator password",
      "pos": [
        12241,
        12284
      ]
    },
    {
      "content": "When you use the Windows PowerShell interface to access the virtual device, you will be required to enter a device administrator password.",
      "pos": [
        12286,
        12424
      ]
    },
    {
      "content": "For the security of your data, you are required to change this password before the virtual device can be used.",
      "pos": [
        12425,
        12535
      ]
    },
    {
      "content": "Perform the following steps to change the device administrator password for your StorSimple virtual device.",
      "pos": [
        12537,
        12644
      ]
    },
    {
      "pos": [
        12649,
        12703
      ],
      "content": "On your virtual device, go to <bpt id=\"p1\">**</bpt>Devices &gt; Configure<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Scroll down to the <bpt id=\"p1\">**</bpt>Device Administrator password<ept id=\"p1\">**</ept> section.",
      "pos": [
        12708,
        12769
      ]
    },
    {
      "content": "Provide an administrator password that contains from 8 to 15 characters.",
      "pos": [
        12770,
        12842
      ]
    },
    {
      "content": "The password must be a combination of uppercase, lowercase, numeric, and special characters.",
      "pos": [
        12843,
        12935
      ]
    },
    {
      "content": "Confirm the password.",
      "pos": [
        12940,
        12961
      ]
    },
    {
      "pos": [
        12966,
        13007
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "The device administrator password should now be updated.",
      "pos": [
        13009,
        13065
      ]
    },
    {
      "content": "You will use this modified password to access the the Windows PowerShell interface on your virtual device.",
      "pos": [
        13066,
        13172
      ]
    },
    {
      "content": "Configure remote management (optional)",
      "pos": [
        13179,
        13217
      ]
    },
    {
      "content": "Remote access to your virtual device via the Windows PowerShell interface is not enabled by default.",
      "pos": [
        13219,
        13319
      ]
    },
    {
      "content": "You need to enable remote management on the virtual device first, and then enable it on the client that will be used to access your virtual device.",
      "pos": [
        13320,
        13467
      ]
    },
    {
      "content": "You can choose to connect over HTTP or HTTPS.",
      "pos": [
        13469,
        13514
      ]
    },
    {
      "content": "For security reasons, we recommend that you use HTTPS with a self-signed certificate to connect to your virtual device.",
      "pos": [
        13515,
        13634
      ]
    },
    {
      "content": "Perform the following steps to configure remote management for your StorSimple virtual device.",
      "pos": [
        13636,
        13730
      ]
    },
    {
      "pos": [
        13736,
        13790
      ],
      "content": "On your virtual device, go to <bpt id=\"p1\">**</bpt>Devices &gt; Configure<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        13795,
        13844
      ],
      "content": "Scroll down to the <bpt id=\"p1\">**</bpt>Remote Management<ept id=\"p1\">**</ept> section."
    },
    {
      "pos": [
        13849,
        13893
      ],
      "content": "Set <bpt id=\"p1\">**</bpt>Enable Remote Management<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."
    },
    {
      "content": "You can now choose to connect using HTTP.",
      "pos": [
        13898,
        13939
      ]
    },
    {
      "content": "The default is to connect over HTTPS.",
      "pos": [
        13940,
        13977
      ]
    },
    {
      "content": "Connecting over HTTP is acceptable only on trusted networks.",
      "pos": [
        13978,
        14038
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Download Remote Management Certificate<ept id=\"p1\">**</ept> to download a remote management certificate.",
      "pos": [
        14043,
        14136
      ]
    },
    {
      "content": "You will specify a location in which to save this file.",
      "pos": [
        14137,
        14192
      ]
    },
    {
      "content": "This certificate then needs to be installed on the client or host machine that you will use to connect to the virtual device.",
      "pos": [
        14193,
        14318
      ]
    },
    {
      "pos": [
        14323,
        14364
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "Work with the StorSimple virtual device",
      "pos": [
        14370,
        14409
      ]
    },
    {
      "content": "Now that you have created and configured the StorSimple virtual device, you are ready to start working with it.",
      "pos": [
        14411,
        14522
      ]
    },
    {
      "content": "You can work with volume containers, volumes, and backup policies on a virtual device just as you would on a physical StorSimple device; the only difference is that you need to make sure that you select the virtual device from your device list.",
      "pos": [
        14523,
        14767
      ]
    },
    {
      "content": "Refer to the following sections for instructions on associated tasks:",
      "pos": [
        14768,
        14837
      ]
    },
    {
      "content": "Volume containers",
      "pos": [
        14843,
        14860
      ]
    },
    {
      "content": "Volumes",
      "pos": [
        14906,
        14913
      ]
    },
    {
      "content": "Backup policies",
      "pos": [
        14949,
        14964
      ]
    },
    {
      "content": "The following sections discuss some of the differences you will encounter when working with the virtual device.",
      "pos": [
        15005,
        15116
      ]
    },
    {
      "content": "Maintain a StorSimple virtual device",
      "pos": [
        15122,
        15158
      ]
    },
    {
      "content": "Because it is a software-only device, maintenance for the virtual device is minimal when compared to maintenance for the physical device.",
      "pos": [
        15160,
        15297
      ]
    },
    {
      "content": "You have the following options:",
      "pos": [
        15298,
        15329
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Software updates<ept id=\"p1\">**</ept> – You can view the date that the software was last updated, together with any update status messages.",
      "pos": [
        15333,
        15455
      ]
    },
    {
      "content": "You can use the Scan updates button at the bottom of the page to perform a manual scan if you want to check for new updates.",
      "pos": [
        15456,
        15580
      ]
    },
    {
      "pos": [
        15583,
        15720
      ],
      "content": "<bpt id=\"p1\">**</bpt>Support package<ept id=\"p1\">**</ept> – You can create and upload a support package to help Microsoft Support troubleshoot issues with your virtual device."
    },
    {
      "content": "Storage accounts for a virtual device",
      "pos": [
        15726,
        15763
      ]
    },
    {
      "content": "Storage accounts are created for use by the StorSimple Manager service, by the virtual device, and by the physical device.",
      "pos": [
        15765,
        15887
      ]
    },
    {
      "content": "When you create your storage accounts, we recommend that you use a region identifier in the friendly name to help ensure that the region is consistent throughout all of the system components.",
      "pos": [
        15888,
        16079
      ]
    },
    {
      "content": "For a virtual device, it is important that all of the components be in the same region to prevent performance issues.",
      "pos": [
        16080,
        16197
      ]
    },
    {
      "content": "Deactivate a StorSimple virtual device",
      "pos": [
        16203,
        16241
      ]
    },
    {
      "content": "Deactivating a virtual device deletes the VM and the resources created when it was provisioned.",
      "pos": [
        16243,
        16338
      ]
    },
    {
      "content": "After the virtual device is deactivated, it cannot be restored to its previous state.",
      "pos": [
        16339,
        16424
      ]
    },
    {
      "content": "Before you deactivate the virtual device, make sure to stop or delete clients and hosts that depend on it.",
      "pos": [
        16425,
        16531
      ]
    },
    {
      "content": "Deactivating a virtual device results in the following actions:",
      "pos": [
        16533,
        16596
      ]
    },
    {
      "content": "The virtual device is removed.",
      "pos": [
        16600,
        16630
      ]
    },
    {
      "content": "The OSDisk and Data Disks created for the virtual device are removed.",
      "pos": [
        16634,
        16703
      ]
    },
    {
      "content": "The hosted service and virtual network created during provisioning are retained.",
      "pos": [
        16707,
        16787
      ]
    },
    {
      "content": "If you are not using them, you should delete them manually.",
      "pos": [
        16788,
        16847
      ]
    },
    {
      "content": "Cloud snapshots created for the virtual device are retained.",
      "pos": [
        16851,
        16911
      ]
    },
    {
      "content": "As soon as the device is shown as deactivated on the StorSimple Manager service page, you can delete the virtual device from the StorSimple Manager service device list.",
      "pos": [
        16913,
        17081
      ]
    },
    {
      "content": "Remotely access a StorSimple virtual device",
      "pos": [
        17087,
        17130
      ]
    },
    {
      "content": "After you have enabled it on the StorSimple device configuration page, you can use Windows PowerShell remoting to connect to the virtual device from another virtual machine inside the same virtual network; for example, you can connect from the host VM that you configured and used to connect iSCSI.",
      "pos": [
        17132,
        17430
      ]
    },
    {
      "content": "In most deployments, you will have already opened a public endpoint to access your host VM that you can use for accessing the virtual device.",
      "pos": [
        17431,
        17572
      ]
    },
    {
      "pos": [
        17575,
        17774
      ],
      "content": "<ph id=\"ph1\">[AZURE.WARNING]</ph> For enhanced security, we strongly recommend that you use HTTPS when connecting to the endpoints and then delete the endpoints after you have completed your PowerShell remote session."
    },
    {
      "pos": [
        17776,
        17930
      ],
      "content": "You should follow the procedures in <bpt id=\"p1\">[</bpt>Connect remotely to your StorSimple device<ept id=\"p1\">](storsimple-remote-connect.md)</ept> to set up remoting for your virtual device."
    },
    {
      "content": "However, if you want to connect directly to the virtual device from another computer outside the virtual network or outside the Microsoft Azure environment, you need to create additional endpoints as described in the following procedure.",
      "pos": [
        17932,
        18169
      ]
    },
    {
      "content": "Perform the following steps to create a public endpoint on the virtual device.",
      "pos": [
        18171,
        18249
      ]
    },
    {
      "content": "Sign in to the Azure portal.",
      "pos": [
        18254,
        18282
      ]
    },
    {
      "pos": [
        18286,
        18392
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Virtual Machines<ept id=\"p1\">**</ept>, and then select the virtual machine that is being used as your virtual device."
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Endpoints<ept id=\"p1\">**</ept>.",
      "pos": [
        18396,
        18416
      ]
    },
    {
      "content": "The Endpoints page lists all endpoints for the virtual machine.",
      "pos": [
        18417,
        18480
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.",
      "pos": [
        18484,
        18498
      ]
    },
    {
      "content": "The Add Endpoint dialog box appears.",
      "pos": [
        18499,
        18535
      ]
    },
    {
      "content": "Click the arrow to continue.",
      "pos": [
        18536,
        18564
      ]
    },
    {
      "pos": [
        18568,
        18643
      ],
      "content": "For the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept>, type the following name for the endpoint: <bpt id=\"p2\">**</bpt>WinRMHttps<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        18647,
        18685
      ],
      "content": "For the <bpt id=\"p1\">**</bpt>Protocol<ept id=\"p1\">**</ept>, specify <bpt id=\"p2\">**</bpt>TCP<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        18689,
        18776
      ],
      "content": "For the <bpt id=\"p1\">**</bpt>Public Port<ept id=\"p1\">**</ept>, type the port numbers that you want to use for the connection."
    },
    {
      "pos": [
        18780,
        18820
      ],
      "content": "For the <bpt id=\"p1\">**</bpt>Private Port<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>5986<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click the check mark to create the endpoint.",
      "pos": [
        18824,
        18868
      ]
    },
    {
      "content": "After the endpoint is created, you can view its details to determine the Public Virtual IP (VIP) address.",
      "pos": [
        18870,
        18975
      ]
    },
    {
      "content": "Record this address.",
      "pos": [
        18976,
        18996
      ]
    },
    {
      "content": "We recommend that you connect from another virtual machine inside the same virtual network because this practice minimizes the number of public endpoints on your virtual network.",
      "pos": [
        18998,
        19176
      ]
    },
    {
      "content": "When you use this method, you simply connect to the virtual machine through a Remote Desktop session and then configure that virtual machine for use as you would any other Windows client on a local network.",
      "pos": [
        19177,
        19383
      ]
    },
    {
      "content": "You do not need to append the public port number because the port will already be known.",
      "pos": [
        19384,
        19472
      ]
    },
    {
      "content": "Stop and restart",
      "pos": [
        19478,
        19494
      ]
    },
    {
      "content": "Unlike the physical StorSimple device, there is no power on or power off button to push on a StorSimple virtual device.",
      "pos": [
        19496,
        19615
      ]
    },
    {
      "content": "However, there may be occasions where you need to stop and restart the virtual device.",
      "pos": [
        19616,
        19702
      ]
    },
    {
      "content": "For example, some updates might require that the VM be restarted to finish the update process.",
      "pos": [
        19703,
        19797
      ]
    },
    {
      "content": "The easiest way for you to start, stop, and restart a virtual device is to use the Virtual Machines Management Console.",
      "pos": [
        19798,
        19917
      ]
    },
    {
      "content": "When you look at the Management Console, the virtual device status is <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept> because it is started by default after it is created.",
      "pos": [
        19919,
        20054
      ]
    },
    {
      "content": "You can stop and restart a virtual machine at any time.",
      "pos": [
        20055,
        20110
      ]
    },
    {
      "content": "To stop a virtual device, click its name, and then click <bpt id=\"p1\">**</bpt>Shutdown<ept id=\"p1\">**</ept>.",
      "pos": [
        20112,
        20182
      ]
    },
    {
      "content": "While the virtual device is shutting down, its status is <bpt id=\"p1\">**</bpt>Stopping<ept id=\"p1\">**</ept>.",
      "pos": [
        20183,
        20253
      ]
    },
    {
      "content": "After the virtual device is stopped, its status is <bpt id=\"p1\">**</bpt>Stopped<ept id=\"p1\">**</ept>.",
      "pos": [
        20254,
        20317
      ]
    },
    {
      "content": "When a virtual device is running and you want to restart it, click its name, and then click <bpt id=\"p1\">**</bpt>Restart<ept id=\"p1\">**</ept>.",
      "pos": [
        20319,
        20423
      ]
    },
    {
      "content": "While the virtual device is restarting, its status is <bpt id=\"p1\">**</bpt>Restarting<ept id=\"p1\">**</ept>.",
      "pos": [
        20424,
        20493
      ]
    },
    {
      "content": "When the virtual device is ready for you to use, its status is <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept>.",
      "pos": [
        20494,
        20569
      ]
    },
    {
      "content": "You can also use the following Windows PowerShell cmdlets to start, stop, and restart the virtual device.",
      "pos": [
        20571,
        20676
      ]
    },
    {
      "content": "An example follows each cmdlet.",
      "pos": [
        20677,
        20708
      ]
    },
    {
      "content": "Reset to factory defaults",
      "pos": [
        21014,
        21039
      ]
    },
    {
      "content": "If you decide that you just want to start over with your virtual device, simply deactivate and delete it and then create a new one.",
      "pos": [
        21041,
        21172
      ]
    },
    {
      "content": "Just like when your physical device is reset, your new virtual device will not have any updates installed; therefore, make sure to check for updates before using it.",
      "pos": [
        21173,
        21338
      ]
    },
    {
      "content": "Failover to the virtual device",
      "pos": [
        21344,
        21374
      ]
    },
    {
      "content": "Disaster recovery (DR) is one of the key scenarios that the StorSimple virtual device was designed for.",
      "pos": [
        21376,
        21479
      ]
    },
    {
      "content": "In this scenario, the physical StorSimple device or entire datacenter might not be available.",
      "pos": [
        21480,
        21573
      ]
    },
    {
      "content": "Fortunately, you can use a virtual device to restore operations in an alternate location.",
      "pos": [
        21574,
        21663
      ]
    },
    {
      "content": "During DR, the volume containers from the source device change ownership and are transferred to the virtual device.",
      "pos": [
        21664,
        21779
      ]
    },
    {
      "content": "The prerequisites for DR are that the virtual device has been created and configured, all the volumes within the volume container have been taken offline, and the volume container has an associated cloud snapshot.",
      "pos": [
        21780,
        21993
      ]
    },
    {
      "content": "To restore your physical device to the StorSimple virtual device",
      "pos": [
        21999,
        22063
      ]
    },
    {
      "content": "Verify that the volume container you want to fail over has associated cloud snapshots.",
      "pos": [
        22068,
        22154
      ]
    },
    {
      "pos": [
        22158,
        22229
      ],
      "content": "Open the <bpt id=\"p1\">**</bpt>Device<ept id=\"p1\">**</ept> page, and then click the <bpt id=\"p2\">**</bpt>Volume Containers<ept id=\"p2\">**</ept> tab."
    },
    {
      "content": "Select a volume container that you would like to fail over to the virtual device.",
      "pos": [
        22233,
        22314
      ]
    },
    {
      "content": "Click the volume container to display the list of volumes within the container.",
      "pos": [
        22315,
        22394
      ]
    },
    {
      "content": "Select a volume and click <bpt id=\"p1\">**</bpt>Take Offline<ept id=\"p1\">**</ept> to take the volume offline.",
      "pos": [
        22395,
        22465
      ]
    },
    {
      "content": "Repeat this process for all the volumes in the volume container.",
      "pos": [
        22466,
        22530
      ]
    },
    {
      "content": "Repeat the previous step for all the volume containers you want to fail over to the virtual device.",
      "pos": [
        22534,
        22633
      ]
    },
    {
      "pos": [
        22637,
        22774
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Device<ept id=\"p1\">**</ept> page, select the device that you need to fail over, and then click <bpt id=\"p2\">**</bpt>Failover<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>Device Failover<ept id=\"p3\">**</ept> wizard."
    },
    {
      "content": "In <bpt id=\"p1\">**</bpt>Choose volume container to failover<ept id=\"p1\">**</ept>, select the volume containers you would like to fail over.",
      "pos": [
        22778,
        22879
      ]
    },
    {
      "content": "To be displayed in this list, the volume container must contain a cloud snapshot and be offline.",
      "pos": [
        22880,
        22976
      ]
    },
    {
      "content": "If a volume container that you expected to see is not present, cancel the wizard and verify that it is offline.",
      "pos": [
        22977,
        23088
      ]
    },
    {
      "content": "On the next page, in <bpt id=\"p1\">**</bpt>Choose a target device for the volumes<ept id=\"p1\">**</ept> in the selected containers, select the virtual device from the drop-down list of available devices.",
      "pos": [
        23092,
        23255
      ]
    },
    {
      "content": "Only the devices that have the available capacity are displayed on the list.",
      "pos": [
        23256,
        23332
      ]
    },
    {
      "content": "Review all the failover settings on the <bpt id=\"p1\">**</bpt>Confirm failover<ept id=\"p1\">**</ept> page.",
      "pos": [
        23336,
        23402
      ]
    },
    {
      "content": "If they are correct, click the check icon.",
      "pos": [
        23403,
        23445
      ]
    },
    {
      "content": "The failover process will begin.",
      "pos": [
        23447,
        23479
      ]
    },
    {
      "content": "When the failover is finished, go to the Devices page and select the virtual device that was used as the target for the failover process.",
      "pos": [
        23480,
        23617
      ]
    },
    {
      "content": "Go to the Volume Containers page.",
      "pos": [
        23618,
        23651
      ]
    },
    {
      "content": "All the volume containers, along with the volumes from the old device should appear.",
      "pos": [
        23652,
        23736
      ]
    },
    {
      "pos": [
        23739,
        23815
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> The amount of storage supported on the virtual device is 30 TB."
    },
    {
      "content": "Shut down or delete the virtual device",
      "pos": [
        23820,
        23858
      ]
    },
    {
      "content": "If you previously configured and used a StorSimple virtual device but now want to stop accruing compute charges for its use, you can shut down the virtual device.",
      "pos": [
        23860,
        24022
      ]
    },
    {
      "content": "Shutting down the virtual device doesn’t delete its operating system or data disks in storage.",
      "pos": [
        24023,
        24117
      ]
    },
    {
      "content": "It does stop charges accruing on your subscription, but storage charges for the OS and data disks will continue.",
      "pos": [
        24118,
        24230
      ]
    },
    {
      "content": "If you delete or shut down the virtual device, it will appear as <bpt id=\"p1\">**</bpt>Offline<ept id=\"p1\">**</ept> on the Devices page of the StorSimple Manager service.",
      "pos": [
        24232,
        24363
      ]
    },
    {
      "content": "You can choose to deactivate it or delete it as a device if you also wish to delete the backups created by the virtual device.",
      "pos": [
        24364,
        24490
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Deactivate a device<ept id=\"p1\">](storsimple-deactivate-and-delete-device.md#deactivate-a-device)</ept>.",
      "pos": [
        24491,
        24603
      ]
    },
    {
      "content": "To shut down the StorSimple virtual device",
      "pos": [
        24609,
        24651
      ]
    },
    {
      "content": "Sign in to the Azure portal.",
      "pos": [
        24656,
        24684
      ]
    },
    {
      "pos": [
        24689,
        24752
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Virtual Machines<ept id=\"p1\">**</ept>, and then select the virtual device."
    },
    {
      "pos": [
        24757,
        24776
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Shutdown<ept id=\"p1\">**</ept>."
    },
    {
      "content": "To delete the StorSimple virtual device",
      "pos": [
        24782,
        24821
      ]
    },
    {
      "content": "Sign in to the Azure portal.",
      "pos": [
        24826,
        24854
      ]
    },
    {
      "pos": [
        24858,
        24921
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Virtual Machines<ept id=\"p1\">**</ept>, and then select the virtual device."
    },
    {
      "pos": [
        24925,
        24993
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Delete<ept id=\"p1\">**</ept> and choose to delete all the virtual machine disks."
    },
    {
      "content": "Next steps",
      "pos": [
        24999,
        25009
      ]
    },
    {
      "pos": [
        25011,
        25261
      ],
      "content": "To administer your virtual device, refer to the detailed list of workflows in <bpt id=\"p1\">[</bpt>Administer StorSimple device using StorSimple Manager service<ept id=\"p1\">](storsimple-manager-service-administration.md#administer-storsimple-device-using-storsimple-manager-service)</ept>."
    }
  ],
  "content": "<properties\n   pageTitle=\"StorSimple virtual device in Azure | Microsoft Azure\"\n   description=\"Learn how to create, deploy, and manage a StorSimple virtual device in a Microsoft Azure virtual network. (Applies to StorSimple version .3 and earlier.)\"\n   services=\"storsimple\"\n   documentationCenter=\"\"\n   authors=\"alkohli\"\n   manager=\"carolz\"\n   editor=\"\" />\n<tags\n   ms.service=\"storsimple\"\n   ms.devlang=\"NA\"\n   ms.topic=\"hero-article\"\n   ms.tgt_pltfrm=\"NA\"\n   ms.workload=\"NA\"\n   ms.date=\"09/02/2015\"\n   ms.author=\"alkohli\" />\n\n# Deploy and manage a StorSimple virtual device in Azure\n\n[AZURE.INCLUDE [storsimple-version-selector-sva](../../includes/storsimple-version-selector-sva.md)]\n\n## Overview\n\nThe StorSimple virtual device is an additional capability that comes with your Microsoft Azure StorSimple solution. The StorSimple virtual device runs on a virtual machine in a Microsoft Azure virtual network, and you can use it to back up and clone data from your hosts. The following topics in this article will help you learn about, configure, and use the StorSimple virtual device.\n\n- How the virtual device differs from the physical device.\n\n- Security considerations for using a virtual device.\n\n- Prerequisites for the virtual device.\n\n- Create and configure the virtual device.\n\n- Work with the virtual device.\n\n- Failover to the virtual device.\n\n- Shut down or delete the virtual device.\n\n\n## How the virtual device differs from the physical device\n\nThe StorSimple virtual device is a software-only version of StorSimple that runs on a single node in a Microsoft Azure virtual machine. The virtual device supports disaster recovery scenarios in which your physical device is not available, and is appropriate for use in cloud dev and test scenarios.\n\nThe following are some key differences between the StorSimple virtual device and the physical StorSimple device:\n\n- The virtual device has only one network interface: DATA 0. The physical device has six network interfaces: DATA 0 through DATA 5.\n- The virtual device is registered during the configuration step instead of as a separate task.\n- The service data encryption key cannot be regenerated from the virtual device. During key rollover, you will regenerate the key on the physical device and then update the virtual device with the new key.\n- If updates need to be applied to the virtual device, it will experience some down time, whereas the physical device will not.\n\n## Security considerations for using a virtual device\n\nKeep the following security considerations in mind when you use the StorSimple virtual device:\n\n- The virtual device is secured through your Microsoft Azure subscription. This means that if you are using the virtual device and your Azure subscription is compromised, the data stored on your virtual device is also susceptible.\n\n- The public key of the certificate used to encrypt data stored in Azure StorSimple is securely made available to the Azure portal, and the private key is retained with the StorSimple device. On the StorSimple virtual device, both the public and private keys are stored in Azure.\n\n- The virtual device is hosted in the Microsoft Azure datacenter.\n\n\n## Prerequisites for the virtual device\n\nThe following sections will help you prepare to use the StorSimple virtual device.\n\n### Azure requirements\n\nBefore you provision the virtual device, you need to make the following preparations in your Azure environment:\n\n- For the virtual device, [configure a virtual network on Azure](virtual-networks-create-vnet.md).\n- It is advisable to use the default DNS server provided by Azure instead of specifying your own DNS server name. If your DNS server name is not valid, the creation of the virtual device will fail.\n- Point-to-site and site-to-site are optional, but not required. If you wish, you can configure these options for more advanced scenarios.\n\n>[AZURE.IMPORTANT] **Make sure that the virtual network is in the same region as the cloud storage accounts that you are going to be using with the virtual device.**\n\n- You can create [Azure Virtual Machines](../virtual-machines/virtual-machines-about.md) (host servers) in the virtual network that can use the volumes exposed by the virtual device. These servers must meet the following requirements:\n    - Be Windows or Linux VMs with iSCSI Initiator software installed.\n    - Be running in the same virtual network as the virtual device.\n    - Be able to connect to the iSCSI target of the virtual device through the internal IP address of the virtual device.\n\n- Make sure you have configured support for iSCSI and cloud traffic on the same virtual network.\n\n### StorSimple requirements\n\nMake the following updates to your Azure StorSimple service before you create a virtual device:\n\n\n- Add [access control records](storsimple-manage-acrs.md) for the VMs that are going to be host servers for your virtual device.\n\n- Make sure that you have a [storage account](storsimple-manage-storage-accounts.md#add-a-storage-account) in the same region as the virtual device. Storage accounts in different regions may result in poor performance.\n\n- Make sure that you use a different storage account for virtual device creation from the one used for your data. Using the same storage account may result in poor performance.\n\nMake sure that you have the following information before you begin:\n\n- You have your Azure portal account with access credentials.\n\n- You have your Azure storage account access credentials.\n\n- You have a copy of the service data encryption key from your physical device.\n\n- You have a copy of the cloud service encryption key for each volume container.\n\n\n## Create and configure the virtual device\n\nBefore performing these procedures, make sure that you have met the [Prerequisites for the virtual device](#prerequisites-for-the-virtual-device).\n\nAfter completing these procedures, you are ready to [Work with the virtual device](#work-with-the-storsimple-virtual-device).\n\n### Create the virtual device\n\nAfter you have created a virtual network, configured a StorSimple Manager service, and registered your physical StorSimple device with the service, you can use the following steps to create a StorSimple virtual device.\n\nPerform the following steps to create the StorSimple virtual device.\n\n\n\n1.  In the Azure portal, go to the **StorSimple Manager** service.\n\n2. Go to the **Devices** page.\n\n3. In the **Create Virtual Device** dialog box, specify the following details.\n\n    ![StorSimple create virtual device](./media/storsimple-virtual-device/StorSimple_CreateVirtualDevice1.png)\n\n    1. **Name** – A unique name for your virtual device.\n\n    2. **Virtual Network** – The name of the virtual network that you want to use with this virtual device.\n\n    3. **Subnet** – The subnet on the virtual network for use with the virtual device.\n\n    4. **Storage Account for Virtual Device Creation** – The storage account that will be used to hold the image of the virtual device during provisioning. This storage account should be in the same region as the virtual device and virtual network. It should not be used for data storage by either the physical device or the virtual device. By default, a new storage account will be created for this purpose. However, if you know that you already have a storage account that is suitable for this use, you can select it from the list.\n\n4. Click the check mark to indicate that you understand that the data stored on the virtual device will be hosted in a Microsoft datacenter. A virtual device will now be created. It may take up to 45 minutes to 1 hour to create a virtual device.\n    ![StorSimple virtual device creating stage](./media/storsimple-virtual-device/StorSimple_VirtualDeviceCreating1M.png)\n\nWhen you use only a physical device, your encryption key is kept with your device; therefore, Microsoft cannot decrypt it. When you use a virtual device, both the encryption key and the decryption key are stored in Microsoft Azure. For more information, see [Security considerations for using a virtual device](#security-considerations-for-using-a-virtual-device).\n\n### Configure and register the virtual device\n\nBefore starting this procedure, make sure that you have a copy of the service data encryption key. The service data encryption key was created when you configured your first StorSimple physical device and you were instructed to save it in a secure location. If you do not have a copy of the service data encryption key, you must [contact Microsoft Support](storsimple-contact-microsoft-support.md) for assistance.\n\nPerform the following steps to configure and register your StorSimple virtual device.\n\n\n1. Select the **StorSimple virtual device** you just created on the **Devices** page.\n\n2. Click **Complete Device Configuration**. This starts the Configure device wizard.\n\n    ![StorSimple complete device setup in Devices page](./media/storsimple-virtual-device/StorSimple_CompleteDeviceSetupSVA1M.png)\n\n1. In the Configure device wizard:\n\n    1. Enter the **Service Data Encryption Key** in the space provided.\n    2. Enter the **Snapshot Manager password**. The **Snapshot Manager password** must be 14 or 15 characters in length and must contain a combination of lowercase, uppercase, numeric, and special characters.\n    3. Enter the **device administrator password**. The **device administrator password** must be between 8 to 15 characters and must contain a combination of lowercase, uppercase, numeric, and special characters.\n    4. Click the check icon to finish the initial configuration and registration of the virtual device.\n\n        ![StorSimple virtual device settings](./media/storsimple-virtual-device/StorSimple_VirtualDeviceSettings1.png)\n\nAfter the configuration and registration is complete, the device will come online. It may take several minutes for the device to come online.\n\n![StorSimple virtual device online stage](./media/storsimple-virtual-device/StorSimple_VirtualDeviceOnline1M.png)\n\n### Modify the device configuration settings\n\nThe following section describes the device configuration settings that you may want to configure for the StorSimple virtual device. These settings include those of CHAP, StorSimple Snapshot Manager password, or device administrator password.\n\n#### Configure the CHAP initiator (optional)\n\nThis parameter contains the credentials that your virtual device (target) expects from the initiators (servers) that are attempting to access the volumes. The initiators will provide a CHAP user name and a CHAP password to identify themselves to your device during this authentication.\n\n#### Configure the CHAP target (optional)\n\nThis parameter contains the credentials that your virtual device uses when a CHAP-enabled initiator requests mutual or bi-directional authentication. Your virtual device will use a Reverse CHAP user name and Reverse CHAP password to identify itself to the initiator during this authentication process. Note that CHAP target settings are global settings. When these are applied, all the volumes connected to the storage virtual device will use CHAP authentication.\n\n#### Configure the StorSimple Snapshot Manager (optional)\n\nStorSimple Snapshot Manager software resides on your Windows host and allows administrators to manage backups of your StorSimple device in the form of local and cloud snapshots.\n\n>[AZURE.NOTE] For the virtual device, your Windows host is an Azure VM.\n\nWhen configuring a device in the StorSimple Snapshot Manager, you will be prompted to provide the StorSimple device IP address and password to authenticate your storage device. This password is first configured through the Windows PowerShell interface.\n\nPerform the following steps to change StorSimple Snapshot Manager when using it with your StorSimple virtual device.\n\n1. On your virtual device, go to **Devices > Configure**.\n\n- Scroll down to the **Snapshot Manager** section. Enter a password that is 14 or 15 characters. Make sure that the password contains a combination of uppercase, lowercase, numeric, and special characters.\n\n- Confirm the password.\n\n- Click **Save** at the bottom of the page.\n\nThe StorSimple Snapshot Manager password is now updated and can be used when you authenticate your Windows hosts.\n\n#### Configure the device administrator password\n\nWhen you use the Windows PowerShell interface to access the virtual device, you will be required to enter a device administrator password. For the security of your data, you are required to change this password before the virtual device can be used.\n\nPerform the following steps to change the device administrator password for your StorSimple virtual device.\n\n1. On your virtual device, go to **Devices > Configure**.\n\n1. Scroll down to the **Device Administrator password** section. Provide an administrator password that contains from 8 to 15 characters. The password must be a combination of uppercase, lowercase, numeric, and special characters.\n\n1. Confirm the password.\n\n1. Click **Save** at the bottom of the page.\n\nThe device administrator password should now be updated. You will use this modified password to access the the Windows PowerShell interface on your virtual device.\n\n#### Configure remote management (optional)\n\nRemote access to your virtual device via the Windows PowerShell interface is not enabled by default. You need to enable remote management on the virtual device first, and then enable it on the client that will be used to access your virtual device.\n\nYou can choose to connect over HTTP or HTTPS. For security reasons, we recommend that you use HTTPS with a self-signed certificate to connect to your virtual device.\n\nPerform the following steps to configure remote management for your StorSimple virtual device.\n\n\n1. On your virtual device, go to **Devices > Configure**.\n\n2. Scroll down to the **Remote Management** section.\n\n3. Set **Enable Remote Management** to **Yes**.\n\n4. You can now choose to connect using HTTP. The default is to connect over HTTPS. Connecting over HTTP is acceptable only on trusted networks.\n\n5. Click **Download Remote Management Certificate** to download a remote management certificate. You will specify a location in which to save this file. This certificate then needs to be installed on the client or host machine that you will use to connect to the virtual device.\n\n6. Click **Save** at the bottom of the page.\n\n\n## Work with the StorSimple virtual device\n\nNow that you have created and configured the StorSimple virtual device, you are ready to start working with it. You can work with volume containers, volumes, and backup policies on a virtual device just as you would on a physical StorSimple device; the only difference is that you need to make sure that you select the virtual device from your device list. Refer to the following sections for instructions on associated tasks:\n\n\n- [Volume containers](storsimple-manage-volume-containers.md)\n\n- [Volumes](storsimple-manage-volumes.md)\n\n- [Backup policies](storsimple-manage-backup-policies.md)\n\nThe following sections discuss some of the differences you will encounter when working with the virtual device.\n\n### Maintain a StorSimple virtual device\n\nBecause it is a software-only device, maintenance for the virtual device is minimal when compared to maintenance for the physical device. You have the following options:\n\n- **Software updates** – You can view the date that the software was last updated, together with any update status messages. You can use the Scan updates button at the bottom of the page to perform a manual scan if you want to check for new updates.\n- **Support package** – You can create and upload a support package to help Microsoft Support troubleshoot issues with your virtual device.\n\n### Storage accounts for a virtual device\n\nStorage accounts are created for use by the StorSimple Manager service, by the virtual device, and by the physical device. When you create your storage accounts, we recommend that you use a region identifier in the friendly name to help ensure that the region is consistent throughout all of the system components. For a virtual device, it is important that all of the components be in the same region to prevent performance issues.\n\n### Deactivate a StorSimple virtual device\n\nDeactivating a virtual device deletes the VM and the resources created when it was provisioned. After the virtual device is deactivated, it cannot be restored to its previous state. Before you deactivate the virtual device, make sure to stop or delete clients and hosts that depend on it.\n\nDeactivating a virtual device results in the following actions:\n\n- The virtual device is removed.\n\n- The OSDisk and Data Disks created for the virtual device are removed.\n\n- The hosted service and virtual network created during provisioning are retained. If you are not using them, you should delete them manually.\n\n- Cloud snapshots created for the virtual device are retained.\n\nAs soon as the device is shown as deactivated on the StorSimple Manager service page, you can delete the virtual device from the StorSimple Manager service device list.\n\n### Remotely access a StorSimple virtual device\n\nAfter you have enabled it on the StorSimple device configuration page, you can use Windows PowerShell remoting to connect to the virtual device from another virtual machine inside the same virtual network; for example, you can connect from the host VM that you configured and used to connect iSCSI. In most deployments, you will have already opened a public endpoint to access your host VM that you can use for accessing the virtual device.\n\n>[AZURE.WARNING] For enhanced security, we strongly recommend that you use HTTPS when connecting to the endpoints and then delete the endpoints after you have completed your PowerShell remote session.\n\nYou should follow the procedures in [Connect remotely to your StorSimple device](storsimple-remote-connect.md) to set up remoting for your virtual device.\n\nHowever, if you want to connect directly to the virtual device from another computer outside the virtual network or outside the Microsoft Azure environment, you need to create additional endpoints as described in the following procedure.\n\nPerform the following steps to create a public endpoint on the virtual device.\n\n1. Sign in to the Azure portal.\n\n- Click **Virtual Machines**, and then select the virtual machine that is being used as your virtual device.\n\n- Click **Endpoints**. The Endpoints page lists all endpoints for the virtual machine.\n\n- Click **Add**. The Add Endpoint dialog box appears. Click the arrow to continue.\n\n- For the **Name**, type the following name for the endpoint: **WinRMHttps**.\n\n- For the **Protocol**, specify **TCP**.\n\n- For the **Public Port**, type the port numbers that you want to use for the connection.\n\n- For the **Private Port**, type **5986**.\n\n- Click the check mark to create the endpoint.\n\nAfter the endpoint is created, you can view its details to determine the Public Virtual IP (VIP) address. Record this address.\n\nWe recommend that you connect from another virtual machine inside the same virtual network because this practice minimizes the number of public endpoints on your virtual network. When you use this method, you simply connect to the virtual machine through a Remote Desktop session and then configure that virtual machine for use as you would any other Windows client on a local network. You do not need to append the public port number because the port will already be known.\n\n### Stop and restart\n\nUnlike the physical StorSimple device, there is no power on or power off button to push on a StorSimple virtual device. However, there may be occasions where you need to stop and restart the virtual device. For example, some updates might require that the VM be restarted to finish the update process. The easiest way for you to start, stop, and restart a virtual device is to use the Virtual Machines Management Console.\n\nWhen you look at the Management Console, the virtual device status is **Running** because it is started by default after it is created. You can stop and restart a virtual machine at any time.\n\nTo stop a virtual device, click its name, and then click **Shutdown**. While the virtual device is shutting down, its status is **Stopping**. After the virtual device is stopped, its status is **Stopped**.\n\nWhen a virtual device is running and you want to restart it, click its name, and then click **Restart**. While the virtual device is restarting, its status is **Restarting**. When the virtual device is ready for you to use, its status is **Running**.\n\nYou can also use the following Windows PowerShell cmdlets to start, stop, and restart the virtual device. An example follows each cmdlet.\n\n`Start-AzureVMC:\\PS>Start-AzureVM -ServiceName \"MyStorSimpleservice1\" -Name \"MyStorSimpleDevice\"`\n\n\n`Stop-AzureVMC:\\PS>Stop-AzureVM -ServiceName \"MyStorSimpleservice1\" -Name \"MyStorSimpleDevice\"`\n\n`Restart-AzureVMC:\\PS>Restart-AzureVM -ServiceName \"MyStorSimpleservice1\" -Name \"MyStorSimpleDevice\"`\n\n### Reset to factory defaults\n\nIf you decide that you just want to start over with your virtual device, simply deactivate and delete it and then create a new one. Just like when your physical device is reset, your new virtual device will not have any updates installed; therefore, make sure to check for updates before using it.\n\n\n## Failover to the virtual device\n\nDisaster recovery (DR) is one of the key scenarios that the StorSimple virtual device was designed for. In this scenario, the physical StorSimple device or entire datacenter might not be available. Fortunately, you can use a virtual device to restore operations in an alternate location. During DR, the volume containers from the source device change ownership and are transferred to the virtual device. The prerequisites for DR are that the virtual device has been created and configured, all the volumes within the volume container have been taken offline, and the volume container has an associated cloud snapshot.\n\n### To restore your physical device to the StorSimple virtual device\n\n1. Verify that the volume container you want to fail over has associated cloud snapshots.\n\n- Open the **Device** page, and then click the **Volume Containers** tab.\n\n- Select a volume container that you would like to fail over to the virtual device. Click the volume container to display the list of volumes within the container. Select a volume and click **Take Offline** to take the volume offline. Repeat this process for all the volumes in the volume container.\n\n- Repeat the previous step for all the volume containers you want to fail over to the virtual device.\n\n- On the **Device** page, select the device that you need to fail over, and then click **Failover** to open the **Device Failover** wizard.\n\n- In **Choose volume container to failover**, select the volume containers you would like to fail over. To be displayed in this list, the volume container must contain a cloud snapshot and be offline. If a volume container that you expected to see is not present, cancel the wizard and verify that it is offline.\n\n- On the next page, in **Choose a target device for the volumes** in the selected containers, select the virtual device from the drop-down list of available devices. Only the devices that have the available capacity are displayed on the list.\n\n- Review all the failover settings on the **Confirm failover** page. If they are correct, click the check icon.\n\nThe failover process will begin. When the failover is finished, go to the Devices page and select the virtual device that was used as the target for the failover process. Go to the Volume Containers page. All the volume containers, along with the volumes from the old device should appear.\n\n>[AZURE.NOTE] The amount of storage supported on the virtual device is 30 TB.\n\n## Shut down or delete the virtual device\n\nIf you previously configured and used a StorSimple virtual device but now want to stop accruing compute charges for its use, you can shut down the virtual device. Shutting down the virtual device doesn’t delete its operating system or data disks in storage. It does stop charges accruing on your subscription, but storage charges for the OS and data disks will continue.\n\nIf you delete or shut down the virtual device, it will appear as **Offline** on the Devices page of the StorSimple Manager service. You can choose to deactivate it or delete it as a device if you also wish to delete the backups created by the virtual device. For more information, see [Deactivate a device](storsimple-deactivate-and-delete-device.md#deactivate-a-device).\n\n### To shut down the StorSimple virtual device\n\n1. Sign in to the Azure portal.\n\n2. Click **Virtual Machines**, and then select the virtual device.\n\n3. Click **Shutdown**.\n\n### To delete the StorSimple virtual device\n\n1. Sign in to the Azure portal.\n\n- Click **Virtual Machines**, and then select the virtual device.\n\n- Click **Delete** and choose to delete all the virtual machine disks.\n\n\n## Next steps\n\nTo administer your virtual device, refer to the detailed list of workflows in [Administer StorSimple device using StorSimple Manager service](storsimple-manager-service-administration.md#administer-storsimple-device-using-storsimple-manager-service).\n"
}