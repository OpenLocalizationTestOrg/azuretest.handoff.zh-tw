{
  "nodes": [
    {
      "content": "Advanced Analytics Process and Technology in Action: using SQL Server | Microsoft Azure",
      "pos": [
        28,
        115
      ]
    },
    {
      "content": "Advanced Analytics Process and Technology in Action",
      "pos": [
        135,
        186
      ]
    },
    {
      "content": "Advanced Analytics Process and Technology in Action: using SQL Server",
      "pos": [
        574,
        643
      ]
    },
    {
      "content": "In this tutorial, you walkthrough building and deploying a model using a publicly available dataset -- the <bpt id=\"p1\">[</bpt>NYC Taxi Trips<ept id=\"p1\">](http://www.andresmh.com/nyctaxitrips/)</ept> dataset.",
      "pos": [
        645,
        816
      ]
    },
    {
      "content": "The procedure follows the Azure Advanced Analytics Process and Technology (ADAPT) guide.",
      "pos": [
        817,
        905
      ]
    },
    {
      "pos": [
        912,
        968
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"dataset\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>NYC Taxi Trips Dataset Description"
    },
    {
      "content": "The NYC Taxi Trip data is about 20GB of compressed CSV files (~48GB uncompressed), comprising more than 173 million individual trips and the fares paid for each trip.",
      "pos": [
        970,
        1136
      ]
    },
    {
      "content": "Each trip record includes the pickup and drop-off location and time, anonymized hack (driver's) license number and medallion (taxiâ€™s unique id) number.",
      "pos": [
        1137,
        1288
      ]
    },
    {
      "content": "The data covers all trips in the year 2013 and is provided in the following two datasets for each month:",
      "pos": [
        1289,
        1393
      ]
    },
    {
      "content": "The 'trip_data' CSV contains trip details, such as number of passengers, pickup and dropoff points, trip duration, and trip length.",
      "pos": [
        1398,
        1529
      ]
    },
    {
      "content": "Here are a few sample records:",
      "pos": [
        1530,
        1560
      ]
    },
    {
      "content": "The 'trip_fare' CSV contains details of the fare paid for each trip, such as payment type, fare amount, surcharge and taxes, tips and tolls, and the total amount paid.",
      "pos": [
        2656,
        2823
      ]
    },
    {
      "content": "Here are a few sample records:",
      "pos": [
        2824,
        2854
      ]
    },
    {
      "content": "The unique key to join trip\\_data and trip\\_fare is composed of the fields: medallion, hack\\_licence and pickup\\_datetime.",
      "pos": [
        3599,
        3721
      ]
    },
    {
      "pos": [
        3726,
        3776
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"mltasks\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Examples of Prediction Tasks"
    },
    {
      "pos": [
        3778,
        3857
      ],
      "content": "We will formulate three prediction problems based on the <bpt id=\"p1\">*</bpt>tip\\_amount<ept id=\"p1\">*</ept>, namely:"
    },
    {
      "pos": [
        3862,
        4053
      ],
      "content": "Binary classification: Predict whether or not a tip was paid for a trip, i.e. a <bpt id=\"p1\">*</bpt>tip\\_amount<ept id=\"p1\">*</ept> that is greater than $0 is a positive example, while a <bpt id=\"p2\">*</bpt>tip\\_amount<ept id=\"p2\">*</ept> of $0 is a negative example."
    },
    {
      "content": "Multiclass classification: To predict the range of tip paid for the trip.",
      "pos": [
        4058,
        4131
      ]
    },
    {
      "content": "We divide the <bpt id=\"p1\">*</bpt>tip\\_amount<ept id=\"p1\">*</ept> into five bins or classes:",
      "pos": [
        4132,
        4186
      ]
    },
    {
      "content": "Regression task: To predict the amount of tip paid for a trip.",
      "pos": [
        4433,
        4495
      ]
    },
    {
      "pos": [
        4503,
        4591
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"setup\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Setting Up the Azure data science environment for advanced analytics"
    },
    {
      "pos": [
        4593,
        4779
      ],
      "content": "As you can see from the <bpt id=\"p1\">[</bpt>Plan Your Environment<ept id=\"p1\">](machine-learning-data-science-plan-your-environment.md)</ept> guide, there are several options to work with the NYC Taxi Trips dataset in Azure:"
    },
    {
      "content": "Work with the data in Azure blobs then model in Azure Machine Learning",
      "pos": [
        4783,
        4853
      ]
    },
    {
      "content": "Load the data into a SQL Server database then model in Azure Machine Learning",
      "pos": [
        4856,
        4933
      ]
    },
    {
      "content": "In this tutorial we will demonstrate parallel bulk import of the data to a SQL Server, data exploration, feature engineering and down sampling using SQL Server Management Studio as well as using IPython Notebook.",
      "pos": [
        4935,
        5147
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>Sample scripts<ept id=\"p1\">](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/DataScienceScripts)</ept> and <bpt id=\"p2\">[</bpt>IPython notebooks<ept id=\"p2\">](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/iPythonNotebooks)</ept> are shared in GitHub.",
      "pos": [
        5148,
        5438
      ]
    },
    {
      "content": "A sample IPython notebook to work with the data in Azure blobs is also available in the same location.",
      "pos": [
        5439,
        5541
      ]
    },
    {
      "content": "To set up your Azure Data Science environment:",
      "pos": [
        5543,
        5589
      ]
    },
    {
      "content": "Create a storage account",
      "pos": [
        5595,
        5619
      ]
    },
    {
      "content": "Create an Azure ML workspace",
      "pos": [
        5664,
        5692
      ]
    },
    {
      "pos": [
        5736,
        5915
      ],
      "content": "<bpt id=\"p1\">[</bpt>Provision a Data Science Virtual Machine<ept id=\"p1\">](machine-learning-data-science-setup-sql-server-virtual-machine.md)</ept>, which will serve as a SQL Server as well an IPython Notebook server."
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> The sample scripts and IPython notebooks will be downloaded to your Data Science virtual machine during the setup process.",
      "pos": [
        5923,
        6058
      ]
    },
    {
      "content": "When the VM post-installation script completes, the samples will be in your VM's Documents library:",
      "pos": [
        6059,
        6158
      ]
    },
    {
      "pos": [
        6169,
        6238
      ],
      "content": "Sample Scripts: <ph id=\"ph1\">`C:\\Users\\&lt;user_name&gt;\\Documents\\Data Science Scripts`</ph>"
    },
    {
      "pos": [
        6249,
        6497
      ],
      "content": "Sample IPython Notebooks: `C:\\Users\\<user_name>\\Documents\\IPython Notebooks\\DataScienceSamples`  \nwhere `<user_name>` is your VM's Windows login name. We will refer to the sample folders as **Sample Scripts** and **Sample IPython Notebooks**.",
      "leadings": [
        "",
        "    > "
      ],
      "nodes": [
        {
          "content": "Sample IPython Notebooks: <ph id=\"ph1\">`C:\\Users\\&lt;user_name&gt;\\Documents\\IPython Notebooks\\DataScienceSamples`</ph>",
          "pos": [
            0,
            95
          ]
        },
        {
          "content": "where `<user_name>` is your VM's Windows login name. We will refer to the sample folders as **Sample Scripts** and **Sample IPython Notebooks**.",
          "pos": [
            98,
            242
          ],
          "nodes": [
            {
              "content": "where <ph id=\"ph1\">`&lt;user_name&gt;`</ph> is your VM's Windows login name.",
              "pos": [
                0,
                52
              ]
            },
            {
              "content": "We will refer to the sample folders as <bpt id=\"p1\">**</bpt>Sample Scripts<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Sample IPython Notebooks<ept id=\"p2\">**</ept>.",
              "pos": [
                53,
                144
              ]
            }
          ]
        }
      ]
    },
    {
      "pos": [
        6500,
        6772
      ],
      "content": "Based on the dataset size, data source location, and the selected Azure target environment, this scenario is similar to <bpt id=\"p1\">[</bpt>Scenario \\#5: Large dataset in a local files, target SQL Server in Azure VM<ept id=\"p1\">](../machine-learning-data-science-plan-sample-scenarios.md#largelocaltodb)</ept>."
    },
    {
      "pos": [
        6777,
        6830
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"getdata\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Get the Data from Public Source"
    },
    {
      "pos": [
        6832,
        7115
      ],
      "content": "To get the <bpt id=\"p1\">[</bpt>NYC Taxi Trips<ept id=\"p1\">](http://www.andresmh.com/nyctaxitrips/)</ept> dataset from its public location, you may use any of the methods described in <bpt id=\"p2\">[</bpt>Move Data to and from Azure Blob Storage<ept id=\"p2\">](machine-learning-data-science-move-azure-blob.md)</ept> to copy the data to your new virtual machine."
    },
    {
      "content": "To copy the data using AzCopy:",
      "pos": [
        7117,
        7147
      ]
    },
    {
      "content": "Log in to your virtual machine (VM)",
      "pos": [
        7152,
        7187
      ]
    },
    {
      "content": "Create a new directory in the VM's data disk (Note: Do not use the Temporary Disk which comes with the VM as a Data Disk).",
      "pos": [
        7192,
        7314
      ]
    },
    {
      "content": "In a Command Prompt window, run the following Azcopy command line, replacing &lt;path_to_data_folder&gt; with your data folder created in (2):",
      "pos": [
        7319,
        7455
      ]
    },
    {
      "content": "When the AzCopy completes, a total of 24 zipped CSV files (12 for trip\\_data and 12 for trip\\_fare) should be in the data folder.",
      "pos": [
        7617,
        7746
      ]
    },
    {
      "content": "Unzip the downloaded files.",
      "pos": [
        7751,
        7778
      ]
    },
    {
      "content": "Note the folder where the uncompressed files reside.",
      "pos": [
        7779,
        7831
      ]
    },
    {
      "content": "This folder will be referred to as the &lt;path\\_to\\_data\\_files\\&gt;.",
      "pos": [
        7832,
        7896
      ]
    },
    {
      "pos": [
        7901,
        7963
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"dbload\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Bulk Import Data into SQL Server Database"
    },
    {
      "content": "The performance of loading/transferring large amounts of data to an SQL database and subsequent queries can be improved by using <bpt id=\"p1\">_</bpt>Partitioned Tables and Views<ept id=\"p1\">_</ept>.",
      "pos": [
        7965,
        8125
      ]
    },
    {
      "content": "In this section, we will follow the instructions described in <bpt id=\"p1\">[</bpt>Parallel Bulk Data Import Using SQL Partition Tables<ept id=\"p1\">](machine-learning-data-science-parallel-load-sql-partitioned-tables.md)</ept> to create a new database and load the data into partitioned tables in parallel.",
      "pos": [
        8126,
        8393
      ]
    },
    {
      "pos": [
        8398,
        8465
      ],
      "content": "While logged in to your VM, start <bpt id=\"p1\">**</bpt>SQL Server Management Studio<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Connect using Windows Authentication.",
      "pos": [
        8470,
        8507
      ]
    },
    {
      "content": "SSMS Connect",
      "pos": [
        8515,
        8527
      ]
    },
    {
      "content": "If you have not yet changed the SQL Server authentication mode and created a new SQL login user, open the script file named <bpt id=\"p1\">**</bpt>change\\_auth.sql<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Sample Scripts<ept id=\"p2\">**</ept> folder.",
      "pos": [
        8537,
        8715
      ]
    },
    {
      "content": "Change the  default user name and password.",
      "pos": [
        8716,
        8759
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>!Execute<ept id=\"p1\">**</ept> in the toolbar to run the script.",
      "pos": [
        8760,
        8812
      ]
    },
    {
      "content": "Execute Script",
      "pos": [
        8820,
        8834
      ]
    },
    {
      "content": "Verify and/or change the SQL Server default database and log folders to ensure that newly created databases will be stored in a Data Disk.",
      "pos": [
        8844,
        8982
      ]
    },
    {
      "content": "The SQL Server VM image that is optimized for datawarehousing loads is pre-configured with data and log disks.",
      "pos": [
        8983,
        9093
      ]
    },
    {
      "content": "If your VM did not include a Data Disk and you added new virtual hard disks during the VM setup process, change the default folders as follows:",
      "pos": [
        9094,
        9237
      ]
    },
    {
      "pos": [
        9245,
        9320
      ],
      "content": "Right-click the SQL Server name in the left panel and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>."
    },
    {
      "content": "SQL Server Properties",
      "pos": [
        9332,
        9353
      ]
    },
    {
      "pos": [
        9366,
        9439
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Database Settings<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>Select a page<ept id=\"p2\">**</ept> list to the left."
    },
    {
      "content": "Verify and/or change the <bpt id=\"p1\">**</bpt>Database default locations<ept id=\"p1\">**</ept> to the <bpt id=\"p2\">**</bpt>Data Disk<ept id=\"p2\">**</ept> locations of your choice.",
      "pos": [
        9447,
        9549
      ]
    },
    {
      "content": "This is where new databases reside if created with the default location settings.",
      "pos": [
        9550,
        9631
      ]
    },
    {
      "content": "SQL Database Defaults",
      "pos": [
        9647,
        9668
      ]
    },
    {
      "content": "To create a new database and a set of filegroups to hold the partitioned tables, open the sample script <bpt id=\"p1\">**</bpt>create\\_db\\_default.sql<ept id=\"p1\">**</ept>.",
      "pos": [
        9680,
        9812
      ]
    },
    {
      "content": "The script will create a new database named <bpt id=\"p1\">**</bpt>TaxiNYC<ept id=\"p1\">**</ept> and 12 filegroups in the default data location.",
      "pos": [
        9813,
        9916
      ]
    },
    {
      "content": "Each filegroup will hold one month of trip\\_data and trip\\_fare data.",
      "pos": [
        9917,
        9986
      ]
    },
    {
      "content": "Modify the database name, if desired.",
      "pos": [
        9987,
        10024
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>!Execute<ept id=\"p1\">**</ept> to run the script.",
      "pos": [
        10025,
        10062
      ]
    },
    {
      "content": "Next, create two partition tables, one for the trip\\_data and another for the trip\\_fare.",
      "pos": [
        10067,
        10156
      ]
    },
    {
      "content": "Open the sample script <bpt id=\"p1\">**</bpt>create\\_partitioned\\_table.sql<ept id=\"p1\">**</ept>, which will:",
      "pos": [
        10157,
        10227
      ]
    },
    {
      "content": "Create a partition function to split the data by month.",
      "pos": [
        10235,
        10290
      ]
    },
    {
      "content": "Create a partition scheme to map each month's data to a different filegroup.",
      "pos": [
        10297,
        10373
      ]
    },
    {
      "pos": [
        10380,
        10537
      ],
      "content": "Create two partitioned tables mapped to the partition scheme: <bpt id=\"p1\">**</bpt>nyctaxi\\_trip<ept id=\"p1\">**</ept> will hold the trip\\_data and <bpt id=\"p2\">**</bpt>nyctaxi\\_fare<ept id=\"p2\">**</ept> will hold the trip\\_fare data."
    },
    {
      "pos": [
        10543,
        10614
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>!Execute<ept id=\"p1\">**</ept> to run the script and create the partitioned tables."
    },
    {
      "pos": [
        10619,
        10768
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Sample Scripts<ept id=\"p1\">**</ept> folder, there are two sample PowerShell scripts provided to demonstrate parallel bulk imports of data to SQL Server tables."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>bcp\\_parallel\\_generic.ps1<ept id=\"p1\">**</ept> is a generic script to parallel bulk import data into a table.",
      "pos": [
        10776,
        10869
      ]
    },
    {
      "content": "Modify this script to set the input and target variables as indicated in the comment lines in the script.",
      "pos": [
        10870,
        10975
      ]
    },
    {
      "pos": [
        10982,
        11130
      ],
      "content": "<bpt id=\"p1\">**</bpt>bcp\\_parallel\\_nyctaxi.ps1<ept id=\"p1\">**</ept> is a pre-configured version of the generic script and can be used to to load both tables for the NYC Taxi Trips data."
    },
    {
      "content": "Right-click the <bpt id=\"p1\">**</bpt>bcp\\_parallel\\_nyctaxi.ps1<ept id=\"p1\">**</ept> script name and click <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept> to open it in PowerShell.",
      "pos": [
        11137,
        11240
      ]
    },
    {
      "content": "Review the preset variables and modify according to your selected database name, input data folder, target log folder, and paths to the  sample format files <bpt id=\"p1\">**</bpt>nyctaxi_trip.xml<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>nyctaxi\\_fare.xml<ept id=\"p2\">**</ept> (provided in the <bpt id=\"p3\">**</bpt>Sample Scripts<ept id=\"p3\">**</ept> folder).",
      "pos": [
        11241,
        11489
      ]
    },
    {
      "content": "Bulk Import Data",
      "pos": [
        11498,
        11514
      ]
    },
    {
      "content": "You may also select the authentication mode, default is Windows Authentication.",
      "pos": [
        11525,
        11604
      ]
    },
    {
      "content": "Click the green arrow in the toolbar to run.",
      "pos": [
        11605,
        11649
      ]
    },
    {
      "content": "The script will launch 24 bulk import operations in parallel, 12 for each partitioned table.",
      "pos": [
        11650,
        11742
      ]
    },
    {
      "content": "You may monitor the data import progress by opening the SQL Server default data folder as set above.",
      "pos": [
        11743,
        11843
      ]
    },
    {
      "content": "The PowerShell script reports the starting and ending times.",
      "pos": [
        11848,
        11908
      ]
    },
    {
      "content": "When all bulk imports complete, the ending time is reported.",
      "pos": [
        11909,
        11969
      ]
    },
    {
      "content": "Check the target log folder to verify that the bulk imports were successful, i.e., no errors reported in the target log folder.",
      "pos": [
        11970,
        12097
      ]
    },
    {
      "content": "Your database is now ready for exploration, feature engineering, and other operations as desired.",
      "pos": [
        12103,
        12200
      ]
    },
    {
      "content": "Since the tables are partitioned according to the <bpt id=\"p1\">**</bpt>pickup\\_datetime<ept id=\"p1\">**</ept> field, queries which include <bpt id=\"p2\">**</bpt>pickup\\_datetime<ept id=\"p2\">**</ept> conditions in the <bpt id=\"p3\">**</bpt>WHERE<ept id=\"p3\">**</ept> clause will benefit from the partition scheme.",
      "pos": [
        12201,
        12396
      ]
    },
    {
      "content": "In <bpt id=\"p1\">**</bpt>SQL Server Management Studio<ept id=\"p1\">**</ept>, explore the provided sample script <bpt id=\"p2\">**</bpt>sample\\_queries.sql<ept id=\"p2\">**</ept>.",
      "pos": [
        12402,
        12498
      ]
    },
    {
      "content": "To run any of the sample queries, highlight the query lines then click <bpt id=\"p1\">**</bpt>!Execute<ept id=\"p1\">**</ept> in the toolbar.",
      "pos": [
        12499,
        12598
      ]
    },
    {
      "content": "The NYC Taxi Trips data is loaded in two separate tables.",
      "pos": [
        12604,
        12661
      ]
    },
    {
      "content": "To improve join operations, it is highly recommended to index the tables.",
      "pos": [
        12662,
        12735
      ]
    },
    {
      "content": "The sample script <bpt id=\"p1\">**</bpt>create\\_partitioned\\_index.sql<ept id=\"p1\">**</ept> creates partitioned indexes on the composite join key <bpt id=\"p2\">**</bpt>medallion, hack\\_license, and pickup\\_datetime<ept id=\"p2\">**</ept>.",
      "pos": [
        12736,
        12894
      ]
    },
    {
      "pos": [
        12899,
        12977
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"dbexplore\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Data Exploration and Feature Engineering in SQL Server"
    },
    {
      "content": "In this section, we will perform data exploration and feature generation by running SQL queries directly in the <bpt id=\"p1\">**</bpt>SQL Server Management Studio<ept id=\"p1\">**</ept> using the SQL Server database created earlier.",
      "pos": [
        12979,
        13170
      ]
    },
    {
      "content": "A sample script named <bpt id=\"p1\">**</bpt>sample\\_queries.sql<ept id=\"p1\">**</ept> is provided in the <bpt id=\"p2\">**</bpt>Sample Scripts<ept id=\"p2\">**</ept> folder.",
      "pos": [
        13171,
        13262
      ]
    },
    {
      "content": "Modify the script to change the database name, if it is different from the default: <bpt id=\"p1\">**</bpt>TaxiNYC<ept id=\"p1\">**</ept>.",
      "pos": [
        13263,
        13359
      ]
    },
    {
      "content": "In this exercise, we will:",
      "pos": [
        13361,
        13387
      ]
    },
    {
      "pos": [
        13391,
        13535
      ],
      "content": "Connect to <bpt id=\"p1\">**</bpt>SQL Server Management Studio<ept id=\"p1\">**</ept> using either Windows Authentication or using SQL Authentication and the SQL login name and password."
    },
    {
      "content": "Explore data distributions of a few fields in varying time windows.",
      "pos": [
        13538,
        13605
      ]
    },
    {
      "content": "Investigate data quality of the longitude and latitude fields.",
      "pos": [
        13608,
        13670
      ]
    },
    {
      "pos": [
        13673,
        13755
      ],
      "content": "Generate binary and multiclass classification labels based on the <bpt id=\"p1\">**</bpt>tip\\_amount<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Generate features and compute/compare trip distances.",
      "pos": [
        13758,
        13811
      ]
    },
    {
      "content": "Join the two tables and extract a random sample that will be used to build models.",
      "pos": [
        13814,
        13896
      ]
    },
    {
      "content": "When you are ready to proceed to Azure Machine Learning, you may either:",
      "pos": [
        13898,
        13970
      ]
    },
    {
      "content": "Save the final SQL query to extract and sample the data and copy-paste the query directly into a [Reader][reader] module in Azure Machine Learning, or",
      "pos": [
        13977,
        14127
      ]
    },
    {
      "content": "Persist the sampled and engineered data you plan to use for model building in a new database table and use the new table in the [Reader][reader] module in Azure Machine Learning.",
      "pos": [
        14132,
        14310
      ]
    },
    {
      "content": "In this section we will save the final query to extract and sample the data.",
      "pos": [
        14312,
        14388
      ]
    },
    {
      "content": "The second method is demonstrated in the <bpt id=\"p1\">[</bpt>Data Exploration and Feature Engineering in IPython Notebook<ept id=\"p1\">](#ipnb)</ept> section.",
      "pos": [
        14389,
        14508
      ]
    },
    {
      "content": "For a quick verification of the number of rows and columns in the tables populated earlier using parallel bulk import,",
      "pos": [
        14510,
        14628
      ]
    },
    {
      "content": "Exploration: Trip distribution by medallion",
      "pos": [
        14933,
        14976
      ]
    },
    {
      "content": "This example identifies the medallion (taxi numbers) with more than 100 trips within a given time period.",
      "pos": [
        14978,
        15083
      ]
    },
    {
      "content": "The query would benefit from the partitioned table access since it is conditioned by the partition scheme of <bpt id=\"p1\">**</bpt>pickup\\_datetime<ept id=\"p1\">**</ept>.",
      "pos": [
        15084,
        15214
      ]
    },
    {
      "content": "Querying the full dataset will also make use of the partitioned table and/or index scan.",
      "pos": [
        15215,
        15303
      ]
    },
    {
      "content": "Exploration: Trip distribution by medallion and hack_license",
      "pos": [
        15473,
        15533
      ]
    },
    {
      "content": "Data Quality Assessment: Verify records with incorrect longitude and/or latitude",
      "pos": [
        15731,
        15811
      ]
    },
    {
      "content": "This example investigates if any of the longitude and/or latitude fields either contain an invalid value (radian degrees should be between -90 and 90), or have (0, 0) coordinates.",
      "pos": [
        15813,
        15992
      ]
    },
    {
      "content": "Exploration: Tipped vs. Not Tipped Trips distribution",
      "pos": [
        16483,
        16536
      ]
    },
    {
      "content": "This example finds the number of trips that were tipped vs. not tipped in a given time period (or in the full dataset if covering the full year).",
      "pos": [
        16538,
        16683
      ]
    },
    {
      "content": "This distribution reflects the binary label distribution to be later used for binary classification modeling.",
      "pos": [
        16684,
        16793
      ]
    },
    {
      "content": "Exploration: Tip Class/Range Distribution",
      "pos": [
        17038,
        17079
      ]
    },
    {
      "content": "This example computes the distribution of tip ranges in a given time period (or in the full dataset if covering the full year).",
      "pos": [
        17081,
        17208
      ]
    },
    {
      "content": "This is the distribution of the label classes that will be used later for multiclass classification modeling.",
      "pos": [
        17209,
        17318
      ]
    },
    {
      "content": "Exploration: Compute and Compare Trip Distance",
      "pos": [
        17778,
        17824
      ]
    },
    {
      "content": "This example converts the pickup and drop-off longitude and latitude to SQL geography points, computes the trip distance using SQL geography points difference, and returns a random sample of the results for comparison.",
      "pos": [
        17826,
        18044
      ]
    },
    {
      "content": "The example limits the results to valid coordinates only using the data quality assessment query covered earlier.",
      "pos": [
        18045,
        18158
      ]
    },
    {
      "content": "Feature Engineering in SQL Queries",
      "pos": [
        18891,
        18925
      ]
    },
    {
      "content": "The label generation and geography conversion exploration queries can also be used to generate labels/features by removing the counting part.",
      "pos": [
        18927,
        19068
      ]
    },
    {
      "content": "Additional feature engineering SQL examples are provided in the <bpt id=\"p1\">[</bpt>Data Exploration and Feature Engineering in IPython Notebook<ept id=\"p1\">](#ipnb)</ept> section.",
      "pos": [
        19069,
        19211
      ]
    },
    {
      "content": "It is more efficient to run the feature generation queries on the full dataset or a large subset of it using SQL queries which run directly on the SQL Server database instance.",
      "pos": [
        19212,
        19388
      ]
    },
    {
      "content": "The queries may be executed in <bpt id=\"p1\">**</bpt>SQL Server Management Studio<ept id=\"p1\">**</ept>, IPython Notebook or any development tool/environment which can access the database locally or remotely.",
      "pos": [
        19389,
        19557
      ]
    },
    {
      "content": "Preparing Data for Model Building",
      "pos": [
        19564,
        19597
      ]
    },
    {
      "content": "The following query joins the <bpt id=\"p1\">**</bpt>nyctaxi\\_trip<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>nyctaxi\\_fare<ept id=\"p2\">**</ept> tables, generates a binary classification label <bpt id=\"p3\">**</bpt>tipped<ept id=\"p3\">**</ept>, a multi-class classification label <bpt id=\"p4\">**</bpt>tip\\_class<ept id=\"p4\">**</ept>, and extracts a 1% random sample from the full joined dataset.",
      "pos": [
        19599,
        19841
      ]
    },
    {
      "content": "This query can be copied then pasted directly in the <bpt id=\"p1\">[</bpt>Azure Machine Learning Studio<ept id=\"p1\">](https://studio.azureml.net)</ept> [Reader][reader] module for direct data ingestion from the SQL Server database instance in Azure.",
      "pos": [
        19842,
        20052
      ]
    },
    {
      "content": "The query excludes records with incorrect (0, 0) coordinates.",
      "pos": [
        20053,
        20114
      ]
    },
    {
      "pos": [
        20832,
        20911
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"ipnb\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Data Exploration and Feature Engineering in IPython Notebook"
    },
    {
      "content": "In this section, we will perform data exploration and feature generation",
      "pos": [
        20913,
        20985
      ]
    },
    {
      "content": "using both Python and SQL queries against the SQL Server database created earlier.",
      "pos": [
        20986,
        21068
      ]
    },
    {
      "content": "A sample IPython notebook named <bpt id=\"p1\">**</bpt>machine-Learning-data-science-process-sql-story.ipynb<ept id=\"p1\">**</ept> is provided in the <bpt id=\"p2\">**</bpt>Sample IPython Notebooks<ept id=\"p2\">**</ept> folder.",
      "pos": [
        21069,
        21214
      ]
    },
    {
      "content": "This notebook is also available on <bpt id=\"p1\">[</bpt>GitHub<ept id=\"p1\">](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/iPythonNotebooks)</ept>.",
      "pos": [
        21215,
        21372
      ]
    },
    {
      "content": "The recommended sequence when working with big data is the following:",
      "pos": [
        21374,
        21443
      ]
    },
    {
      "content": "Read in a small sample of the data into an in-memory data frame.",
      "pos": [
        21447,
        21511
      ]
    },
    {
      "content": "Perform some visualizations and explorations using the sampled data.",
      "pos": [
        21514,
        21582
      ]
    },
    {
      "content": "Experiment with feature engineering using the sampled data.",
      "pos": [
        21585,
        21644
      ]
    },
    {
      "content": "For larger data exploration, data manipulation and feature engineering, use Python to issue SQL Queries directly against the SQL Server database in the Azure VM.",
      "pos": [
        21648,
        21809
      ]
    },
    {
      "content": "Decide the sample size to use for Azure Machine Learning model building.",
      "pos": [
        21812,
        21884
      ]
    },
    {
      "content": "When ready to proceed to Azure Machine Learning, you may either:",
      "pos": [
        21886,
        21950
      ]
    },
    {
      "content": "Save the final SQL query to extract and sample the data and copy-paste the query directly into a [Reader][reader] module in Azure Machine Learning.",
      "pos": [
        21957,
        22104
      ]
    },
    {
      "content": "This method is demonstrated in the <bpt id=\"p1\">[</bpt>Building Models in Azure Machine Learning<ept id=\"p1\">](#mlmodel)</ept> section.",
      "pos": [
        22105,
        22202
      ]
    },
    {
      "content": "Persist the sampled and engineered data you plan to use for model building in a new database table, then use the new table in the [Reader][reader] module.",
      "pos": [
        22210,
        22364
      ]
    },
    {
      "content": "The following are a few data exploration, data visualization, and feature engineering examples.",
      "pos": [
        22366,
        22461
      ]
    },
    {
      "content": "For more examples, see the sample SQL IPython notebook in the <bpt id=\"p1\">**</bpt>Sample IPython Notebooks<ept id=\"p1\">**</ept> folder.",
      "pos": [
        22462,
        22560
      ]
    },
    {
      "content": "Initialize Database Credentials",
      "pos": [
        22567,
        22598
      ]
    },
    {
      "content": "Initialize your database connection settings in the following variables:",
      "pos": [
        22600,
        22672
      ]
    },
    {
      "content": "Create Database Connection",
      "pos": [
        22825,
        22851
      ]
    },
    {
      "content": "Report number of rows and columns in table nyctaxi_trip",
      "pos": [
        23029,
        23084
      ]
    },
    {
      "content": "Total number of rows = 173179759",
      "pos": [
        23504,
        23536
      ]
    },
    {
      "content": "Total number of columns = 14",
      "pos": [
        23541,
        23569
      ]
    },
    {
      "content": "Read-in a small data sample from the SQL Server Database",
      "pos": [
        23580,
        23636
      ]
    },
    {
      "content": "Time to read the sample table is 6.492000 seconds",
      "pos": [
        24267,
        24316
      ]
    },
    {
      "content": "Number of rows and columns retrieved = (84952, 21)",
      "pos": [
        24319,
        24369
      ]
    },
    {
      "content": "Descriptive Statistics",
      "pos": [
        24380,
        24402
      ]
    },
    {
      "content": "Now are ready to explore the sampled data.",
      "pos": [
        24404,
        24446
      ]
    },
    {
      "content": "We start with",
      "pos": [
        24447,
        24460
      ]
    },
    {
      "content": "looking at descriptive statistics for the <bpt id=\"p1\">**</bpt>trip\\_distance<ept id=\"p1\">**</ept> (or any other) field(s):",
      "pos": [
        24461,
        24546
      ]
    },
    {
      "content": "Visualization: Box Plot Example",
      "pos": [
        24590,
        24621
      ]
    },
    {
      "content": "Next we look at the box plot for the trip distance to visualize the quantiles",
      "pos": [
        24623,
        24700
      ]
    },
    {
      "content": "Plot #1",
      "pos": [
        24764,
        24771
      ]
    },
    {
      "content": "Visualization: Distribution Plot Example",
      "pos": [
        24782,
        24822
      ]
    },
    {
      "content": "Plot #2",
      "pos": [
        25036,
        25043
      ]
    },
    {
      "content": "Visualization: Bar and Line Plots",
      "pos": [
        25054,
        25087
      ]
    },
    {
      "content": "In this example, we bin the trip distance into five bins and visualize the binning results.",
      "pos": [
        25089,
        25180
      ]
    },
    {
      "content": "We can plot the above bin distribution in a bar or line plot as below",
      "pos": [
        25341,
        25410
      ]
    },
    {
      "content": "Plot #3",
      "pos": [
        25479,
        25486
      ]
    },
    {
      "content": "Plot #4",
      "pos": [
        25560,
        25567
      ]
    },
    {
      "content": "Visualization: Scatterplot Example",
      "pos": [
        25578,
        25612
      ]
    },
    {
      "content": "We show scatter plot between <bpt id=\"p1\">**</bpt>trip\\_time\\_in\\_secs<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>trip\\_distance<ept id=\"p2\">**</ept> to see if there",
      "pos": [
        25614,
        25706
      ]
    },
    {
      "content": "is any correlation",
      "pos": [
        25707,
        25725
      ]
    },
    {
      "content": "Plot #6",
      "pos": [
        25794,
        25801
      ]
    },
    {
      "pos": [
        25807,
        25893
      ],
      "content": "Similarly we can check the relationship between <bpt id=\"p1\">**</bpt>rate\\_code<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>trip\\_distance<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Plot #8",
      "pos": [
        25960,
        25967
      ]
    },
    {
      "content": "Sub-Sampling the Data in SQL",
      "pos": [
        25977,
        26005
      ]
    },
    {
      "pos": [
        26007,
        26357
      ],
      "content": "When preparing data for model building in <bpt id=\"p1\">[</bpt>Azure Machine Learning Studio<ept id=\"p1\">](https://studio.azureml.net)</ept>, you may either decide on the <bpt id=\"p2\">**</bpt>SQL query to use directly in the Reader module<ept id=\"p2\">**</ept> or persist the engineered and sampled data in a new table, which you could use in the [Reader][reader] module with a simple <bpt id=\"p3\">**</bpt>SELECT * FROM &lt;your\\_new\\_table\\_name&gt;<ept id=\"p3\">**</ept>."
    },
    {
      "content": "In this section we will create a new table to hold the sampled and engineered data.",
      "pos": [
        26359,
        26442
      ]
    },
    {
      "content": "An example of a direct SQL query for model building is provided in the <bpt id=\"p1\">[</bpt>Data Exploration and Feature Engineering in SQL Server<ept id=\"p1\">](#dbexplore)</ept> section.",
      "pos": [
        26443,
        26591
      ]
    },
    {
      "content": "Create a Sample Table and Populate with 1% of the Joined Tables.",
      "pos": [
        26598,
        26662
      ]
    },
    {
      "content": "Drop Table First if it Exists.",
      "pos": [
        26663,
        26693
      ]
    },
    {
      "pos": [
        26695,
        26875
      ],
      "content": "In this section, we join the tables <bpt id=\"p1\">**</bpt>nyctaxi\\_trip<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>nyctaxi\\_fare<ept id=\"p2\">**</ept>, extract a 1% random sample, and persist the sampled data in a new table name <bpt id=\"p3\">**</bpt>nyctaxi\\_one\\_percent<ept id=\"p3\">**</ept>:"
    },
    {
      "content": "Data Exploration using SQL Queries in IPython Notebook",
      "pos": [
        27647,
        27701
      ]
    },
    {
      "content": "In this section, we explore data distributions using the 1% sampled data which is persisted in the new table we created above.",
      "pos": [
        27703,
        27829
      ]
    },
    {
      "content": "Note that similar explorations can be performed using the original tables, optionally using <bpt id=\"p1\">**</bpt>TABLESAMPLE<ept id=\"p1\">**</ept> to limit the exploration sample or by limiting the results to a given time period using the <bpt id=\"p2\">**</bpt>pickup\\_datetime<ept id=\"p2\">**</ept> partitions, as illustrated in the <bpt id=\"p3\">[</bpt>Data Exploration and Feature Engineering in SQL Server<ept id=\"p3\">](#dbexplore)</ept> section.",
      "pos": [
        27830,
        28162
      ]
    },
    {
      "content": "Exploration: Daily distribution of trips",
      "pos": [
        28169,
        28209
      ]
    },
    {
      "content": "Exploration: Trip distribution per medallion",
      "pos": [
        28424,
        28468
      ]
    },
    {
      "content": "Feature Generation Using SQL Queries in IPython Notebook",
      "pos": [
        28633,
        28689
      ]
    },
    {
      "content": "In this section we will generate new labels and features directly using SQL queries, operating on the 1% sample table we created in the previous section.",
      "pos": [
        28691,
        28844
      ]
    },
    {
      "content": "Label Generation: Generate Class Labels",
      "pos": [
        28851,
        28890
      ]
    },
    {
      "content": "In the following example, we generate two sets of labels to use for modeling:",
      "pos": [
        28892,
        28969
      ]
    },
    {
      "pos": [
        28974,
        29040
      ],
      "content": "Binary Class Labels <bpt id=\"p1\">**</bpt>tipped<ept id=\"p1\">**</ept> (predicting if a tip will be given)"
    },
    {
      "pos": [
        29044,
        29110
      ],
      "content": "Multiclass Labels <bpt id=\"p1\">**</bpt>tip\\_class<ept id=\"p1\">**</ept> (predicting the tip bin or range)"
    },
    {
      "content": "Feature Engineering: Count Features for Categorical Columns",
      "pos": [
        29978,
        30037
      ]
    },
    {
      "content": "This example transforms a categorical field into a numeric field by replacing each category with the count of its occurrences in the data.",
      "pos": [
        30039,
        30177
      ]
    },
    {
      "content": "Feature Engineering: Bin features for Numerical Columns",
      "pos": [
        31110,
        31165
      ]
    },
    {
      "content": "This example transforms a continuous numeric field into preset category ranges, i.e., transform numeric field into a categorical field.",
      "pos": [
        31167,
        31302
      ]
    },
    {
      "content": "Feature Engineering: Extract Location Features from Decimal Latitude/Longitude",
      "pos": [
        32160,
        32238
      ]
    },
    {
      "content": "This example breaks down the decimal representation of a latitude and/or longitude field into multiple region fields of different granularity, such as, country, city, town, block, etc. Note that the new geo-fields are not mapped to actual locations.",
      "pos": [
        32240,
        32489
      ]
    },
    {
      "content": "For information on mapping geocode locations, see <bpt id=\"p1\">[</bpt>Bing Maps REST Services<ept id=\"p1\">](https://msdn.microsoft.com/library/ff701710.aspx)</ept>.",
      "pos": [
        32490,
        32616
      ]
    },
    {
      "content": "Verify the final form of the featurized table",
      "pos": [
        34478,
        34523
      ]
    },
    {
      "content": "We are now ready to proceed to model building and model deployment in <bpt id=\"p1\">[</bpt>Azure Machine Learning<ept id=\"p1\">](https://studio.azureml.net)</ept>.",
      "pos": [
        34614,
        34737
      ]
    },
    {
      "content": "The data is ready for any of the prediction problems identified earlier, namely:",
      "pos": [
        34738,
        34818
      ]
    },
    {
      "content": "Binary classification: To predict whether or not a tip was paid for a trip.",
      "pos": [
        34823,
        34898
      ]
    },
    {
      "content": "Multiclass classification: To predict the range of tip paid, according to the previously defined classes.",
      "pos": [
        34903,
        35008
      ]
    },
    {
      "content": "Regression task: To predict the amount of tip paid for a trip.",
      "pos": [
        35013,
        35075
      ]
    },
    {
      "pos": [
        35083,
        35146
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"mlmodel\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Building Models in Azure Machine Learning"
    },
    {
      "content": "To begin the modeling exercise, log in to your Azure Machine Learning workspace.",
      "pos": [
        35148,
        35228
      ]
    },
    {
      "content": "If you have not yet created a machine learning workspace, see <bpt id=\"p1\">[</bpt>Create an Azure ML workspace<ept id=\"p1\">](machine-learning-create-workspace.md)</ept>.",
      "pos": [
        35229,
        35360
      ]
    },
    {
      "pos": [
        35365,
        35492
      ],
      "content": "To get started with Azure Machine Learning, see <bpt id=\"p1\">[</bpt>What is Azure Machine Learning Studio?<ept id=\"p1\">](machine-learning-what-is-ml-studio.md)</ept>"
    },
    {
      "pos": [
        35497,
        35567
      ],
      "content": "Log in to <bpt id=\"p1\">[</bpt>Azure Machine Learning Studio<ept id=\"p1\">](https://studio.azureml.net)</ept>."
    },
    {
      "content": "The Studio Home page provides a wealth of information, videos, tutorials, links to the Modules Reference, and other resources.",
      "pos": [
        35572,
        35698
      ]
    },
    {
      "content": "Fore more information about Azure Machine Learning, consult the <bpt id=\"p1\">[</bpt>Azure Machine Learning Documentation Center<ept id=\"p1\">](http://azure.microsoft.com/documentation/services/machine-learning/)</ept>.",
      "pos": [
        35699,
        35878
      ]
    },
    {
      "content": "A typical training experiment consists of the following:",
      "pos": [
        35880,
        35936
      ]
    },
    {
      "pos": [
        35941,
        35970
      ],
      "content": "Create a <bpt id=\"p1\">**</bpt>+NEW<ept id=\"p1\">**</ept> experiment."
    },
    {
      "content": "Get the data to Azure ML.",
      "pos": [
        35974,
        35999
      ]
    },
    {
      "content": "Pre-process, transform and manipulate the data as needed.",
      "pos": [
        36003,
        36060
      ]
    },
    {
      "content": "Generate features as needed.",
      "pos": [
        36064,
        36092
      ]
    },
    {
      "content": "Split the data into training/validation/testing datasets(or have separate datasets for each).",
      "pos": [
        36096,
        36189
      ]
    },
    {
      "content": "Select one or more machine learning algorithms depending on the learning problem to solve.",
      "pos": [
        36193,
        36283
      ]
    },
    {
      "content": "E.g., binary classification, multiclass classification, regression.",
      "pos": [
        36284,
        36351
      ]
    },
    {
      "content": "Train one or more models using the training dataset.",
      "pos": [
        36355,
        36407
      ]
    },
    {
      "content": "Score the validation dataset using the trained model(s).",
      "pos": [
        36411,
        36467
      ]
    },
    {
      "content": "Evaluate the model(s) to compute the relevant metrics for the learning problem.",
      "pos": [
        36471,
        36550
      ]
    },
    {
      "content": "Fine tune the model(s) and select the best model to deploy.",
      "pos": [
        36555,
        36614
      ]
    },
    {
      "content": "In this exercise, we have already explored and engineered the data in SQL Server, and decided on the sample size to ingest in Azure ML.",
      "pos": [
        36616,
        36751
      ]
    },
    {
      "content": "To build one or more of the prediction models we decided:",
      "pos": [
        36752,
        36809
      ]
    },
    {
      "content": "Get the data to Azure ML using the [Reader][reader] module, available in the <bpt id=\"p1\">**</bpt>Data Input and Output<ept id=\"p1\">**</ept> section.",
      "pos": [
        36814,
        36925
      ]
    },
    {
      "content": "For more information, see the [Reader][reader] module reference page.",
      "pos": [
        36926,
        36995
      ]
    },
    {
      "content": "Azure ML Reader",
      "pos": [
        37003,
        37018
      ]
    },
    {
      "pos": [
        37028,
        37109
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Azure SQL Database<ept id=\"p1\">**</ept> as the <bpt id=\"p2\">**</bpt>Data source<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept> panel."
    },
    {
      "content": "Enter the database DNS name in the <bpt id=\"p1\">**</bpt>Database server name<ept id=\"p1\">**</ept> field.",
      "pos": [
        37114,
        37180
      ]
    },
    {
      "content": "Format: <ph id=\"ph1\">`tcp:&lt;your_virtual_machine_DNS_name&gt;,1433`</ph>",
      "pos": [
        37181,
        37231
      ]
    },
    {
      "pos": [
        37236,
        37291
      ],
      "content": "Enter the <bpt id=\"p1\">**</bpt>Database name<ept id=\"p1\">**</ept> in the corresponding field."
    },
    {
      "pos": [
        37296,
        37417
      ],
      "content": "Enter the <bpt id=\"p1\">**</bpt>SQL user name<ept id=\"p1\">**</ept> in the **Server user aqccount name, and the password in the <bpt id=\"p2\">**</bpt>Server user account password<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        37422,
        37469
      ],
      "content": "Check <bpt id=\"p1\">**</bpt>Accept any server certificate<ept id=\"p1\">**</ept> option."
    },
    {
      "pos": [
        37474,
        37681
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Database query<ept id=\"p1\">**</ept> edit text area, paste the query which extracts the necessary database fields (including any computed fields such as the labels) and down samples the data to the desired sample size."
    },
    {
      "content": "An example of a binary classification experiment reading data directly from the SQL Server database is in the figure below.",
      "pos": [
        37683,
        37806
      ]
    },
    {
      "content": "Similar experiments can be constructed for multiclass classification and regression problems.",
      "pos": [
        37807,
        37900
      ]
    },
    {
      "content": "Azure ML Train",
      "pos": [
        37904,
        37918
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.IMPORTANT]</ph> In the modeling data extraction and sampling query examples provided in previous sections, <bpt id=\"p1\">**</bpt>all labels for the three modeling exercises are included in the query<ept id=\"p1\">**</ept>.",
      "pos": [
        37927,
        38110
      ]
    },
    {
      "content": "An important (required) step in each of the modeling exercises is to <bpt id=\"p1\">**</bpt>exclude<ept id=\"p1\">**</ept> the unnecessary labels for the other two problems, and any other <bpt id=\"p2\">**</bpt>target leaks<ept id=\"p2\">**</ept>.",
      "pos": [
        38111,
        38274
      ]
    },
    {
      "content": "For e.g., when using binary classification, use the label <bpt id=\"p1\">**</bpt>tipped<ept id=\"p1\">**</ept> and exclude the fields <bpt id=\"p2\">**</bpt>tip\\_class<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>tip\\_amount<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>total\\_amount<ept id=\"p4\">**</ept>.",
      "pos": [
        38275,
        38422
      ]
    },
    {
      "content": "The latter are target leaks since they imply the tip paid.",
      "pos": [
        38423,
        38481
      ]
    },
    {
      "content": "To exclude unnecessary columns and/or target leaks, you may use the [Project Columns][project-columns] module or the [Metadata Editor][metadata-editor].",
      "pos": [
        38486,
        38638
      ]
    },
    {
      "content": "For more information, see [Project Columns][project-columns] and [Metadata Editor][metadata-editor] reference pages.",
      "pos": [
        38639,
        38755
      ]
    },
    {
      "pos": [
        38760,
        38825
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"mldeploy\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Deploying Models in Azure Machine Learning"
    },
    {
      "content": "When your model is ready, you can easily deploy it as a web service directly from the experiment.",
      "pos": [
        38827,
        38924
      ]
    },
    {
      "content": "For more information about publishing Azure ML web services, see <bpt id=\"p1\">[</bpt>Publish an Azure Machine Learning web service<ept id=\"p1\">](machine-learning-publish-a-machine-learning-web-service.md)</ept>.",
      "pos": [
        38925,
        39098
      ]
    },
    {
      "content": "To deploy a new web service, you need to:",
      "pos": [
        39100,
        39141
      ]
    },
    {
      "content": "Create a scoring experiment.",
      "pos": [
        39146,
        39174
      ]
    },
    {
      "content": "Publish the web service.",
      "pos": [
        39178,
        39202
      ]
    },
    {
      "pos": [
        39204,
        39336
      ],
      "content": "To create a scoring experiment from a <bpt id=\"p1\">**</bpt>Finished<ept id=\"p1\">**</ept> training experiment, click <bpt id=\"p2\">**</bpt>CREATE SCORING EXPERIMENT<ept id=\"p2\">**</ept> in the lower action bar."
    },
    {
      "content": "Azure Scoring",
      "pos": [
        39340,
        39353
      ]
    },
    {
      "content": "Azure Machine Learning will attempt to create a scoring experiment based on the components of the training experiment.",
      "pos": [
        39360,
        39478
      ]
    },
    {
      "content": "In particular, it will:",
      "pos": [
        39479,
        39502
      ]
    },
    {
      "content": "Save the trained model and remove the model training modules.",
      "pos": [
        39507,
        39568
      ]
    },
    {
      "pos": [
        39572,
        39650
      ],
      "content": "Identify a logical <bpt id=\"p1\">**</bpt>input port<ept id=\"p1\">**</ept> to represent the expected input data schema."
    },
    {
      "pos": [
        39654,
        39741
      ],
      "content": "Identify a logical <bpt id=\"p1\">**</bpt>output port<ept id=\"p1\">**</ept> to represent the expected web service output schema."
    },
    {
      "content": "When the scoring experiment is created, review it and adjust as needed.",
      "pos": [
        39743,
        39814
      ]
    },
    {
      "content": "A typical adjustment is to replace the input dataset and/or query with one which excludes label fields, as these will not be available when the service is called.",
      "pos": [
        39815,
        39977
      ]
    },
    {
      "content": "It is also a good practice to reduce the size of the input dataset and/or query to a few records, just enough to indicate the input schema.",
      "pos": [
        39978,
        40117
      ]
    },
    {
      "content": "For the output port, it is common to exclude all input fields and only include the <bpt id=\"p1\">**</bpt>Scored Labels<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Scored Probabilities<ept id=\"p2\">**</ept> in the output using the [Project Columns][project-columns] module.",
      "pos": [
        40118,
        40314
      ]
    },
    {
      "content": "A sample scoring experiment is in the figure below.",
      "pos": [
        40316,
        40367
      ]
    },
    {
      "content": "When ready to publish, click the <bpt id=\"p1\">**</bpt>PUBLISH WEB SERVICE<ept id=\"p1\">**</ept> button in the lower action bar.",
      "pos": [
        40368,
        40456
      ]
    },
    {
      "content": "Azure ML Publish",
      "pos": [
        40460,
        40476
      ]
    },
    {
      "content": "To recap, in this walkthrough tutorial, you have created an Azure data science environment, worked with a large public dataset all the way from data acquisition to model training and publishing of an Azure Machine Learning web service.",
      "pos": [
        40483,
        40718
      ]
    },
    {
      "content": "License Information",
      "pos": [
        40724,
        40743
      ]
    },
    {
      "content": "This sample walkthrough and its accompanying scripts and IPython notebook(s) are shared by Microsoft under the MIT license.",
      "pos": [
        40745,
        40868
      ]
    },
    {
      "content": "Please check the LICENSE.txt file in in the directory of the sample code on GitHub for more details.",
      "pos": [
        40869,
        40969
      ]
    },
    {
      "content": "References",
      "pos": [
        40975,
        40985
      ]
    },
    {
      "content": "â€¢   <bpt id=\"p1\">[</bpt>AndrÃ©s Monroy NYC Taxi Trips Download Page<ept id=\"p1\">](http://www.andresmh.com/nyctaxitrips/)</ept>",
      "pos": [
        40987,
        41074
      ]
    },
    {
      "content": "â€¢   <bpt id=\"p1\">[</bpt>FOILing NYCâ€™s Taxi Trip Data by Chris Whong<ept id=\"p1\">](http://chriswhong.com/open-data/foil_nyc_taxi/)</ept><ph id=\"ph1\"> </ph>",
      "pos": [
        41077,
        41175
      ]
    },
    {
      "content": "â€¢   <bpt id=\"p1\">[</bpt>NYC Taxi and Limousine Commission Research and Statistics<ept id=\"p1\">](https://www1.nyc.gov/html/tlc/html/about/statistics.shtml)</ept>",
      "pos": [
        41178,
        41300
      ]
    },
    {
      "content": "test",
      "pos": [
        43216,
        43220
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Advanced Analytics Process and Technology in Action: using SQL Server | Microsoft Azure\" \n    description=\"Advanced Analytics Process and Technology in Action\"  \n    services=\"machine-learning\" \n    solutions=\"\" \n    documentationCenter=\"\" \n    authors=\"msolhab\" \n    manager=\"paulettm\" \n    editor=\"cgronlun\" />\n\n<tags \n    ms.service=\"machine-learning\" \n    ms.workload=\"data-services\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"09/01/2015\" \n    ms.author=\"mohabib;fashah;bradsev\"/> \n\n                \n# Advanced Analytics Process and Technology in Action: using SQL Server\n\nIn this tutorial, you walkthrough building and deploying a model using a publicly available dataset -- the [NYC Taxi Trips](http://www.andresmh.com/nyctaxitrips/) dataset. The procedure follows the Azure Advanced Analytics Process and Technology (ADAPT) guide. \n\n\n## <a name=\"dataset\"></a>NYC Taxi Trips Dataset Description\n\nThe NYC Taxi Trip data is about 20GB of compressed CSV files (~48GB uncompressed), comprising more than 173 million individual trips and the fares paid for each trip. Each trip record includes the pickup and drop-off location and time, anonymized hack (driver's) license number and medallion (taxiâ€™s unique id) number. The data covers all trips in the year 2013 and is provided in the following two datasets for each month:\n\n1. The 'trip_data' CSV contains trip details, such as number of passengers, pickup and dropoff points, trip duration, and trip length. Here are a few sample records:\n\n        medallion,hack_license,vendor_id,rate_code,store_and_fwd_flag,pickup_datetime,dropoff_datetime,passenger_count,trip_time_in_secs,trip_distance,pickup_longitude,pickup_latitude,dropoff_longitude,dropoff_latitude\n        89D227B655E5C82AECF13C3F540D4CF4,BA96DE419E711691B9445D6A6307C170,CMT,1,N,2013-01-01 15:11:48,2013-01-01 15:18:10,4,382,1.00,-73.978165,40.757977,-73.989838,40.751171\n        0BD7C8F5BA12B88E0B67BED28BEA73D8,9FD8F69F0804BDB5549F40E9DA1BE472,CMT,1,N,2013-01-06 00:18:35,2013-01-06 00:22:54,1,259,1.50,-74.006683,40.731781,-73.994499,40.75066\n        0BD7C8F5BA12B88E0B67BED28BEA73D8,9FD8F69F0804BDB5549F40E9DA1BE472,CMT,1,N,2013-01-05 18:49:41,2013-01-05 18:54:23,1,282,1.10,-74.004707,40.73777,-74.009834,40.726002\n        DFD2202EE08F7A8DC9A57B02ACB81FE2,51EE87E3205C985EF8431D850C786310,CMT,1,N,2013-01-07 23:54:15,2013-01-07 23:58:20,2,244,.70,-73.974602,40.759945,-73.984734,40.759388\n        DFD2202EE08F7A8DC9A57B02ACB81FE2,51EE87E3205C985EF8431D850C786310,CMT,1,N,2013-01-07 23:25:03,2013-01-07 23:34:24,1,560,2.10,-73.97625,40.748528,-74.002586,40.747868\n\n2. The 'trip_fare' CSV contains details of the fare paid for each trip, such as payment type, fare amount, surcharge and taxes, tips and tolls, and the total amount paid. Here are a few sample records:\n\n        medallion, hack_license, vendor_id, pickup_datetime, payment_type, fare_amount, surcharge, mta_tax, tip_amount, tolls_amount, total_amount\n        89D227B655E5C82AECF13C3F540D4CF4,BA96DE419E711691B9445D6A6307C170,CMT,2013-01-01 15:11:48,CSH,6.5,0,0.5,0,0,7\n        0BD7C8F5BA12B88E0B67BED28BEA73D8,9FD8F69F0804BDB5549F40E9DA1BE472,CMT,2013-01-06 00:18:35,CSH,6,0.5,0.5,0,0,7\n        0BD7C8F5BA12B88E0B67BED28BEA73D8,9FD8F69F0804BDB5549F40E9DA1BE472,CMT,2013-01-05 18:49:41,CSH,5.5,1,0.5,0,0,7\n        DFD2202EE08F7A8DC9A57B02ACB81FE2,51EE87E3205C985EF8431D850C786310,CMT,2013-01-07 23:54:15,CSH,5,0.5,0.5,0,0,6\n        DFD2202EE08F7A8DC9A57B02ACB81FE2,51EE87E3205C985EF8431D850C786310,CMT,2013-01-07 23:25:03,CSH,9.5,0.5,0.5,0,0,10.5\n\nThe unique key to join trip\\_data and trip\\_fare is composed of the fields: medallion, hack\\_licence and pickup\\_datetime.\n\n## <a name=\"mltasks\"></a>Examples of Prediction Tasks\n\nWe will formulate three prediction problems based on the *tip\\_amount*, namely:\n\n1. Binary classification: Predict whether or not a tip was paid for a trip, i.e. a *tip\\_amount* that is greater than $0 is a positive example, while a *tip\\_amount* of $0 is a negative example.\n\n2. Multiclass classification: To predict the range of tip paid for the trip. We divide the *tip\\_amount* into five bins or classes:\n    \n        Class 0 : tip_amount = $0\n        Class 1 : tip_amount > $0 and tip_amount <= $5\n        Class 2 : tip_amount > $5 and tip_amount <= $10\n        Class 3 : tip_amount > $10 and tip_amount <= $20\n        Class 4 : tip_amount > $20\n\n3. Regression task: To predict the amount of tip paid for a trip.  \n\n\n## <a name=\"setup\"></a>Setting Up the Azure data science environment for advanced analytics\n\nAs you can see from the [Plan Your Environment](machine-learning-data-science-plan-your-environment.md) guide, there are several options to work with the NYC Taxi Trips dataset in Azure:\n\n- Work with the data in Azure blobs then model in Azure Machine Learning\n- Load the data into a SQL Server database then model in Azure Machine Learning\n\nIn this tutorial we will demonstrate parallel bulk import of the data to a SQL Server, data exploration, feature engineering and down sampling using SQL Server Management Studio as well as using IPython Notebook. [Sample scripts](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/DataScienceScripts) and [IPython notebooks](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/iPythonNotebooks) are shared in GitHub. A sample IPython notebook to work with the data in Azure blobs is also available in the same location.\n\nTo set up your Azure Data Science environment:\n\n1. [Create a storage account](../storage-create-storage-account.md)\n\n2. [Create an Azure ML workspace](machine-learning-create-workspace.md)\n\n3. [Provision a Data Science Virtual Machine](machine-learning-data-science-setup-sql-server-virtual-machine.md), which will serve as a SQL Server as well an IPython Notebook server.\n\n    > [AZURE.NOTE] The sample scripts and IPython notebooks will be downloaded to your Data Science virtual machine during the setup process. When the VM post-installation script completes, the samples will be in your VM's Documents library:  \n    > - Sample Scripts: `C:\\Users\\<user_name>\\Documents\\Data Science Scripts`  \n    > - Sample IPython Notebooks: `C:\\Users\\<user_name>\\Documents\\IPython Notebooks\\DataScienceSamples`  \n    > where `<user_name>` is your VM's Windows login name. We will refer to the sample folders as **Sample Scripts** and **Sample IPython Notebooks**.\n\n\nBased on the dataset size, data source location, and the selected Azure target environment, this scenario is similar to [Scenario \\#5: Large dataset in a local files, target SQL Server in Azure VM](../machine-learning-data-science-plan-sample-scenarios.md#largelocaltodb).\n\n## <a name=\"getdata\"></a>Get the Data from Public Source\n\nTo get the [NYC Taxi Trips](http://www.andresmh.com/nyctaxitrips/) dataset from its public location, you may use any of the methods described in [Move Data to and from Azure Blob Storage](machine-learning-data-science-move-azure-blob.md) to copy the data to your new virtual machine.\n\nTo copy the data using AzCopy:\n\n1. Log in to your virtual machine (VM)\n\n2. Create a new directory in the VM's data disk (Note: Do not use the Temporary Disk which comes with the VM as a Data Disk).\n\n3. In a Command Prompt window, run the following Azcopy command line, replacing <path_to_data_folder> with your data folder created in (2):\n\n        \"C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\AzCopy\\azcopy\" /Source:https://nyctaxitrips.blob.core.windows.net/data /Dest:<path_to_data_folder> /S\n\n    When the AzCopy completes, a total of 24 zipped CSV files (12 for trip\\_data and 12 for trip\\_fare) should be in the data folder.\n\n4. Unzip the downloaded files. Note the folder where the uncompressed files reside. This folder will be referred to as the <path\\_to\\_data\\_files\\>.\n\n## <a name=\"dbload\"></a>Bulk Import Data into SQL Server Database\n\nThe performance of loading/transferring large amounts of data to an SQL database and subsequent queries can be improved by using _Partitioned Tables and Views_. In this section, we will follow the instructions described in [Parallel Bulk Data Import Using SQL Partition Tables](machine-learning-data-science-parallel-load-sql-partitioned-tables.md) to create a new database and load the data into partitioned tables in parallel.\n\n1. While logged in to your VM, start **SQL Server Management Studio**.\n\n2. Connect using Windows Authentication.\n\n    ![SSMS Connect][12]\n\n3. If you have not yet changed the SQL Server authentication mode and created a new SQL login user, open the script file named **change\\_auth.sql** in the **Sample Scripts** folder. Change the  default user name and password. Click **!Execute** in the toolbar to run the script.\n\n    ![Execute Script][13]\n\n4. Verify and/or change the SQL Server default database and log folders to ensure that newly created databases will be stored in a Data Disk. The SQL Server VM image that is optimized for datawarehousing loads is pre-configured with data and log disks. If your VM did not include a Data Disk and you added new virtual hard disks during the VM setup process, change the default folders as follows:\n\n    - Right-click the SQL Server name in the left panel and click **Properties**.\n\n        ![SQL Server Properties][14]\n\n    - Select **Database Settings** from the **Select a page** list to the left.\n\n    - Verify and/or change the **Database default locations** to the **Data Disk** locations of your choice. This is where new databases reside if created with the default location settings.\n    \n        ![SQL Database Defaults][15]  \n\n5. To create a new database and a set of filegroups to hold the partitioned tables, open the sample script **create\\_db\\_default.sql**. The script will create a new database named **TaxiNYC** and 12 filegroups in the default data location. Each filegroup will hold one month of trip\\_data and trip\\_fare data. Modify the database name, if desired. Click **!Execute** to run the script.\n\n6. Next, create two partition tables, one for the trip\\_data and another for the trip\\_fare. Open the sample script **create\\_partitioned\\_table.sql**, which will:\n\n    - Create a partition function to split the data by month.\n    - Create a partition scheme to map each month's data to a different filegroup.\n    - Create two partitioned tables mapped to the partition scheme: **nyctaxi\\_trip** will hold the trip\\_data and **nyctaxi\\_fare** will hold the trip\\_fare data.\n\n    Click **!Execute** to run the script and create the partitioned tables.\n\n7. In the **Sample Scripts** folder, there are two sample PowerShell scripts provided to demonstrate parallel bulk imports of data to SQL Server tables.\n\n    - **bcp\\_parallel\\_generic.ps1** is a generic script to parallel bulk import data into a table. Modify this script to set the input and target variables as indicated in the comment lines in the script.\n    - **bcp\\_parallel\\_nyctaxi.ps1** is a pre-configured version of the generic script and can be used to to load both tables for the NYC Taxi Trips data.  \n\n8. Right-click the **bcp\\_parallel\\_nyctaxi.ps1** script name and click **Edit** to open it in PowerShell. Review the preset variables and modify according to your selected database name, input data folder, target log folder, and paths to the  sample format files **nyctaxi_trip.xml** and **nyctaxi\\_fare.xml** (provided in the **Sample Scripts** folder). \n\n    ![Bulk Import Data][16]\n\n    You may also select the authentication mode, default is Windows Authentication. Click the green arrow in the toolbar to run. The script will launch 24 bulk import operations in parallel, 12 for each partitioned table. You may monitor the data import progress by opening the SQL Server default data folder as set above.\n\n9. The PowerShell script reports the starting and ending times. When all bulk imports complete, the ending time is reported. Check the target log folder to verify that the bulk imports were successful, i.e., no errors reported in the target log folder.\n\n10. Your database is now ready for exploration, feature engineering, and other operations as desired. Since the tables are partitioned according to the **pickup\\_datetime** field, queries which include **pickup\\_datetime** conditions in the **WHERE** clause will benefit from the partition scheme.\n\n11. In **SQL Server Management Studio**, explore the provided sample script **sample\\_queries.sql**. To run any of the sample queries, highlight the query lines then click **!Execute** in the toolbar.\n\n12. The NYC Taxi Trips data is loaded in two separate tables. To improve join operations, it is highly recommended to index the tables. The sample script **create\\_partitioned\\_index.sql** creates partitioned indexes on the composite join key **medallion, hack\\_license, and pickup\\_datetime**.\n\n## <a name=\"dbexplore\"></a>Data Exploration and Feature Engineering in SQL Server\n\nIn this section, we will perform data exploration and feature generation by running SQL queries directly in the **SQL Server Management Studio** using the SQL Server database created earlier. A sample script named **sample\\_queries.sql** is provided in the **Sample Scripts** folder. Modify the script to change the database name, if it is different from the default: **TaxiNYC**.\n\nIn this exercise, we will:\n\n- Connect to **SQL Server Management Studio** using either Windows Authentication or using SQL Authentication and the SQL login name and password.\n- Explore data distributions of a few fields in varying time windows.\n- Investigate data quality of the longitude and latitude fields.\n- Generate binary and multiclass classification labels based on the **tip\\_amount**.\n- Generate features and compute/compare trip distances.\n- Join the two tables and extract a random sample that will be used to build models.\n\nWhen you are ready to proceed to Azure Machine Learning, you may either:  \n\n1. Save the final SQL query to extract and sample the data and copy-paste the query directly into a [Reader][reader] module in Azure Machine Learning, or \n2. Persist the sampled and engineered data you plan to use for model building in a new database table and use the new table in the [Reader][reader] module in Azure Machine Learning.\n\nIn this section we will save the final query to extract and sample the data. The second method is demonstrated in the [Data Exploration and Feature Engineering in IPython Notebook](#ipnb) section.\n\nFor a quick verification of the number of rows and columns in the tables populated earlier using parallel bulk import,\n\n    -- Report number of rows in table nyctaxi_trip without table scan\n    SELECT SUM(rows) FROM sys.partitions WHERE object_id = OBJECT_ID('nyctaxi_trip')\n\n    -- Report number of columns in table nyctaxi_trip\n    SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'nyctaxi_trip' \n\n#### Exploration: Trip distribution by medallion\n\nThis example identifies the medallion (taxi numbers) with more than 100 trips within a given time period. The query would benefit from the partitioned table access since it is conditioned by the partition scheme of **pickup\\_datetime**. Querying the full dataset will also make use of the partitioned table and/or index scan.\n\n    SELECT medallion, COUNT(*)\n    FROM nyctaxi_fare\n    WHERE pickup_datetime BETWEEN '20130101' AND '20130331'\n    GROUP BY medallion\n    HAVING COUNT(*) > 100\n\n#### Exploration: Trip distribution by medallion and hack_license\n\n    SELECT medallion, hack_license, COUNT(*)\n    FROM nyctaxi_fare\n    WHERE pickup_datetime BETWEEN '20130101' AND '20130131'\n    GROUP BY medallion, hack_license\n    HAVING COUNT(*) > 100\n\n#### Data Quality Assessment: Verify records with incorrect longitude and/or latitude\n\nThis example investigates if any of the longitude and/or latitude fields either contain an invalid value (radian degrees should be between -90 and 90), or have (0, 0) coordinates.\n\n    SELECT COUNT(*) FROM nyctaxi_trip\n    WHERE pickup_datetime BETWEEN '20130101' AND '20130331'\n    AND  (CAST(pickup_longitude AS float) NOT BETWEEN -90 AND 90\n    OR    CAST(pickup_latitude AS float) NOT BETWEEN -90 AND 90\n    OR    CAST(dropoff_longitude AS float) NOT BETWEEN -90 AND 90\n    OR    CAST(dropoff_latitude AS float) NOT BETWEEN -90 AND 90\n    OR    (pickup_longitude = '0' AND pickup_latitude = '0')\n    OR    (dropoff_longitude = '0' AND dropoff_latitude = '0'))\n\n#### Exploration: Tipped vs. Not Tipped Trips distribution\n\nThis example finds the number of trips that were tipped vs. not tipped in a given time period (or in the full dataset if covering the full year). This distribution reflects the binary label distribution to be later used for binary classification modeling.\n\n    SELECT tipped, COUNT(*) AS tip_freq FROM (\n      SELECT CASE WHEN (tip_amount > 0) THEN 1 ELSE 0 END AS tipped, tip_amount\n      FROM nyctaxi_fare\n      WHERE pickup_datetime BETWEEN '20130101' AND '20131231') tc\n    GROUP BY tipped\n\n#### Exploration: Tip Class/Range Distribution\n\nThis example computes the distribution of tip ranges in a given time period (or in the full dataset if covering the full year). This is the distribution of the label classes that will be used later for multiclass classification modeling.\n\n    SELECT tip_class, COUNT(*) AS tip_freq FROM (\n        SELECT CASE \n            WHEN (tip_amount = 0) THEN 0\n            WHEN (tip_amount > 0 AND tip_amount <= 5) THEN 1\n            WHEN (tip_amount > 5 AND tip_amount <= 10) THEN 2\n            WHEN (tip_amount > 10 AND tip_amount <= 20) THEN 3\n            ELSE 4 \n        END AS tip_class\n    FROM nyctaxi_fare\n    WHERE pickup_datetime BETWEEN '20130101' AND '20131231') tc\n    GROUP BY tip_class\n\n#### Exploration: Compute and Compare Trip Distance\n\nThis example converts the pickup and drop-off longitude and latitude to SQL geography points, computes the trip distance using SQL geography points difference, and returns a random sample of the results for comparison. The example limits the results to valid coordinates only using the data quality assessment query covered earlier.\n\n    SELECT \n    pickup_location=geography::STPointFromText('POINT(' + pickup_longitude + ' ' + pickup_latitude + ')', 4326)\n    ,dropoff_location=geography::STPointFromText('POINT(' + dropoff_longitude + ' ' + dropoff_latitude + ')', 4326)\n    ,trip_distance\n    ,computedist=round(geography::STPointFromText('POINT(' + pickup_longitude + ' ' + pickup_latitude + ')', 4326).STDistance(geography::STPointFromText('POINT(' + dropoff_longitude + ' ' + dropoff_latitude + ')', 4326))/1000, 2)\n    FROM nyctaxi_trip\n    tablesample(0.01 percent)\n    WHERE CAST(pickup_latitude AS float) BETWEEN -90 AND 90\n    AND   CAST(dropoff_latitude AS float) BETWEEN -90 AND 90\n    AND   pickup_longitude != '0' AND dropoff_longitude != '0'\n\n#### Feature Engineering in SQL Queries\n\nThe label generation and geography conversion exploration queries can also be used to generate labels/features by removing the counting part. Additional feature engineering SQL examples are provided in the [Data Exploration and Feature Engineering in IPython Notebook](#ipnb) section. It is more efficient to run the feature generation queries on the full dataset or a large subset of it using SQL queries which run directly on the SQL Server database instance. The queries may be executed in **SQL Server Management Studio**, IPython Notebook or any development tool/environment which can access the database locally or remotely.\n\n#### Preparing Data for Model Building\n\nThe following query joins the **nyctaxi\\_trip** and **nyctaxi\\_fare** tables, generates a binary classification label **tipped**, a multi-class classification label **tip\\_class**, and extracts a 1% random sample from the full joined dataset. This query can be copied then pasted directly in the [Azure Machine Learning Studio](https://studio.azureml.net) [Reader][reader] module for direct data ingestion from the SQL Server database instance in Azure. The query excludes records with incorrect (0, 0) coordinates.\n\n    SELECT t.*, f.payment_type, f.fare_amount, f.surcharge, f.mta_tax, f.tolls_amount,  f.total_amount, f.tip_amount,\n        CASE WHEN (tip_amount > 0) THEN 1 ELSE 0 END AS tipped,\n        CASE WHEN (tip_amount = 0) THEN 0\n            WHEN (tip_amount > 0 AND tip_amount <= 5) THEN 1\n            WHEN (tip_amount > 5 AND tip_amount <= 10) THEN 2\n            WHEN (tip_amount > 10 AND tip_amount <= 20) THEN 3\n            ELSE 4\n        END AS tip_class\n    FROM nyctaxi_trip t, nyctaxi_fare f\n    TABLESAMPLE (1 percent)\n    WHERE t.medallion = f.medallion\n    AND   t.hack_license = f.hack_license\n    AND   t.pickup_datetime = f.pickup_datetime\n    AND   pickup_longitude != '0' AND dropoff_longitude != '0'\n\n\n## <a name=\"ipnb\"></a>Data Exploration and Feature Engineering in IPython Notebook\n\nIn this section, we will perform data exploration and feature generation\nusing both Python and SQL queries against the SQL Server database created earlier. A sample IPython notebook named **machine-Learning-data-science-process-sql-story.ipynb** is provided in the **Sample IPython Notebooks** folder. This notebook is also available on [GitHub](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/iPythonNotebooks).\n\nThe recommended sequence when working with big data is the following:\n\n- Read in a small sample of the data into an in-memory data frame.\n- Perform some visualizations and explorations using the sampled data.\n- Experiment with feature engineering using the sampled data. \n- For larger data exploration, data manipulation and feature engineering, use Python to issue SQL Queries directly against the SQL Server database in the Azure VM.\n- Decide the sample size to use for Azure Machine Learning model building.\n\nWhen ready to proceed to Azure Machine Learning, you may either:  \n\n1. Save the final SQL query to extract and sample the data and copy-paste the query directly into a [Reader][reader] module in Azure Machine Learning. This method is demonstrated in the [Building Models in Azure Machine Learning](#mlmodel) section.    \n2. Persist the sampled and engineered data you plan to use for model building in a new database table, then use the new table in the [Reader][reader] module.\n\nThe following are a few data exploration, data visualization, and feature engineering examples. For more examples, see the sample SQL IPython notebook in the **Sample IPython Notebooks** folder.\n\n#### Initialize Database Credentials\n\nInitialize your database connection settings in the following variables:\n\n    SERVER_NAME=<server name>\n    DATABASE_NAME=<database name>\n    USERID=<user name>\n    PASSWORD=<password>\n    DB_DRIVER = <database server>\n\n#### Create Database Connection\n\n    CONNECTION_STRING = 'DRIVER={'+DRIVER+'};SERVER='+SERVER_NAME+';DATABASE='+DATABASE_NAME+';UID='+USERID+';PWD='+PASSWORD\n    conn = pyodbc.connect(CONNECTION_STRING)\n\n#### Report number of rows and columns in table nyctaxi_trip\n\n    nrows = pd.read_sql('''\n        SELECT SUM(rows) FROM sys.partitions \n        WHERE object_id = OBJECT_ID('nyctaxi_trip')\n    ''', conn)\n    \n    print 'Total number of rows = %d' % nrows.iloc[0,0]\n    \n    ncols = pd.read_sql('''\n        SELECT COUNT(*) FROM information_schema.columns \n        WHERE table_name = ('nyctaxi_trip')\n    ''', conn)\n    \n    print 'Total number of columns = %d' % ncols.iloc[0,0]\n\n- Total number of rows = 173179759  \n- Total number of columns = 14\n    \n#### Read-in a small data sample from the SQL Server Database\n\n    t0 = time.time()\n    \n    query = '''\n        SELECT t.*, f.payment_type, f.fare_amount, f.surcharge, f.mta_tax, \n            f.tolls_amount, f.total_amount, f.tip_amount \n        FROM nyctaxi_trip t, nyctaxi_fare f \n        TABLESAMPLE (0.05 PERCENT)\n        WHERE t.medallion = f.medallion \n        AND   t.hack_license = f.hack_license \n        AND   t.pickup_datetime = f.pickup_datetime\n    '''\n\n    df1 = pd.read_sql(query, conn)\n    \n    t1 = time.time()\n    print 'Time to read the sample table is %f seconds' % (t1-t0)\n    \n    print 'Number of rows and columns retrieved = (%d, %d)' % (df1.shape[0], df1.shape[1])\n\nTime to read the sample table is 6.492000 seconds  \nNumber of rows and columns retrieved = (84952, 21)\n    \n#### Descriptive Statistics\n\nNow are ready to explore the sampled data. We start with\nlooking at descriptive statistics for the **trip\\_distance** (or any other) field(s):\n\n    df1['trip_distance'].describe()\n\n#### Visualization: Box Plot Example\n\nNext we look at the box plot for the trip distance to visualize the quantiles\n\n    df1.boxplot(column='trip_distance',return_type='dict')\n\n![Plot #1][1]\n\n#### Visualization: Distribution Plot Example\n\n    fig = plt.figure()\n    ax1 = fig.add_subplot(1,2,1)\n    ax2 = fig.add_subplot(1,2,2)\n    df1['trip_distance'].plot(ax=ax1,kind='kde', style='b-')\n    df1['trip_distance'].hist(ax=ax2, bins=100, color='k')\n\n![Plot #2][2]\n\n#### Visualization: Bar and Line Plots\n\nIn this example, we bin the trip distance into five bins and visualize the binning results.\n\n    trip_dist_bins = [0, 1, 2, 4, 10, 1000]\n    df1['trip_distance']\n    trip_dist_bin_id = pd.cut(df1['trip_distance'], trip_dist_bins)\n    trip_dist_bin_id\n\nWe can plot the above bin distribution in a bar or line plot as below\n\n    pd.Series(trip_dist_bin_id).value_counts().plot(kind='bar')\n\n![Plot #3][3]\n\n    pd.Series(trip_dist_bin_id).value_counts().plot(kind='line')\n\n![Plot #4][4]\n\n#### Visualization: Scatterplot Example\n\nWe show scatter plot between **trip\\_time\\_in\\_secs** and **trip\\_distance** to see if there\nis any correlation\n\n    plt.scatter(df1['trip_time_in_secs'], df1['trip_distance'])\n\n![Plot #6][6]\n\nSimilarly we can check the relationship between **rate\\_code** and **trip\\_distance**.\n\n    plt.scatter(df1['passenger_count'], df1['trip_distance'])\n\n![Plot #8][8]\n\n### Sub-Sampling the Data in SQL\n\nWhen preparing data for model building in [Azure Machine Learning Studio](https://studio.azureml.net), you may either decide on the **SQL query to use directly in the Reader module** or persist the engineered and sampled data in a new table, which you could use in the [Reader][reader] module with a simple **SELECT * FROM <your\\_new\\_table\\_name>**.\n\nIn this section we will create a new table to hold the sampled and engineered data. An example of a direct SQL query for model building is provided in the [Data Exploration and Feature Engineering in SQL Server](#dbexplore) section.\n\n#### Create a Sample Table and Populate with 1% of the Joined Tables. Drop Table First if it Exists.\n\nIn this section, we join the tables **nyctaxi\\_trip** and **nyctaxi\\_fare**, extract a 1% random sample, and persist the sampled data in a new table name **nyctaxi\\_one\\_percent**:\n\n    cursor = conn.cursor()\n    \n    drop_table_if_exists = '''\n        IF OBJECT_ID('nyctaxi_one_percent', 'U') IS NOT NULL DROP TABLE nyctaxi_one_percent\n    '''\n    \n    nyctaxi_one_percent_insert = '''\n        SELECT t.*, f.payment_type, f.fare_amount, f.surcharge, f.mta_tax, f.tolls_amount, f.total_amount, f.tip_amount\n        INTO nyctaxi_one_percent \n        FROM nyctaxi_trip t, nyctaxi_fare f\n        TABLESAMPLE (1 PERCENT)\n        WHERE t.medallion = f.medallion\n        AND   t.hack_license = f.hack_license\n        AND   t.pickup_datetime = f.pickup_datetime\n        AND   pickup_longitude <> '0' AND dropoff_longitude <> '0'\n    '''\n    \n    cursor.execute(drop_table_if_exists)\n    cursor.execute(nyctaxi_one_percent_insert)\n    cursor.commit()\n    \n### Data Exploration using SQL Queries in IPython Notebook\n\nIn this section, we explore data distributions using the 1% sampled data which is persisted in the new table we created above. Note that similar explorations can be performed using the original tables, optionally using **TABLESAMPLE** to limit the exploration sample or by limiting the results to a given time period using the **pickup\\_datetime** partitions, as illustrated in the [Data Exploration and Feature Engineering in SQL Server](#dbexplore) section.\n\n#### Exploration: Daily distribution of trips\n\n    query = '''\n        SELECT CONVERT(date, dropoff_datetime) AS date, COUNT(*) AS c \n        FROM nyctaxi_one_percent \n        GROUP BY CONVERT(date, dropoff_datetime)\n    '''\n\n    pd.read_sql(query,conn)\n\n#### Exploration: Trip distribution per medallion\n\n    query = '''\n        SELECT medallion,count(*) AS c \n        FROM nyctaxi_one_percent \n        GROUP BY medallion\n    '''\n    \n    pd.read_sql(query,conn)\n\n### Feature Generation Using SQL Queries in IPython Notebook\n\nIn this section we will generate new labels and features directly using SQL queries, operating on the 1% sample table we created in the previous section.\n\n#### Label Generation: Generate Class Labels\n\nIn the following example, we generate two sets of labels to use for modeling:\n\n1. Binary Class Labels **tipped** (predicting if a tip will be given)\n2. Multiclass Labels **tip\\_class** (predicting the tip bin or range)\n\n        nyctaxi_one_percent_add_col = '''\n            ALTER TABLE nyctaxi_one_percent ADD tipped bit, tip_class int\n        '''\n        \n        cursor.execute(nyctaxi_one_percent_add_col)\n        cursor.commit()\n    \n        nyctaxi_one_percent_update_col = '''\n            UPDATE nyctaxi_one_percent \n            SET \n               tipped = CASE WHEN (tip_amount > 0) THEN 1 ELSE 0 END,\n               tip_class = CASE WHEN (tip_amount = 0) THEN 0\n                                WHEN (tip_amount > 0 AND tip_amount <= 5) THEN 1\n                                WHEN (tip_amount > 5 AND tip_amount <= 10) THEN 2\n                                WHEN (tip_amount > 10 AND tip_amount <= 20) THEN 3\n                                ELSE 4\n                            END\n        '''\n\n        cursor.execute(nyctaxi_one_percent_update_col)\n        cursor.commit()\n\n#### Feature Engineering: Count Features for Categorical Columns\n\nThis example transforms a categorical field into a numeric field by replacing each category with the count of its occurrences in the data.\n\n    nyctaxi_one_percent_insert_col = '''\n        ALTER TABLE nyctaxi_one_percent ADD cmt_count int, vts_count int\n    '''\n\n    cursor.execute(nyctaxi_one_percent_insert_col)\n    cursor.commit()\n\n    nyctaxi_one_percent_update_col = '''\n        WITH B AS \n        (\n            SELECT medallion, hack_license, \n                SUM(CASE WHEN vendor_id = 'cmt' THEN 1 ELSE 0 END) AS cmt_count,\n                SUM(CASE WHEN vendor_id = 'vts' THEN 1 ELSE 0 END) AS vts_count\n            FROM nyctaxi_one_percent \n            GROUP BY medallion, hack_license\n        ) \n    \n        UPDATE nyctaxi_one_percent \n        SET nyctaxi_one_percent.cmt_count = B.cmt_count,\n            nyctaxi_one_percent.vts_count = B.vts_count\n        FROM nyctaxi_one_percent A INNER JOIN B \n        ON A.medallion = B.medallion AND A.hack_license = B.hack_license\n    '''\n    \n    cursor.execute(nyctaxi_one_percent_update_col)\n    cursor.commit()\n\n#### Feature Engineering: Bin features for Numerical Columns\n\nThis example transforms a continuous numeric field into preset category ranges, i.e., transform numeric field into a categorical field.\n\n    nyctaxi_one_percent_insert_col = '''\n        ALTER TABLE nyctaxi_one_percent ADD trip_time_bin int\n    '''\n\n    cursor.execute(nyctaxi_one_percent_insert_col)\n    cursor.commit()\n\n    nyctaxi_one_percent_update_col = '''\n        WITH B(medallion,hack_license,pickup_datetime,trip_time_in_secs, BinNumber ) AS \n        (\n            SELECT medallion,hack_license,pickup_datetime,trip_time_in_secs, \n            NTILE(5) OVER (ORDER BY trip_time_in_secs) AS BinNumber from nyctaxi_one_percent\n        )\n    \n        UPDATE nyctaxi_one_percent \n        SET trip_time_bin = B.BinNumber\n        FROM nyctaxi_one_percent A INNER JOIN B \n        ON A.medallion = B.medallion\n        AND A.hack_license = B.hack_license\n        AND A.pickup_datetime = B.pickup_datetime\n    '''\n    \n    cursor.execute(nyctaxi_one_percent_update_col)\n    cursor.commit()\n\n#### Feature Engineering: Extract Location Features from Decimal Latitude/Longitude\n\nThis example breaks down the decimal representation of a latitude and/or longitude field into multiple region fields of different granularity, such as, country, city, town, block, etc. Note that the new geo-fields are not mapped to actual locations. For information on mapping geocode locations, see [Bing Maps REST Services](https://msdn.microsoft.com/library/ff701710.aspx). \n\n    nyctaxi_one_percent_insert_col = '''\n        ALTER TABLE nyctaxi_one_percent \n        ADD l1 varchar(6), l2 varchar(3), l3 varchar(3), l4 varchar(3),\n            l5 varchar(3), l6 varchar(3), l7 varchar(3)\n    '''\n\n    cursor.execute(nyctaxi_one_percent_insert_col)\n    cursor.commit()\n\n    nyctaxi_one_percent_update_col = '''\n        UPDATE nyctaxi_one_percent\n        SET l1=round(pickup_longitude,0) \n            , l2 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 1 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),1,1) ELSE '0' END     \n            , l3 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 2 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),2,1) ELSE '0' END     \n            , l4 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 3 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),3,1) ELSE '0' END     \n            , l5 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 4 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),4,1) ELSE '0' END     \n            , l6 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 5 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),5,1) ELSE '0' END     \n            , l7 = CASE WHEN LEN (PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1)) >= 6 THEN SUBSTRING(PARSENAME(ROUND(ABS(pickup_longitude) - FLOOR(ABS(pickup_longitude)),6),1),6,1) ELSE '0' END \n    '''\n\n    cursor.execute(nyctaxi_one_percent_update_col)\n    cursor.commit()\n\n#### Verify the final form of the featurized table\n\n    query = '''SELECT TOP 100 * FROM nyctaxi_one_percent'''\n    pd.read_sql(query,conn)\n\nWe are now ready to proceed to model building and model deployment in [Azure Machine Learning](https://studio.azureml.net). The data is ready for any of the prediction problems identified earlier, namely:\n\n1. Binary classification: To predict whether or not a tip was paid for a trip.\n\n2. Multiclass classification: To predict the range of tip paid, according to the previously defined classes.\n\n3. Regression task: To predict the amount of tip paid for a trip.  \n\n\n## <a name=\"mlmodel\"></a>Building Models in Azure Machine Learning\n\nTo begin the modeling exercise, log in to your Azure Machine Learning workspace. If you have not yet created a machine learning workspace, see [Create an Azure ML workspace](machine-learning-create-workspace.md).\n\n1. To get started with Azure Machine Learning, see [What is Azure Machine Learning Studio?](machine-learning-what-is-ml-studio.md)\n\n2. Log in to [Azure Machine Learning Studio](https://studio.azureml.net).\n\n3. The Studio Home page provides a wealth of information, videos, tutorials, links to the Modules Reference, and other resources. Fore more information about Azure Machine Learning, consult the [Azure Machine Learning Documentation Center](http://azure.microsoft.com/documentation/services/machine-learning/).\n\nA typical training experiment consists of the following:\n\n1. Create a **+NEW** experiment.\n2. Get the data to Azure ML.\n3. Pre-process, transform and manipulate the data as needed.\n4. Generate features as needed.\n5. Split the data into training/validation/testing datasets(or have separate datasets for each).\n6. Select one or more machine learning algorithms depending on the learning problem to solve. E.g., binary classification, multiclass classification, regression.\n7. Train one or more models using the training dataset.\n8. Score the validation dataset using the trained model(s).\n9. Evaluate the model(s) to compute the relevant metrics for the learning problem.\n10. Fine tune the model(s) and select the best model to deploy.\n\nIn this exercise, we have already explored and engineered the data in SQL Server, and decided on the sample size to ingest in Azure ML. To build one or more of the prediction models we decided:\n\n1. Get the data to Azure ML using the [Reader][reader] module, available in the **Data Input and Output** section. For more information, see the [Reader][reader] module reference page.\n\n    ![Azure ML Reader][17]\n\n2. Select **Azure SQL Database** as the **Data source** in the **Properties** panel.\n\n3. Enter the database DNS name in the **Database server name** field. Format: `tcp:<your_virtual_machine_DNS_name>,1433`\n\n4. Enter the **Database name** in the corresponding field.\n\n5. Enter the **SQL user name** in the **Server user aqccount name, and the password in the **Server user account password**.\n\n6. Check **Accept any server certificate** option.\n\n7. In the **Database query** edit text area, paste the query which extracts the necessary database fields (including any computed fields such as the labels) and down samples the data to the desired sample size.\n\nAn example of a binary classification experiment reading data directly from the SQL Server database is in the figure below. Similar experiments can be constructed for multiclass classification and regression problems.\n\n![Azure ML Train][10]\n\n> [AZURE.IMPORTANT] In the modeling data extraction and sampling query examples provided in previous sections, **all labels for the three modeling exercises are included in the query**. An important (required) step in each of the modeling exercises is to **exclude** the unnecessary labels for the other two problems, and any other **target leaks**. For e.g., when using binary classification, use the label **tipped** and exclude the fields **tip\\_class**, **tip\\_amount**, and **total\\_amount**. The latter are target leaks since they imply the tip paid.\n>\n> To exclude unnecessary columns and/or target leaks, you may use the [Project Columns][project-columns] module or the [Metadata Editor][metadata-editor]. For more information, see [Project Columns][project-columns] and [Metadata Editor][metadata-editor] reference pages.\n\n## <a name=\"mldeploy\"></a>Deploying Models in Azure Machine Learning\n\nWhen your model is ready, you can easily deploy it as a web service directly from the experiment. For more information about publishing Azure ML web services, see [Publish an Azure Machine Learning web service](machine-learning-publish-a-machine-learning-web-service.md).\n\nTo deploy a new web service, you need to:\n\n1. Create a scoring experiment.\n2. Publish the web service.\n\nTo create a scoring experiment from a **Finished** training experiment, click **CREATE SCORING EXPERIMENT** in the lower action bar.\n\n![Azure Scoring][18]\n\nAzure Machine Learning will attempt to create a scoring experiment based on the components of the training experiment. In particular, it will:\n\n1. Save the trained model and remove the model training modules.\n2. Identify a logical **input port** to represent the expected input data schema.\n3. Identify a logical **output port** to represent the expected web service output schema.\n\nWhen the scoring experiment is created, review it and adjust as needed. A typical adjustment is to replace the input dataset and/or query with one which excludes label fields, as these will not be available when the service is called. It is also a good practice to reduce the size of the input dataset and/or query to a few records, just enough to indicate the input schema. For the output port, it is common to exclude all input fields and only include the **Scored Labels** and **Scored Probabilities** in the output using the [Project Columns][project-columns] module.\n\nA sample scoring experiment is in the figure below. When ready to publish, click the **PUBLISH WEB SERVICE** button in the lower action bar.\n\n![Azure ML Publish][11]\n\nTo recap, in this walkthrough tutorial, you have created an Azure data science environment, worked with a large public dataset all the way from data acquisition to model training and publishing of an Azure Machine Learning web service.\n\n### License Information\n\nThis sample walkthrough and its accompanying scripts and IPython notebook(s) are shared by Microsoft under the MIT license. Please check the LICENSE.txt file in in the directory of the sample code on GitHub for more details.\n\n### References\n\nâ€¢   [AndrÃ©s Monroy NYC Taxi Trips Download Page](http://www.andresmh.com/nyctaxitrips/)  \nâ€¢   [FOILing NYCâ€™s Taxi Trip Data by Chris Whong](http://chriswhong.com/open-data/foil_nyc_taxi/)   \nâ€¢   [NYC Taxi and Limousine Commission Research and Statistics](https://www1.nyc.gov/html/tlc/html/about/statistics.shtml)\n\n\n[1]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_26_1.png\n[2]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_28_1.png\n[3]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_35_1.png\n[4]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_36_1.png\n[5]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_39_1.png\n[6]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_42_1.png\n[7]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_44_1.png\n[8]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_46_1.png\n[9]: ./media/machine-learning-data-science-process-sql-walkthrough/sql-walkthrough_71_1.png\n[10]: ./media/machine-learning-data-science-process-sql-walkthrough/azuremltrain.png\n[11]: ./media/machine-learning-data-science-process-sql-walkthrough/azuremlpublish.png\n[12]: ./media/machine-learning-data-science-process-sql-walkthrough/ssmsconnect.png\n[13]: ./media/machine-learning-data-science-process-sql-walkthrough/executescript.png\n[14]: ./media/machine-learning-data-science-process-sql-walkthrough/sqlserverproperties.png\n[15]: ./media/machine-learning-data-science-process-sql-walkthrough/sqldefaultdirs.png\n[16]: ./media/machine-learning-data-science-process-sql-walkthrough/bulkimport.png\n[17]: ./media/machine-learning-data-science-process-sql-walkthrough/amlreader.png\n[18]: ./media/machine-learning-data-science-process-sql-walkthrough/amlscoring.png\n\n\n<!-- Module References -->\n[metadata-editor]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/\n[project-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/\n[reader]: https://msdn.microsoft.com/library/azure/4e1b0fe6-aded-4b3f-a36f-39b8862b9004/\n \ntest\n"
}