{
  "nodes": [
    {
      "content": "Tutorial: Integrating Google Apps with Azure Active Directory | Microsoft Azure",
      "pos": [
        26,
        105
      ]
    },
    {
      "content": "Learn how to use Google Apps with Azure Active Directory to enable single sign-on, automated provisioning, and more!",
      "pos": [
        123,
        239
      ]
    },
    {
      "content": "Tutorial: How to integrate Google Apps with Azure Active Directory",
      "pos": [
        542,
        608
      ]
    },
    {
      "content": "This tutorial will show you how to connect your Google Apps environment to your Azure Active Directory (Azure AD).",
      "pos": [
        610,
        724
      ]
    },
    {
      "content": "You will learn how to configure single sign-on to Google Apps, how to enable automated user provisioning, and how to assign users to have access to Google Apps.",
      "pos": [
        725,
        885
      ]
    },
    {
      "content": "Prerequisites",
      "pos": [
        890,
        903
      ]
    },
    {
      "pos": [
        908,
        1060
      ],
      "content": "To access Azure Active Directory through the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>, you must first have a valid Azure subscription."
    },
    {
      "content": "You must have a valid tenant for <bpt id=\"p1\">[</bpt>Google Apps for Work<ept id=\"p1\">](https://www.google.com/work/apps/)</ept> or <bpt id=\"p2\">[</bpt>Google Apps for Education<ept id=\"p2\">](https://www.google.com/edu/products/productivity-tools/)</ept>.",
      "pos": [
        1065,
        1244
      ]
    },
    {
      "content": "You may use a free trial account for either service.",
      "pos": [
        1245,
        1297
      ]
    },
    {
      "content": "Step 1: Add Google Apps to your Directory",
      "pos": [
        1301,
        1342
      ]
    },
    {
      "pos": [
        1347,
        1470
      ],
      "content": "In the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>, on the left navigation pane, click <bpt id=\"p2\">**</bpt>Active Directory<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Select Active Directory from the left navigation pane.",
      "pos": [
        1478,
        1532
      ]
    },
    {
      "pos": [
        1541,
        1633
      ],
      "content": "From the <bpt id=\"p1\">**</bpt>Directory<ept id=\"p1\">**</ept> list, select the directory that you would like to add Google Apps to."
    },
    {
      "pos": [
        1638,
        1680
      ],
      "content": "Click on <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> in the top menu."
    },
    {
      "content": "Click on Applications.",
      "pos": [
        1688,
        1710
      ]
    },
    {
      "pos": [
        1719,
        1759
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "Click Add to add a new application.",
      "pos": [
        1767,
        1802
      ]
    },
    {
      "pos": [
        1811,
        1899
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>What do you want to do<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Add an application from the gallery<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click Add an application from the gallery.",
      "pos": [
        1907,
        1949
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>search box<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>Google Apps<ept id=\"p2\">**</ept>.",
      "pos": [
        1958,
        2002
      ]
    },
    {
      "content": "Then select <bpt id=\"p1\">**</bpt>Google Apps<ept id=\"p1\">**</ept> from the results, and click <bpt id=\"p2\">**</bpt>Complete<ept id=\"p2\">**</ept> to add the application.",
      "pos": [
        2003,
        2095
      ]
    },
    {
      "content": "Add Google Apps.",
      "pos": [
        2103,
        2119
      ]
    },
    {
      "content": "You should now see the Quick Start page for Google Apps:",
      "pos": [
        2128,
        2184
      ]
    },
    {
      "content": "Google Apps' Quick Start page in Azure AD",
      "pos": [
        2192,
        2233
      ]
    },
    {
      "content": "Step 2: Enable Single Sign-On",
      "pos": [
        2241,
        2270
      ]
    },
    {
      "pos": [
        2275,
        2375
      ],
      "content": "In Azure AD, on the Quick Start page for Google Apps, click the <bpt id=\"p1\">**</bpt>Configure single sign-on<ept id=\"p1\">**</ept> button."
    },
    {
      "content": "The configure single sign-on button",
      "pos": [
        2383,
        2418
      ]
    },
    {
      "content": "A dialog will open and you'll see a screen that asks \"How would you like users to sign on to Google Apps?\"",
      "pos": [
        2427,
        2533
      ]
    },
    {
      "content": "Select <bpt id=\"p1\">**</bpt>Azure AD Single Sign-On<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.",
      "pos": [
        2534,
        2594
      ]
    },
    {
      "content": "Select Azure AD Single Sign-On",
      "pos": [
        2602,
        2632
      ]
    },
    {
      "pos": [
        2644,
        2832
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> To learn more about about the different single sign-on options, <bpt id=\"p1\">[</bpt>click here<ept id=\"p1\">](../active-directory-appssoaccess-whatis/#how-does-single-sign-on-with-azure-active-directory-work)</ept>"
    },
    {
      "pos": [
        2837,
        3012
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Configure App Settings<ept id=\"p1\">**</ept> page, for the <bpt id=\"p2\">**</bpt>Sign On URL<ept id=\"p2\">**</ept> field, type in your Google Apps tenant URL using the following format: <ph id=\"ph1\">`https://mail.google.com/a/&lt;yourdomain&gt;`</ph>"
    },
    {
      "content": "Type in your tenant URL",
      "pos": [
        3020,
        3043
      ]
    },
    {
      "pos": [
        3052,
        3204
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Configure single sign-on at Google Apps<ept id=\"p1\">**</ept> page, click on <bpt id=\"p2\">**</bpt>Download certificate<ept id=\"p2\">**</ept>, and then save the certificate file locally on your computer."
    },
    {
      "content": "Download the certificate.",
      "pos": [
        3212,
        3237
      ]
    },
    {
      "pos": [
        3246,
        3383
      ],
      "content": "Open a new tab in your browser, and sign into the <bpt id=\"p1\">[</bpt>Google Apps Admin Console<ept id=\"p1\">](http://admin.google.com/)</ept> using your administrator account."
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept>.",
      "pos": [
        3388,
        3407
      ]
    },
    {
      "content": "If you don't see the link, it may be hidden under the <bpt id=\"p1\">**</bpt>More Controls<ept id=\"p1\">**</ept> menu at the bottom of the screen.",
      "pos": [
        3408,
        3513
      ]
    },
    {
      "content": "Click Security.",
      "pos": [
        3521,
        3536
      ]
    },
    {
      "pos": [
        3546,
        3610
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Set up single sign-on (SSO).<ept id=\"p2\">**</ept>"
    },
    {
      "content": "Click SSO.",
      "pos": [
        3618,
        3628
      ]
    },
    {
      "content": "Perform the following configuration changes:",
      "pos": [
        3638,
        3682
      ]
    },
    {
      "content": "Configure SSO",
      "pos": [
        3690,
        3703
      ]
    },
    {
      "pos": [
        3716,
        3772
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Setup SSO with third party identity provider<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        3780,
        3898
      ],
      "content": "In Azure AD, copy the <bpt id=\"p1\">**</bpt>Single sign-on service URL<ept id=\"p1\">**</ept>, and paste it into the <bpt id=\"p2\">**</bpt>Sign-in page URL<ept id=\"p2\">**</ept> field in Google Apps."
    },
    {
      "pos": [
        3906,
        4026
      ],
      "content": "In Azure AD, copy the <bpt id=\"p1\">**</bpt>Single sign-out service URL<ept id=\"p1\">**</ept>, and paste it into the <bpt id=\"p2\">**</bpt>Sign-out page URL<ept id=\"p2\">**</ept> field in Google Apps."
    },
    {
      "pos": [
        4034,
        4148
      ],
      "content": "In Azure AD, copy the <bpt id=\"p1\">**</bpt>Change password URL<ept id=\"p1\">**</ept>, and paste it into the <bpt id=\"p2\">**</bpt>Change password URL<ept id=\"p2\">**</ept> field in Google Apps."
    },
    {
      "pos": [
        4156,
        4264
      ],
      "content": "In Google Apps, for the <bpt id=\"p1\">**</bpt>Verification certificate<ept id=\"p1\">**</ept>, upload the certificate that you downloaded in step #4."
    },
    {
      "pos": [
        4272,
        4295
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save Changes<ept id=\"p1\">**</ept>."
    },
    {
      "content": "In Azure AD, select the single sign-on configuration confirmation checkbox to enable the certificate that you uploaded to Google Apps.",
      "pos": [
        4300,
        4434
      ]
    },
    {
      "content": "Then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.",
      "pos": [
        4435,
        4455
      ]
    },
    {
      "content": "Check the confirmation checkbox",
      "pos": [
        4463,
        4494
      ]
    },
    {
      "content": "On the final page of the dialog, type in an email address if you would like to receive email notifications for errors and warnings related to the maintenance of this single sign-on configuration.",
      "pos": [
        4505,
        4700
      ]
    },
    {
      "content": "Type in your email address.",
      "pos": [
        4709,
        4736
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Complete<ept id=\"p1\">**</ept> to close the dialog.",
      "pos": [
        4747,
        4786
      ]
    },
    {
      "content": "To test your configuration, see the section below titled <bpt id=\"p1\">[</bpt>Assign Users to Google Apps<ept id=\"p1\">](#step-4-assign-users-to-google-apps)</ept>.",
      "pos": [
        4787,
        4911
      ]
    },
    {
      "content": "Step 3: Enable Automated User Provisioning",
      "pos": [
        4915,
        4957
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Another viable option for automating user provisioning to Google Apps is to use <bpt id=\"p1\">[</bpt>Google Apps Directory Sync (GADS)<ept id=\"p1\">](https://support.google.com/a/answer/106368?hl=en)</ept> which provisions your on-premises Active Directory identities to Google Apps.",
      "pos": [
        4961,
        5217
      ]
    },
    {
      "content": "In contrast, the solution in this tutorial provisions your Azure Active Directory (cloud) users and mail-enabled groups to Google Apps.",
      "pos": [
        5218,
        5353
      ]
    },
    {
      "content": "Sign into the <bpt id=\"p1\">[</bpt>Google Apps Admin Console<ept id=\"p1\">](http://admin.google.com/)</ept> using your administrator account, and click <bpt id=\"p2\">**</bpt>Security<ept id=\"p2\">**</ept>.",
      "pos": [
        5358,
        5483
      ]
    },
    {
      "content": "If you don't see the link, it may be hidden under the <bpt id=\"p1\">**</bpt>More Controls<ept id=\"p1\">**</ept> menu at the bottom of the screen.",
      "pos": [
        5484,
        5589
      ]
    },
    {
      "content": "Click Security.",
      "pos": [
        5597,
        5612
      ]
    },
    {
      "pos": [
        5622,
        5672
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>API Reference<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click API Reference.",
      "pos": [
        5680,
        5700
      ]
    },
    {
      "pos": [
        5710,
        5739
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Enable API access<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Click API Reference.",
      "pos": [
        5747,
        5767
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.IMPORTANT]</ph> For every user that you intend to provision to Google Apps, their username in Azure Active Directory <bpt id=\"p1\">*</bpt>must<ept id=\"p1\">*</ept> be tied to a custom domain.",
      "pos": [
        5780,
        5933
      ]
    },
    {
      "content": "For example, usernames that look like bob@contoso.onmicrosoft.com will not be accepted by Google Apps, whereas bob@contoso.com will be accepted.",
      "pos": [
        5934,
        6078
      ]
    },
    {
      "content": "You can change an existing user's domain by editing their properties in Azure AD.",
      "pos": [
        6079,
        6160
      ]
    },
    {
      "content": "Instructions for how to set a custom domain for both Azure Active Directory and Google Apps are included below.",
      "pos": [
        6161,
        6272
      ]
    },
    {
      "content": "If you haven't added a custom domain name to your Azure Active Directory yet, then follow the steps below:",
      "pos": [
        6277,
        6383
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>, on the left navigation pane, click <bpt id=\"p2\">**</bpt>Active Directory<ept id=\"p2\">**</ept>.",
      "pos": [
        6391,
        6514
      ]
    },
    {
      "content": "In the directory list, select your directory.",
      "pos": [
        6515,
        6560
      ]
    },
    {
      "pos": [
        6569,
        6657
      ],
      "content": "Click on <bpt id=\"p1\">**</bpt>Domains<ept id=\"p1\">**</ept> from the top-level menu, and then click on <bpt id=\"p2\">**</bpt>Add a custom domain<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Add a Custom Domain",
      "pos": [
        6669,
        6688
      ]
    },
    {
      "content": "Type your domain name into the <bpt id=\"p1\">**</bpt>Domain name<ept id=\"p1\">**</ept> field.",
      "pos": [
        6701,
        6754
      ]
    },
    {
      "content": "This should be the same domain name that you intend to use for Google Apps.",
      "pos": [
        6755,
        6830
      ]
    },
    {
      "content": "When ready, click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button.",
      "pos": [
        6831,
        6868
      ]
    },
    {
      "content": "Type in your domain name.",
      "pos": [
        6880,
        6905
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to go to the verification page.",
      "pos": [
        6918,
        6964
      ]
    },
    {
      "content": "To verify that you own this domain, you must edit the domain's DNS records according to the values provided on this page.",
      "pos": [
        6965,
        7086
      ]
    },
    {
      "content": "You may choose to verify using either <bpt id=\"p1\">**</bpt>MX records<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>TXT records<ept id=\"p2\">**</ept>, depending on what you select for the <bpt id=\"p3\">**</bpt>Record Type<ept id=\"p3\">**</ept> option.",
      "pos": [
        7087,
        7220
      ]
    },
    {
      "content": "For more comprehensive instructions on how to verify domain name with Azure AD, see <bpt id=\"p1\">[</bpt>Add your own domain name to Azure AD<ept id=\"p1\">](https://go.microsoft.com/fwLink/?LinkID=278919&amp;clcid=0x409)</ept>.",
      "pos": [
        7221,
        7404
      ]
    },
    {
      "content": "Verify your domain name.",
      "pos": [
        7416,
        7440
      ]
    },
    {
      "content": "Repeat the above steps for all of the domains that you intend to add to your directory.",
      "pos": [
        7453,
        7540
      ]
    },
    {
      "content": "Now that you have verified all of your domains with Azure AD, you must now verify them again with Google Apps.",
      "pos": [
        7545,
        7655
      ]
    },
    {
      "content": "For each domain that isn't already registered with Google Apps, perform the following steps:",
      "pos": [
        7656,
        7748
      ]
    },
    {
      "pos": [
        7756,
        7839
      ],
      "content": "In the <bpt id=\"p1\">[</bpt>Google Apps Admin Console<ept id=\"p1\">](http://admin.google.com/)</ept>, click on <bpt id=\"p2\">**</bpt>Domains<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click on Domains",
      "pos": [
        7851,
        7867
      ]
    },
    {
      "pos": [
        7880,
        7921
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Add a domain or a domain alias<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Add a new domain",
      "pos": [
        7933,
        7949
      ]
    },
    {
      "pos": [
        7962,
        8055
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Add another domain<ept id=\"p1\">**</ept>, and type in the name of the domain that you would like to add."
    },
    {
      "content": "Type in your domain name",
      "pos": [
        8067,
        8091
      ]
    },
    {
      "content": "Click on <bpt id=\"p1\">**</bpt>Continue and verify domain ownership<ept id=\"p1\">**</ept>.",
      "pos": [
        8104,
        8154
      ]
    },
    {
      "content": "Then follow the steps to verify that you own the domain name.",
      "pos": [
        8155,
        8216
      ]
    },
    {
      "content": "For comprehensive instructions on how to verify your domain with Google Apps, see <bpt id=\"p1\">[</bpt>Verify your site ownership with Google Apps<ept id=\"p1\">](https://support.google.com/webmasters/answer/35179)</ept>.",
      "pos": [
        8217,
        8397
      ]
    },
    {
      "content": "Repeat the above steps for any additional domains that you intend to add to Google Apps.",
      "pos": [
        8405,
        8493
      ]
    },
    {
      "pos": [
        8501,
        8754
      ],
      "content": "<ph id=\"ph1\">[AZURE.WARNING]</ph> If you change the primary domain for your Google Apps tenant, and if you have already configured single sign-on with Azure AD, then you will have to repeat step #3 under <bpt id=\"p1\">[</bpt>Step Two: Enable Single Sign-On<ept id=\"p1\">](#step-two-enable-single-sign-on)</ept>."
    },
    {
      "pos": [
        8759,
        8846
      ],
      "content": "In the <bpt id=\"p1\">[</bpt>Google Apps Admin Console<ept id=\"p1\">](http://admin.google.com/)</ept>, click on <bpt id=\"p2\">**</bpt>Admin Roles<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click on Google Apps",
      "pos": [
        8854,
        8874
      ]
    },
    {
      "content": "Determine which admin account you would like to use to manage user provisioning.",
      "pos": [
        8884,
        8964
      ]
    },
    {
      "content": "For the <bpt id=\"p1\">**</bpt>admin role<ept id=\"p1\">**</ept> of that account, edit the <bpt id=\"p2\">**</bpt>Privileges<ept id=\"p2\">**</ept> for that role.",
      "pos": [
        8965,
        9043
      ]
    },
    {
      "content": "Make sure it has all of the <bpt id=\"p1\">**</bpt>Admin API Privileges<ept id=\"p1\">**</ept> enabled so that this account can be used for provisioning.",
      "pos": [
        9044,
        9155
      ]
    },
    {
      "content": "Click on Google Apps",
      "pos": [
        9163,
        9183
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If you are configuring a production environment, the best practice is to create a new admin account in Google Apps specifically for this step.",
      "pos": [
        9196,
        9351
      ]
    },
    {
      "content": "These account must have an admin role associated with it that has the necessary API privileges.",
      "pos": [
        9352,
        9447
      ]
    },
    {
      "pos": [
        9452,
        9562
      ],
      "content": "In Azure Active Directory, click on <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> in the top-level menu, and then click on <bpt id=\"p2\">**</bpt>Google Apps<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click on Google Apps",
      "pos": [
        9570,
        9590
      ]
    },
    {
      "pos": [
        9600,
        9682
      ],
      "content": "On the Quick Start page for Google Apps, click on <bpt id=\"p1\">**</bpt>Configure user provisioning<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Configure user provisioning",
      "pos": [
        9690,
        9717
      ]
    },
    {
      "pos": [
        9728,
        9893
      ],
      "content": "In the dialog that opens, click on <bpt id=\"p1\">**</bpt>enable user provisioning<ept id=\"p1\">**</ept> to authenticate into the Google Apps Admin Account that you would like to use to manage provisioning."
    },
    {
      "content": "Enable provisioning",
      "pos": [
        9901,
        9920
      ]
    },
    {
      "content": "Confirm that you would like to give Azure Active Directory permission to make changes to your Google Apps tenant.",
      "pos": [
        9931,
        10044
      ]
    },
    {
      "content": "Confirm permissions.",
      "pos": [
        10052,
        10072
      ]
    },
    {
      "pos": [
        10083,
        10122
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Complete<ept id=\"p1\">**</ept> to close the dialog."
    },
    {
      "content": "Step 4: Assign Users to Google Apps",
      "pos": [
        10126,
        10161
      ]
    },
    {
      "content": "To test your configuration, start creating a new test account in the directory.",
      "pos": [
        10166,
        10245
      ]
    },
    {
      "pos": [
        10250,
        10324
      ],
      "content": "On the Google Apps Quick Start page, click on the <bpt id=\"p1\">**</bpt>Assign Users<ept id=\"p1\">**</ept> button."
    },
    {
      "content": "Click on Assign Users",
      "pos": [
        10332,
        10353
      ]
    },
    {
      "pos": [
        10363,
        10446
      ],
      "content": "Select your test user, and click the <bpt id=\"p1\">**</bpt>Assign<ept id=\"p1\">**</ept> button at the bottom of the screen:"
    },
    {
      "content": "If you haven't enable automated user provisioning, then you'll see the following prompt to confirm:",
      "pos": [
        10451,
        10550
      ]
    },
    {
      "content": "If you have enabled automated user provisioning, then you'll see a prompt to define what type of role the user should have in Google Apps.",
      "pos": [
        10595,
        10733
      ]
    },
    {
      "content": "Newly provisioned users should appear in your Google Apps environment after a few minutes.",
      "pos": [
        10734,
        10824
      ]
    },
    {
      "pos": [
        10829,
        11017
      ],
      "content": "To test your single sign-on settings, open the Access Panel at <bpt id=\"p1\">[</bpt>https://myapps.microsoft.com<ept id=\"p1\">](https://myapps.microsoft.com/)</ept>, then sign into the test account, and click on <bpt id=\"p2\">**</bpt>Google Apps<ept id=\"p2\">**</ept>."
    },
    {
      "content": "test",
      "pos": [
        13436,
        13440
      ]
    }
  ],
  "content": "<properties\n   pageTitle=\"Tutorial: Integrating Google Apps with Azure Active Directory | Microsoft Azure\"\n   description=\"Learn how to use Google Apps with Azure Active Directory to enable single sign-on, automated provisioning, and more!\"\n   services=\"active-directory\"\n   documentationCenter=\"\"\n   authors=\"liviodlc\"\n   manager=\"TerryLanfear\"\n   editor=\"\"/>\n\n<tags\n   ms.service=\"active-directory\"\n   ms.devlang=\"na\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"identity\"\n   ms.date=\"07/15/2015\"\n   ms.author=\"liviodlc\"/>\n\n#Tutorial: How to integrate Google Apps with Azure Active Directory\n\nThis tutorial will show you how to connect your Google Apps environment to your Azure Active Directory (Azure AD). You will learn how to configure single sign-on to Google Apps, how to enable automated user provisioning, and how to assign users to have access to Google Apps. \n\n##Prerequisites\n\n1. To access Azure Active Directory through the [Azure Management Portal](https://manage.windowsazure.com), you must first have a valid Azure subscription.\n\n2. You must have a valid tenant for [Google Apps for Work](https://www.google.com/work/apps/) or [Google Apps for Education](https://www.google.com/edu/products/productivity-tools/). You may use a free trial account for either service.\n\n##Step 1: Add Google Apps to your Directory\n\n1. In the [Azure Management Portal](https://manage.windowsazure.com), on the left navigation pane, click **Active Directory**.\n\n    ![Select Active Directory from the left navigation pane.][0]\n\n2. From the **Directory** list, select the directory that you would like to add Google Apps to.\n\n3. Click on **Applications** in the top menu.\n\n    ![Click on Applications.][1]\n\n4. Click **Add** at the bottom of the page.\n\n    ![Click Add to add a new application.][2]\n\n5. On the **What do you want to do** dialog, click **Add an application from the gallery**.\n\n    ![Click Add an application from the gallery.][3]\n\n6. In the **search box**, type **Google Apps**. Then select **Google Apps** from the results, and click **Complete** to add the application.\n\n    ![Add Google Apps.][4]\n\n7. You should now see the Quick Start page for Google Apps:\n\n    ![Google Apps' Quick Start page in Azure AD][5]\n\n##Step 2: Enable Single Sign-On\n\n1. In Azure AD, on the Quick Start page for Google Apps, click the **Configure single sign-on** button.\n\n    ![The configure single sign-on button][6]\n\n2. A dialog will open and you'll see a screen that asks \"How would you like users to sign on to Google Apps?\" Select **Azure AD Single Sign-On**, and then click **Next**.\n\n    ![Select Azure AD Single Sign-On][7]\n\n    > [AZURE.NOTE] To learn more about about the different single sign-on options, [click here](../active-directory-appssoaccess-whatis/#how-does-single-sign-on-with-azure-active-directory-work)\n\n3. On the **Configure App Settings** page, for the **Sign On URL** field, type in your Google Apps tenant URL using the following format: `https://mail.google.com/a/<yourdomain>`\n\n    ![Type in your tenant URL][8]\n\n4. On the **Configure single sign-on at Google Apps** page, click on **Download certificate**, and then save the certificate file locally on your computer.\n\n    ![Download the certificate.][9]\n\n5. Open a new tab in your browser, and sign into the [Google Apps Admin Console](http://admin.google.com/) using your administrator account.\n\n6. Click **Security**. If you don't see the link, it may be hidden under the **More Controls** menu at the bottom of the screen.\n\n    ![Click Security.][10]\n\n7. On the **Security** page, click **Set up single sign-on (SSO).**\n\n    ![Click SSO.][11]\n\n8. Perform the following configuration changes:\n\n    ![Configure SSO][12]\n\n    - Select **Setup SSO with third party identity provider**.\n\n    - In Azure AD, copy the **Single sign-on service URL**, and paste it into the **Sign-in page URL** field in Google Apps.\n\n    - In Azure AD, copy the **Single sign-out service URL**, and paste it into the **Sign-out page URL** field in Google Apps.\n\n    - In Azure AD, copy the **Change password URL**, and paste it into the **Change password URL** field in Google Apps.\n\n    - In Google Apps, for the **Verification certificate**, upload the certificate that you downloaded in step #4.\n\n    - Click **Save Changes**.\n\n9. In Azure AD, select the single sign-on configuration confirmation checkbox to enable the certificate that you uploaded to Google Apps. Then click **Next**.\n\n    ![Check the confirmation checkbox][13]\n\n10. On the final page of the dialog, type in an email address if you would like to receive email notifications for errors and warnings related to the maintenance of this single sign-on configuration. \n\n    ![Type in your email address.][14]\n\n11. Click **Complete** to close the dialog. To test your configuration, see the section below titled [Assign Users to Google Apps](#step-4-assign-users-to-google-apps).\n\n##Step 3: Enable Automated User Provisioning\n\n> [AZURE.NOTE] Another viable option for automating user provisioning to Google Apps is to use [Google Apps Directory Sync (GADS)](https://support.google.com/a/answer/106368?hl=en) which provisions your on-premises Active Directory identities to Google Apps. In contrast, the solution in this tutorial provisions your Azure Active Directory (cloud) users and mail-enabled groups to Google Apps.\n\n1. Sign into the [Google Apps Admin Console](http://admin.google.com/) using your administrator account, and click **Security**. If you don't see the link, it may be hidden under the **More Controls** menu at the bottom of the screen.\n\n    ![Click Security.][10]\n\n2. On the **Security** page, click **API Reference**.\n\n    ![Click API Reference.][15]\n\n3. Select **Enable API access**.\n\n    ![Click API Reference.][16]\n\n    > [AZURE.IMPORTANT] For every user that you intend to provision to Google Apps, their username in Azure Active Directory *must* be tied to a custom domain. For example, usernames that look like bob@contoso.onmicrosoft.com will not be accepted by Google Apps, whereas bob@contoso.com will be accepted. You can change an existing user's domain by editing their properties in Azure AD. Instructions for how to set a custom domain for both Azure Active Directory and Google Apps are included below.\n\n4. If you haven't added a custom domain name to your Azure Active Directory yet, then follow the steps below:\n\n    - In the [Azure Management Portal](https://manage.windowsazure.com), on the left navigation pane, click **Active Directory**. In the directory list, select your directory. \n\n    - Click on **Domains** from the top-level menu, and then click on **Add a custom domain**.\n\n        ![Add a Custom Domain][17]\n\n    - Type your domain name into the **Domain name** field. This should be the same domain name that you intend to use for Google Apps. When ready, click the **Add** button.\n\n        ![Type in your domain name.][18]\n\n    - Click **Next** to go to the verification page. To verify that you own this domain, you must edit the domain's DNS records according to the values provided on this page. You may choose to verify using either **MX records** or **TXT records**, depending on what you select for the **Record Type** option. For more comprehensive instructions on how to verify domain name with Azure AD, see [Add your own domain name to Azure AD](https://go.microsoft.com/fwLink/?LinkID=278919&clcid=0x409).\n\n        ![Verify your domain name.][19]\n\n    - Repeat the above steps for all of the domains that you intend to add to your directory.\n\n5. Now that you have verified all of your domains with Azure AD, you must now verify them again with Google Apps. For each domain that isn't already registered with Google Apps, perform the following steps:\n\n    - In the [Google Apps Admin Console](http://admin.google.com/), click on **Domains**.\n\n        ![Click on Domains][20]\n\n    - Click **Add a domain or a domain alias**.\n\n        ![Add a new domain][21]\n\n    - Select **Add another domain**, and type in the name of the domain that you would like to add.\n\n        ![Type in your domain name][22]\n\n    - Click on **Continue and verify domain ownership**. Then follow the steps to verify that you own the domain name. For comprehensive instructions on how to verify your domain with Google Apps, see [Verify your site ownership with Google Apps](https://support.google.com/webmasters/answer/35179).\n\n    - Repeat the above steps for any additional domains that you intend to add to Google Apps.\n\n    > [AZURE.WARNING] If you change the primary domain for your Google Apps tenant, and if you have already configured single sign-on with Azure AD, then you will have to repeat step #3 under [Step Two: Enable Single Sign-On](#step-two-enable-single-sign-on).\n\n6. In the [Google Apps Admin Console](http://admin.google.com/), click on **Admin Roles**.\n\n    ![Click on Google Apps][26]\n\n7. Determine which admin account you would like to use to manage user provisioning. For the **admin role** of that account, edit the **Privileges** for that role. Make sure it has all of the **Admin API Privileges** enabled so that this account can be used for provisioning.\n\n    ![Click on Google Apps][27]\n\n    > [AZURE.NOTE] If you are configuring a production environment, the best practice is to create a new admin account in Google Apps specifically for this step. These account must have an admin role associated with it that has the necessary API privileges.\n\n8. In Azure Active Directory, click on **Applications** in the top-level menu, and then click on **Google Apps**.\n\n    ![Click on Google Apps][23]\n\n9. On the Quick Start page for Google Apps, click on **Configure user provisioning**.\n\n    ![Configure user provisioning][24]\n\n10. In the dialog that opens, click on **enable user provisioning** to authenticate into the Google Apps Admin Account that you would like to use to manage provisioning.\n\n    ![Enable provisioning][25]\n\n11. Confirm that you would like to give Azure Active Directory permission to make changes to your Google Apps tenant.\n\n    ![Confirm permissions.][28]\n\n12. Click **Complete** to close the dialog.\n\n##Step 4: Assign Users to Google Apps\n\n1. To test your configuration, start creating a new test account in the directory.\n\n2. On the Google Apps Quick Start page, click on the **Assign Users** button.\n\n    ![Click on Assign Users][29]\n\n3. Select your test user, and click the **Assign** button at the bottom of the screen:\n\n - If you haven't enable automated user provisioning, then you'll see the following prompt to confirm:\n\n        ![Confirm the assignment.][30]\n\n - If you have enabled automated user provisioning, then you'll see a prompt to define what type of role the user should have in Google Apps. Newly provisioned users should appear in your Google Apps environment after a few minutes.\n\n4. To test your single sign-on settings, open the Access Panel at [https://myapps.microsoft.com](https://myapps.microsoft.com/), then sign into the test account, and click on **Google Apps**.\n\n[AZURE.INCLUDE [saas-toc](../../includes/active-directory-saas-toc.md)]\n\n[0]: ./media/active-directory-saas-google-apps-tutorial/azure-active-directory.png\n[1]: ./media/active-directory-saas-google-apps-tutorial/applications-tab.png\n[2]: ./media/active-directory-saas-google-apps-tutorial/add-app.png\n[3]: ./media/active-directory-saas-google-apps-tutorial/add-app-gallery.png\n[4]: ./media/active-directory-saas-google-apps-tutorial/add-gapps.png\n[5]: ./media/active-directory-saas-google-apps-tutorial/gapps-added.png\n[6]: ./media/active-directory-saas-google-apps-tutorial/config-sso.png\n[7]: ./media/active-directory-saas-google-apps-tutorial/sso-gapps.png\n[8]: ./media/active-directory-saas-google-apps-tutorial/sso-url.png\n[9]: ./media/active-directory-saas-google-apps-tutorial/download-cert.png\n[10]: ./media/active-directory-saas-google-apps-tutorial/gapps-security.png\n[11]: ./media/active-directory-saas-google-apps-tutorial/security-gapps.png\n[12]: ./media/active-directory-saas-google-apps-tutorial/gapps-sso-config.png\n[13]: ./media/active-directory-saas-google-apps-tutorial/gapps-sso-confirm.png\n[14]: ./media/active-directory-saas-google-apps-tutorial/gapps-sso-email.png\n[15]: ./media/active-directory-saas-google-apps-tutorial/gapps-api.png\n[16]: ./media/active-directory-saas-google-apps-tutorial/gapps-api-enabled.png\n[17]: ./media/active-directory-saas-google-apps-tutorial/add-custom-domain.png\n[18]: ./media/active-directory-saas-google-apps-tutorial/specify-domain.png\n[19]: ./media/active-directory-saas-google-apps-tutorial/verify-domain.png\n[20]: ./media/active-directory-saas-google-apps-tutorial/gapps-domains.png\n[21]: ./media/active-directory-saas-google-apps-tutorial/gapps-add-domain.png\n[22]: ./media/active-directory-saas-google-apps-tutorial/gapps-add-another.png\n[23]: ./media/active-directory-saas-google-apps-tutorial/apps-gapps.png\n[24]: ./media/active-directory-saas-google-apps-tutorial/gapps-provisioning.png\n[25]: ./media/active-directory-saas-google-apps-tutorial/gapps-provisioning-auth.png\n[26]: ./media/active-directory-saas-google-apps-tutorial/gapps-admin.png\n[27]: ./media/active-directory-saas-google-apps-tutorial/gapps-admin-privileges.png\n[28]: ./media/active-directory-saas-google-apps-tutorial/gapps-auth.png\n[29]: ./media/active-directory-saas-google-apps-tutorial/assign-users.png\n[30]: ./media/active-directory-saas-google-apps-tutorial/assign-confirm.png\n\ntest\n"
}