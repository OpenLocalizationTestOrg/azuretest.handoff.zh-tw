{
  "nodes": [
    {
      "content": "Traffic Manager Monitoring",
      "pos": [
        27,
        53
      ]
    },
    {
      "content": "This article will help undertstand and configure Traffic Manager monitoring",
      "pos": [
        71,
        146
      ]
    },
    {
      "content": "About Traffic Manager Monitoring",
      "pos": [
        461,
        493
      ]
    },
    {
      "content": "Azure Traffic Manager monitors your endpoints, including cloud services and websites, to ensure they are available.",
      "pos": [
        495,
        610
      ]
    },
    {
      "content": "In order for monitoring to work correctly, you must set it up the same way for every endpoint that you specify in your Traffic Manager profile.",
      "pos": [
        611,
        754
      ]
    },
    {
      "content": "After you configure monitoring, Traffic Manager will display the status for your endpoints and profile in the Management Portal.",
      "pos": [
        755,
        883
      ]
    },
    {
      "content": "You can configure monitoring settings in the Management Portal on the Configure page for your Traffic Manager profile.",
      "pos": [
        884,
        1002
      ]
    },
    {
      "content": "You can specify the following settings:",
      "pos": [
        1003,
        1042
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Protocol<ept id=\"p1\">**</ept> – Choose HTTP or HTTPS.",
      "pos": [
        1046,
        1082
      ]
    },
    {
      "content": "It’s important to note that HTTPS monitoring does not verify whether your SSL certificate is valid, it only checks that certificate is present.",
      "pos": [
        1083,
        1226
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Port<ept id=\"p1\">**</ept> – Choose the port used for the request.",
      "pos": [
        1230,
        1278
      ]
    },
    {
      "content": "Standard HTTP and HTTPS ports are among the choices.",
      "pos": [
        1279,
        1331
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Relative path and file name<ept id=\"p1\">**</ept> – Give the path and the name of the file that the monitoring system will attempt to access.",
      "pos": [
        1335,
        1458
      ]
    },
    {
      "content": "Note that a forward slash \"/\" is a valid entry for the relative path and implies that the file is in the root directory (default).",
      "pos": [
        1459,
        1589
      ]
    },
    {
      "content": "About monitoring health status",
      "pos": [
        1595,
        1625
      ]
    },
    {
      "content": "Azure Traffic Manager displays profile and endpoint service health in the Management Portal.",
      "pos": [
        1627,
        1719
      ]
    },
    {
      "content": "The status column for both the profile and the endpoint displays the most recent monitor status.",
      "pos": [
        1720,
        1816
      ]
    },
    {
      "content": "You can use this status to understand the health of your profiles according to your Traffic Manager monitoring settings.",
      "pos": [
        1817,
        1937
      ]
    },
    {
      "content": "When your profile is healthy, DNS queries will be distributed to your services based on the traffic routing settings for the profile (Round Robin, Performance, or Failover).",
      "pos": [
        1938,
        2111
      ]
    },
    {
      "content": "Once the Traffic Manager monitoring system detects a change in monitor status, it updates the status entry in the Management Portal.",
      "pos": [
        2112,
        2244
      ]
    },
    {
      "content": "It can take up to five minutes for the state change to refresh.",
      "pos": [
        2245,
        2308
      ]
    },
    {
      "content": "Endpoint Monitor status",
      "pos": [
        2314,
        2337
      ]
    },
    {
      "content": "The Endpoint Monitor status in the table below is the result of a combination of the endpoint health probe results and your profile and endpoint configurations.",
      "pos": [
        2339,
        2499
      ]
    },
    {
      "content": "Profile status",
      "pos": [
        2502,
        2516
      ]
    },
    {
      "content": "Endpoint status",
      "pos": [
        2517,
        2532
      ]
    },
    {
      "content": "Endpoint Monitor status (API and Portal)",
      "pos": [
        2533,
        2573
      ]
    },
    {
      "content": "Notes",
      "pos": [
        2574,
        2579
      ]
    },
    {
      "content": "Disabled",
      "pos": [
        2600,
        2608
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        2609,
        2616
      ]
    },
    {
      "content": "Inactive",
      "pos": [
        2617,
        2625
      ]
    },
    {
      "content": "Disabled profiles are not monitored.",
      "pos": [
        2626,
        2662
      ]
    },
    {
      "content": "However, the endpoint status within disabled profiles can still be managed.",
      "pos": [
        2663,
        2738
      ]
    },
    {
      "content": "&amp;lt;any&amp;gt;",
      "pos": [
        2741,
        2752
      ]
    },
    {
      "content": "Disabled",
      "pos": [
        2753,
        2761
      ]
    },
    {
      "content": "Disabled",
      "pos": [
        2762,
        2770
      ]
    },
    {
      "content": "Disabled profiles are not monitored.",
      "pos": [
        2771,
        2807
      ]
    },
    {
      "content": "However, the endpoint status within disabled profiles can still be managed.",
      "pos": [
        2808,
        2883
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        2886,
        2893
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        2894,
        2901
      ]
    },
    {
      "content": "Online",
      "pos": [
        2902,
        2908
      ]
    },
    {
      "content": "Endpoint is monitored and is healthy.",
      "pos": [
        2909,
        2946
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        2949,
        2956
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        2957,
        2964
      ]
    },
    {
      "content": "Degraded",
      "pos": [
        2965,
        2973
      ]
    },
    {
      "content": "Endpoint is monitored and is unhealthy.",
      "pos": [
        2974,
        3013
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3016,
        3023
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3024,
        3031
      ]
    },
    {
      "content": "CheckingEndpoint",
      "pos": [
        3032,
        3048
      ]
    },
    {
      "content": "Endpoint is monitored but the results of the first probe have not yet been received.",
      "pos": [
        3049,
        3133
      ]
    },
    {
      "content": "This state is temporary when you’ve just added a new endpoint to the profile, or have just enabled an endpoint or profile.",
      "pos": [
        3134,
        3256
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3259,
        3266
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3267,
        3274
      ]
    },
    {
      "content": "Stopped",
      "pos": [
        3275,
        3282
      ]
    },
    {
      "content": "The underlying cloud service or website is not running.",
      "pos": [
        3283,
        3338
      ]
    },
    {
      "content": "Profile Monitor status",
      "pos": [
        3345,
        3367
      ]
    },
    {
      "content": "The Profile Monitor status in the table below is the result of the combination of the endpoint monitor status and your configured profile status.",
      "pos": [
        3369,
        3514
      ]
    },
    {
      "content": "Profile status (as configured)",
      "pos": [
        3517,
        3547
      ]
    },
    {
      "content": "Endpoint Monitor status",
      "pos": [
        3548,
        3571
      ]
    },
    {
      "content": "Profile Monitor status (API and Portal)",
      "pos": [
        3572,
        3611
      ]
    },
    {
      "content": "Notes",
      "pos": [
        3612,
        3617
      ]
    },
    {
      "content": "Disabled",
      "pos": [
        3638,
        3646
      ]
    },
    {
      "content": "&amp;lt;any&amp;gt; or a profile with no defined endpoints.",
      "pos": [
        3647,
        3698
      ]
    },
    {
      "content": "Disabled",
      "pos": [
        3699,
        3707
      ]
    },
    {
      "content": "Endpoints are not monitored.",
      "pos": [
        3708,
        3736
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3739,
        3746
      ]
    },
    {
      "content": "The status of at least one endpoint is “Degraded”.",
      "pos": [
        3747,
        3797
      ]
    },
    {
      "content": "Degraded",
      "pos": [
        3798,
        3806
      ]
    },
    {
      "content": "This is a flag that customer action is required.",
      "pos": [
        3807,
        3855
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        3858,
        3865
      ]
    },
    {
      "content": "The status of at least one endpoint is “Online”.",
      "pos": [
        3866,
        3914
      ]
    },
    {
      "content": "No endpoints are “Degraded”.",
      "pos": [
        3915,
        3943
      ]
    },
    {
      "content": "Online",
      "pos": [
        3944,
        3950
      ]
    },
    {
      "content": "The service is accepting traffic and customer action is not required.",
      "pos": [
        3951,
        4020
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        4023,
        4030
      ]
    },
    {
      "content": "The status of at least one endpoint is “CheckingEndpoint”.",
      "pos": [
        4031,
        4089
      ]
    },
    {
      "content": "No endpoints are “Online” or “Degraded”.",
      "pos": [
        4090,
        4130
      ]
    },
    {
      "content": "CheckingEndpoints",
      "pos": [
        4131,
        4148
      ]
    },
    {
      "content": "Transition state.",
      "pos": [
        4149,
        4166
      ]
    },
    {
      "content": "This typically occurs when a profile has just been enabled and the endpoint health is being probed.",
      "pos": [
        4167,
        4266
      ]
    },
    {
      "content": "Enabled",
      "pos": [
        4269,
        4276
      ]
    },
    {
      "content": "The status of all endpoints defined in the profile is either “Disabled” or “Stopped”, or the profile has no defined endpoints.",
      "pos": [
        4277,
        4403
      ]
    },
    {
      "content": "Inactive",
      "pos": [
        4404,
        4412
      ]
    },
    {
      "content": "No endpoints are active, but the profile is still enabled.",
      "pos": [
        4413,
        4471
      ]
    },
    {
      "content": "How monitoring works",
      "pos": [
        4477,
        4497
      ]
    },
    {
      "content": "An example timeline illustrating the monitoring process with a single cloud service is displayed is below.",
      "pos": [
        4499,
        4605
      ]
    },
    {
      "content": "This scenario shows the following:",
      "pos": [
        4606,
        4640
      ]
    },
    {
      "content": "The cloud service is available and receiving traffic via this Traffic Manager profile ONLY.",
      "pos": [
        4644,
        4735
      ]
    },
    {
      "content": "The cloud service becomes unavailable.",
      "pos": [
        4739,
        4777
      ]
    },
    {
      "content": "The cloud service remains unavailable for a time much longer than the DNS Time-to-Live (TTL).",
      "pos": [
        4781,
        4874
      ]
    },
    {
      "content": "The cloud service becomes available again.",
      "pos": [
        4878,
        4920
      ]
    },
    {
      "content": "The cloud service resumes receiving traffic via this Traffic Manager profile ONLY.",
      "pos": [
        4924,
        5006
      ]
    },
    {
      "content": "Traffic Manager Monitoring Sequence",
      "pos": [
        5010,
        5045
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Figure 1<ept id=\"p1\">**</ept> – Monitoring sequence example.",
      "pos": [
        5097,
        5140
      ]
    },
    {
      "content": "The numbers in the diagram correspond to the numbered explanation below.",
      "pos": [
        5141,
        5213
      ]
    },
    {
      "pos": [
        5218,
        5343
      ],
      "content": "<bpt id=\"p1\">**</bpt>GET<ept id=\"p1\">**</ept> – The Traffic Manager monitoring system performs a GET on the path and file you specified in the monitoring settings."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>200 OK<ept id=\"p1\">**</ept> – The monitoring system expects an HTTP 200 OK message back within 10 seconds.",
      "pos": [
        5347,
        5436
      ]
    },
    {
      "content": "When it receives this response, it assumes that the cloud service is available.",
      "pos": [
        5437,
        5516
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Traffic Manager only considers an endpoint to be Online if the return message is a 200 OK.",
      "pos": [
        5520,
        5623
      ]
    },
    {
      "content": "If a non-200 response is received, it will assume the endpoint is not available and will count this as a failed check.",
      "pos": [
        5624,
        5742
      ]
    },
    {
      "content": "More details about troubleshooting failed checks see <bpt id=\"p1\">[</bpt>Troubleshooting degraded status on Azure Traffic Manager<ept id=\"p1\">](traffic-manager-troubleshooting-degraded.md)</ept>.",
      "pos": [
        5743,
        5900
      ]
    },
    {
      "pos": [
        5905,
        5983
      ],
      "content": "<bpt id=\"p1\">**</bpt>30 seconds between checks<ept id=\"p1\">**</ept> – This check will be performed every 30 seconds."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Cloud service unavailable<ept id=\"p1\">**</ept> – The cloud service becomes unavailable.",
      "pos": [
        5987,
        6057
      ]
    },
    {
      "content": "Traffic Manager will not know until the next monitor check.",
      "pos": [
        6058,
        6117
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Attempts to access monitoring file (4 tries)<ept id=\"p1\">**</ept> – The monitoring system performs a GET, but does not receive a response in 10 seconds or less.",
      "pos": [
        6121,
        6264
      ]
    },
    {
      "content": "It then performs three more tries at 30 second intervals.",
      "pos": [
        6265,
        6322
      ]
    },
    {
      "content": "This means that at most, it takes approximately 1.5 minutes for the monitoring system to detect when a service becomes unavailable.",
      "pos": [
        6323,
        6454
      ]
    },
    {
      "content": "If one of the tries is successful, then the number of tries is reset.",
      "pos": [
        6455,
        6524
      ]
    },
    {
      "content": "Although not shown in the diagram, if the 200 OK message(s) come back more than 10 seconds after the GET, the monitoring system will still count this as a failed check.",
      "pos": [
        6525,
        6693
      ]
    },
    {
      "pos": [
        6697,
        6828
      ],
      "content": "<bpt id=\"p1\">**</bpt>Marked degraded<ept id=\"p1\">**</ept> – After the fourth failure in a row, the monitoring system will mark the unavailable cloud service as Degraded."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Traffic to cloud service decreases<ept id=\"p1\">**</ept> – Traffic may continue to flow to the unavailable cloud service.",
      "pos": [
        6834,
        6937
      ]
    },
    {
      "content": "Clients will experience failures because the service is unavailable.",
      "pos": [
        6938,
        7006
      ]
    },
    {
      "content": "Clients and secondary DNS servers have cached the DNS record for the IP address of the unavailable cloud service.",
      "pos": [
        7007,
        7120
      ]
    },
    {
      "content": "They continue to resolve the DNS name of the company domain to the IP address of the service.",
      "pos": [
        7121,
        7214
      ]
    },
    {
      "content": "In addition, secondary DNS servers may still hand out the DNS information of the unavailable service.",
      "pos": [
        7215,
        7316
      ]
    },
    {
      "content": "As clients and secondary DNS servers are updated, traffic to the IP address of the unavailable service will slow.",
      "pos": [
        7317,
        7430
      ]
    },
    {
      "content": "The monitoring system continues to perform checks at 30 second intervals.",
      "pos": [
        7431,
        7504
      ]
    },
    {
      "content": "In this example, the service does not respond and remains unavailable.",
      "pos": [
        7505,
        7575
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Traffic to cloud service stops<ept id=\"p1\">**</ept> – By this time, most DNS servers and clients should be updated and traffic to the unavailable service stops.",
      "pos": [
        7579,
        7722
      ]
    },
    {
      "content": "The maximum amount time before traffic completely stops is dependent on the TTL time.",
      "pos": [
        7723,
        7808
      ]
    },
    {
      "content": "The default DNS TTL is 300 seconds (5 minutes).",
      "pos": [
        7809,
        7856
      ]
    },
    {
      "content": "Using this value, clients stop using the service after 5 minutes.",
      "pos": [
        7857,
        7922
      ]
    },
    {
      "content": "The monitoring system continues to perform checks at 30 second intervals and the cloud service does not respond.",
      "pos": [
        7923,
        8035
      ]
    },
    {
      "pos": [
        8039,
        8208
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cloud service comes back online and receives traffic<ept id=\"p1\">**</ept> – The service becomes available, but Traffic Manager does not know until the monitoring system performs a check."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Traffic to service resumes<ept id=\"p1\">**</ept> - Traffic Manager sends a GET and receives a 200 OK in under 10 seconds.",
      "pos": [
        8213,
        8316
      ]
    },
    {
      "content": "It then begins to hand out the cloud service’s DNS name to DNS servers as they request updates.",
      "pos": [
        8317,
        8412
      ]
    },
    {
      "content": "As a result, traffic starts to flow to the service once again.",
      "pos": [
        8413,
        8475
      ]
    },
    {
      "content": "Child and parent endpoint status for nested profiles",
      "pos": [
        8480,
        8532
      ]
    },
    {
      "content": "The following table describes the behavior of Traffic Manager monitoring for child and parent profiles of a nested profile and the minChildEndpoints setting.",
      "pos": [
        8534,
        8691
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>What is Traffic Manager?<ept id=\"p1\">](traffic-manager-overview.md)</ept>.",
      "pos": [
        8692,
        8774
      ]
    },
    {
      "content": "Child Profile Monitor status",
      "pos": [
        8777,
        8805
      ]
    },
    {
      "content": "Parent Endpoint Monitor status",
      "pos": [
        8806,
        8836
      ]
    },
    {
      "content": "Notes",
      "pos": [
        8837,
        8842
      ]
    },
    {
      "content": "DisabledThis is due to the profile being disabled by you.",
      "pos": [
        8859,
        8916
      ]
    },
    {
      "content": "Stopped",
      "pos": [
        8917,
        8924
      ]
    },
    {
      "content": "The parent endpoint state is Stopped, not Disabled.",
      "pos": [
        8925,
        8976
      ]
    },
    {
      "content": "The Disabled state is reserved for indicating that you have disabled the endpoint in the parent profile.",
      "pos": [
        8977,
        9081
      ]
    },
    {
      "content": "DegradedAt least one is child endpoint is in a Degraded state.",
      "pos": [
        9084,
        9146
      ]
    },
    {
      "content": "Online state, if the number of Online endpoints in the child profile is at least the value of minChildEndpoints.CheckingEndpoint state, if the number of Online plus CheckingEndpoint endpoints in the child profile is at least the value of minChildEndpoints.Otherwise, in the Degraded state.",
      "pos": [
        9147,
        9436
      ]
    },
    {
      "content": "Traffic is routed to an endpoint of status CheckingEndpoint.If minChildEndpoints is set too high, the parent endpoint will always be degraded.",
      "pos": [
        9437,
        9579
      ]
    },
    {
      "content": "OnlineAt least one child is an Online state and none are in the Degraded state.",
      "pos": [
        9582,
        9661
      ]
    },
    {
      "content": "Same as above.",
      "pos": [
        9662,
        9676
      ]
    },
    {
      "content": "CheckingEndpointsAt least one is ‘CheckingEndpoint’; none are ‘Online’ or ‘Degraded’",
      "pos": [
        9680,
        9764
      ]
    },
    {
      "content": "Same as above.",
      "pos": [
        9765,
        9779
      ]
    },
    {
      "content": "InactiveAll endpoints are either Disabled or Stopped, or this is a profile with no endpoints",
      "pos": [
        9783,
        9875
      ]
    },
    {
      "content": "Stopped",
      "pos": [
        9876,
        9883
      ]
    },
    {
      "content": "To configure monitoring for a specific path and file name",
      "pos": [
        9890,
        9947
      ]
    },
    {
      "content": "Create a file with the same name on each endpoint you plan to include in your profile.",
      "pos": [
        9952,
        10038
      ]
    },
    {
      "content": "For each endpoint, use a web browser to test access to the file.",
      "pos": [
        10042,
        10106
      ]
    },
    {
      "content": "The URL consists of the domain name of the specific endpoint (the cloud service or website), the path to the file, and the file name.",
      "pos": [
        10107,
        10240
      ]
    },
    {
      "pos": [
        10245,
        10379
      ],
      "content": "In the Management Portal, under <bpt id=\"p1\">**</bpt>Monitoring Settings<ept id=\"p1\">**</ept>, in the <bpt id=\"p2\">**</bpt>Relative Path and File Name<ept id=\"p2\">**</ept> field, specify the path and file name."
    },
    {
      "pos": [
        10383,
        10481
      ],
      "content": "When you are finished making your configuration changes, click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "See Also",
      "pos": [
        10486,
        10494
      ]
    },
    {
      "content": "What is Traffic Manager?",
      "pos": [
        10497,
        10521
      ]
    },
    {
      "content": "About Traffic Manager traffic routing Methods",
      "pos": [
        10554,
        10599
      ]
    },
    {
      "content": "Cloud Services",
      "pos": [
        10646,
        10660
      ]
    },
    {
      "content": "Websites",
      "pos": [
        10713,
        10721
      ]
    },
    {
      "content": "Troubleshooting degraded status on Azure Traffic Manager",
      "pos": [
        10774,
        10830
      ]
    }
  ],
  "content": "<properties \n   pageTitle=\"Traffic Manager Monitoring\"\n   description=\"This article will help undertstand and configure Traffic Manager monitoring\"\n   services=\"traffic-manager\"\n   documentationCenter=\"\"\n   authors=\"joaoma\"\n   manager=\"adinah\"\n   editor=\"tysonn\" />\n<tags \n   ms.service=\"traffic-manager\"\n   ms.devlang=\"na\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"infrastructure-services\"\n   ms.date=\"08/19/2015\"\n   ms.author=\"joaoma\" />\n\n# About Traffic Manager Monitoring\n\nAzure Traffic Manager monitors your endpoints, including cloud services and websites, to ensure they are available. In order for monitoring to work correctly, you must set it up the same way for every endpoint that you specify in your Traffic Manager profile. After you configure monitoring, Traffic Manager will display the status for your endpoints and profile in the Management Portal. You can configure monitoring settings in the Management Portal on the Configure page for your Traffic Manager profile. You can specify the following settings:\n\n- **Protocol** – Choose HTTP or HTTPS. It’s important to note that HTTPS monitoring does not verify whether your SSL certificate is valid, it only checks that certificate is present.\n\n- **Port** – Choose the port used for the request. Standard HTTP and HTTPS ports are among the choices.\n\n- **Relative path and file name** – Give the path and the name of the file that the monitoring system will attempt to access. Note that a forward slash \"/\" is a valid entry for the relative path and implies that the file is in the root directory (default). \n\n## About monitoring health status\n\nAzure Traffic Manager displays profile and endpoint service health in the Management Portal. The status column for both the profile and the endpoint displays the most recent monitor status. You can use this status to understand the health of your profiles according to your Traffic Manager monitoring settings. When your profile is healthy, DNS queries will be distributed to your services based on the traffic routing settings for the profile (Round Robin, Performance, or Failover). Once the Traffic Manager monitoring system detects a change in monitor status, it updates the status entry in the Management Portal. It can take up to five minutes for the state change to refresh.\n\n### Endpoint Monitor status\n\nThe Endpoint Monitor status in the table below is the result of a combination of the endpoint health probe results and your profile and endpoint configurations.\n\n|Profile status|Endpoint status|Endpoint Monitor status (API and Portal)|Notes|\n|---|---|---|---|\n|Disabled|Enabled|Inactive|Disabled profiles are not monitored. However, the endpoint status within disabled profiles can still be managed.|\n|&lt;any&gt;|Disabled|Disabled|Disabled profiles are not monitored. However, the endpoint status within disabled profiles can still be managed.|\n|Enabled|Enabled|Online|Endpoint is monitored and is healthy.|\n|Enabled|Enabled|Degraded|Endpoint is monitored and is unhealthy.|\n|Enabled|Enabled|CheckingEndpoint|Endpoint is monitored but the results of the first probe have not yet been received. This state is temporary when you’ve just added a new endpoint to the profile, or have just enabled an endpoint or profile.|\n|Enabled|Enabled|Stopped|The underlying cloud service or website is not running.|\n\n### Profile Monitor status\n\nThe Profile Monitor status in the table below is the result of the combination of the endpoint monitor status and your configured profile status.\n\n|Profile status (as configured)|Endpoint Monitor status|Profile Monitor status (API and Portal)|Notes|\n|---|---|---|---|\n|Disabled|&lt;any&gt; or a profile with no defined endpoints.|Disabled|Endpoints are not monitored.|\n|Enabled|The status of at least one endpoint is “Degraded”.|Degraded|This is a flag that customer action is required.|\n|Enabled|The status of at least one endpoint is “Online”. No endpoints are “Degraded”.|Online|The service is accepting traffic and customer action is not required.|\n|Enabled|The status of at least one endpoint is “CheckingEndpoint”. No endpoints are “Online” or “Degraded”.|CheckingEndpoints|Transition state. This typically occurs when a profile has just been enabled and the endpoint health is being probed.|\n|Enabled|The status of all endpoints defined in the profile is either “Disabled” or “Stopped”, or the profile has no defined endpoints.|Inactive|No endpoints are active, but the profile is still enabled.|\n\n## How monitoring works\n\nAn example timeline illustrating the monitoring process with a single cloud service is displayed is below. This scenario shows the following:\n\n- The cloud service is available and receiving traffic via this Traffic Manager profile ONLY.\n\n- The cloud service becomes unavailable.\n\n- The cloud service remains unavailable for a time much longer than the DNS Time-to-Live (TTL).\n\n- The cloud service becomes available again.\n\n- The cloud service resumes receiving traffic via this Traffic Manager profile ONLY.\n\n![Traffic Manager Monitoring Sequence](./media/traffic-manager-monitoring/IC697947.jpg)\n\n**Figure 1** – Monitoring sequence example. The numbers in the diagram correspond to the numbered explanation below.\n\n1. **GET** – The Traffic Manager monitoring system performs a GET on the path and file you specified in the monitoring settings.\n2. **200 OK** – The monitoring system expects an HTTP 200 OK message back within 10 seconds. When it receives this response, it assumes that the cloud service is available. \n\n>[AZURE.NOTE] Traffic Manager only considers an endpoint to be Online if the return message is a 200 OK. If a non-200 response is received, it will assume the endpoint is not available and will count this as a failed check. More details about troubleshooting failed checks see [Troubleshooting degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).\n\n3. **30 seconds between checks** – This check will be performed every 30 seconds.\n4. **Cloud service unavailable** – The cloud service becomes unavailable. Traffic Manager will not know until the next monitor check.\n5. **Attempts to access monitoring file (4 tries)** – The monitoring system performs a GET, but does not receive a response in 10 seconds or less. It then performs three more tries at 30 second intervals. This means that at most, it takes approximately 1.5 minutes for the monitoring system to detect when a service becomes unavailable. If one of the tries is successful, then the number of tries is reset. Although not shown in the diagram, if the 200 OK message(s) come back more than 10 seconds after the GET, the monitoring system will still count this as a failed check.\n6. **Marked degraded** – After the fourth failure in a row, the monitoring system will mark the unavailable cloud service as Degraded. \n\n7. **Traffic to cloud service decreases** – Traffic may continue to flow to the unavailable cloud service. Clients will experience failures because the service is unavailable. Clients and secondary DNS servers have cached the DNS record for the IP address of the unavailable cloud service. They continue to resolve the DNS name of the company domain to the IP address of the service. In addition, secondary DNS servers may still hand out the DNS information of the unavailable service. As clients and secondary DNS servers are updated, traffic to the IP address of the unavailable service will slow. The monitoring system continues to perform checks at 30 second intervals. In this example, the service does not respond and remains unavailable.\n8. **Traffic to cloud service stops** – By this time, most DNS servers and clients should be updated and traffic to the unavailable service stops. The maximum amount time before traffic completely stops is dependent on the TTL time. The default DNS TTL is 300 seconds (5 minutes). Using this value, clients stop using the service after 5 minutes. The monitoring system continues to perform checks at 30 second intervals and the cloud service does not respond.\n9. **Cloud service comes back online and receives traffic** – The service becomes available, but Traffic Manager does not know until the monitoring system performs a check.\n10. **Traffic to service resumes** - Traffic Manager sends a GET and receives a 200 OK in under 10 seconds. It then begins to hand out the cloud service’s DNS name to DNS servers as they request updates. As a result, traffic starts to flow to the service once again.\n\n## Child and parent endpoint status for nested profiles\n\nThe following table describes the behavior of Traffic Manager monitoring for child and parent profiles of a nested profile and the minChildEndpoints setting. For more information, see [What is Traffic Manager?](traffic-manager-overview.md).\n\n|Child Profile Monitor status|Parent Endpoint Monitor status|Notes|\n|---|---|---|\n|DisabledThis is due to the profile being disabled by you.|Stopped|The parent endpoint state is Stopped, not Disabled. The Disabled state is reserved for indicating that you have disabled the endpoint in the parent profile.|\n|DegradedAt least one is child endpoint is in a Degraded state.|Online state, if the number of Online endpoints in the child profile is at least the value of minChildEndpoints.CheckingEndpoint state, if the number of Online plus CheckingEndpoint endpoints in the child profile is at least the value of minChildEndpoints.Otherwise, in the Degraded state.|Traffic is routed to an endpoint of status CheckingEndpoint.If minChildEndpoints is set too high, the parent endpoint will always be degraded.|\n|OnlineAt least one child is an Online state and none are in the Degraded state.|Same as above.||\n|CheckingEndpointsAt least one is ‘CheckingEndpoint’; none are ‘Online’ or ‘Degraded’|Same as above.||\n|InactiveAll endpoints are either Disabled or Stopped, or this is a profile with no endpoints|Stopped||\n\n## To configure monitoring for a specific path and file name\n\n1. Create a file with the same name on each endpoint you plan to include in your profile.\n2. For each endpoint, use a web browser to test access to the file. The URL consists of the domain name of the specific endpoint (the cloud service or website), the path to the file, and the file name. \n3. In the Management Portal, under **Monitoring Settings**, in the **Relative Path and File Name** field, specify the path and file name.\n4. When you are finished making your configuration changes, click **Save** at the bottom of the page.\n\n## See Also\n\n[What is Traffic Manager?](traffic-manager-overview.md)\n\n[About Traffic Manager traffic routing Methods](traffic-manager-load-balancing-methods.md)\n\n[Cloud Services](http://go.microsoft.com/fwlink/p/?LinkId=314074)\n\n[Websites](http://go.microsoft.com/fwlink/p/?LinkId=393327)\n\n[Troubleshooting degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md)\n "
}