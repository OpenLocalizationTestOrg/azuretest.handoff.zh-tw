{
  "nodes": [
    {
      "content": "Tutorial: Azure Active Directory integration with SAP HANA Cloud Platform | Microsoft Azure",
      "pos": [
        23,
        114
      ]
    },
    {
      "content": "Learn how to use SAP HANA Cloud Platform with Azure Active Directory to enable single sign-on, automated provisioning, and more!.",
      "pos": [
        129,
        258
      ]
    },
    {
      "content": "Tutorial: Azure Active Directory integration with SAP HANA Cloud Platform",
      "pos": [
        511,
        584
      ]
    },
    {
      "pos": [
        586,
        671
      ],
      "content": "<ph id=\"ph1\">[AZURE.TIP]</ph>For feedback, click <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=529793)</ept>."
    },
    {
      "content": "The objective of this tutorial is to show the integration of Azure and SAP HANA Cloud Platform.",
      "pos": [
        675,
        770
      ]
    },
    {
      "content": "The scenario outlined in this tutorial assumes that you already have the following items:",
      "pos": [
        773,
        862
      ]
    },
    {
      "content": "A valid Azure subscription",
      "pos": [
        868,
        894
      ]
    },
    {
      "content": "A SAP HANA Cloud Platform account",
      "pos": [
        899,
        932
      ]
    },
    {
      "pos": [
        936,
        1170
      ],
      "content": "After completing this tutorial, the Azure AD users you have assigned to SAP HANA Cloud Platform will be able to single sign into the application using the <bpt id=\"p1\">[</bpt>Introduction to the Access Panel<ept id=\"p1\">](https://msdn.microsoft.com/library/dn308586)</ept>"
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.IMPORTANT]</ph>You need to deploy your own application or subscribe to an application on your SAP HANA Cloud Platform account to test single sign on.",
      "pos": [
        1173,
        1324
      ]
    },
    {
      "content": "In this tutorial, an application is deployed in the account.",
      "pos": [
        1325,
        1385
      ]
    },
    {
      "content": "The scenario outlined in this tutorial consists of the following building blocks:",
      "pos": [
        1389,
        1470
      ]
    },
    {
      "content": "Enabling the application integration for SAP HANA Cloud Platform",
      "pos": [
        1476,
        1540
      ]
    },
    {
      "content": "Configuring single sign-on",
      "pos": [
        1545,
        1571
      ]
    },
    {
      "content": "Assigning a role to a user",
      "pos": [
        1576,
        1602
      ]
    },
    {
      "content": "Assigning users",
      "pos": [
        1607,
        1622
      ]
    },
    {
      "content": "Scenario",
      "pos": [
        1626,
        1634
      ]
    },
    {
      "content": "Enabling the application integration for SAP HANA Cloud Platform",
      "pos": [
        1726,
        1790
      ]
    },
    {
      "content": "The objective of this section is to outline how to enable the application integration for SAP HANA Cloud Platform.",
      "pos": [
        1794,
        1908
      ]
    },
    {
      "content": "To enable the application integration for SAP HANA Cloud Platform, perform the following steps:",
      "pos": [
        1913,
        2008
      ]
    },
    {
      "pos": [
        2014,
        2102
      ],
      "content": "In the Azure Management Portal, on the left navigation pane, click <bpt id=\"p1\">**</bpt>Active Directory<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Active Directory",
      "pos": [
        2110,
        2126
      ]
    },
    {
      "pos": [
        2229,
        2330
      ],
      "content": "From the <bpt id=\"p1\">**</bpt>Directory<ept id=\"p1\">**</ept> list, select the directory for which you want to enable directory integration."
    },
    {
      "pos": [
        2336,
        2429
      ],
      "content": "To open the applications view, in the directory view, click <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> in the top menu."
    },
    {
      "content": "Applications",
      "pos": [
        2437,
        2449
      ]
    },
    {
      "pos": [
        2548,
        2588
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> at the bottom of the page."
    },
    {
      "content": "Add application",
      "pos": [
        2596,
        2611
      ]
    },
    {
      "pos": [
        2713,
        2801
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>What do you want to do<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Add an application from the gallery<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Add an application from gallerry",
      "pos": [
        2809,
        2841
      ]
    },
    {
      "pos": [
        2960,
        3016
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>search box<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>SAP HANA Cloud Platform<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Application Gallery",
      "pos": [
        3024,
        3043
      ]
    },
    {
      "pos": [
        3149,
        3257
      ],
      "content": "In the results pane, select <bpt id=\"p1\">**</bpt>SAP HANA Cloud Platform<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Complete<ept id=\"p2\">**</ept> to add the application."
    },
    {
      "content": "SAP Hana",
      "pos": [
        3265,
        3273
      ]
    },
    {
      "content": "Configuring single sign-on",
      "pos": [
        3365,
        3391
      ]
    },
    {
      "content": "The objective of this section is to outline how to enable users to authenticate to SAP HANA Cloud Platform with their account in Azure AD using federation based on the SAML protocol.",
      "pos": [
        3395,
        3577
      ]
    },
    {
      "content": "As part of this procedure, you are required to upload a base-64 encoded certificate to your SAP HANA Cloud Platform tenant.",
      "pos": [
        3580,
        3703
      ]
    },
    {
      "content": "If you are not familiar with this procedure, see <bpt id=\"p1\">[</bpt>How to convert a binary certificate into a text file<ept id=\"p1\">](http://youtu.be/PlgrzUZ-Y1o)</ept>",
      "pos": [
        3706,
        3838
      ]
    },
    {
      "content": "To configure single sign-on, perform the following steps:",
      "pos": [
        3843,
        3900
      ]
    },
    {
      "pos": [
        3906,
        4079
      ],
      "content": "In the Azure AD portal, on the <bpt id=\"p1\">**</bpt>SAP HANA Cloud Platform<ept id=\"p1\">**</ept> application integration page, click <bpt id=\"p2\">**</bpt>Configure single sign-on<ept id=\"p2\">**</ept> to open the **Configure Single Sign On ** dialog."
    },
    {
      "content": "Configure single sign-on",
      "pos": [
        4087,
        4111
      ]
    },
    {
      "pos": [
        4222,
        4372
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>How would you like users to sign on to SAP HANA Cloud Platform<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Microsoft Azure AD Single Sign-On<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Configure Single Sign-On",
      "pos": [
        4380,
        4404
      ]
    },
    {
      "pos": [
        4515,
        4713
      ],
      "content": "In a different web browser window, sign on to the SAP HANA Cloud Platform Cockpit at https://account.\\&lt;landscape host\\&gt;.ondemand.com/cockpit (e.g.: <bpt id=\"p1\">*</bpt>https://account.hanatrial.ondemand.com/cockpit<ept id=\"p1\">*</ept>)."
    },
    {
      "pos": [
        4719,
        4743
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Trust<ept id=\"p1\">**</ept> tab."
    },
    {
      "content": "Trust",
      "pos": [
        4751,
        4756
      ]
    },
    {
      "content": "In trust management section, perform the following steps:",
      "pos": [
        4848,
        4905
      ]
    },
    {
      "content": "Get Metadata",
      "pos": [
        4913,
        4925
      ]
    },
    {
      "pos": [
        5028,
        5069
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Local Service Provider<ept id=\"p1\">**</ept> tab."
    },
    {
      "pos": [
        5078,
        5156
      ],
      "content": "To download the SAP HANA Cloud Platform metadata file, click <bpt id=\"p1\">**</bpt>Get Metadata<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        5162,
        5288
      ],
      "content": "In the Azure Active Directory portal, on the <bpt id=\"p1\">**</bpt>Configure App URL<ept id=\"p1\">**</ept> page, perform the following steps, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Configure App URL",
      "pos": [
        5296,
        5313
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Sign On URL<ept id=\"p1\">**</ept> textbox, type the URL used by your users to sign into your <bpt id=\"p2\">**</bpt>SAP HANA Cloud Platform<ept id=\"p2\">**</ept> application.",
      "pos": [
        5421,
        5543
      ]
    },
    {
      "content": "This is the account-specific URL of a protected resource in your SAP HANA Cloud Platform application.",
      "pos": [
        5544,
        5645
      ]
    },
    {
      "content": "The URL is based on the following pattern: <bpt id=\"p1\">*</bpt>https://\\&lt;applicationName\\&gt;\\&lt;accountName\\&gt;.\\&lt;landscape host\\&gt;.ondemand.com/\\&lt;path\\_to\\_protected\\_resource\\&gt;<ept id=\"p1\">*</ept> (e.g.: <bpt id=\"p2\">*</bpt>https://xleavep1941203872trial.hanatrial.ondemand.com/xleave<ept id=\"p2\">*</ept>)",
      "pos": [
        5646,
        5870
      ]
    },
    {
      "pos": [
        5881,
        5992
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>This is the URL in your SAP HANA Cloud Platform application that requires the user to authenticate."
    },
    {
      "pos": [
        6002,
        6118
      ],
      "content": "Open the downloaded SAP HANA Cloud Platform metadata file, and then locate the <bpt id=\"p1\">**</bpt>ns3:AssertionConsumerService<ept id=\"p1\">**</ept> tag."
    },
    {
      "pos": [
        6127,
        6246
      ],
      "content": "Copy the value of the <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> attribute, and then paste it into the <bpt id=\"p2\">**</bpt>SAP HANA Cloud Platform Reply URL<ept id=\"p2\">**</ept> textbox."
    },
    {
      "pos": [
        6252,
        6417
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Configure single sign-on at SAP HANA Cloud Platform<ept id=\"p1\">**</ept> page, to download your metadata, click <bpt id=\"p2\">**</bpt>Download metadata<ept id=\"p2\">**</ept>, and then save the file on your computer."
    },
    {
      "content": "Configure Single Sign-On",
      "pos": [
        6425,
        6449
      ]
    },
    {
      "pos": [
        6560,
        6671
      ],
      "content": "On the SAP HANA Cloud Platform Cockpit, in the <bpt id=\"p1\">**</bpt>Local Service Provider<ept id=\"p1\">**</ept> section, perform the following steps:"
    },
    {
      "content": "Trust Management",
      "pos": [
        6679,
        6695
      ]
    },
    {
      "pos": [
        6802,
        6817
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        6826,
        6871
      ],
      "content": "As <bpt id=\"p1\">**</bpt>Configuration Type<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        6880,
        6932
      ],
      "content": "As <bpt id=\"p1\">**</bpt>Local Provider Name<ept id=\"p1\">**</ept>, leave the default value."
    },
    {
      "pos": [
        6941,
        7039
      ],
      "content": "To generate a <bpt id=\"p1\">**</bpt>Signing Key<ept id=\"p1\">**</ept> and a <bpt id=\"p2\">**</bpt>Signing Certificate<ept id=\"p2\">**</ept> key pair, click <bpt id=\"p3\">**</bpt>Generate Key Pair<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        7048,
        7098
      ],
      "content": "As <bpt id=\"p1\">**</bpt>Principal Propagation<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Disabled<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        7107,
        7156
      ],
      "content": "As <bpt id=\"p1\">**</bpt>Force Authentication<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Disabled<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        7165,
        7180
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        7186,
        7280
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Trusted Identity Provider<ept id=\"p1\">**</ept> tab, and then click <bpt id=\"p2\">**</bpt>Add Trusted Identity Provider<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Trust Management",
      "pos": [
        7288,
        7304
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>To manage the list of trusted identity providers, you need to have chosen the Custom configuration type in the Local Service Provider section.",
      "pos": [
        7408,
        7562
      ]
    },
    {
      "content": "For Default configuration type, you have a non-editable and implicit trust to the SAP ID Service.",
      "pos": [
        7563,
        7660
      ]
    },
    {
      "content": "For None, you don't have any trust settings.",
      "pos": [
        7661,
        7705
      ]
    },
    {
      "pos": [
        7711,
        7803
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> tab, and then click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to upload the downloaded metadata file."
    },
    {
      "content": "Trust Management",
      "pos": [
        7811,
        7827
      ]
    },
    {
      "pos": [
        7931,
        8096
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> After uploading the metadata file, the values for <bpt id=\"p1\">**</bpt>Single Sign-on URL<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Single Logout URL<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Signing Certificate<ept id=\"p3\">**</ept> are populated automatically."
    },
    {
      "pos": [
        8102,
        8131
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Attributes<ept id=\"p1\">**</ept> tab."
    },
    {
      "pos": [
        8137,
        8192
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Attributes<ept id=\"p1\">**</ept> tab, perform the following steps:"
    },
    {
      "content": "Attributes",
      "pos": [
        8200,
        8210
      ]
    },
    {
      "pos": [
        8311,
        8403
      ],
      "content": "By clicking <bpt id=\"p1\">**</bpt>Add Assertion-Based Attribute<ept id=\"p1\">**</ept>, add the following assertion-based attributes:"
    },
    {
      "content": "Assertion Attribute",
      "pos": [
        8414,
        8433
      ]
    },
    {
      "content": "Principal Attribute",
      "pos": [
        8435,
        8454
      ]
    },
    {
      "content": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname",
      "pos": [
        8516,
        8579
      ]
    },
    {
      "content": "firstname",
      "pos": [
        8583,
        8592
      ]
    },
    {
      "content": "--------------------",
      "pos": [
        8593,
        8613
      ]
    },
    {
      "content": "--------------------",
      "pos": [
        8614,
        8634
      ]
    },
    {
      "content": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname",
      "pos": [
        8645,
        8706
      ]
    },
    {
      "content": "lastname",
      "pos": [
        8715,
        8723
      ]
    },
    {
      "content": "-----------",
      "pos": [
        8724,
        8735
      ]
    },
    {
      "content": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress",
      "pos": [
        8746,
        8812
      ]
    },
    {
      "content": "email",
      "pos": [
        8813,
        8818
      ]
    },
    {
      "pos": [
        8826,
        9069
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>The configuration of the Attributes depends on how the application(s) on HCP are developed, i.e. which attribute(s) they expect in the SAML response and under which name (Principal Attribute) they access this attribute in the code."
    },
    {
      "content": "a.",
      "pos": [
        9083,
        9085
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Default Attribute<ept id=\"p1\">**</ept> in the screenshot is just for illustration purposes.",
      "pos": [
        9087,
        9165
      ]
    },
    {
      "content": "It is not required to make the scenario work.",
      "pos": [
        9166,
        9211
      ]
    },
    {
      "content": "b.",
      "pos": [
        9225,
        9227
      ]
    },
    {
      "content": "The names and values for <bpt id=\"p1\">**</bpt>Principal Attribute<ept id=\"p1\">**</ept> shown in the screenshot depend on how the application is developed.",
      "pos": [
        9229,
        9345
      ]
    },
    {
      "content": "It is possible that your application requires different mappings.",
      "pos": [
        9346,
        9411
      ]
    },
    {
      "pos": [
        9417,
        9598
      ],
      "content": "In the Azure portal, on the <bpt id=\"p1\">**</bpt>Configure single sign-on at SAP HANA Cloud Platform<ept id=\"p1\">**</ept> dialogue page, select the single sign-on configuration confirmation, and then click <bpt id=\"p2\">**</bpt>Complete<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Configure Single Sign-On",
      "pos": [
        9606,
        9630
      ]
    },
    {
      "content": "As an optional step, you can configure assertion-based groups for your Azure Active Directory Identity Provider",
      "pos": [
        9739,
        9850
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>Using groups on SAP HANA Cloud Platform allows you to dynamically assign one or more users to one or more roles in your SAP HANA Cloud Platform applications, determined by values of attributes in the SAML 2.0 assertion.",
      "pos": [
        9853,
        10084
      ]
    },
    {
      "content": "For example, if the assertion contains the attribute \"<bpt id=\"p1\">*</bpt>contract=temporary<ept id=\"p1\">*</ept>\", you may want all affected users to be added to the group \"<bpt id=\"p2\">*</bpt>TEMPORARY<ept id=\"p2\">*</ept>\".",
      "pos": [
        10085,
        10233
      ]
    },
    {
      "content": "The group \"<bpt id=\"p1\">*</bpt>TEMPORARY<ept id=\"p1\">*</ept>\" may contain one or more roles from one or more applications deployed in your SAP HANA Cloud Platform account.",
      "pos": [
        10234,
        10367
      ]
    },
    {
      "content": "Use assertion-based groups if you want to mass-assign many users to one or more roles of applications in your SAP HANA Cloud Platform account.",
      "pos": [
        10373,
        10515
      ]
    },
    {
      "content": "If you only want to assign a single or small number of users to (a) specific role(s) we recommend assigning them directly in the “<bpt id=\"p1\">**</bpt>Authorizations<ept id=\"p1\">**</ept>” tab of the SAP HANA Cloud Platform cockpit.",
      "pos": [
        10516,
        10709
      ]
    },
    {
      "content": "Assigning a role to a user",
      "pos": [
        10713,
        10739
      ]
    },
    {
      "content": "In order to enable Azure AD users to log into SAP HANA Cloud Platform, you must assign roles in the SAP HANA Cloud Platform to them.",
      "pos": [
        10743,
        10875
      ]
    },
    {
      "content": "To assign a role to a user, perform the following steps:",
      "pos": [
        10880,
        10936
      ]
    },
    {
      "pos": [
        10942,
        10993
      ],
      "content": "Log in to your <bpt id=\"p1\">**</bpt>SAP HANA Cloud Platform<ept id=\"p1\">**</ept> cockpit."
    },
    {
      "content": "Perform the following steps:",
      "pos": [
        10999,
        11027
      ]
    },
    {
      "content": "Authorizations",
      "pos": [
        11035,
        11049
      ]
    },
    {
      "pos": [
        11154,
        11178
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Authorization<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        11187,
        11211
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Users<ept id=\"p1\">**</ept> tab."
    },
    {
      "pos": [
        11220,
        11275
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>User<ept id=\"p1\">**</ept> textbox, type the user’s email address."
    },
    {
      "pos": [
        11284,
        11330
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Assign<ept id=\"p1\">**</ept> to assign the user to a role."
    },
    {
      "pos": [
        11339,
        11354
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Assigning users",
      "pos": [
        11358,
        11373
      ]
    },
    {
      "content": "To test your configuration, you need to grant the Azure AD users you want to allow using your application access to it by assigning them.",
      "pos": [
        11377,
        11514
      ]
    },
    {
      "content": "To assign users to SAP HANA Cloud Platform, perform the following steps:",
      "pos": [
        11519,
        11591
      ]
    },
    {
      "content": "In the Azure AD portal, create a test account.",
      "pos": [
        11597,
        11643
      ]
    },
    {
      "pos": [
        11649,
        11737
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>SAP HANA Cloud Platform<ept id=\"p1\">**</ept> application integration page, click <bpt id=\"p2\">**</bpt>Assign users<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Assign Users",
      "pos": [
        11745,
        11757
      ]
    },
    {
      "pos": [
        11856,
        11947
      ],
      "content": "Select your test user, click <bpt id=\"p1\">**</bpt>Assign<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> to confirm your assignment."
    },
    {
      "content": "Yes",
      "pos": [
        11955,
        11958
      ]
    },
    {
      "content": "If you want to test your single sign-on settings, open the Access Panel.",
      "pos": [
        12046,
        12118
      ]
    },
    {
      "content": "For more details about the Access Panel, see <bpt id=\"p1\">[</bpt>Introduction to the Access Panel<ept id=\"p1\">](https://msdn.microsoft.com/library/dn308586)</ept>.",
      "pos": [
        12119,
        12244
      ]
    },
    {
      "content": "test",
      "pos": [
        12245,
        12249
      ]
    }
  ],
  "content": "<properties pageTitle=\"Tutorial: Azure Active Directory integration with SAP HANA Cloud Platform | Microsoft Azure\" description=\"Learn how to use SAP HANA Cloud Platform with Azure Active Directory to enable single sign-on, automated provisioning, and more!.\" services=\"active-directory\" authors=\"MarkusVi\"  documentationCenter=\"na\" manager=\"stevenpo\"/>\n<tags ms.service=\"active-directory\" ms.devlang=\"na\" ms.topic=\"article\" ms.tgt_pltfrm=\"na\" ms.workload=\"identity\" ms.date=\"08/01/2015\" ms.author=\"markvi\" />\n#Tutorial: Azure Active Directory integration with SAP HANA Cloud Platform\n>[AZURE.TIP]For feedback, click [here](http://go.microsoft.com/fwlink/?LinkId=529793).\n  \nThe objective of this tutorial is to show the integration of Azure and SAP HANA Cloud Platform.  \nThe scenario outlined in this tutorial assumes that you already have the following items:\n\n-   A valid Azure subscription\n-   A SAP HANA Cloud Platform account\n  \nAfter completing this tutorial, the Azure AD users you have assigned to SAP HANA Cloud Platform will be able to single sign into the application using the [Introduction to the Access Panel](https://msdn.microsoft.com/library/dn308586)\n\n>[AZURE.IMPORTANT]You need to deploy your own application or subscribe to an application on your SAP HANA Cloud Platform account to test single sign on. In this tutorial, an application is deployed in the account.\n  \nThe scenario outlined in this tutorial consists of the following building blocks:\n\n1.  Enabling the application integration for SAP HANA Cloud Platform\n2.  Configuring single sign-on\n3.  Assigning a role to a user\n4.  Assigning users\n\n![Scenario](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790795.png \"Scenario\")\n##Enabling the application integration for SAP HANA Cloud Platform\n  \nThe objective of this section is to outline how to enable the application integration for SAP HANA Cloud Platform.\n\n###To enable the application integration for SAP HANA Cloud Platform, perform the following steps:\n\n1.  In the Azure Management Portal, on the left navigation pane, click **Active Directory**.\n\n    ![Active Directory](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC700993.png \"Active Directory\")\n\n2.  From the **Directory** list, select the directory for which you want to enable directory integration.\n\n3.  To open the applications view, in the directory view, click **Applications** in the top menu.\n\n    ![Applications](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC700994.png \"Applications\")\n\n4.  Click **Add** at the bottom of the page.\n\n    ![Add application](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC749321.png \"Add application\")\n\n5.  On the **What do you want to do** dialog, click **Add an application from the gallery**.\n\n    ![Add an application from gallerry](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC749322.png \"Add an application from gallerry\")\n\n6.  In the **search box**, type **SAP HANA Cloud Platform**.\n\n    ![Application Gallery](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790796.png \"Application Gallery\")\n\n7.  In the results pane, select **SAP HANA Cloud Platform**, and then click **Complete** to add the application.\n\n    ![SAP Hana](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC793929.png \"SAP Hana\")\n##Configuring single sign-on\n  \nThe objective of this section is to outline how to enable users to authenticate to SAP HANA Cloud Platform with their account in Azure AD using federation based on the SAML protocol.  \nAs part of this procedure, you are required to upload a base-64 encoded certificate to your SAP HANA Cloud Platform tenant.  \nIf you are not familiar with this procedure, see [How to convert a binary certificate into a text file](http://youtu.be/PlgrzUZ-Y1o)\n\n###To configure single sign-on, perform the following steps:\n\n1.  In the Azure AD portal, on the **SAP HANA Cloud Platform** application integration page, click **Configure single sign-on** to open the **Configure Single Sign On ** dialog.\n\n    ![Configure single sign-on](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC778552.png \"Configure single sign-on\")\n\n2.  On the **How would you like users to sign on to SAP HANA Cloud Platform** page, select **Microsoft Azure AD Single Sign-On**, and then click **Next**.\n\n    ![Configure Single Sign-On](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790797.png \"Configure Single Sign-On\")\n\n3.  In a different web browser window, sign on to the SAP HANA Cloud Platform Cockpit at https://account.\\<landscape host\\>.ondemand.com/cockpit (e.g.: *https://account.hanatrial.ondemand.com/cockpit*).\n\n4.  Click the **Trust** tab.\n\n    ![Trust](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790800.png \"Trust\")\n\n5.  In trust management section, perform the following steps:\n\n    ![Get Metadata](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC793930.png \"Get Metadata\")\n\n    1.  Click the **Local Service Provider** tab.\n    2.  To download the SAP HANA Cloud Platform metadata file, click **Get Metadata**.\n\n6.  In the Azure Active Directory portal, on the **Configure App URL** page, perform the following steps, and then click **Next**.\n\n    ![Configure App URL](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790798.png \"Configure App URL\")\n\n    1.  In the **Sign On URL** textbox, type the URL used by your users to sign into your **SAP HANA Cloud Platform** application. This is the account-specific URL of a protected resource in your SAP HANA Cloud Platform application. The URL is based on the following pattern: *https://\\<applicationName\\>\\<accountName\\>.\\<landscape host\\>.ondemand.com/\\<path\\_to\\_protected\\_resource\\>* (e.g.: *https://xleavep1941203872trial.hanatrial.ondemand.com/xleave*)\n\n        >[AZURE.NOTE]This is the URL in your SAP HANA Cloud Platform application that requires the user to authenticate.\n\n    2.  Open the downloaded SAP HANA Cloud Platform metadata file, and then locate the **ns3:AssertionConsumerService** tag.\n    3.  Copy the value of the **Location** attribute, and then paste it into the **SAP HANA Cloud Platform Reply URL** textbox.\n\n7.  On the **Configure single sign-on at SAP HANA Cloud Platform** page, to download your metadata, click **Download metadata**, and then save the file on your computer.\n\n    ![Configure Single Sign-On](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790799.png \"Configure Single Sign-On\")\n\n8.  On the SAP HANA Cloud Platform Cockpit, in the **Local Service Provider** section, perform the following steps:\n\n    ![Trust Management](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC793931.png \"Trust Management\")\n\n    1.  Click **Edit**.\n    2.  As **Configuration Type**, select **Custom**.\n    3.  As **Local Provider Name**, leave the default value.\n    4.  To generate a **Signing Key** and a **Signing Certificate** key pair, click **Generate Key Pair**.\n    5.  As **Principal Propagation**, select **Disabled**.\n    6.  As **Force Authentication**, select **Disabled**.\n    7.  Click **Save**.\n\n9.  Click the **Trusted Identity Provider** tab, and then click **Add Trusted Identity Provider**.\n\n    ![Trust Management](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790802.png \"Trust Management\")\n\n    >[AZURE.NOTE]To manage the list of trusted identity providers, you need to have chosen the Custom configuration type in the Local Service Provider section. For Default configuration type, you have a non-editable and implicit trust to the SAP ID Service. For None, you don't have any trust settings.\n\n10. Click the **General** tab, and then click **Browse** to upload the downloaded metadata file.\n\n    ![Trust Management](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC793932.png \"Trust Management\")\n\n    >[AZURE.NOTE] After uploading the metadata file, the values for **Single Sign-on URL**, **Single Logout URL** and **Signing Certificate** are populated automatically.\n\n11. Click the **Attributes** tab.\n\n12. On the **Attributes** tab, perform the following steps:\n\n    ![Attributes](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790804.png \"Attributes\")\n\n    1.  By clicking **Add Assertion-Based Attribute**, add the following assertion-based attributes:\n\n        |Assertion Attribute| Principal Attribute|\n        |-------------------|--------------------|\n        |http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname|   firstname|--------------------|--------------------|\n        |http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname|        lastname|-----------|\n        |http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress|email|\n\n    >[AZURE.NOTE]The configuration of the Attributes depends on how the application(s) on HCP are developed, i.e. which attribute(s) they expect in the SAML response and under which name (Principal Attribute) they access this attribute in the code.\n    >  \n    >a.  The **Default Attribute** in the screenshot is just for illustration purposes. It is not required to make the scenario work.  \n    >\n    >b.  The names and values for **Principal Attribute** shown in the screenshot depend on how the application is developed. It is possible that your application requires different mappings.\n\n13. In the Azure portal, on the **Configure single sign-on at SAP HANA Cloud Platform** dialogue page, select the single sign-on configuration confirmation, and then click **Complete**.\n\n    ![Configure Single Sign-On](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC796933.png \"Configure Single Sign-On\")\n  \nAs an optional step, you can configure assertion-based groups for your Azure Active Directory Identity Provider\n\n>[AZURE.NOTE]Using groups on SAP HANA Cloud Platform allows you to dynamically assign one or more users to one or more roles in your SAP HANA Cloud Platform applications, determined by values of attributes in the SAML 2.0 assertion. For example, if the assertion contains the attribute \"*contract=temporary*\", you may want all affected users to be added to the group \"*TEMPORARY*\". The group \"*TEMPORARY*\" may contain one or more roles from one or more applications deployed in your SAP HANA Cloud Platform account.\n>  \n>Use assertion-based groups if you want to mass-assign many users to one or more roles of applications in your SAP HANA Cloud Platform account. If you only want to assign a single or small number of users to (a) specific role(s) we recommend assigning them directly in the “**Authorizations**” tab of the SAP HANA Cloud Platform cockpit.\n\n##Assigning a role to a user\n  \nIn order to enable Azure AD users to log into SAP HANA Cloud Platform, you must assign roles in the SAP HANA Cloud Platform to them.\n\n###To assign a role to a user, perform the following steps:\n\n1.  Log in to your **SAP HANA Cloud Platform** cockpit.\n\n2.  Perform the following steps:\n\n    ![Authorizations](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790805.png \"Authorizations\")\n\n    1.  Click **Authorization**.\n    2.  Click the **Users** tab.\n    3.  In the **User** textbox, type the user’s email address.\n    4.  Click **Assign** to assign the user to a role.\n    5.  Click **Save**.\n\n##Assigning users\n  \nTo test your configuration, you need to grant the Azure AD users you want to allow using your application access to it by assigning them.\n\n###To assign users to SAP HANA Cloud Platform, perform the following steps:\n\n1.  In the Azure AD portal, create a test account.\n\n2.  On the **SAP HANA Cloud Platform** application integration page, click **Assign users**.\n\n    ![Assign Users](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC790806.png \"Assign Users\")\n\n3.  Select your test user, click **Assign**, and then click **Yes** to confirm your assignment.\n\n    ![Yes](./media/active-directory-saas-sap-hana-cloud-platform-tutorial/IC767830.png \"Yes\")\n  \nIf you want to test your single sign-on settings, open the Access Panel. For more details about the Access Panel, see [Introduction to the Access Panel](https://msdn.microsoft.com/library/dn308586).\ntest\n"
}