{
  "nodes": [
    {
      "content": "PowerShell for StorSimple device management | Microsoft Azure",
      "pos": [
        27,
        88
      ]
    },
    {
      "content": "Learn how to use Windows PowerShell for StorSimple to manage your StorSimple device.",
      "pos": [
        106,
        190
      ]
    },
    {
      "content": "Use Windows PowerShell for StorSimple to administer your device",
      "pos": [
        487,
        550
      ]
    },
    {
      "content": "Overview",
      "pos": [
        555,
        563
      ]
    },
    {
      "content": "Windows PowerShell for StorSimple provides a command-line interface that you can use to manage your Microsoft Azure StorSimple device.",
      "pos": [
        565,
        699
      ]
    },
    {
      "content": "As the name suggests, it is a Windows PowerShell-based, command-line interface that is built in a constrained runspace.",
      "pos": [
        700,
        819
      ]
    },
    {
      "content": "From the perspective of the user at the command line, a constrained runspace appears as a restricted version of Windows PowerShell.",
      "pos": [
        820,
        951
      ]
    },
    {
      "content": "While maintaining some of the basic capabilities of Windows PowerShell, this interface has additional dedicated cmdlets that are geared towards managing your Microsoft Azure StorSimple device.",
      "pos": [
        952,
        1144
      ]
    },
    {
      "content": "This article describes the Windows PowerShell for StorSimple features, including how you can connect to this interface, and contains links to step-by-step procedures or workflows that you can perform using this interface.",
      "pos": [
        1147,
        1368
      ]
    },
    {
      "content": "The workflows include how to register your device, configure the network interface on your device, install updates that require the device to be in maintenance mode, change the device state, and troubleshoot any issues that you may experience.",
      "pos": [
        1369,
        1612
      ]
    },
    {
      "content": "After reading this article, you will be able to:",
      "pos": [
        1614,
        1662
      ]
    },
    {
      "content": "Connect to your StorSimple device using Windows PowerShell for StorSimple.",
      "pos": [
        1666,
        1740
      ]
    },
    {
      "content": "Administer your StorSimple device using Windows PowerShell for StorSimple.",
      "pos": [
        1744,
        1818
      ]
    },
    {
      "content": "Get help in Windows PowerShell for StorSimple.",
      "pos": [
        1822,
        1868
      ]
    },
    {
      "content": "Windows PowerShell for StorSimple cmdlets allow you to manage your StorSimple device from a serial console or remotely via Windows PowerShell remoting.",
      "pos": [
        1891,
        2042
      ]
    },
    {
      "content": "For more information about each of the individual cmdlets that can be used in this interface, go to <bpt id=\"p1\">[</bpt>cmdlet reference for Windows PowerShell for StorSimple<ept id=\"p1\">](https://technet.microsoft.com/library/dn688168.aspx)</ept>.",
      "pos": [
        2043,
        2253
      ]
    },
    {
      "content": "The Azure PowerShell StorSimple cmdlets are a different collection of cmdlets that allow you to automate StorSimple service-level and migration tasks from the command line.",
      "pos": [
        2258,
        2430
      ]
    },
    {
      "content": "For more information about the Azure PowerShell cmdlets for StorSimple, go to the <bpt id=\"p1\">[</bpt>Azure StorSimple cmdlet reference<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/dn920427.aspx)</ept>.",
      "pos": [
        2431,
        2605
      ]
    },
    {
      "content": "You can access the Windows PowerShell for StorSimple using one of the following methods:",
      "pos": [
        2607,
        2695
      ]
    },
    {
      "content": "Connect to StorSimple device serial console",
      "pos": [
        2700,
        2743
      ]
    },
    {
      "content": "Connect remotely to StorSimple using Windows PowerShell",
      "pos": [
        2825,
        2880
      ]
    },
    {
      "content": "Connect to Windows PowerShell for StorSimple via the device serial console",
      "pos": [
        2964,
        3038
      ]
    },
    {
      "content": "You can <bpt id=\"p1\">[</bpt>download PuTTY<ept id=\"p1\">](http://www.putty.org/)</ept> or similar terminal emulation software to connect to Windows PowerShell for StorSimple.",
      "pos": [
        3040,
        3175
      ]
    },
    {
      "content": "You need to configure PuTTY specifically to access the Microsoft Azure StorSimple device.",
      "pos": [
        3176,
        3265
      ]
    },
    {
      "content": "The following topics contain detailed steps about how to configure PuTTy and connect to the device.",
      "pos": [
        3266,
        3365
      ]
    },
    {
      "content": "Various menu options in the serial console are also explained.",
      "pos": [
        3366,
        3428
      ]
    },
    {
      "content": "About the serial console",
      "pos": [
        3434,
        3458
      ]
    },
    {
      "content": "When you access the Windows PowerShell interface of your StorSimple device through the serial console, a banner message is presented, followed by menu options.",
      "pos": [
        3460,
        3619
      ]
    },
    {
      "content": "The banner message contains basic StorSimple device information such as the model, name, installed software version, and status of the controller you are accessing.",
      "pos": [
        3622,
        3786
      ]
    },
    {
      "content": "The following image shows an example of a banner message.",
      "pos": [
        3787,
        3844
      ]
    },
    {
      "content": "Serial banner message",
      "pos": [
        3848,
        3869
      ]
    },
    {
      "pos": [
        3942,
        4068
      ],
      "content": "<ph id=\"ph1\">[AZURE.IMPORTANT]</ph> You can use the banner message to identify whether the controller you are connected to is Active or Passive."
    },
    {
      "content": "The following image shows the various runspace options that are available in the serial console menu.",
      "pos": [
        4071,
        4172
      ]
    },
    {
      "content": "Register your device 2",
      "pos": [
        4176,
        4198
      ]
    },
    {
      "content": "You can choose from the following settings:",
      "pos": [
        4268,
        4311
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Log in with full access<ept id=\"p1\">**</ept>",
      "pos": [
        4316,
        4343
      ]
    },
    {
      "content": "This option allows you to connect (with the proper credentials) to the <bpt id=\"p1\">**</bpt>SSAdminConsole<ept id=\"p1\">**</ept> runspace on the local controller.",
      "pos": [
        4344,
        4467
      ]
    },
    {
      "content": "(The local controller is the controller that you are currently accessing through the serial console of your StorSimple device.)",
      "pos": [
        4468,
        4595
      ]
    },
    {
      "content": "This option can also be used to allow Microsoft Support to access unrestricted runspace (a support session) to troubleshoot any possible device issues.",
      "pos": [
        4597,
        4748
      ]
    },
    {
      "content": "After you use option 1 to log on, you can allow the Microsoft Support engineer to access unrestricted runspace by running a specific cmdlet.",
      "pos": [
        4749,
        4889
      ]
    },
    {
      "content": "For details, refer to <bpt id=\"p1\">[</bpt>Start a support session<ept id=\"p1\">](storsimple-contact-microsoft-support.md#start-a-support-session-in-windows-powershell-for-storsimple)</ept>.",
      "pos": [
        4890,
        5040
      ]
    },
    {
      "content": "This option connects to a runspace on the local controller.",
      "pos": [
        5041,
        5100
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Log in to peer controller with full access<ept id=\"p1\">**</ept>",
      "pos": [
        5105,
        5151
      ]
    },
    {
      "content": "This option is the same as option 1, except that you can connect (with the proper credentials) to the <bpt id=\"p1\">**</bpt>SSAdminConsole<ept id=\"p1\">**</ept> runspace on the peer controller.",
      "pos": [
        5152,
        5305
      ]
    },
    {
      "content": "Because the StorSimple device is a high availability device with two controllers in an active-passive configuration, peer refers to the other controller in the device that you are accessing through the serial console).",
      "pos": [
        5306,
        5524
      ]
    },
    {
      "content": "Similar to option 1, this option can also be used to allow Microsoft Support to access unrestricted runspace on a peer controller.",
      "pos": [
        5525,
        5655
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Connect with limited access<ept id=\"p1\">**</ept>",
      "pos": [
        5660,
        5691
      ]
    },
    {
      "content": "This option is used to access Windows PowerShell interface in limited mode.",
      "pos": [
        5692,
        5767
      ]
    },
    {
      "content": "You are not prompted for access credentials.",
      "pos": [
        5768,
        5812
      ]
    },
    {
      "content": "This option connects to a more restricted runspace compared to options 1 and 2.",
      "pos": [
        5813,
        5892
      ]
    },
    {
      "content": "Some of the tasks that are available through option 1 that cannot be performed in this runspace are:",
      "pos": [
        5894,
        5994
      ]
    },
    {
      "content": "Reset to the factory settings",
      "pos": [
        6002,
        6031
      ]
    },
    {
      "content": "Change the password",
      "pos": [
        6038,
        6057
      ]
    },
    {
      "content": "Enable or disable support access",
      "pos": [
        6064,
        6096
      ]
    },
    {
      "content": "Apply updates",
      "pos": [
        6103,
        6116
      ]
    },
    {
      "content": "Install hotfixes",
      "pos": [
        6123,
        6139
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Change language<ept id=\"p1\">**</ept>",
      "pos": [
        6344,
        6363
      ]
    },
    {
      "content": "This option allows you to change the display language on the Windows PowerShell interface.",
      "pos": [
        6364,
        6454
      ]
    },
    {
      "content": "The languages supported are English, Japanese, Russian, French, South Korean, Spanish, Italian, German, Chinese, and Brazilian Portuguese.",
      "pos": [
        6455,
        6593
      ]
    },
    {
      "content": "Make sure that you use the following PuTTY settings to connect to the Windows PowerShell interface from the serial console.",
      "pos": [
        6595,
        6718
      ]
    },
    {
      "content": "To configure PuTTY",
      "pos": [
        6725,
        6743
      ]
    },
    {
      "pos": [
        6748,
        6835
      ],
      "content": "In the PuTTY Reconfiguration dialog box, in the <bpt id=\"p1\">**</bpt>Category<ept id=\"p1\">**</ept> pane, select <bpt id=\"p2\">**</bpt>Keyboard<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Make sure that the following options are selected (these are the default settings when you start a new session).",
      "pos": [
        6840,
        6952
      ]
    },
    {
      "content": "Keyboard item",
      "pos": [
        6960,
        6973
      ]
    },
    {
      "content": "Select",
      "pos": [
        6974,
        6980
      ]
    },
    {
      "content": "Backspace key",
      "pos": [
        7001,
        7014
      ]
    },
    {
      "content": "Control-?",
      "pos": [
        7015,
        7024
      ]
    },
    {
      "content": "(127)",
      "pos": [
        7025,
        7030
      ]
    },
    {
      "content": "Home and End keys",
      "pos": [
        7037,
        7054
      ]
    },
    {
      "content": "Standard",
      "pos": [
        7055,
        7063
      ]
    },
    {
      "content": "Function keys and keypad",
      "pos": [
        7070,
        7094
      ]
    },
    {
      "content": "ESC[n~",
      "pos": [
        7095,
        7101
      ]
    },
    {
      "content": "Initial state of cursor keys",
      "pos": [
        7108,
        7136
      ]
    },
    {
      "content": "Normal",
      "pos": [
        7137,
        7143
      ]
    },
    {
      "content": "Initial state of numeric keypad",
      "pos": [
        7150,
        7181
      ]
    },
    {
      "content": "Normal",
      "pos": [
        7182,
        7188
      ]
    },
    {
      "content": "Enable extra keyboard features",
      "pos": [
        7195,
        7225
      ]
    },
    {
      "content": "Control-Alt is different from AltGr",
      "pos": [
        7226,
        7261
      ]
    },
    {
      "content": "Supported Putty Settings",
      "pos": [
        7270,
        7294
      ]
    },
    {
      "pos": [
        7367,
        7383
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        7388,
        7437
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Category<ept id=\"p1\">**</ept> pane, select <bpt id=\"p2\">**</bpt>Translation<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        7442,
        7501
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Remote character set<ept id=\"p1\">**</ept> list box, select <bpt id=\"p2\">**</bpt>UTF-8<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Under <bpt id=\"p1\">**</bpt>Handling of line drawing characters<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Use Unicode line drawing code points<ept id=\"p2\">**</ept>.",
      "pos": [
        7506,
        7601
      ]
    },
    {
      "content": "The following illustration shows the correct PuTTY selections.",
      "pos": [
        7602,
        7664
      ]
    },
    {
      "content": "UTF Putty Settings",
      "pos": [
        7672,
        7690
      ]
    },
    {
      "pos": [
        7763,
        7779
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>."
    },
    {
      "content": "You can now use PuTTY to connect to the device serial console by doing the following steps:",
      "pos": [
        7782,
        7873
      ]
    },
    {
      "content": "Connect remotely to StorSimple using Windows PowerShell for StorSimple",
      "pos": [
        7959,
        8029
      ]
    },
    {
      "content": "You can use Windows PowerShell remoting to connect to your StorSimple device.",
      "pos": [
        8030,
        8107
      ]
    },
    {
      "content": "When you connect this way, you will not see a menu.",
      "pos": [
        8108,
        8159
      ]
    },
    {
      "content": "(You see a menu only if you use the serial console on the device to connect.) With Windows PowerShell remoting, you connect to a specific runspace.",
      "pos": [
        8160,
        8307
      ]
    },
    {
      "content": "You can also specify the display language.",
      "pos": [
        8308,
        8350
      ]
    },
    {
      "content": "The display language is independent of the language that you set by using the Change Language option in the serial console menu.",
      "pos": [
        8353,
        8481
      ]
    },
    {
      "content": "Remote PowerShell will automatically pick up the locale of the device you are connecting from if none is specified.",
      "pos": [
        8482,
        8597
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If you are working with Microsoft Azure virtual hosts and StorSimple virtual devices, you can use Windows PowerShell remoting and the virtual host to connect to the virtual device.",
      "pos": [
        8600,
        8793
      ]
    },
    {
      "content": "If you have set up a share location on the host on which to save information from the Windows PowerShell session you should be aware that the Everyone principal includes only authenticated users.",
      "pos": [
        8794,
        8989
      ]
    },
    {
      "content": "Therefore, if you have set the share up to allow access by Everyone and you connect without specifying credentials, the unauthenticated Anonymous principal will be used and you will see an error.",
      "pos": [
        8990,
        9185
      ]
    },
    {
      "content": "To fix this issue, on the share host you must enable the Guest account and then give the Guest account full access to the share or you must specify valid credentials along with the Windows PowerShell cmdlet.",
      "pos": [
        9186,
        9393
      ]
    },
    {
      "content": "You can use HTTP or HTTPS to connect via Windows PowerShell remoting.",
      "pos": [
        9396,
        9465
      ]
    },
    {
      "content": "Use the instructions in the following tutorials:",
      "pos": [
        9466,
        9514
      ]
    },
    {
      "content": "Connect remotely using http",
      "pos": [
        9519,
        9546
      ]
    },
    {
      "content": "Connect remotely using https",
      "pos": [
        9602,
        9630
      ]
    },
    {
      "content": "Connection security considerations",
      "pos": [
        9688,
        9722
      ]
    },
    {
      "content": "When you are deciding how to connect to Windows PowerShell for StorSimple, consider the following:",
      "pos": [
        9724,
        9822
      ]
    },
    {
      "content": "Connecting directly to the device serial console is secure but connecting to the serial console over network switches is not.",
      "pos": [
        9826,
        9951
      ]
    },
    {
      "content": "Be cautious of the security risk when connecting to device serial over network switches.",
      "pos": [
        9952,
        10040
      ]
    },
    {
      "content": "Connecting through an HTTP session might offer more security than connecting through the serial console over network.",
      "pos": [
        10044,
        10161
      ]
    },
    {
      "content": "Although this is not the most secure method, it is acceptable on trusted networks.",
      "pos": [
        10162,
        10244
      ]
    },
    {
      "content": "Connecting through an HTTPS session with a self-signed certificate is the most secure and the recommended option.",
      "pos": [
        10248,
        10361
      ]
    },
    {
      "content": "Administer your StorSimple device using Windows PowerShell for StorSimple",
      "pos": [
        10367,
        10440
      ]
    },
    {
      "content": "The following table shows a summary of all the common management tasks and complex workflows that can be performed within the Windows PowerShell interface of your StorSimple device.For more information about each workflow, click the appropriate entry in the table.",
      "pos": [
        10441,
        10705
      ]
    },
    {
      "content": "Windows PowerShell for StorSimple workflows",
      "pos": [
        10712,
        10755
      ]
    },
    {
      "content": "If you want to do this ...",
      "pos": [
        10758,
        10784
      ]
    },
    {
      "content": "Use this procedure.",
      "pos": [
        10785,
        10804
      ]
    },
    {
      "content": "Register your device",
      "pos": [
        10817,
        10837
      ]
    },
    {
      "content": "Configure and register the device using Windows PowerShell for StorSimple",
      "pos": [
        10839,
        10912
      ]
    },
    {
      "content": "Configure web proxy",
      "pos": [
        11038,
        11057
      ]
    },
    {
      "content": "View web proxy settings",
      "pos": [
        11062,
        11085
      ]
    },
    {
      "content": "Configure web proxy for your StorSimple device",
      "pos": [
        11087,
        11133
      ]
    },
    {
      "content": "Modify DATA 0 network interface settings on your device",
      "pos": [
        11172,
        11227
      ]
    },
    {
      "content": "Modify DATA 0 network interface for your StorSimple device",
      "pos": [
        11229,
        11287
      ]
    },
    {
      "content": "Stop a controller",
      "pos": [
        11320,
        11337
      ]
    },
    {
      "content": "Restart or shut down a controller",
      "pos": [
        11344,
        11377
      ]
    },
    {
      "content": "Shut down a device",
      "pos": [
        11384,
        11402
      ]
    },
    {
      "content": "Reset the device to factory default settings",
      "pos": [
        11407,
        11451
      ]
    },
    {
      "content": "Manage device controllers",
      "pos": [
        11453,
        11478
      ]
    },
    {
      "content": "Install maintenance mode updates and hotfixes",
      "pos": [
        11522,
        11567
      ]
    },
    {
      "content": "Update your device",
      "pos": [
        11569,
        11587
      ]
    },
    {
      "content": "Enter maintenance mode",
      "pos": [
        11620,
        11642
      ]
    },
    {
      "content": "Exit maintenance mode",
      "pos": [
        11648,
        11669
      ]
    },
    {
      "content": "StorSimple device modes",
      "pos": [
        11671,
        11694
      ]
    },
    {
      "content": "Create a Support package",
      "pos": [
        11726,
        11750
      ]
    },
    {
      "content": "Decrypt and edit a support package",
      "pos": [
        11755,
        11789
      ]
    },
    {
      "content": "Create and manage a Support package",
      "pos": [
        11791,
        11826
      ]
    },
    {
      "content": "Start a Support session",
      "pos": [
        11875,
        11898
      ]
    },
    {
      "content": "Start a support session in Windows PowerShell for StorSimple",
      "pos": [
        11905,
        11965
      ]
    },
    {
      "content": "Get Help in Windows PowerShell for StorSimple",
      "pos": [
        12076,
        12121
      ]
    },
    {
      "content": "In Windows PowerShell for StorSimple, cmdlet Help is available.",
      "pos": [
        12123,
        12186
      ]
    },
    {
      "content": "An online, up-to-date version of this Help is also available, which you can use to update the Help on your system.",
      "pos": [
        12187,
        12301
      ]
    },
    {
      "content": "Getting Help in this interface is similar to that in Windows PowerShell, and most of the Help-related cmdlets will work.",
      "pos": [
        12303,
        12423
      ]
    },
    {
      "content": "You can find Help for Windows PowerShell online in the TechNet Library: <bpt id=\"p1\">[</bpt>Scripting with Windows PowerShell<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=108518)</ept>.",
      "pos": [
        12424,
        12579
      ]
    },
    {
      "content": "The following is a brief description of the types of Help for this Windows PowerShell interface, including how to update the Help.",
      "pos": [
        12581,
        12711
      ]
    },
    {
      "content": "To get Help for a cmdlet",
      "pos": [
        12718,
        12742
      ]
    },
    {
      "pos": [
        12746,
        12837
      ],
      "content": "To get Help for any cmdlet or function, use the following command: <ph id=\"ph1\">`Get-Help &lt;cmdlet-name&gt;`</ph>"
    },
    {
      "pos": [
        12841,
        12962
      ],
      "content": "To get online Help for any cmdlet, use the previous cmdlet with the <ph id=\"ph1\">`-Online`</ph> parameter: <ph id=\"ph2\">`Get-Help &lt;cmdlet-name&gt; -Online`</ph>"
    },
    {
      "pos": [
        12966,
        13062
      ],
      "content": "For full Help, you can use the –Full parameter, and for examples, use the <ph id=\"ph1\">`–Examples`</ph> parameter."
    },
    {
      "content": "To update Help",
      "pos": [
        13069,
        13083
      ]
    },
    {
      "content": "You can easily update the Help in the Windows PowerShell interface.",
      "pos": [
        13085,
        13152
      ]
    },
    {
      "content": "Perform the following steps to update the Help on your system.",
      "pos": [
        13153,
        13215
      ]
    },
    {
      "content": "To update cmdlet Help",
      "pos": [
        13222,
        13243
      ]
    },
    {
      "pos": [
        13248,
        13314
      ],
      "content": "Start Windows PowerShell with the <bpt id=\"p1\">**</bpt>Run as administrator<ept id=\"p1\">**</ept> option."
    },
    {
      "pos": [
        13319,
        13365
      ],
      "content": "At the command prompt, type:\n `Update-Help`",
      "leadings": [
        "",
        "   "
      ],
      "nodes": [
        {
          "content": "At the command prompt, type:",
          "pos": [
            0,
            28
          ]
        }
      ]
    },
    {
      "content": "The updated Help files will be installed.",
      "pos": [
        13370,
        13411
      ]
    },
    {
      "content": "After the Help files are installed, type: <ph id=\"ph1\">`Get-Help Get-Command`</ph>.",
      "pos": [
        13416,
        13481
      ]
    },
    {
      "content": "This will display a list of cmdlets for which Help is available.",
      "pos": [
        13482,
        13546
      ]
    },
    {
      "pos": [
        13550,
        13704
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> To get a list of all the available cmdlets in any of the runspaces, log in to the corresponding menu option and run the <ph id=\"ph2\">`Get-Command`</ph> cmdlet."
    },
    {
      "content": "Next steps",
      "pos": [
        13709,
        13719
      ]
    },
    {
      "pos": [
        13720,
        13969
      ],
      "content": "If you experience any issues with your StorSimple device when performing one of the above workflows, refer to <bpt id=\"p1\">[</bpt>Tools for troubleshooting StorSimple deployments<ept id=\"p1\">](storsimple-troubleshoot-deployment.md#tools-for-troubleshooting-storsimple-deployments)</ept>."
    }
  ],
  "content": "<properties \n   pageTitle=\"PowerShell for StorSimple device management | Microsoft Azure\"\n   description=\"Learn how to use Windows PowerShell for StorSimple to manage your StorSimple device.\"\n   services=\"storsimple\"\n   documentationCenter=\"NA\"\n   authors=\"alkohli\"\n   manager=\"carolz\"\n   editor=\"\" />\n<tags \n   ms.service=\"storsimple\"\n   ms.devlang=\"NA\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"NA\"\n   ms.workload=\"TBD\"\n   ms.date=\"08/28/2015\"\n   ms.author=\"alkohli@microsoft.com\" />\n\n# Use Windows PowerShell for StorSimple to administer your device\n\n## Overview\n\nWindows PowerShell for StorSimple provides a command-line interface that you can use to manage your Microsoft Azure StorSimple device. As the name suggests, it is a Windows PowerShell-based, command-line interface that is built in a constrained runspace. From the perspective of the user at the command line, a constrained runspace appears as a restricted version of Windows PowerShell. While maintaining some of the basic capabilities of Windows PowerShell, this interface has additional dedicated cmdlets that are geared towards managing your Microsoft Azure StorSimple device. \n\nThis article describes the Windows PowerShell for StorSimple features, including how you can connect to this interface, and contains links to step-by-step procedures or workflows that you can perform using this interface. The workflows include how to register your device, configure the network interface on your device, install updates that require the device to be in maintenance mode, change the device state, and troubleshoot any issues that you may experience.\n\nAfter reading this article, you will be able to:\n\n- Connect to your StorSimple device using Windows PowerShell for StorSimple.\n\n- Administer your StorSimple device using Windows PowerShell for StorSimple.\n\n- Get help in Windows PowerShell for StorSimple.\n\n>[AZURE.NOTE]   \n\n>- Windows PowerShell for StorSimple cmdlets allow you to manage your StorSimple device from a serial console or remotely via Windows PowerShell remoting. For more information about each of the individual cmdlets that can be used in this interface, go to [cmdlet reference for Windows PowerShell for StorSimple](https://technet.microsoft.com/library/dn688168.aspx).\n\n>- The Azure PowerShell StorSimple cmdlets are a different collection of cmdlets that allow you to automate StorSimple service-level and migration tasks from the command line. For more information about the Azure PowerShell cmdlets for StorSimple, go to the [Azure StorSimple cmdlet reference](https://msdn.microsoft.com/library/azure/dn920427.aspx).\n\nYou can access the Windows PowerShell for StorSimple using one of the following methods:\n\n- [Connect to StorSimple device serial console](#connect-to-windows-powershell-for-storsimple-via-the-device-serial-console)\n- [Connect remotely to StorSimple using Windows PowerShell](#connect-remotely-to-storsimple-using-windows-powershell-for-storsimple)\n    \n\n## Connect to Windows PowerShell for StorSimple via the device serial console\n\nYou can [download PuTTY](http://www.putty.org/) or similar terminal emulation software to connect to Windows PowerShell for StorSimple. You need to configure PuTTY specifically to access the Microsoft Azure StorSimple device. The following topics contain detailed steps about how to configure PuTTy and connect to the device. Various menu options in the serial console are also explained.\n\n### About the serial console\n\nWhen you access the Windows PowerShell interface of your StorSimple device through the serial console, a banner message is presented, followed by menu options. \n\nThe banner message contains basic StorSimple device information such as the model, name, installed software version, and status of the controller you are accessing. The following image shows an example of a banner message.\n\n![Serial banner message](./media/storsimple-windows-powershell-administration/IC741098.png)\n\n\n\n>[AZURE.IMPORTANT] You can use the banner message to identify whether the controller you are connected to is Active or Passive.\n\n\nThe following image shows the various runspace options that are available in the serial console menu.\n\n![Register your device 2](./media/storsimple-windows-powershell-administration/IC740906.png)\n\nYou can choose from the following settings:\n\n1. **Log in with full access**\nThis option allows you to connect (with the proper credentials) to the **SSAdminConsole** runspace on the local controller. (The local controller is the controller that you are currently accessing through the serial console of your StorSimple device.) \nThis option can also be used to allow Microsoft Support to access unrestricted runspace (a support session) to troubleshoot any possible device issues. After you use option 1 to log on, you can allow the Microsoft Support engineer to access unrestricted runspace by running a specific cmdlet. For details, refer to [Start a support session](storsimple-contact-microsoft-support.md#start-a-support-session-in-windows-powershell-for-storsimple). This option connects to a runspace on the local controller.\n\n1. **Log in to peer controller with full access**\nThis option is the same as option 1, except that you can connect (with the proper credentials) to the **SSAdminConsole** runspace on the peer controller. Because the StorSimple device is a high availability device with two controllers in an active-passive configuration, peer refers to the other controller in the device that you are accessing through the serial console).\nSimilar to option 1, this option can also be used to allow Microsoft Support to access unrestricted runspace on a peer controller.\n\n1. **Connect with limited access**\nThis option is used to access Windows PowerShell interface in limited mode. You are not prompted for access credentials. This option connects to a more restricted runspace compared to options 1 and 2.  Some of the tasks that are available through option 1 that cannot be performed in this runspace are:\n\n    - Reset to the factory settings\n    - Change the password\n    - Enable or disable support access\n    - Apply updates\n    - Install hotfixes \n                                                \n\n    >[AZURE.NOTE] **This is the preferred option if you have forgotten the device administrator password and cannot connect through option 1 or 2.**\n\n1. **Change language**\nThis option allows you to change the display language on the Windows PowerShell interface. The languages supported are English, Japanese, Russian, French, South Korean, Spanish, Italian, German, Chinese, and Brazilian Portuguese.\n\nMake sure that you use the following PuTTY settings to connect to the Windows PowerShell interface from the serial console.\n\n#### To configure PuTTY\n\n1. In the PuTTY Reconfiguration dialog box, in the **Category** pane, select **Keyboard**.\n\n1. Make sure that the following options are selected (these are the default settings when you start a new session). \n\n    |Keyboard item|Select|\n    |---|---|\n    |Backspace key|Control-? (127)|\n    |Home and End keys|Standard|\n    |Function keys and keypad|ESC[n~|\n    |Initial state of cursor keys|Normal|\n    |Initial state of numeric keypad|Normal|\n    |Enable extra keyboard features|Control-Alt is different from AltGr|\n\n    ![Supported Putty Settings](./media/storsimple-windows-powershell-administration/IC740877.png)\n\n1. Click **Apply**.\n\n1. In the **Category** pane, select **Translation**.\n\n1. In the **Remote character set** list box, select **UTF-8**.\n\n1. Under **Handling of line drawing characters**, select **Use Unicode line drawing code points**. The following illustration shows the correct PuTTY selections.\n\n    ![UTF Putty Settings](./media/storsimple-windows-powershell-administration/IC740878.png)\n\n1. Click **Apply**.\n\n\nYou can now use PuTTY to connect to the device serial console by doing the following steps:\n\n[AZURE.INCLUDE [storsimple-use-putty](../../includes/storsimple-use-putty.md)]\n\n\n## Connect remotely to StorSimple using Windows PowerShell for StorSimple\nYou can use Windows PowerShell remoting to connect to your StorSimple device. When you connect this way, you will not see a menu. (You see a menu only if you use the serial console on the device to connect.) With Windows PowerShell remoting, you connect to a specific runspace. You can also specify the display language. \n\nThe display language is independent of the language that you set by using the Change Language option in the serial console menu. Remote PowerShell will automatically pick up the locale of the device you are connecting from if none is specified.\n\n>[AZURE.NOTE] If you are working with Microsoft Azure virtual hosts and StorSimple virtual devices, you can use Windows PowerShell remoting and the virtual host to connect to the virtual device. If you have set up a share location on the host on which to save information from the Windows PowerShell session you should be aware that the Everyone principal includes only authenticated users. Therefore, if you have set the share up to allow access by Everyone and you connect without specifying credentials, the unauthenticated Anonymous principal will be used and you will see an error. To fix this issue, on the share host you must enable the Guest account and then give the Guest account full access to the share or you must specify valid credentials along with the Windows PowerShell cmdlet.\n\n\nYou can use HTTP or HTTPS to connect via Windows PowerShell remoting. Use the instructions in the following tutorials:\n\n- [Connect remotely using http](storsimple-remote-connect.md#connect-through-http)\n- [Connect remotely using https](storsimple-remote-connect.md#connect-through-https)\n\n## Connection security considerations\n\nWhen you are deciding how to connect to Windows PowerShell for StorSimple, consider the following:\n\n- Connecting directly to the device serial console is secure but connecting to the serial console over network switches is not. Be cautious of the security risk when connecting to device serial over network switches.\n\n- Connecting through an HTTP session might offer more security than connecting through the serial console over network. Although this is not the most secure method, it is acceptable on trusted networks.\n\n- Connecting through an HTTPS session with a self-signed certificate is the most secure and the recommended option.\n\n\n## Administer your StorSimple device using Windows PowerShell for StorSimple\nThe following table shows a summary of all the common management tasks and complex workflows that can be performed within the Windows PowerShell interface of your StorSimple device.For more information about each workflow, click the appropriate entry in the table.\n\n#### Windows PowerShell for StorSimple workflows\n\n|If you want to do this ...|Use this procedure.|\n|---|---|\n|Register your device|[Configure and register the device using Windows PowerShell for StorSimple](storsimple-deployment-walkthrough.md#step-3-configure-and-register-the-device-through-windows-powershell-for-storsimple) |\n|Configure web proxy</br>View web proxy settings|[Configure web proxy for your StorSimple device](storsimple-configure-web-proxy.md)|\n|Modify DATA 0 network interface settings on your device|[Modify DATA 0 network interface for your StorSimple device](storsimple-modify-data-0.md)|\n|Stop a controller </br> Restart or shut down a controller </br> Shut down a device</br>Reset the device to factory default settings|[Manage device controllers](storsimple-manage-device-controller.md)|\n|Install maintenance mode updates and hotfixes|[Update your device](storsimple-update-device.md)|\n|Enter maintenance mode </br>Exit maintenance mode|[StorSimple device modes](storsimple-device-modes.md)|\n|Create a Support package</br>Decrypt and edit a support package|[Create and manage a Support package](storsimple-create-manage-support-package.md)|\n|Start a Support session</br>|[Start a support session in Windows PowerShell for StorSimple](/storsimple-contact-microsoft-support.md#start-a-support-session-in-windows-powershell-for-storsimple)\n \n\n## Get Help in Windows PowerShell for StorSimple\n\nIn Windows PowerShell for StorSimple, cmdlet Help is available. An online, up-to-date version of this Help is also available, which you can use to update the Help on your system.\n\nGetting Help in this interface is similar to that in Windows PowerShell, and most of the Help-related cmdlets will work. You can find Help for Windows PowerShell online in the TechNet Library: [Scripting with Windows PowerShell](http://go.microsoft.com/fwlink/?LinkID=108518).\n\nThe following is a brief description of the types of Help for this Windows PowerShell interface, including how to update the Help.\n\n#### To get Help for a cmdlet\n\n- To get Help for any cmdlet or function, use the following command: `Get-Help <cmdlet-name>`\n\n- To get online Help for any cmdlet, use the previous cmdlet with the `-Online` parameter: `Get-Help <cmdlet-name> -Online`\n\n- For full Help, you can use the –Full parameter, and for examples, use the `–Examples` parameter.\n\n#### To update Help\n\nYou can easily update the Help in the Windows PowerShell interface. Perform the following steps to update the Help on your system.\n\n#### To update cmdlet Help\n\n1. Start Windows PowerShell with the **Run as administrator** option.\n\n1. At the command prompt, type:\n    `Update-Help`\n\n1. The updated Help files will be installed.\n\n1. After the Help files are installed, type: `Get-Help Get-Command`. This will display a list of cmdlets for which Help is available.\n\n\n>[AZURE.NOTE] To get a list of all the available cmdlets in any of the runspaces, log in to the corresponding menu option and run the `Get-Command` cmdlet.\n\n## Next steps\nIf you experience any issues with your StorSimple device when performing one of the above workflows, refer to [Tools for troubleshooting StorSimple deployments](storsimple-troubleshoot-deployment.md#tools-for-troubleshooting-storsimple-deployments).\n\n"
}