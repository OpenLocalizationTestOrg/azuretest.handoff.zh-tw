{
  "nodes": [
    {
      "content": "Working with the Mobile Services Android Client Library",
      "pos": [
        27,
        82
      ]
    },
    {
      "content": "Learn how to use an Android client for Azure Mobile Services.",
      "pos": [
        101,
        162
      ]
    },
    {
      "content": "How to use the Android client library for Mobile Services",
      "pos": [
        492,
        549
      ]
    },
    {
      "content": "This guide shows you how to perform common scenarios using the Android client for Azure Mobile Services.",
      "pos": [
        669,
        773
      ]
    },
    {
      "content": "The scenarios covered include querying for data; inserting, updating, and deleting data, authenticating users, handling errors, and customizing the client.",
      "pos": [
        775,
        930
      ]
    },
    {
      "content": "If you are new to Mobile Services, you should first complete the quickstart tutorial [Get started with Mobile Services].",
      "pos": [
        932,
        1052
      ]
    },
    {
      "content": "Successfully completing that tutorial ensures that you will have  installed Android Studio; it will help you configure your account and create your first mobile service, and install the Mobile Services SDK, which supports Android version 2.2 or later, but we recommend building against Android version 4.2 or later.",
      "pos": [
        1053,
        1368
      ]
    },
    {
      "pos": [
        1370,
        1497
      ],
      "content": "You can find the Javadocs API reference for the Android client library <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298735)</ept>."
    },
    {
      "pos": [
        1589,
        1632
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"setup\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Setup and Prerequisites"
    },
    {
      "content": "We assume that you have created a mobile service and a table.",
      "pos": [
        1634,
        1695
      ]
    },
    {
      "content": "For more information see <bpt id=\"p1\">[</bpt>Create a table<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298592)</ept>.",
      "pos": [
        1696,
        1787
      ]
    },
    {
      "content": "In the code used in this topic, we assume the table is named <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept>, and that it has the following columns:",
      "pos": [
        1788,
        1899
      ]
    },
    {
      "content": "id",
      "pos": [
        1903,
        1905
      ]
    },
    {
      "content": "text",
      "pos": [
        1908,
        1912
      ]
    },
    {
      "content": "complete",
      "pos": [
        1915,
        1923
      ]
    },
    {
      "content": "The corresponding typed client side object is the following:",
      "pos": [
        1925,
        1985
      ]
    },
    {
      "content": "When dynamic schema is enabled, Azure Mobile Services automatically generates new columns based on the object in the insert or update request.",
      "pos": [
        2112,
        2254
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Dynamic schema<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296271)</ept>.",
      "pos": [
        2255,
        2347
      ]
    },
    {
      "content": "<ph id=\"ph1\">&lt;a name=\"create-client\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Create the Mobile Services client",
      "pos": [
        2351,
        2420
      ]
    },
    {
      "content": "The following code creates the <bpt id=\"p1\">[</bpt>MobileServiceClient<ept id=\"p1\">](http://dl.windowsazure.com/androiddocs/com/microsoft/windowsazure/mobileservices/MobileServiceClient.html)</ept> object that is used to access your mobile service.",
      "pos": [
        2421,
        2631
      ]
    },
    {
      "content": "The code goes in the <ph id=\"ph1\">`onCreate`</ph> method of the Activity class specified in <bpt id=\"p1\">*</bpt>AndroidManifest.xml<ept id=\"p1\">*</ept> as a <bpt id=\"p2\">**</bpt>MAIN<ept id=\"p2\">**</ept> action and <bpt id=\"p3\">**</bpt>LAUNCHER<ept id=\"p3\">**</ept> category.",
      "pos": [
        2632,
        2775
      ]
    },
    {
      "content": "In the code above, replace <ph id=\"ph1\">`MobileServiceUrl`</ph> and <ph id=\"ph2\">`AppKey`</ph> with the mobile service URL and application key, in that order.",
      "pos": [
        3006,
        3128
      ]
    },
    {
      "content": "Both of these are available on the Azure Management Portal, by selecting your mobile service and then clicking on <bpt id=\"p1\">*</bpt>Dashboard<ept id=\"p1\">*</ept>.",
      "pos": [
        3129,
        3255
      ]
    },
    {
      "pos": [
        3259,
        3319
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"instantiating\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Create a table reference"
    },
    {
      "content": "The easiest way to query or modify data in the mobile service is by using the <bpt id=\"p1\">*</bpt>typed programming model<ept id=\"p1\">*</ept>, since Java is a strongly typed language (later on we will discuss the <bpt id=\"p2\">*</bpt>untyped<ept id=\"p2\">*</ept> model).",
      "pos": [
        3321,
        3513
      ]
    },
    {
      "content": "This model provides seamless serialization and deserialization to JSON using the <bpt id=\"p1\">[</bpt>gson<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=290801)</ept> library when sending data between the client and the mobile service: the developer doesn't have to do anything, the framework handles it all.",
      "pos": [
        3514,
        3792
      ]
    },
    {
      "content": "The first thing you do to query or modify data is to create a <bpt id=\"p1\">[</bpt>MobileServiceTable<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296835)</ept> object by calling the <bpt id=\"p2\">**</bpt>getTable<ept id=\"p2\">**</ept> method on the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MobileServiceClient<ept id=\"p4\">**</ept><ept id=\"p3\">](http://dl.windowsazure.com/androiddocs/com/microsoft/windowsazure/mobileservices/MobileServiceClient.html)</ept>.",
      "pos": [
        3794,
        4108
      ]
    },
    {
      "content": "We will look at two overloads of this method:",
      "pos": [
        4110,
        4155
      ]
    },
    {
      "pos": [
        4350,
        4428
      ],
      "content": "In the following code, <bpt id=\"p1\">*</bpt>mClient<ept id=\"p1\">*</ept> is a reference to your mobile service client."
    },
    {
      "pos": [
        4430,
        4561
      ],
      "content": "The <bpt id=\"p1\">[</bpt>first overload<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296839)</ept> is used where the class name and the table name are the same:"
    },
    {
      "pos": [
        4649,
        4777
      ],
      "content": "The <bpt id=\"p1\">[</bpt>2nd overload<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296840)</ept> is used when the table name is different from the type name."
    },
    {
      "pos": [
        4885,
        4920
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"api\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>The API structure"
    },
    {
      "content": "Since version 2.0 of the client library, mobile services table operations use the <bpt id=\"p1\">[</bpt>Future<ept id=\"p1\">](http://developer.android.com/reference/java/util/concurrent/Future.html)</ept> and <bpt id=\"p2\">[</bpt>AsyncTask<ept id=\"p2\">](http://developer.android.com/reference/android/os/AsyncTask.html)</ept> objects in all of the asynchronous operations such as methods involving queries and operations like inserts, updates and deletes.",
      "pos": [
        4922,
        5297
      ]
    },
    {
      "content": "This makes it easier to perform multiple operations (while on a background thread) without having to deal with multiple nested callbacks.",
      "pos": [
        5298,
        5435
      ]
    },
    {
      "pos": [
        5440,
        5503
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"querying\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Query data from a mobile service"
    },
    {
      "content": "This section describes how to issue queries to the mobile service.",
      "pos": [
        5505,
        5571
      ]
    },
    {
      "content": "Subsections describe diffent aspects such as sorting, filtering, and paging.",
      "pos": [
        5572,
        5648
      ]
    },
    {
      "content": "Finally, we discuss how you can concatenate these operations together.",
      "pos": [
        5649,
        5719
      ]
    },
    {
      "pos": [
        5725,
        5784
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"showAll\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Return all Items from a Table"
    },
    {
      "content": "The following code returns all items in the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> table.",
      "pos": [
        5786,
        5847
      ]
    },
    {
      "content": "It displays them in the UI by adding the items to an adapter.",
      "pos": [
        5848,
        5909
      ]
    },
    {
      "content": "This code is similar to what is in the the quickstart tutorial [Get started with Mobile Services].",
      "pos": [
        5910,
        6008
      ]
    },
    {
      "pos": [
        6810,
        6925
      ],
      "content": "Queries like this one use the <bpt id=\"p1\">[</bpt>AsyncTask<ept id=\"p1\">](http://developer.android.com/reference/android/os/AsyncTask.html)</ept> object."
    },
    {
      "pos": [
        6927,
        7095
      ],
      "content": "The <bpt id=\"p1\">*</bpt>result<ept id=\"p1\">*</ept> variable returns the result set from the query, and the code following the <ph id=\"ph1\">`mToDoTable.execute().get()`</ph> statement shows how to display the individual rows."
    },
    {
      "pos": [
        7102,
        7154
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"filtering\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Filter returned data"
    },
    {
      "content": "The following code returns all items from the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> table whose <bpt id=\"p2\">*</bpt>complete<ept id=\"p2\">*</ept> field equals <bpt id=\"p3\">*</bpt>false<ept id=\"p3\">*</ept>.",
      "pos": [
        7156,
        7257
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>mToDoTable<ept id=\"p1\">*</ept> is the reference to the mobile service table that we created previously.",
      "pos": [
        7258,
        7343
      ]
    },
    {
      "content": "You start a filter with a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>where<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296867)</ept> method call on the table reference.",
      "pos": [
        7983,
        8105
      ]
    },
    {
      "content": "This is followed by a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>field<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296869)</ept> method call followed by a method call that specifies the logical predicate.",
      "pos": [
        8106,
        8264
      ]
    },
    {
      "content": "Possible predicate methods include <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>eq<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298461)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ne<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298462)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>gt<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=298463)</ept>, <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>ge<ept id=\"p8\">**</ept><ept id=\"p7\">](http://go.microsoft.com/fwlink/p/?LinkId=298464)</ept>, <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>lt<ept id=\"p10\">**</ept><ept id=\"p9\">](http://go.microsoft.com/fwlink/p/?LinkId=298465)</ept>, <bpt id=\"p11\">[</bpt><bpt id=\"p12\">**</bpt>le<ept id=\"p12\">**</ept><ept id=\"p11\">](http://go.microsoft.com/fwlink/p/?LinkId=298466)</ept> etc.",
      "pos": [
        8265,
        8657
      ]
    },
    {
      "content": "This is sufficient for comparing number and string fields to specific values.",
      "pos": [
        8659,
        8736
      ]
    },
    {
      "content": "But you can do a lot more.",
      "pos": [
        8737,
        8763
      ]
    },
    {
      "content": "For example, you can filter on dates.",
      "pos": [
        8765,
        8802
      ]
    },
    {
      "content": "You can compare the entire date field, but you can also compare parts of the date, with methods such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>year<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298467)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>month<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298468)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>day<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=298469)</ept>, <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>hour<ept id=\"p8\">**</ept><ept id=\"p7\">](http://go.microsoft.com/fwlink/p/?LinkId=298470)</ept>, <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>minute<ept id=\"p10\">**</ept><ept id=\"p9\">](http://go.microsoft.com/fwlink/p/?LinkId=298471)</ept> and <bpt id=\"p11\">[</bpt><bpt id=\"p12\">**</bpt>second<ept id=\"p12\">**</ept><ept id=\"p11\">](http://go.microsoft.com/fwlink/p/?LinkId=298472)</ept>.",
      "pos": [
        8803,
        9279
      ]
    },
    {
      "content": "The following partial code adds a filter for items whose <bpt id=\"p1\">*</bpt>due date<ept id=\"p1\">*</ept> equals 2013.",
      "pos": [
        9280,
        9360
      ]
    },
    {
      "content": "You can do a wide variety of complex filters on string fields with methods like <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>startsWith<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298473)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>endsWith<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298474)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>concat<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=298475)</ept>, <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>subString<ept id=\"p8\">**</ept><ept id=\"p7\">](http://go.microsoft.com/fwlink/p/?LinkId=298477)</ept>, <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>indexOf<ept id=\"p10\">**</ept><ept id=\"p9\">](http://go.microsoft.com/fwlink/p/?LinkId=298488)</ept>, <bpt id=\"p11\">[</bpt><bpt id=\"p12\">**</bpt>replace<ept id=\"p12\">**</ept><ept id=\"p11\">](http://go.microsoft.com/fwlink/p/?LinkId=298491)</ept>, <bpt id=\"p13\">[</bpt><bpt id=\"p14\">**</bpt>toLower<ept id=\"p14\">**</ept><ept id=\"p13\">](http://go.microsoft.com/fwlink/p/?LinkId=298492)</ept>, <bpt id=\"p15\">[</bpt><bpt id=\"p16\">**</bpt>toUpper<ept id=\"p16\">**</ept><ept id=\"p15\">](http://go.microsoft.com/fwlink/p/?LinkId=298493)</ept>, <bpt id=\"p17\">[</bpt><bpt id=\"p18\">**</bpt>trim<ept id=\"p18\">**</ept><ept id=\"p17\">](http://go.microsoft.com/fwlink/p/?LinkId=298495)</ept>, and <bpt id=\"p19\">[</bpt><bpt id=\"p20\">**</bpt>length<ept id=\"p20\">**</ept><ept id=\"p19\">](http://go.microsoft.com/fwlink/p/?LinkId=298496)</ept>.",
      "pos": [
        9428,
        10152
      ]
    },
    {
      "content": "The following partial code filters for table rows where the <bpt id=\"p1\">*</bpt>text<ept id=\"p1\">*</ept> column starts with \"PRI0\".",
      "pos": [
        10153,
        10246
      ]
    },
    {
      "content": "Number fields also allow a wide variety of more complex filters with methods like <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>add<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298497)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>sub<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298499)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>mul<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=298500)</ept>, <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>div<ept id=\"p8\">**</ept><ept id=\"p7\">](http://go.microsoft.com/fwlink/p/?LinkId=298502)</ept>, <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>mod<ept id=\"p10\">**</ept><ept id=\"p9\">](http://go.microsoft.com/fwlink/p/?LinkId=298503)</ept>, <bpt id=\"p11\">[</bpt><bpt id=\"p12\">**</bpt>floor<ept id=\"p12\">**</ept><ept id=\"p11\">](http://go.microsoft.com/fwlink/p/?LinkId=298505)</ept>, <bpt id=\"p13\">[</bpt><bpt id=\"p14\">**</bpt>ceiling<ept id=\"p14\">**</ept><ept id=\"p13\">](http://go.microsoft.com/fwlink/p/?LinkId=298506)</ept>, and <bpt id=\"p15\">[</bpt><bpt id=\"p16\">**</bpt>round<ept id=\"p16\">**</ept><ept id=\"p15\">](http://go.microsoft.com/fwlink/p/?LinkId=298507)</ept>.",
      "pos": [
        10320,
        10893
      ]
    },
    {
      "content": "The following partial code filters for table rows where the <bpt id=\"p1\">*</bpt>duration<ept id=\"p1\">*</ept> is an even number.",
      "pos": [
        10894,
        10983
      ]
    },
    {
      "content": "You can combine predicates with methods like <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>and<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298512)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>or<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298514)</ept> and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>not<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=298515)</ept>.",
      "pos": [
        11062,
        11288
      ]
    },
    {
      "content": "This partial code combines two of the above examples.",
      "pos": [
        11289,
        11342
      ]
    },
    {
      "content": "And you can group and nest logical operators, as shown in this partial code:",
      "pos": [
        11464,
        11540
      ]
    },
    {
      "pos": [
        11758,
        11967
      ],
      "content": "For more detailed discussion and examples of filtering, see <bpt id=\"p1\">[</bpt>Exploring the richness of the Mobile Services Android client query model<ept id=\"p1\">](http://hashtagfail.com/post/46493261719/mobile-services-android-querying)</ept>."
    },
    {
      "pos": [
        11973,
        12021
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"sorting\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Sort returned data"
    },
    {
      "content": "The following code returns all items from a table of <bpt id=\"p1\">*</bpt>ToDoItems<ept id=\"p1\">*</ept> sorted ascending by the <bpt id=\"p2\">*</bpt>text<ept id=\"p2\">*</ept> field.",
      "pos": [
        12023,
        12125
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>mToDoTable<ept id=\"p1\">*</ept> is the reference to the mobile mervice table that you created previously.",
      "pos": [
        12126,
        12212
      ]
    },
    {
      "pos": [
        12289,
        12446
      ],
      "content": "The first parameter of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>orderBy<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298519)</ept> method is a string equal to the name of the field on which to sort."
    },
    {
      "pos": [
        12448,
        12607
      ],
      "content": "The second parameter uses the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>QueryOrder<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298521)</ept> enumeration to specify whether to sort ascending or descending."
    },
    {
      "pos": [
        12609,
        12743
      ],
      "content": "Note that if you are filtering using the <bpt id=\"p1\">***</bpt>where<ept id=\"p1\">***</ept> method, the <bpt id=\"p2\">***</bpt>where<ept id=\"p2\">***</ept> method must be invoked prior to the <bpt id=\"p3\">***</bpt>orderBy<ept id=\"p3\">***</ept> method."
    },
    {
      "pos": [
        12749,
        12798
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"paging\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Return data in pages"
    },
    {
      "content": "The first example shows how to select the top 5 items from a table.",
      "pos": [
        12800,
        12867
      ]
    },
    {
      "content": "The query returns the items from a table of  <bpt id=\"p1\">*</bpt>ToDoItems<ept id=\"p1\">*</ept>.",
      "pos": [
        12868,
        12925
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>mToDoTable<ept id=\"p1\">*</ept> is the reference to the mobile service table that you created previously.",
      "pos": [
        12926,
        13012
      ]
    },
    {
      "content": "Next, we define a query that skips the first 5 items, and then returns the next 5.",
      "pos": [
        13101,
        13183
      ]
    },
    {
      "pos": [
        13242,
        13297
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"selecting\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Select specific columns"
    },
    {
      "content": "The following code illustrates how to return all items from a table of  <bpt id=\"p1\">*</bpt>ToDoItems<ept id=\"p1\">*</ept>, but only displays the <bpt id=\"p2\">*</bpt>complete<ept id=\"p2\">*</ept> and <bpt id=\"p3\">*</bpt>text<ept id=\"p3\">*</ept> fields.",
      "pos": [
        13299,
        13435
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>mToDoTable<ept id=\"p1\">*</ept> is the reference to the mobile service table that we created previously.",
      "pos": [
        13436,
        13521
      ]
    },
    {
      "content": "Here the parameters to the select function are the string names of the table's columns that you want to return.",
      "pos": [
        13588,
        13699
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>select<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=290689)</ept> method needs to follow methods like <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>where<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=296296)</ept> and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>orderBy<ept id=\"p6\">**</ept><ept id=\"p5\">](http://go.microsoft.com/fwlink/p/?LinkId=296313)</ept>, if they are present.",
      "pos": [
        13701,
        13952
      ]
    },
    {
      "content": "It can be followed by methods like <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>top<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298731)</ept>.",
      "pos": [
        13953,
        14047
      ]
    },
    {
      "pos": [
        14053,
        14109
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"chaining\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Concatenate query methods"
    },
    {
      "content": "The methods used in querying mobile mervice tables can be concatenated.",
      "pos": [
        14111,
        14182
      ]
    },
    {
      "content": "This allows you to do things like select specific columns of filtered rows that are sorted and paged.",
      "pos": [
        14183,
        14284
      ]
    },
    {
      "content": "You can create quite complex logical filters.",
      "pos": [
        14285,
        14330
      ]
    },
    {
      "content": "What makes this work is that the query methods you use return <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MobileServiceQuery&amp;lt;T&amp;gt;<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298551)</ept> objects, which can in turn have additional methods invoked on them.",
      "pos": [
        14332,
        14544
      ]
    },
    {
      "content": "To end the series of methods and actually run the query, you call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>execute<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298554)</ept> method.",
      "pos": [
        14545,
        14685
      ]
    },
    {
      "pos": [
        14687,
        14782
      ],
      "content": "Here's a code sample where <bpt id=\"p1\">*</bpt>mToDoTable<ept id=\"p1\">*</ept> is a reference to the mobile services <bpt id=\"p2\">*</bpt>ToDoItem<ept id=\"p2\">*</ept> table."
    },
    {
      "content": "The main requirement in chaining methods together is that the <bpt id=\"p1\">*</bpt>where<ept id=\"p1\">*</ept> method and predicates need to come first.",
      "pos": [
        15119,
        15230
      ]
    },
    {
      "content": "After that, you can call subsequent methods in the order that best meets the needs of your application.",
      "pos": [
        15231,
        15334
      ]
    },
    {
      "pos": [
        15339,
        15404
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"inserting\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Insert data into a mobile service"
    },
    {
      "content": "The following code shows how to insert a new row into a table.",
      "pos": [
        15406,
        15468
      ]
    },
    {
      "pos": [
        15470,
        15551
      ],
      "content": "First you instantiate an instance of the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> class and set its properties."
    },
    {
      "content": "Next you execute the following code:",
      "pos": [
        15677,
        15713
      ]
    },
    {
      "content": "This code inserts the new item, and adds it to the adapter so it displays in the UI.",
      "pos": [
        16420,
        16504
      ]
    },
    {
      "content": "Mobile Services supports unique custom string values for the table id.",
      "pos": [
        16506,
        16576
      ]
    },
    {
      "content": "This allows applications to use custom values such as email addresses or usernames for the id column of a Mobile Services table.",
      "pos": [
        16577,
        16705
      ]
    },
    {
      "content": "For example if you wanted to identify each record by an email address, you could use the following JSON object.",
      "pos": [
        16706,
        16817
      ]
    },
    {
      "content": "If a string id value is not provided when inserting new records into a table, Mobile Services will generate a unique value for the id.",
      "pos": [
        16989,
        17123
      ]
    },
    {
      "content": "Supporting string ids provides the following advantages to developers",
      "pos": [
        17125,
        17194
      ]
    },
    {
      "content": "Ids can be generated without making a roundtrip to the database.",
      "pos": [
        17198,
        17262
      ]
    },
    {
      "content": "Records are easier to merge from different tables or databases.",
      "pos": [
        17265,
        17328
      ]
    },
    {
      "content": "Ids values can integrate better with an application's logic.",
      "pos": [
        17331,
        17391
      ]
    },
    {
      "content": "You can also use server scripts to set id values.",
      "pos": [
        17393,
        17442
      ]
    },
    {
      "content": "The script example below generates a custom GUID and assigns it to a new record's id.",
      "pos": [
        17443,
        17528
      ]
    },
    {
      "content": "This is similar to the id value that Mobile Services would generate if you didn't pass in a value for a record's id.",
      "pos": [
        17529,
        17645
      ]
    },
    {
      "content": "If an application provides a value for an id, Mobile Services will store it as is.",
      "pos": [
        18174,
        18256
      ]
    },
    {
      "content": "This includes leading or trailing white spaces.",
      "pos": [
        18257,
        18304
      ]
    },
    {
      "content": "White space will not be trimmed from value.",
      "pos": [
        18305,
        18348
      ]
    },
    {
      "pos": [
        18350,
        18447
      ],
      "content": "The value for the <ph id=\"ph1\">`id`</ph> must be unique and it must not include characters from the following sets:"
    },
    {
      "content": "Control characters: [0x0000-0x001F] and [0x007F-0x009F].",
      "pos": [
        18451,
        18507
      ]
    },
    {
      "content": "For more information, see [ASCII control codes C0 and C1].",
      "pos": [
        18508,
        18566
      ]
    },
    {
      "pos": [
        18570,
        18687
      ],
      "content": "Printable characters: <bpt id=\"p1\">**</bpt>\"<ept id=\"p1\">**</ept>(0x0022), <bpt id=\"p2\">**</bpt>\\+<ept id=\"p2\">**</ept> (0x002B), <bpt id=\"p3\">**</bpt>/<ept id=\"p3\">**</ept> (0x002F), <bpt id=\"p4\">**</bpt>?<ept id=\"p4\">**</ept> (0x003F), <bpt id=\"p5\">**</bpt>\\\\<ept id=\"p5\">**</ept> (0x005C), <bpt id=\"p6\">**</bpt>`<ept id=\"p6\">**</ept> (0x0060)"
    },
    {
      "content": "The ids \".\" and \"..\"",
      "pos": [
        18691,
        18711
      ]
    },
    {
      "content": "You can alternatively use integer Ids for your tables.",
      "pos": [
        18713,
        18767
      ]
    },
    {
      "content": "In order to use an integer Id you must create your table with the <ph id=\"ph1\">`mobile table create`</ph> command using the <ph id=\"ph2\">`--integerId`</ph> option.",
      "pos": [
        18768,
        18895
      ]
    },
    {
      "content": "This command is used with the Command-line Interface (CLI) for Azure.",
      "pos": [
        18896,
        18965
      ]
    },
    {
      "content": "For more information on using the CLI, see [CLI to manage Mobile Services tables].",
      "pos": [
        18966,
        19048
      ]
    },
    {
      "pos": [
        19053,
        19115
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"updating\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Update data in a mobile service"
    },
    {
      "content": "The following code shows how to update data in a table.",
      "pos": [
        19117,
        19172
      ]
    },
    {
      "content": "In this example, <bpt id=\"p1\">*</bpt>item<ept id=\"p1\">*</ept> is a reference to a row in the <bpt id=\"p2\">*</bpt>ToDoItem<ept id=\"p2\">*</ept> table, which has had some changes made to it.",
      "pos": [
        19173,
        19284
      ]
    },
    {
      "content": "The following method updates the table and the UI adapter.",
      "pos": [
        19285,
        19343
      ]
    },
    {
      "pos": [
        20194,
        20256
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"deleting\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Delete data in a mobile service"
    },
    {
      "content": "The following code shows how to delete data from a table.",
      "pos": [
        20258,
        20315
      ]
    },
    {
      "content": "It deletes an existing item from the ToDoItem table that has had the <bpt id=\"p1\">**</bpt>Completed<ept id=\"p1\">**</ept> check box on the UI checked.",
      "pos": [
        20316,
        20427
      ]
    },
    {
      "content": "The following code illustrates another way to do this.",
      "pos": [
        21366,
        21420
      ]
    },
    {
      "content": "It deletes an existing item in the ToDoItem table by specifying the value of the id field of the row to delete (assumed to equal \"2FA404AB-E458-44CD-BC1B-3BC847EF0902\").",
      "pos": [
        21421,
        21590
      ]
    },
    {
      "content": "In an actual app you would pick up the ID somehow and pass it in as a variable.",
      "pos": [
        21591,
        21670
      ]
    },
    {
      "content": "Here, to simplify testing, you can go into the Azure Mobile Services portal for your service, click <bpt id=\"p1\">**</bpt>Data<ept id=\"p1\">**</ept> and copy an ID that you wish to test with.",
      "pos": [
        21671,
        21822
      ]
    },
    {
      "content": "<ph id=\"ph1\">&lt;a name=\"lookup\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Look up a specific item",
      "pos": [
        22516,
        22568
      ]
    },
    {
      "content": "Sometimes you want to look up a specific item by its <bpt id=\"p1\">*</bpt>id<ept id=\"p1\">*</ept>, unlike querying where you typically get a collection of items that satisfy some criteria.",
      "pos": [
        22569,
        22717
      ]
    },
    {
      "content": "The following code shows how to do this, for an <bpt id=\"p1\">*</bpt>id<ept id=\"p1\">*</ept> value of <ph id=\"ph1\">`0380BAFB-BCFF-443C-B7D5-30199F730335`</ph>.",
      "pos": [
        22718,
        22819
      ]
    },
    {
      "content": "In an actual app you would pick up the ID somehow and pass it in as a variable.",
      "pos": [
        22820,
        22899
      ]
    },
    {
      "content": "Here, to simplify testing, you can go to the Azure Mobile Services portal for your service, click the <bpt id=\"p1\">**</bpt>Data<ept id=\"p1\">**</ept> tab and copy an ID that you wish to test with.",
      "pos": [
        22900,
        23057
      ]
    },
    {
      "pos": [
        23882,
        23934
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"untyped\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Work with untyped data"
    },
    {
      "content": "The untyped programming model gives you exact control over the JSON serialization, and there are some scenarios where you may wish to use it, for example, if your mobile service table contains a large number of columns and you only need to reference a few of them.",
      "pos": [
        23936,
        24200
      ]
    },
    {
      "content": "Using the typed model requires you to define all of the mobile service table's columns in your data class.",
      "pos": [
        24201,
        24307
      ]
    },
    {
      "content": "But with the untyped model you only define the columns you need to use.",
      "pos": [
        24308,
        24379
      ]
    },
    {
      "content": "Most of the API calls for accessing data are similar to the typed programming calls.",
      "pos": [
        24381,
        24465
      ]
    },
    {
      "content": "The main difference is that in the untyped model you invoke methods on the <bpt id=\"p1\">**</bpt>MobileServiceJsonTable<ept id=\"p1\">**</ept> object, instead of the <bpt id=\"p2\">**</bpt>MobileServiceTable<ept id=\"p2\">**</ept> object.",
      "pos": [
        24466,
        24621
      ]
    },
    {
      "pos": [
        24628,
        24702
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"json_instance\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Create an instance of an untyped table"
    },
    {
      "content": "Similar to the typed model, you start by getting a table reference, but in this case it's a <bpt id=\"p1\">[</bpt>MobileServicesJsonTable<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298733)</ept> object.",
      "pos": [
        24704,
        24878
      ]
    },
    {
      "content": "You get the reference by calling the <bpt id=\"p1\">[</bpt>getTable()<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298734)</ept> method on an instance of the Mobile Services client.",
      "pos": [
        24879,
        25030
      ]
    },
    {
      "content": "First you define the variable:",
      "pos": [
        25032,
        25062
      ]
    },
    {
      "pos": [
        25195,
        25397
      ],
      "content": "Once you create an instance of the Mobile Services client in the <bpt id=\"p1\">**</bpt>onCreate<ept id=\"p1\">**</ept> method (here, the <bpt id=\"p2\">*</bpt>mClient<ept id=\"p2\">*</ept> variable), you next create an instance of a <bpt id=\"p3\">**</bpt>MobileServiceJsonTable<ept id=\"p3\">**</ept>, with the following code."
    },
    {
      "content": "Once you have created an instance of the <bpt id=\"p1\">**</bpt>MobileServiceJsonTable<ept id=\"p1\">**</ept>, you can call almost all of the methods on it that you can with the typed programming model.",
      "pos": [
        25516,
        25676
      ]
    },
    {
      "content": "However in some cases the methods take an untyped parameter, as we see in the following examples.",
      "pos": [
        25677,
        25774
      ]
    },
    {
      "pos": [
        25780,
        25842
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"json_insert\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Insert into an untyped table"
    },
    {
      "content": "The following code shows how to do an insert.",
      "pos": [
        25844,
        25889
      ]
    },
    {
      "content": "The first step is to create a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>JsonObject<ept id=\"p2\">**</ept><ept id=\"p1\">](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/JsonObject.html)</ept>, which is part of the <ph id=\"ph1\">&lt;a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\"&gt;</ph>gson<ph id=\"ph2\">&lt;/a&gt;</ph> library.",
      "pos": [
        25890,
        26147
      ]
    },
    {
      "content": "The next step is to insert the object.",
      "pos": [
        26284,
        26322
      ]
    },
    {
      "content": "The callback function passed to the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>insert<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=298535)</ept> method is an instance of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TableJsonOperationCallback<ept id=\"p4\">**</ept><ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=298532)</ept> class.",
      "pos": [
        26323,
        26538
      ]
    },
    {
      "content": "Note how the parameter of the <bpt id=\"p1\">*</bpt>insert<ept id=\"p1\">*</ept> method is a JsonObject.",
      "pos": [
        26539,
        26601
      ]
    },
    {
      "content": "If you need to get the ID of the inserted object, use this method call:",
      "pos": [
        27076,
        27147
      ]
    },
    {
      "pos": [
        27220,
        27282
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"json_delete\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Delete from an untyped table"
    },
    {
      "content": "The following code shows how to delete an instance, in this case, the same instance of a <bpt id=\"p1\">**</bpt>JsonObject<ept id=\"p1\">**</ept> that was created in the prior <bpt id=\"p2\">*</bpt>insert<ept id=\"p2\">*</ept> example.",
      "pos": [
        27284,
        27435
      ]
    },
    {
      "content": "Note that the code is the same as with the typed case, but the method has a different signature since it references an <bpt id=\"p1\">**</bpt>JsonObject<ept id=\"p1\">**</ept>.",
      "pos": [
        27436,
        27570
      ]
    },
    {
      "content": "You can also delete an instance directly by using its ID:",
      "pos": [
        27609,
        27666
      ]
    },
    {
      "pos": [
        27707,
        27775
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"json_get\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Return all rows from an untyped table"
    },
    {
      "content": "The following code shows how to retrieve an entire table.",
      "pos": [
        27777,
        27834
      ]
    },
    {
      "content": "Since you are using a JSON Table, you can selectively retrieve only some of the table's columns.",
      "pos": [
        27835,
        27931
      ]
    },
    {
      "content": "You can do filtering, sorting and paging by concatenating  methods that have the same names as those used in the typed programming model.",
      "pos": [
        29436,
        29573
      ]
    },
    {
      "pos": [
        29578,
        29639
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"binding\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Bind data to the user interface"
    },
    {
      "content": "Data binding involves three components:",
      "pos": [
        29641,
        29680
      ]
    },
    {
      "content": "the data source",
      "pos": [
        29684,
        29699
      ]
    },
    {
      "content": "the screen layout",
      "pos": [
        29702,
        29719
      ]
    },
    {
      "content": "and the adapter that ties the two together.",
      "pos": [
        29722,
        29765
      ]
    },
    {
      "content": "In our sample code, we return the data from the mobile service table <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> into an array.",
      "pos": [
        29767,
        29861
      ]
    },
    {
      "content": "This is one very common pattern for data applications: database queries typically return a collection of rows which the client gets in a list or array.",
      "pos": [
        29862,
        30013
      ]
    },
    {
      "content": "In this sample the array is the data source.",
      "pos": [
        30014,
        30058
      ]
    },
    {
      "content": "The code specifies a screen layout that defines the view of the data that will appear on the device.",
      "pos": [
        30060,
        30160
      ]
    },
    {
      "pos": [
        30162,
        30289
      ],
      "content": "And the two are bound together with an adapter, which in this code is an extension of the <bpt id=\"p1\">*</bpt>ArrayAdapter&amp;lt;ToDoItem&amp;gt;<ept id=\"p1\">*</ept> class."
    },
    {
      "pos": [
        30295,
        30341
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"layout\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Define the Layout"
    },
    {
      "content": "The layout is defined by several snippets of XML code.",
      "pos": [
        30343,
        30397
      ]
    },
    {
      "content": "Given an existing layout, let's assume the following code represents the <bpt id=\"p1\">**</bpt>ListView<ept id=\"p1\">**</ept> we want to populate with our server data.",
      "pos": [
        30398,
        30525
      ]
    },
    {
      "content": "In the above code the <bpt id=\"p1\">*</bpt>listitem<ept id=\"p1\">*</ept> attribute specifies the id of the layout for an individual row in the list.",
      "pos": [
        30737,
        30845
      ]
    },
    {
      "content": "Here is that code, which specifies a check box and its associated text.",
      "pos": [
        30846,
        30917
      ]
    },
    {
      "content": "This gets instantiated once for each item in the list.",
      "pos": [
        30918,
        30972
      ]
    },
    {
      "content": "A more complex layout would specify additional fields in the display.",
      "pos": [
        30973,
        31042
      ]
    },
    {
      "content": "This code is in the <bpt id=\"p1\">*</bpt>row_list_to_do.xml<ept id=\"p1\">*</ept> file.",
      "pos": [
        31043,
        31089
      ]
    },
    {
      "pos": [
        31579,
        31627
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"adapter\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Define the adapter"
    },
    {
      "content": "Since the data source of our view is an array of <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept>, we subclass our adapter from a <bpt id=\"p2\">*</bpt>ArrayAdapter&amp;lt;ToDoItem&amp;gt;<ept id=\"p2\">*</ept> class.",
      "pos": [
        31629,
        31758
      ]
    },
    {
      "content": "This subclass will produce a View for every <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> using the <bpt id=\"p2\">*</bpt>row_list_to_do<ept id=\"p2\">*</ept> layout.",
      "pos": [
        31759,
        31848
      ]
    },
    {
      "pos": [
        31850,
        31951
      ],
      "content": "In our code we define the following class which is an extension of the <bpt id=\"p1\">*</bpt>ArrayAdapter&amp;lt;E&amp;gt;<ept id=\"p1\">*</ept> class:"
    },
    {
      "content": "You must override the adapter's <bpt id=\"p1\">*</bpt>getView<ept id=\"p1\">*</ept> method.",
      "pos": [
        32021,
        32070
      ]
    },
    {
      "content": "This sample code is one example of how to do this: details will vary with your application.",
      "pos": [
        32071,
        32162
      ]
    },
    {
      "content": "We create an instance of this class in our Activity as follows:",
      "pos": [
        32790,
        32853
      ]
    },
    {
      "content": "Note that the second parameter to the ToDoItemAdapter constructor is a reference to the layout.",
      "pos": [
        32953,
        33048
      ]
    },
    {
      "content": "The call to the constructor is followed by the following code which first gets a reference to the <bpt id=\"p1\">**</bpt>ListView<ept id=\"p1\">**</ept>, and next calls <bpt id=\"p2\">*</bpt>setAdapter<ept id=\"p2\">*</ept> to configure itself to use the adapter we just created:",
      "pos": [
        33049,
        33244
      ]
    },
    {
      "pos": [
        33363,
        33412
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"use-adapter\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Use the adapter"
    },
    {
      "content": "You are now ready to use data binding.",
      "pos": [
        33414,
        33452
      ]
    },
    {
      "content": "The following code shows how to get the items in the mobile service table, clear the apapter, and then call the adapter's <bpt id=\"p1\">*</bpt>add<ept id=\"p1\">*</ept> method to fill it with the returned items.",
      "pos": [
        33453,
        33623
      ]
    },
    {
      "content": "You must also call the adapter any time you modify the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> table if you want to display the results of doing that.",
      "pos": [
        34466,
        34587
      ]
    },
    {
      "content": "Since modifications are done on a record by record basis, you will be dealing with a single row instead of a collection.",
      "pos": [
        34588,
        34708
      ]
    },
    {
      "content": "When you insert an item you call the <bpt id=\"p1\">*</bpt>add<ept id=\"p1\">*</ept> method on the adapter, when deleting, you call the <bpt id=\"p2\">*</bpt>remove<ept id=\"p2\">*</ept> method.",
      "pos": [
        34709,
        34819
      ]
    },
    {
      "pos": [
        34824,
        34879
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"authentication\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Authenticate users"
    },
    {
      "content": "Mobile Services supports authenticating and authorizing app users using a variety of external identity providers: Facebook, Google, Microsoft Account, Twitter, and Azure Active Directory.",
      "pos": [
        34881,
        35068
      ]
    },
    {
      "content": "You can set permissions on tables to restrict access for specific operations to only authenticated users.",
      "pos": [
        35069,
        35174
      ]
    },
    {
      "content": "You can also use the identity of authenticated users to implement authorization rules in your backend.",
      "pos": [
        35175,
        35277
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Get started with authentication<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296316)</ept>.",
      "pos": [
        35278,
        35387
      ]
    },
    {
      "content": "Two authentication flows are supported: a <bpt id=\"p1\">*</bpt>server<ept id=\"p1\">*</ept> flow and a <bpt id=\"p2\">*</bpt>client<ept id=\"p2\">*</ept> flow.",
      "pos": [
        35389,
        35465
      ]
    },
    {
      "content": "The server flow provides the simplest authentication experience, as it relies on the provider's web authentication interface.",
      "pos": [
        35466,
        35591
      ]
    },
    {
      "content": "The client flow allows for deeper integration with device-specific capabilities such as single-sign-on as it relies on provider-specific device-specific SDKs.",
      "pos": [
        35592,
        35750
      ]
    },
    {
      "content": "Three steps are required to enable authentication in your app:",
      "pos": [
        35752,
        35814
      ]
    },
    {
      "content": "Register your app for authentication with a provider, and configure Mobile Services",
      "pos": [
        35818,
        35901
      ]
    },
    {
      "content": "Restrict table permissions to authenticated users only",
      "pos": [
        35904,
        35958
      ]
    },
    {
      "content": "Add authentication code to your app",
      "pos": [
        35961,
        35996
      ]
    },
    {
      "content": "Mobile Services supports the following existing identity providers that you can use to authenticate users:",
      "pos": [
        35999,
        36105
      ]
    },
    {
      "content": "Microsoft Account",
      "pos": [
        36109,
        36126
      ]
    },
    {
      "content": "Facebook",
      "pos": [
        36129,
        36137
      ]
    },
    {
      "content": "Twitter",
      "pos": [
        36140,
        36147
      ]
    },
    {
      "content": "Google",
      "pos": [
        36150,
        36156
      ]
    },
    {
      "content": "Azure Active Directory",
      "pos": [
        36159,
        36181
      ]
    },
    {
      "content": "You can set permissions on tables to restrict access for specific operations to only authenticated users.",
      "pos": [
        36183,
        36288
      ]
    },
    {
      "content": "You can also use the ID of an authenticated user to modify requests.",
      "pos": [
        36289,
        36357
      ]
    },
    {
      "content": "These first two tasks are done using the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com/)</ept>.",
      "pos": [
        36359,
        36460
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Get started with authentication<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=296316)</ept>.",
      "pos": [
        36461,
        36570
      ]
    },
    {
      "pos": [
        36576,
        36641
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"caching\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Add authentication code to your app"
    },
    {
      "content": "Add the following import statements to your app's activity file.",
      "pos": [
        36647,
        36711
      ]
    },
    {
      "pos": [
        37180,
        37401
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>onCreate<ept id=\"p1\">**</ept> method of the activity class, add the following line of code after the code that creates the <ph id=\"ph1\">`MobileServiceClient`</ph> object: we assume that the reference to the <ph id=\"ph2\">`MobileServiceClient`</ph> object is <bpt id=\"p2\">*</bpt>mClient<ept id=\"p2\">*</ept>."
    },
    {
      "content": "This code authenticates the user using a Google login.",
      "pos": [
        38096,
        38150
      ]
    },
    {
      "content": "A dialog is displayed which displays the ID of the authenticated user.",
      "pos": [
        38151,
        38221
      ]
    },
    {
      "content": "You cannot proceed without a positive authentication.",
      "pos": [
        38222,
        38275
      ]
    },
    {
      "pos": [
        38283,
        38508
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> If you are using an identity provider other than Google, change the value passed to the <bpt id=\"p1\">**</bpt>login<ept id=\"p1\">**</ept> method above to one of the following: <bpt id=\"p2\">_</bpt>MicrosoftAccount<ept id=\"p2\">_</ept>, <bpt id=\"p3\">_</bpt>Facebook<ept id=\"p3\">_</ept>, <bpt id=\"p4\">_</bpt>Twitter<ept id=\"p4\">_</ept>, or <bpt id=\"p5\">_</bpt>WindowsAzureActiveDirectory<ept id=\"p5\">_</ept>."
    },
    {
      "content": "When you run the app, sign in with your chosen identity provider.",
      "pos": [
        38514,
        38579
      ]
    },
    {
      "pos": [
        38586,
        38643
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"caching\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Cache authentication tokens"
    },
    {
      "content": "This section shows how to cache an authentication token.",
      "pos": [
        38645,
        38701
      ]
    },
    {
      "content": "Do this to prevent users from having to authenticate again if app is \"hibernated\" while the token is still valid.",
      "pos": [
        38702,
        38815
      ]
    },
    {
      "content": "Caching authentication tokens requires you to store the User ID and authentication token locally on the device.",
      "pos": [
        38817,
        38928
      ]
    },
    {
      "content": "The next time the app starts, you check the cache, and if these values are present, you can skip the log in procedure and re-hydrate the client with this data.",
      "pos": [
        38929,
        39088
      ]
    },
    {
      "content": "However this data is sensitive, and it should be stored encrypted for safety in case the phone gets stolen.",
      "pos": [
        39089,
        39196
      ]
    },
    {
      "content": "The following code snippet demonstrates obtaining a token for a Microsoft Account log in.",
      "pos": [
        39198,
        39287
      ]
    },
    {
      "content": "The token is cached and reloaded if the cache is found.",
      "pos": [
        39288,
        39343
      ]
    },
    {
      "content": "So what happens if your token expires?",
      "pos": [
        41244,
        41282
      ]
    },
    {
      "content": "In this case, when you try to use it to connect, you will get a <bpt id=\"p1\">*</bpt>401 unauthorized<ept id=\"p1\">*</ept> response.",
      "pos": [
        41283,
        41375
      ]
    },
    {
      "content": "The user must then log in to obtain new tokens.",
      "pos": [
        41376,
        41423
      ]
    },
    {
      "content": "You can avoid having to write code to handle this in every place in your app that calls your mobile service by using filters, which allow you to intercept calls to and responses from Mobile Services.",
      "pos": [
        41424,
        41623
      ]
    },
    {
      "content": "The filter code will then test the response for a 401, trigger the sign-in process if needed, and then resume the request that generated the 401.",
      "pos": [
        41624,
        41769
      ]
    },
    {
      "pos": [
        41774,
        41828
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"customizing\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Customize the client"
    },
    {
      "content": "There are several ways for you to customize the default behavior of the Mobile Services client.",
      "pos": [
        41830,
        41925
      ]
    },
    {
      "pos": [
        41931,
        41986
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"headers\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Customize request headers"
    },
    {
      "content": "You might want to attach a custom header to every outgoing request.",
      "pos": [
        41988,
        42055
      ]
    },
    {
      "content": "You can accomplish that by configuring a <bpt id=\"p1\">**</bpt>ServiceFilter<ept id=\"p1\">**</ept> like this:",
      "pos": [
        42056,
        42125
      ]
    },
    {
      "pos": [
        42916,
        42975
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"serialization\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Customize serialization"
    },
    {
      "content": "Mobile Services assumes by default that the table names, column names and data types on the server all match exactly what is on the client.",
      "pos": [
        42977,
        43116
      ]
    },
    {
      "content": "But there can be any number of reasons why the server and client names might not match.",
      "pos": [
        43117,
        43204
      ]
    },
    {
      "content": "One example might be if you have an existing client that you want to change so that it uses Mobile Services instead of a competitor's product.",
      "pos": [
        43205,
        43347
      ]
    },
    {
      "content": "You might want to do the following kinds of customizations:",
      "pos": [
        43349,
        43408
      ]
    },
    {
      "content": "The column names used in the mobile-  service table don't match the names you are using in the client",
      "pos": [
        43412,
        43513
      ]
    },
    {
      "content": "Use a mobile service table that has a different name than the class it maps to in the client",
      "pos": [
        43516,
        43608
      ]
    },
    {
      "content": "Turn on automatic property capitalization",
      "pos": [
        43611,
        43652
      ]
    },
    {
      "content": "Add complex properties to an object",
      "pos": [
        43655,
        43690
      ]
    },
    {
      "pos": [
        43696,
        43763
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"columns\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Map different client and server names"
    },
    {
      "pos": [
        43765,
        43891
      ],
      "content": "Suppose that your Java client code uses standard Java-style names for the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> object properties, such as the following."
    },
    {
      "content": "mId",
      "pos": [
        43895,
        43898
      ]
    },
    {
      "content": "mText",
      "pos": [
        43901,
        43906
      ]
    },
    {
      "content": "mComplete",
      "pos": [
        43909,
        43918
      ]
    },
    {
      "content": "mDuration",
      "pos": [
        43921,
        43930
      ]
    },
    {
      "content": "You must serialize the client names into JSON names that match the column names of the <bpt id=\"p1\">*</bpt>ToDoItem<ept id=\"p1\">*</ept> table on the server.",
      "pos": [
        43933,
        44051
      ]
    },
    {
      "content": "The following code, which makes use of the <ph id=\"ph1\">&lt;a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\"&gt;</ph>gson<ph id=\"ph2\">&lt;/a&gt;</ph> library does this.",
      "pos": [
        44052,
        44197
      ]
    },
    {
      "pos": [
        44545,
        44633
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"table\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Map different table names between client and mobile services"
    },
    {
      "content": "Mapping the client table name to a different mobile services table name is easy, we just use one of the overrides of the",
      "pos": [
        44635,
        44755
      ]
    },
    {
      "content": "<ph id=\"ph1\">&lt;a href=\"http://go.microsoft.com/fwlink/p/?LinkId=296840\" target=\"_blank\"&gt;</ph>getTable()<ph id=\"ph2\">&lt;/a&gt;</ph> function, as seen in the following code.",
      "pos": [
        44756,
        44885
      ]
    },
    {
      "pos": [
        44962,
        45025
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"conversions\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Automate column name mappings"
    },
    {
      "content": "Mapping column names for a narrow table with only a few columns isn't a big deal, as we saw in the prior section.",
      "pos": [
        45027,
        45140
      ]
    },
    {
      "content": "But suppose our table has a lot of columns, say 20 or 30.",
      "pos": [
        45141,
        45198
      ]
    },
    {
      "content": "It turns out that we can call the <ph id=\"ph1\">&lt;a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\"&gt;</ph>gson<ph id=\"ph2\">&lt;/a&gt;</ph> API and specify a conversion strategy that will apply to every column, and avoid having to annotate every single column name.",
      "pos": [
        45199,
        45442
      ]
    },
    {
      "pos": [
        45444,
        45693
      ],
      "content": "To do this we use the <ph id=\"ph1\">&lt;a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\"&gt;</ph>gson<ph id=\"ph2\">&lt;/a&gt;</ph> library which the Android client library uses behind the scenes to serialize Java objects to JSON data, which is sent to Azure Mobile Services."
    },
    {
      "content": "The following code uses the <bpt id=\"p1\">*</bpt>setFieldNamingStrategy()<ept id=\"p1\">*</ept> method, in which we define a <bpt id=\"p2\">*</bpt>FieldNamingStrategy()<ept id=\"p2\">*</ept> method.",
      "pos": [
        45695,
        45810
      ]
    },
    {
      "content": "This method says to delete the initial character (an \"m\"), and then lower-case the next character, for every field name.",
      "pos": [
        45811,
        45931
      ]
    },
    {
      "content": "This code also enables pretty-printing of the output JSON.",
      "pos": [
        45932,
        45990
      ]
    },
    {
      "content": "This code must be executed prior to any method calls on the Mobile Services client object.",
      "pos": [
        46424,
        46514
      ]
    },
    {
      "pos": [
        46520,
        46596
      ],
      "content": "<ph id=\"ph1\">&lt;a name=\"complex\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Store an object or array property into a table"
    },
    {
      "content": "So far all of our serialization examples have involved primitive types such as integers and strings which easily serialize into JSON and into the mobile services table.",
      "pos": [
        46598,
        46766
      ]
    },
    {
      "content": "Suppose we want to add a complex object to our client type, which doesn't automatically serialize to JSON and to the table.",
      "pos": [
        46767,
        46890
      ]
    },
    {
      "content": "For example we might want to add an array of strings to the client object.",
      "pos": [
        46891,
        46965
      ]
    },
    {
      "content": "It is now up to us to specify how to do the serialization, and how to store the array into the mobile services table.",
      "pos": [
        46966,
        47083
      ]
    },
    {
      "pos": [
        47085,
        47425
      ],
      "content": "To see an example of how to do this, check out the blog post <ph id=\"ph1\">&lt;a href=\"http://hashtagfail.com/post/44606137082/mobile-services-android-serialization-gson\" target=\"_blank\"&gt;</ph>Customizing serialization using the <ph id=\"ph2\">&lt;a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\"&gt;</ph>gson<ph id=\"ph3\">&lt;/a&gt;</ph> library in the Mobile Services Android client<ph id=\"ph4\">&lt;/a&gt;</ph>."
    },
    {
      "content": "This general method can be used whenever we have a complex object that is not automatically serializable into JSON and the mobile services table.",
      "pos": [
        47427,
        47572
      ]
    },
    {
      "content": "test",
      "pos": [
        49018,
        49022
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Working with the Mobile Services Android Client Library\"\n    description=\"Learn how to use an Android client for Azure Mobile Services.\"\n    services=\"mobile-services\"\n    documentationCenter=\"android\"\n    authors=\"RickSaling\"\n    manager=\"dwrede\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"mobile-services\"\n    ms.workload=\"mobile\"\n    ms.tgt_pltfrm=\"mobile-android\"\n    ms.devlang=\"java\"\n    ms.topic=\"article\"\n    ms.date=\"06/16/2015\" \n    ms.author=\"ricksal\"/>\n\n\n# How to use the Android client library for Mobile Services\n\n[AZURE.INCLUDE [mobile-services-selector-client-library](../../includes/mobile-services-selector-client-library.md)]\n\nThis guide shows you how to perform common scenarios using the Android client for Azure Mobile Services.  The scenarios covered include querying for data; inserting, updating, and deleting data, authenticating users, handling errors, and customizing the client.\n\nIf you are new to Mobile Services, you should first complete the quickstart tutorial [Get started with Mobile Services]. Successfully completing that tutorial ensures that you will have  installed Android Studio; it will help you configure your account and create your first mobile service, and install the Mobile Services SDK, which supports Android version 2.2 or later, but we recommend building against Android version 4.2 or later.\n\nYou can find the Javadocs API reference for the Android client library [here](http://go.microsoft.com/fwlink/p/?LinkId=298735).\n\n[AZURE.INCLUDE [mobile-services-concepts](../../includes/mobile-services-concepts.md)]\n\n##<a name=\"setup\"></a>Setup and Prerequisites\n\nWe assume that you have created a mobile service and a table. For more information see [Create a table](http://go.microsoft.com/fwlink/p/?LinkId=298592). In the code used in this topic, we assume the table is named *ToDoItem*, and that it has the following columns:\n\n- id\n- text\n- complete\n\nThe corresponding typed client side object is the following:\n\n    public class ToDoItem {\n        private String id;\n        private String text;\n        private Boolean complete;\n    }\n\nWhen dynamic schema is enabled, Azure Mobile Services automatically generates new columns based on the object in the insert or update request. For more information, see [Dynamic schema](http://go.microsoft.com/fwlink/p/?LinkId=296271).\n\n##<a name=\"create-client\"></a>How to: Create the Mobile Services client\nThe following code creates the [MobileServiceClient](http://dl.windowsazure.com/androiddocs/com/microsoft/windowsazure/mobileservices/MobileServiceClient.html) object that is used to access your mobile service. The code goes in the `onCreate` method of the Activity class specified in *AndroidManifest.xml* as a **MAIN** action and **LAUNCHER** category.\n\n        MobileServiceClient mClient = new MobileServiceClient(\n                \"MobileServiceUrl\", // Replace with the above Site URL\n                \"AppKey\",           // replace with the Application Key\n                this)\n\nIn the code above, replace `MobileServiceUrl` and `AppKey` with the mobile service URL and application key, in that order. Both of these are available on the Azure Management Portal, by selecting your mobile service and then clicking on *Dashboard*.\n\n##<a name=\"instantiating\"></a>How to: Create a table reference\n\nThe easiest way to query or modify data in the mobile service is by using the *typed programming model*, since Java is a strongly typed language (later on we will discuss the *untyped* model). This model provides seamless serialization and deserialization to JSON using the [gson](http://go.microsoft.com/fwlink/p/?LinkId=290801) library when sending data between the client and the mobile service: the developer doesn't have to do anything, the framework handles it all.\n\nThe first thing you do to query or modify data is to create a [MobileServiceTable](http://go.microsoft.com/fwlink/p/?LinkId=296835) object by calling the **getTable** method on the [**MobileServiceClient**](http://dl.windowsazure.com/androiddocs/com/microsoft/windowsazure/mobileservices/MobileServiceClient.html).  We will look at two overloads of this method:\n\n    public class MobileServiceClient {\n        public <E> MobileServiceTable<E> getTable(Class<E> clazz);\n        public <E> MobileServiceTable<E> getTable(String name, Class<E> clazz);\n    }\n\nIn the following code, *mClient* is a reference to your mobile service client.\n\nThe [first overload](http://go.microsoft.com/fwlink/p/?LinkId=296839) is used where the class name and the table name are the same:\n\n        MobileServiceTable<ToDoItem> mToDoTable = mClient.getTable(ToDoItem.class);\n\n\nThe [2nd overload](http://go.microsoft.com/fwlink/p/?LinkId=296840) is used when the table name is different from the type name.\n\n        MobileServiceTable<ToDoItem> mToDoTable = mClient.getTable(\"ToDoItemBackup\", ToDoItem.class);\n\n## <a name=\"api\"></a>The API structure\n\nSince version 2.0 of the client library, mobile services table operations use the [Future](http://developer.android.com/reference/java/util/concurrent/Future.html) and [AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html) objects in all of the asynchronous operations such as methods involving queries and operations like inserts, updates and deletes. This makes it easier to perform multiple operations (while on a background thread) without having to deal with multiple nested callbacks.\n\n\n##<a name=\"querying\"></a>How to: Query data from a mobile service\n\nThis section describes how to issue queries to the mobile service. Subsections describe diffent aspects such as sorting, filtering, and paging. Finally, we discuss how you can concatenate these operations together.\n\n### <a name=\"showAll\"></a>How to: Return all Items from a Table\n\nThe following code returns all items in the *ToDoItem* table. It displays them in the UI by adding the items to an adapter. This code is similar to what is in the the quickstart tutorial [Get started with Mobile Services].\n\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n\n                    final MobileServiceList<ToDoItem> result = mToDoTable.execute().get();\n                    runOnUiThread(new Runnable() {\n\n                        @Override\n                        public void run() {\n                            mAdapter.clear();\n                            for (ToDoItem item : result) {\n                                mAdapter.add(item);\n                            }\n                        }\n                    });\n               } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n               }\n               return result;\n            }\n        }.execute();\n\n\nQueries like this one use the [AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html) object.\n\nThe *result* variable returns the result set from the query, and the code following the `mToDoTable.execute().get()` statement shows how to display the individual rows.\n\n\n### <a name=\"filtering\"></a>How to: Filter returned data\n\nThe following code returns all items from the *ToDoItem* table whose *complete* field equals *false*. *mToDoTable* is the reference to the mobile service table that we created previously.\n\n        new AsyncTask<Void, Void, Void>() {\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    final MobileServiceList<ToDoItem> result =\n                        mToDoTable.where().field(\"complete\").eq(false).execute().get();\n                    for (ToDoItem item : result) {\n                        Log.i(TAG, \"Read object with ID \" + item.id);  \n                    }\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n\n\n\nYou start a filter with a [**where**](http://go.microsoft.com/fwlink/p/?LinkId=296867) method call on the table reference. This is followed by a [**field**](http://go.microsoft.com/fwlink/p/?LinkId=296869) method call followed by a method call that specifies the logical predicate. Possible predicate methods include [**eq**](http://go.microsoft.com/fwlink/p/?LinkId=298461), [**ne**](http://go.microsoft.com/fwlink/p/?LinkId=298462), [**gt**](http://go.microsoft.com/fwlink/p/?LinkId=298463), [**ge**](http://go.microsoft.com/fwlink/p/?LinkId=298464), [**lt**](http://go.microsoft.com/fwlink/p/?LinkId=298465), [**le**](http://go.microsoft.com/fwlink/p/?LinkId=298466) etc.\n\nThis is sufficient for comparing number and string fields to specific values. But you can do a lot more.\n\nFor example, you can filter on dates. You can compare the entire date field, but you can also compare parts of the date, with methods such as [**year**](http://go.microsoft.com/fwlink/p/?LinkId=298467), [**month**](http://go.microsoft.com/fwlink/p/?LinkId=298468), [**day**](http://go.microsoft.com/fwlink/p/?LinkId=298469), [**hour**](http://go.microsoft.com/fwlink/p/?LinkId=298470), [**minute**](http://go.microsoft.com/fwlink/p/?LinkId=298471) and [**second**](http://go.microsoft.com/fwlink/p/?LinkId=298472). The following partial code adds a filter for items whose *due date* equals 2013.\n\n        mToDoTable.where().year(\"due\").eq(2013).execute().get();\n\nYou can do a wide variety of complex filters on string fields with methods like [**startsWith**](http://go.microsoft.com/fwlink/p/?LinkId=298473), [**endsWith**](http://go.microsoft.com/fwlink/p/?LinkId=298474), [**concat**](http://go.microsoft.com/fwlink/p/?LinkId=298475), [**subString**](http://go.microsoft.com/fwlink/p/?LinkId=298477), [**indexOf**](http://go.microsoft.com/fwlink/p/?LinkId=298488), [**replace**](http://go.microsoft.com/fwlink/p/?LinkId=298491), [**toLower**](http://go.microsoft.com/fwlink/p/?LinkId=298492), [**toUpper**](http://go.microsoft.com/fwlink/p/?LinkId=298493), [**trim**](http://go.microsoft.com/fwlink/p/?LinkId=298495), and [**length**](http://go.microsoft.com/fwlink/p/?LinkId=298496). The following partial code filters for table rows where the *text* column starts with \"PRI0\".\n\n        mToDoTable.where().startsWith(\"text\", \"PRI0\").execute().get();\n\nNumber fields also allow a wide variety of more complex filters with methods like [**add**](http://go.microsoft.com/fwlink/p/?LinkId=298497), [**sub**](http://go.microsoft.com/fwlink/p/?LinkId=298499), [**mul**](http://go.microsoft.com/fwlink/p/?LinkId=298500), [**div**](http://go.microsoft.com/fwlink/p/?LinkId=298502), [**mod**](http://go.microsoft.com/fwlink/p/?LinkId=298503), [**floor**](http://go.microsoft.com/fwlink/p/?LinkId=298505), [**ceiling**](http://go.microsoft.com/fwlink/p/?LinkId=298506), and [**round**](http://go.microsoft.com/fwlink/p/?LinkId=298507). The following partial code filters for table rows where the *duration* is an even number.\n\n        mToDoTable.where().field(\"duration\").mod(2).eq(0).execute().get();\n\n\nYou can combine predicates with methods like [**and**](http://go.microsoft.com/fwlink/p/?LinkId=298512), [**or**](http://go.microsoft.com/fwlink/p/?LinkId=298514) and [**not**](http://go.microsoft.com/fwlink/p/?LinkId=298515). This partial code combines two of the above examples.\n\n        mToDoTable.where().year(\"due\").eq(2013).and().startsWith(\"text\", \"PRI0\")\n                    .execute().get();\n\nAnd you can group and nest logical operators, as shown in this partial code:\n\n        mToDoTable.where()\n                    .year(\"due\").eq(2013)\n                        .and\n                    (startsWith(\"text\", \"PRI0\").or().field(\"duration\").gt(10))\n                    .execute().get();\n\nFor more detailed discussion and examples of filtering, see [Exploring the richness of the Mobile Services Android client query model](http://hashtagfail.com/post/46493261719/mobile-services-android-querying).\n\n### <a name=\"sorting\"></a>How to: Sort returned data\n\nThe following code returns all items from a table of *ToDoItems* sorted ascending by the *text* field. *mToDoTable* is the reference to the mobile mervice table that you created previously.\n\n        mToDoTable.orderBy(\"text\", QueryOrder.Ascending).execute().get();\n\nThe first parameter of the [**orderBy**](http://go.microsoft.com/fwlink/p/?LinkId=298519) method is a string equal to the name of the field on which to sort.\n\nThe second parameter uses the [**QueryOrder**](http://go.microsoft.com/fwlink/p/?LinkId=298521) enumeration to specify whether to sort ascending or descending.\n\nNote that if you are filtering using the ***where*** method, the ***where*** method must be invoked prior to the ***orderBy*** method.\n\n### <a name=\"paging\"></a>How to: Return data in pages\n\nThe first example shows how to select the top 5 items from a table. The query returns the items from a table of  *ToDoItems*. *mToDoTable* is the reference to the mobile service table that you created previously.\n\n       final MobileServiceList<ToDoItem> result = mToDoTable.top(5).execute().get();\n\n\nNext, we define a query that skips the first 5 items, and then returns the next 5.\n\n        mToDoTable.skip(5).top(5).execute().get();\n\n\n### <a name=\"selecting\"></a>How to: Select specific columns\n\nThe following code illustrates how to return all items from a table of  *ToDoItems*, but only displays the *complete* and *text* fields. *mToDoTable* is the reference to the mobile service table that we created previously.\n\n        mToDoTable.select(\"complete\", \"text\").execute().get();\n\n\nHere the parameters to the select function are the string names of the table's columns that you want to return.\n\nThe [**select**](http://go.microsoft.com/fwlink/p/?LinkId=290689) method needs to follow methods like [**where**](http://go.microsoft.com/fwlink/p/?LinkId=296296) and [**orderBy**](http://go.microsoft.com/fwlink/p/?LinkId=296313), if they are present. It can be followed by methods like [**top**](http://go.microsoft.com/fwlink/p/?LinkId=298731).\n\n### <a name=\"chaining\"></a>How to: Concatenate query methods\n\nThe methods used in querying mobile mervice tables can be concatenated. This allows you to do things like select specific columns of filtered rows that are sorted and paged. You can create quite complex logical filters.\n\nWhat makes this work is that the query methods you use return [**MobileServiceQuery&lt;T&gt;**](http://go.microsoft.com/fwlink/p/?LinkId=298551) objects, which can in turn have additional methods invoked on them. To end the series of methods and actually run the query, you call the [**execute**](http://go.microsoft.com/fwlink/p/?LinkId=298554) method.\n\nHere's a code sample where *mToDoTable* is a reference to the mobile services *ToDoItem* table.\n\n        mToDoTable.where().year(\"due\").eq(2013)\n                        .and().startsWith(\"text\", \"PRI0\")\n                        .or().field(\"duration\").gt(10)\n                    .select(\"id\", \"complete\", \"text\", \"duration\")\n                    .orderBy(duration, QueryOrder.Ascending).top(20)\n                    .execute().get();\n\nThe main requirement in chaining methods together is that the *where* method and predicates need to come first. After that, you can call subsequent methods in the order that best meets the needs of your application.\n\n\n##<a name=\"inserting\"></a>How to: Insert data into a mobile service\n\nThe following code shows how to insert a new row into a table.\n\nFirst you instantiate an instance of the *ToDoItem* class and set its properties.\n\n        ToDoItem mToDoItem = new ToDoItem();\n        mToDoItem.text = \"Test Program\";\n        mToDoItem.complete = false;\n\n Next you execute the following code:\n\n        // Insert the new item\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    mToDoTable.insert(item).get();\n                    if (!item.isComplete()) {\n                        runOnUiThread(new Runnable() {\n                            public void run() {\n                                mAdapter.add(item);\n                            }\n                        });\n                    }\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n\n\nThis code inserts the new item, and adds it to the adapter so it displays in the UI.\n\nMobile Services supports unique custom string values for the table id. This allows applications to use custom values such as email addresses or usernames for the id column of a Mobile Services table. For example if you wanted to identify each record by an email address, you could use the following JSON object.\n\n        ToDoItem mToDoItem = new ToDoItem();\n        mToDoItem.id = \"myemail@mydomain.com\";\n        mToDoItem.text = \"Test Program\";\n        mToDoItem.complete = false;\n\nIf a string id value is not provided when inserting new records into a table, Mobile Services will generate a unique value for the id.\n\nSupporting string ids provides the following advantages to developers\n\n+ Ids can be generated without making a roundtrip to the database.\n+ Records are easier to merge from different tables or databases.\n+ Ids values can integrate better with an application's logic.\n\nYou can also use server scripts to set id values. The script example below generates a custom GUID and assigns it to a new record's id. This is similar to the id value that Mobile Services would generate if you didn't pass in a value for a record's id.\n\n    //Example of generating an id. This is not required since Mobile Services\n    //will generate an id if one is not passed in.\n    item.id = item.id || newGuid();\n    request.execute();\n\n    function newGuid() {\n        var pad4 = function(str) { return \"0000\".substring(str.length) + str; };\n        var hex4 = function () { return pad4(Math.floor(Math.random() * 0x10000 /* 65536 */ ).toString(16)); };\n        return (hex4() + hex4() + \"-\" + hex4() + \"-\" + hex4() + \"-\" + hex4() + \"-\" + hex4() + hex4() + hex4());\n    }\n\n\nIf an application provides a value for an id, Mobile Services will store it as is. This includes leading or trailing white spaces. White space will not be trimmed from value.\n\nThe value for the `id` must be unique and it must not include characters from the following sets:\n\n+ Control characters: [0x0000-0x001F] and [0x007F-0x009F]. For more information, see [ASCII control codes C0 and C1].\n+  Printable characters: **\"**(0x0022), **\\+** (0x002B), **/** (0x002F), **?** (0x003F), **\\\\** (0x005C), **`** (0x0060)\n+  The ids \".\" and \"..\"\n\nYou can alternatively use integer Ids for your tables. In order to use an integer Id you must create your table with the `mobile table create` command using the `--integerId` option. This command is used with the Command-line Interface (CLI) for Azure. For more information on using the CLI, see [CLI to manage Mobile Services tables].\n\n\n##<a name=\"updating\"></a>How to: Update data in a mobile service\n\nThe following code shows how to update data in a table. In this example, *item* is a reference to a row in the *ToDoItem* table, which has had some changes made to it. The following method updates the table and the UI adapter.\n\n    private void updateItem(final ToDoItem item) {\n        if (mClient == null) {\n            return;\n        }\n\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    mToDoTable.update(item).get();\n                    runOnUiThread(new Runnable() {\n                        public void run() {\n                            if (item.isComplete()) {\n                                mAdapter.remove(item);\n                            }\n                            refreshItemsFromTable();\n                        }\n                    });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\n##<a name=\"deleting\"></a>How to: Delete data in a mobile service\n\nThe following code shows how to delete data from a table. It deletes an existing item from the ToDoItem table that has had the **Completed** check box on the UI checked.\n\n    public void checkItem(final ToDoItem item) {\n        if (mClient == null) {\n            return;\n        }\n\n        // Set the item as completed and update it in the table\n        item.setComplete(true);\n\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    mToDoTable.delete(item);\n                    runOnUiThread(new Runnable() {\n                        public void run() {\n                            if (item.isComplete()) {\n                                mAdapter.remove(item);\n                            }\n                            refreshItemsFromTable();\n                        }\n                    });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\n\nThe following code illustrates another way to do this. It deletes an existing item in the ToDoItem table by specifying the value of the id field of the row to delete (assumed to equal \"2FA404AB-E458-44CD-BC1B-3BC847EF0902\"). In an actual app you would pick up the ID somehow and pass it in as a variable. Here, to simplify testing, you can go into the Azure Mobile Services portal for your service, click **Data** and copy an ID that you wish to test with.\n\n    public void deleteItem(View view) {\n\n        final String ID = \"2FA404AB-E458-44CD-BC1B-3BC847EF0902\";\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    mToDoTable.delete(ID);\n                    runOnUiThread(new Runnable() {\n                        public void run() {\n                            refreshItemsFromTable();\n                        }\n               });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\n##<a name=\"lookup\"></a>How to: Look up a specific item\nSometimes you want to look up a specific item by its *id*, unlike querying where you typically get a collection of items that satisfy some criteria. The following code shows how to do this, for an *id* value of `0380BAFB-BCFF-443C-B7D5-30199F730335`. In an actual app you would pick up the ID somehow and pass it in as a variable. Here, to simplify testing, you can go to the Azure Mobile Services portal for your service, click the **Data** tab and copy an ID that you wish to test with.\n\n    /**\n     * Lookup specific item from table and UI\n     */\n    public void lookup(View view) {\n\n        final String ID = \"0380BAFB-BCFF-443C-B7D5-30199F730335\";\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    final ToDoItem result = mToDoTable.lookUp(ID).get();\n                    runOnUiThread(new Runnable() {\n                        public void run() {\n                            mAdapter.clear();\n                            mAdapter.add(result);\n                        }\n               });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\n##<a name=\"untyped\"></a>How to: Work with untyped data\n\nThe untyped programming model gives you exact control over the JSON serialization, and there are some scenarios where you may wish to use it, for example, if your mobile service table contains a large number of columns and you only need to reference a few of them. Using the typed model requires you to define all of the mobile service table's columns in your data class. But with the untyped model you only define the columns you need to use.\n\nMost of the API calls for accessing data are similar to the typed programming calls. The main difference is that in the untyped model you invoke methods on the **MobileServiceJsonTable** object, instead of the **MobileServiceTable** object.\n\n\n### <a name=\"json_instance\"></a>How to: Create an instance of an untyped table\n\nSimilar to the typed model, you start by getting a table reference, but in this case it's a [MobileServicesJsonTable](http://go.microsoft.com/fwlink/p/?LinkId=298733) object. You get the reference by calling the [getTable()](http://go.microsoft.com/fwlink/p/?LinkId=298734) method on an instance of the Mobile Services client.\n\nFirst you define the variable:\n\n    /**\n     * Mobile Service Json Table used to access untyped data\n     */\n    private MobileServiceJsonTable mJsonToDoTable;\n\n\n\nOnce you create an instance of the Mobile Services client in the **onCreate** method (here, the *mClient* variable), you next create an instance of a **MobileServiceJsonTable**, with the following code.\n\n\n            // Get the Mobile Service Json Table to use\n            mJsonToDoTable = mClient.getTable(\"ToDoItem\");\n\nOnce you have created an instance of the **MobileServiceJsonTable**, you can call almost all of the methods on it that you can with the typed programming model. However in some cases the methods take an untyped parameter, as we see in the following examples.\n\n### <a name=\"json_insert\"></a>How to: Insert into an untyped table\n\nThe following code shows how to do an insert. The first step is to create a [**JsonObject**](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/JsonObject.html), which is part of the <a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\">gson</a> library.\n\n        JsonObject item = new JsonObject();\n        item.addProperty(\"text\", \"Wake up\");\n        item.addProperty(\"complete\", false);\n\nThe next step is to insert the object. The callback function passed to the [**insert**](http://go.microsoft.com/fwlink/p/?LinkId=298535) method is an instance of the [**TableJsonOperationCallback**](http://go.microsoft.com/fwlink/p/?LinkId=298532) class. Note how the parameter of the *insert* method is a JsonObject.\n\n        // Insert the new item\n        new AsyncTask<Void, Void, Void>() {\n\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    mJsonToDoTable.insert(item).get();\n                    refreshItemsFromTable();\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n\n\nIf you need to get the ID of the inserted object, use this method call:\n\n                jsonObject.getAsJsonPrimitive(\"id\").getAsInt());\n\n\n### <a name=\"json_delete\"></a>How to: Delete from an untyped table\n\nThe following code shows how to delete an instance, in this case, the same instance of a **JsonObject** that was created in the prior *insert* example. Note that the code is the same as with the typed case, but the method has a different signature since it references an **JsonObject**.\n\n\n         mToDoTable.delete(item);\n\n\nYou can also delete an instance directly by using its ID:\n\n         mToDoTable.delete(ID);\n\n\n\n### <a name=\"json_get\"></a>How to: Return all rows from an untyped table\n\nThe following code shows how to retrieve an entire table. Since you are using a JSON Table, you can selectively retrieve only some of the table's columns.\n\n    public void showAllUntyped(View view) {\n        new AsyncTask<Void, Void, Void>() {\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    final JsonElement result = mJsonToDoTable.execute().get();\n                    final JsonArray results = result.getAsJsonArray();\n                    runOnUiThread(new Runnable() {\n\n                        @Override\n                        public void run() {\n                            mAdapter.clear();\n                            for (JsonElement item : results) {\n                                String ID = item.getAsJsonObject().getAsJsonPrimitive(\"id\").getAsString();\n                                String mText = item.getAsJsonObject().getAsJsonPrimitive(\"text\").getAsString();\n                                Boolean mComplete = item.getAsJsonObject().getAsJsonPrimitive(\"complete\").getAsBoolean();\n                                ToDoItem mToDoItem = new ToDoItem();\n                                mToDoItem.setId(ID);\n                                mToDoItem.setText(mText);\n                                mToDoItem.setComplete(mComplete);\n                                mAdapter.add(mToDoItem);\n                            }\n                        }\n                    });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\nYou can do filtering, sorting and paging by concatenating  methods that have the same names as those used in the typed programming model.\n\n\n##<a name=\"binding\"></a>How to: Bind data to the user interface\n\nData binding involves three components:\n\n- the data source\n- the screen layout\n- and the adapter that ties the two together.\n\nIn our sample code, we return the data from the mobile service table *ToDoItem* into an array. This is one very common pattern for data applications: database queries typically return a collection of rows which the client gets in a list or array. In this sample the array is the data source.\n\nThe code specifies a screen layout that defines the view of the data that will appear on the device.\n\nAnd the two are bound together with an adapter, which in this code is an extension of the *ArrayAdapter&lt;ToDoItem&gt;* class.\n\n### <a name=\"layout\"></a>How to: Define the Layout\n\nThe layout is defined by several snippets of XML code. Given an existing layout, let's assume the following code represents the **ListView** we want to populate with our server data.\n\n    <ListView\n        android:id=\"@+id/listViewToDo\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        tools:listitem=\"@layout/row_list_to_do\" >\n    </ListView>\n\n\nIn the above code the *listitem* attribute specifies the id of the layout for an individual row in the list. Here is that code, which specifies a check box and its associated text. This gets instantiated once for each item in the list. A more complex layout would specify additional fields in the display. This code is in the *row_list_to_do.xml* file.\n\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\"\n        android:orientation=\"horizontal\">\n        <CheckBox\n            android:id=\"@+id/checkToDoItem\"\n            android:layout_width=\"wrap_content\"\n            android:layout_height=\"wrap_content\"\n            android:text=\"@string/checkbox_text\" />\n    </LinearLayout>\n\n\n### <a name=\"adapter\"></a>How to: Define the adapter\n\nSince the data source of our view is an array of *ToDoItem*, we subclass our adapter from a *ArrayAdapter&lt;ToDoItem&gt;* class. This subclass will produce a View for every *ToDoItem* using the *row_list_to_do* layout.\n\nIn our code we define the following class which is an extension of the *ArrayAdapter&lt;E&gt;* class:\n\n    public class ToDoItemAdapter extends ArrayAdapter<ToDoItem> {\n\n\nYou must override the adapter's *getView* method. This sample code is one example of how to do this: details will vary with your application.\n\n    public View getView(int position, View convertView, ViewGroup parent) {\n        View row = convertView;\n\n        final ToDoItem currentItem = getItem(position);\n\n        if (row == null) {\n            LayoutInflater inflater = ((Activity) mContext).getLayoutInflater();\n            row = inflater.inflate(R.layout.row_list_to_do, parent, false);\n        }\n\n        row.setTag(currentItem);\n\n        final CheckBox checkBox = (CheckBox) row.findViewById(R.id.checkToDoItem);\n        checkBox.setText(currentItem.getText());\n        checkBox.setChecked(false);\n        checkBox.setEnabled(true);\n\n        return row;\n    }\n\nWe create an instance of this class in our Activity as follows:\n\n    ToDoItemAdapter mAdapter;\n    mAdapter = new ToDoItemAdapter(this, R.layout.row_list_to_do);\n\nNote that the second parameter to the ToDoItemAdapter constructor is a reference to the layout. The call to the constructor is followed by the following code which first gets a reference to the **ListView**, and next calls *setAdapter* to configure itself to use the adapter we just created:\n\n    ListView listViewToDo = (ListView) findViewById(R.id.listViewToDo);\n    listViewToDo.setAdapter(mAdapter);\n\n\n### <a name=\"use-adapter\"></a>How to: Use the adapter\n\nYou are now ready to use data binding. The following code shows how to get the items in the mobile service table, clear the apapter, and then call the adapter's *add* method to fill it with the returned items.\n\n    public void showAll(View view) {\n        new AsyncTask<Void, Void, Void>() {\n            @Override\n            protected Void doInBackground(Void... params) {\n                try {\n                    final MobileServiceList<ToDoItem> result = mToDoTable.execute().get();\n                    runOnUiThread(new Runnable() {\n\n                        @Override\n                        public void run() {\n                            mAdapter.clear();\n                            for (ToDoItem item : result) {\n                                mAdapter.add(item);\n                            }\n                        }\n                    });\n                } catch (Exception exception) {\n                    createAndShowDialog(exception, \"Error\");\n                }\n                return null;\n            }\n        }.execute();\n    }\n\nYou must also call the adapter any time you modify the *ToDoItem* table if you want to display the results of doing that. Since modifications are done on a record by record basis, you will be dealing with a single row instead of a collection. When you insert an item you call the *add* method on the adapter, when deleting, you call the *remove* method.\n\n\n##<a name=\"authentication\"></a>How to: Authenticate users\n\nMobile Services supports authenticating and authorizing app users using a variety of external identity providers: Facebook, Google, Microsoft Account, Twitter, and Azure Active Directory. You can set permissions on tables to restrict access for specific operations to only authenticated users. You can also use the identity of authenticated users to implement authorization rules in your backend. For more information, see [Get started with authentication](http://go.microsoft.com/fwlink/p/?LinkId=296316).\n\nTwo authentication flows are supported: a *server* flow and a *client* flow. The server flow provides the simplest authentication experience, as it relies on the provider's web authentication interface. The client flow allows for deeper integration with device-specific capabilities such as single-sign-on as it relies on provider-specific device-specific SDKs.\n\nThree steps are required to enable authentication in your app:\n\n- Register your app for authentication with a provider, and configure Mobile Services\n- Restrict table permissions to authenticated users only\n- Add authentication code to your app\n\n\nMobile Services supports the following existing identity providers that you can use to authenticate users:\n\n- Microsoft Account\n- Facebook\n- Twitter\n- Google\n- Azure Active Directory\n\nYou can set permissions on tables to restrict access for specific operations to only authenticated users. You can also use the ID of an authenticated user to modify requests.\n\nThese first two tasks are done using the [Azure Management Portal](https://manage.windowsazure.com/). For more information, see [Get started with authentication](http://go.microsoft.com/fwlink/p/?LinkId=296316).\n\n### <a name=\"caching\"></a>How to: Add authentication code to your app\n\n1.  Add the following import statements to your app's activity file.\n\n        import java.util.concurrent.ExecutionException;\n        import java.util.concurrent.atomic.AtomicBoolean;\n\n        import android.content.Context;\n        import android.content.SharedPreferences;\n        import android.content.SharedPreferences.Editor;\n\n        import com.microsoft.windowsazure.mobileservices.authentication.MobileServiceAuthenticationProvider;\n        import com.microsoft.windowsazure.mobileservices.authentication.MobileServiceUser;\n\n2. In the **onCreate** method of the activity class, add the following line of code after the code that creates the `MobileServiceClient` object: we assume that the reference to the `MobileServiceClient` object is *mClient*.\n\n        // Login using the Google provider.\n\n        ListenableFuture<MobileServiceUser> mLogin = mClient.login(MobileServiceAuthenticationProvider.Google);\n\n        Futures.addCallback(mLogin, new FutureCallback<MobileServiceUser>() {\n            @Override\n            public void onFailure(Throwable exc) {\n                createAndShowDialog((Exception) exc, \"Error\");\n            }\n            @Override\n            public void onSuccess(MobileServiceUser user) {\n                createAndShowDialog(String.format(\n                        \"You are now logged in - %1$2s\",\n                        user.getUserId()), \"Success\");\n                createTable();\n            }\n        });\n\n    This code authenticates the user using a Google login. A dialog is displayed which displays the ID of the authenticated user. You cannot proceed without a positive authentication.\n\n    > [AZURE.NOTE] If you are using an identity provider other than Google, change the value passed to the **login** method above to one of the following: _MicrosoftAccount_, _Facebook_, _Twitter_, or _WindowsAzureActiveDirectory_.\n\n\n3. When you run the app, sign in with your chosen identity provider.\n\n\n### <a name=\"caching\"></a>How to: Cache authentication tokens\n\nThis section shows how to cache an authentication token. Do this to prevent users from having to authenticate again if app is \"hibernated\" while the token is still valid.\n\nCaching authentication tokens requires you to store the User ID and authentication token locally on the device. The next time the app starts, you check the cache, and if these values are present, you can skip the log in procedure and re-hydrate the client with this data. However this data is sensitive, and it should be stored encrypted for safety in case the phone gets stolen.\n\nThe following code snippet demonstrates obtaining a token for a Microsoft Account log in. The token is cached and reloaded if the cache is found.\n\n    private void authenticate() {\n        if (LoadCache())\n        {\n            createTable();\n        }\n        else\n        {\n                // Login using the Google provider.\n                ListenableFuture<MobileServiceUser> mLogin = mClient.login(MobileServiceAuthenticationProvider.Google);\n\n                Futures.addCallback(mLogin, new FutureCallback<MobileServiceUser>() {\n                    @Override\n                    public void onFailure(Throwable exc) {\n                        createAndShowDialog(\"You must log in. Login Required\", \"Error\");\n                    }\n                    @Override\n                    public void onSuccess(MobileServiceUser user) {\n                        createAndShowDialog(String.format(\n                                \"You are now logged in - %1$2s\",\n                                user.getUserId()), \"Success\");\n                        cacheUserToken(mClient.getCurrentUser());\n                        createTable();\n                    }\n                });     }\n    }\n\n\n    private boolean LoadCache()\n    {\n        SharedPreferences prefs = getSharedPreferences(\"temp\", Context.MODE_PRIVATE);\n        String tmp1 = prefs.getString(\"tmp1\", \"undefined\");\n        if (tmp1 == \"undefined\")\n            return false;\n        String tmp2 = prefs.getString(\"tmp2\", \"undefined\");\n        if (tmp2 == \"undefined\")\n            return false;\n        MobileServiceUser user = new MobileServiceUser(tmp1);\n        user.setAuthenticationToken(tmp2);\n        mClient.setCurrentUser(user);\n        return true;\n    }\n\n\n    private void cacheUser(MobileServiceUser user)\n    {\n        SharedPreferences prefs = getSharedPreferences(\"temp\", Context.MODE_PRIVATE);\n        Editor editor = prefs.edit();\n        editor.putString(\"tmp1\", user.getUserId());\n        editor.putString(\"tmp2\", user.getAuthenticationToken());\n        editor.commit();\n    }\n\n\nSo what happens if your token expires? In this case, when you try to use it to connect, you will get a *401 unauthorized* response. The user must then log in to obtain new tokens. You can avoid having to write code to handle this in every place in your app that calls your mobile service by using filters, which allow you to intercept calls to and responses from Mobile Services. The filter code will then test the response for a 401, trigger the sign-in process if needed, and then resume the request that generated the 401.\n\n\n##<a name=\"customizing\"></a>How to: Customize the client\n\nThere are several ways for you to customize the default behavior of the Mobile Services client.\n\n### <a name=\"headers\"></a>How to: Customize request headers\n\nYou might want to attach a custom header to every outgoing request. You can accomplish that by configuring a **ServiceFilter** like this:\n\n    private class CustomHeaderFilter implements ServiceFilter {\n\n        @Override\n        public ListenableFuture<ServiceFilterResponse> handleRequest(\n                    ServiceFilterRequest request,\n                    NextServiceFilterCallback next) {\n\n            runOnUiThread(new Runnable() {\n\n                @Override\n                public void run() {\n                    request.addHeader(\"My-Header\", \"Value\");                    }\n            });\n\n            SettableFuture<ServiceFilterResponse> result = SettableFuture.create();\n            try {\n                ServiceFilterResponse response = next.onNext(request).get();\n                result.set(response);\n            } catch (Exception exc) {\n                result.setException(exc);\n            }\n        }\n\n### <a name=\"serialization\"></a>How to: Customize serialization\n\nMobile Services assumes by default that the table names, column names and data types on the server all match exactly what is on the client. But there can be any number of reasons why the server and client names might not match. One example might be if you have an existing client that you want to change so that it uses Mobile Services instead of a competitor's product.\n\nYou might want to do the following kinds of customizations:\n\n- The column names used in the mobile-  service table don't match the names you are using in the client\n- Use a mobile service table that has a different name than the class it maps to in the client\n- Turn on automatic property capitalization\n- Add complex properties to an object\n\n### <a name=\"columns\"></a>How to: Map different client and server names\n\nSuppose that your Java client code uses standard Java-style names for the *ToDoItem* object properties, such as the following.\n\n- mId\n- mText\n- mComplete\n- mDuration\n\n\nYou must serialize the client names into JSON names that match the column names of the *ToDoItem* table on the server. The following code, which makes use of the <a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\">gson</a> library does this.\n\n    @com.google.gson.annotations.SerializedName(\"text\")\n    private String mText;\n\n    @com.google.gson.annotations.SerializedName(\"id\")\n    private int mId;\n\n    @com.google.gson.annotations.SerializedName(\"complete\")\n    private boolean mComplete;\n\n    @com.google.gson.annotations.SerializedName(\"duration\")\n    private String mDuration;\n\n### <a name=\"table\"></a>How to: Map different table names between client and mobile services\n\nMapping the client table name to a different mobile services table name is easy, we just use one of the overrides of the\n<a href=\"http://go.microsoft.com/fwlink/p/?LinkId=296840\" target=\"_blank\">getTable()</a> function, as seen in the following code.\n\n    mToDoTable = mClient.getTable(\"ToDoItemBackup\", ToDoItem.class);\n\n\n### <a name=\"conversions\"></a>How to: Automate column name mappings\n\nMapping column names for a narrow table with only a few columns isn't a big deal, as we saw in the prior section. But suppose our table has a lot of columns, say 20 or 30. It turns out that we can call the <a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\">gson</a> API and specify a conversion strategy that will apply to every column, and avoid having to annotate every single column name.\n\nTo do this we use the <a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\">gson</a> library which the Android client library uses behind the scenes to serialize Java objects to JSON data, which is sent to Azure Mobile Services.\n\nThe following code uses the *setFieldNamingStrategy()* method, in which we define a *FieldNamingStrategy()* method. This method says to delete the initial character (an \"m\"), and then lower-case the next character, for every field name. This code also enables pretty-printing of the output JSON.\n\n    client.setGsonBuilder(\n        MobileServiceClient\n        .createMobileServiceGsonBuilder()\n        .setFieldNamingStrategy(new FieldNamingStrategy() {\n            public String translateName(Field field) {\n                String name = field.getName();\n                return Character.toLowerCase(name.charAt(1))\n                    + name.substring(2);\n                }\n            })\n            .setPrettyPrinting());\n\n\n\nThis code must be executed prior to any method calls on the Mobile Services client object.\n\n### <a name=\"complex\"></a>How to: Store an object or array property into a table\n\nSo far all of our serialization examples have involved primitive types such as integers and strings which easily serialize into JSON and into the mobile services table. Suppose we want to add a complex object to our client type, which doesn't automatically serialize to JSON and to the table. For example we might want to add an array of strings to the client object. It is now up to us to specify how to do the serialization, and how to store the array into the mobile services table.\n\nTo see an example of how to do this, check out the blog post <a href=\"http://hashtagfail.com/post/44606137082/mobile-services-android-serialization-gson\" target=\"_blank\">Customizing serialization using the <a href=\" http://go.microsoft.com/fwlink/p/?LinkId=290801\" target=\"_blank\">gson</a> library in the Mobile Services Android client</a>.\n\nThis general method can be used whenever we have a complex object that is not automatically serializable into JSON and the mobile services table.\n\n<!-- Anchors. -->\n\n[What is Mobile Services]: #what-is\n[Concepts]: #concepts\n[How to: Create the Mobile Services client]: #create-client\n[How to: Create a table reference]: #instantiating\n[The API structure]: #api\n[How to: Query data from a mobile service]: #querying\n[Return all Items]: #showAll\n[Filter returned data]: #filtering\n[Sort returned data]: #sorting\n[Return data in pages]: #paging\n[Select specific columns]: #selecting\n[How to: Concatenate query methods]: #chaining\n[How to: Bind data to the user interface]: #binding\n[How to: Define the layout]: #layout\n[How to: Define the adapter]: #adapter\n[How to: Use the adapter]: #use-adapter\n[How to: Insert data into a mobile service]: #inserting\n[How to: update data in a mobile service]: #updating\n[How to: Delete data in a mobile service]: #deleting\n[How to: Look up a specific item]: #lookup\n[How to: Work with untyped data]: #untyped\n[How to: Authenticate users]: #authentication\n[Cache authentication tokens]: #caching\n[How to: Handle errors]: #errors\n[How to: Design unit tests]: #tests\n[How to: Customize the client]: #customizing\n[Customize request headers]: #headers\n[Customize serialization]: #serialization\n[Next Steps]: #next-steps\n[Setup and Prerequisites]: #setup\n\n<!-- Images. -->\n\n\n\n<!-- URLs. -->\n[Get started with Mobile Services]: mobile-services-android-get-started.md\n[ASCII control codes C0 and C1]: http://en.wikipedia.org/wiki/Data_link_escape_character#C1_set\n\ntest\n"
}