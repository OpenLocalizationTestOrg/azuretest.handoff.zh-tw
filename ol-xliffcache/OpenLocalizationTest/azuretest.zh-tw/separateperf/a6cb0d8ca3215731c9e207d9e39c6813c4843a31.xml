{
  "nodes": [
    {
      "content": "Enable Remote Desktop Connection for a Role in Azure Cloud Services",
      "pos": [
        24,
        91
      ]
    },
    {
      "content": "How to configure your azure cloud service application to allow remote desktop connections",
      "pos": [
        107,
        196
      ]
    },
    {
      "content": "Enable Remote Desktop Connection for a Role in Azure Cloud Services",
      "pos": [
        456,
        523
      ]
    },
    {
      "content": "[AZURE.SELECTOR]",
      "pos": [
        526,
        542
      ]
    },
    {
      "content": "Azure Portal",
      "pos": [
        546,
        558
      ]
    },
    {
      "content": "PowerShell",
      "pos": [
        609,
        619
      ]
    },
    {
      "content": "Visual Studio",
      "pos": [
        681,
        694
      ]
    },
    {
      "content": "Remote Desktop enables you to access the desktop of a role running in Azure.",
      "pos": [
        748,
        824
      ]
    },
    {
      "content": "You can use a Remote Desktop connection to troubleshoot and diagnose problems with your application while it is running.",
      "pos": [
        825,
        945
      ]
    },
    {
      "content": "You can enable a Remote Desktop connection in your role during development by including the Remote Desktop modules in your service definition or you can choose to enable Remote Desktop through the Remote Desktop Extension.",
      "pos": [
        948,
        1170
      ]
    },
    {
      "content": "The preferred approach is to use the Remote Desktop extension as you can enable Remote Desktop even after the application is deployed without having to redeploy your application.",
      "pos": [
        1171,
        1349
      ]
    },
    {
      "content": "Configure Remote Desktop from the portal",
      "pos": [
        1356,
        1396
      ]
    },
    {
      "content": "The portal uses the Remote Desktop Extension approach so you can enable Remote Desktop even after the application is deployed.",
      "pos": [
        1397,
        1523
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Configure<ept id=\"p1\">**</ept> page for your cloud service allows you to enable Remote Desktop, change the local Administrator account used to connect to the virtual machines, the certificate used in authentication and set the expiration date.",
      "pos": [
        1524,
        1754
      ]
    },
    {
      "pos": [
        1761,
        1853
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Cloud Services<ept id=\"p1\">**</ept>, click the name of the cloud service, and then click <bpt id=\"p2\">**</bpt>Configure<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        1858,
        1875
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Remote<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Cloud services remote",
      "pos": [
        1887,
        1908
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.WARNING]</ph> All role instances will be restarted when you first enable Remote Desktop and click OK (checkmark).",
      "pos": [
        1997,
        2112
      ]
    },
    {
      "content": "To prevent a reboot, the certificate used to encrypt the password must be installed on the role.",
      "pos": [
        2113,
        2209
      ]
    },
    {
      "content": "To prevent a restart, <bpt id=\"p1\">[</bpt>upload a certificate for the cloud service<ept id=\"p1\">](cloud-services-how-to-create-deploy/#how-to-upload-a-certificate-for-a-cloud-service)</ept> and then return to this dialog.",
      "pos": [
        2210,
        2394
      ]
    },
    {
      "pos": [
        2404,
        2485
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Roles<ept id=\"p1\">**</ept>, select the role you want to update or select <bpt id=\"p2\">**</bpt>All<ept id=\"p2\">**</ept> for all roles."
    },
    {
      "content": "Make any of the following changes:",
      "pos": [
        2490,
        2524
      ]
    },
    {
      "content": "To enable Remote Desktop, select the <bpt id=\"p1\">**</bpt>Enable Remote Desktop<ept id=\"p1\">**</ept> check box.",
      "pos": [
        2536,
        2609
      ]
    },
    {
      "content": "To disable Remote Desktop, clear the check box.",
      "pos": [
        2610,
        2657
      ]
    },
    {
      "content": "Create an account to use in Remote Desktop connections to the role instances.",
      "pos": [
        2669,
        2746
      ]
    },
    {
      "content": "Update the password for the existing account.",
      "pos": [
        2758,
        2803
      ]
    },
    {
      "pos": [
        2815,
        2971
      ],
      "content": "Select an uploaded certificate to use for authentication (upload the certificate using <bpt id=\"p1\">**</bpt>Upload<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Certificates<ept id=\"p2\">**</ept> page) or create a new certificate."
    },
    {
      "content": "Change the expiration date for the Remote Desktop configuration.",
      "pos": [
        2984,
        3048
      ]
    },
    {
      "pos": [
        3053,
        3122
      ],
      "content": "When you finish your configuration updates, click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> (checkmark)."
    },
    {
      "content": "Remote into role instances",
      "pos": [
        3128,
        3154
      ]
    },
    {
      "content": "Once Remote Desktop is enabled on the roles you can remote into a role instance through various tools.",
      "pos": [
        3155,
        3257
      ]
    },
    {
      "content": "To connect to a role instance from the portal:",
      "pos": [
        3259,
        3305
      ]
    },
    {
      "pos": [
        3318,
        3369
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Instances<ept id=\"p1\">**</ept> to open the <bpt id=\"p2\">**</bpt>Instances<ept id=\"p2\">**</ept> page."
    },
    {
      "content": "Select a role instance that has Remote Desktop configured.",
      "pos": [
        3377,
        3435
      ]
    },
    {
      "pos": [
        3443,
        3510
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Connect<ept id=\"p1\">**</ept>, and follow the instructions to open the desktop."
    },
    {
      "pos": [
        3519,
        3594
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept> and then <bpt id=\"p2\">**</bpt>Connect<ept id=\"p2\">**</ept> to start the Remote Desktop connection."
    },
    {
      "content": "Use Visual Studio to remote into a role instance",
      "pos": [
        3602,
        3650
      ]
    },
    {
      "content": "In Visual Studio, Server Explorer:",
      "pos": [
        3652,
        3686
      ]
    },
    {
      "pos": [
        3691,
        3755
      ],
      "content": "Expand the <bpt id=\"p1\">**</bpt>Azure\\\\Cloud Services\\\\[cloud service name]<ept id=\"p1\">**</ept> node."
    },
    {
      "pos": [
        3759,
        3803
      ],
      "content": "Expand either <bpt id=\"p1\">**</bpt>Staging<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Production<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Expand the individual role.",
      "pos": [
        3807,
        3834
      ]
    },
    {
      "pos": [
        3838,
        3962
      ],
      "content": "Right-click one of the role instances, click <bpt id=\"p1\">**</bpt>Connect using Remote Desktop...<ept id=\"p1\">**</ept>, and then enter the user name and password."
    },
    {
      "content": "Server explorer remote desktop",
      "pos": [
        3967,
        3997
      ]
    },
    {
      "content": "Use PowerShell to get the RDP file",
      "pos": [
        4089,
        4123
      ]
    },
    {
      "content": "You can use the <bpt id=\"p1\">[</bpt>Get-AzureRemoteDesktopFile<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/dn495261.aspx)</ept> cmdlet to retrieve the RDP file.",
      "pos": [
        4124,
        4257
      ]
    },
    {
      "content": "You can then use the RDP file with Remote Desktop Connection to access the cloud service.",
      "pos": [
        4258,
        4347
      ]
    },
    {
      "content": "Programmatically download the RDP file through the Service Management REST API",
      "pos": [
        4353,
        4431
      ]
    },
    {
      "pos": [
        4432,
        4558
      ],
      "content": "You can use the <bpt id=\"p1\">[</bpt>Download RDP File<ept id=\"p1\">](https://msdn.microsoft.com/library/jj157183.aspx)</ept> REST operation to download the RDP file."
    },
    {
      "content": "To configure Remote Desktop in the service definition file",
      "pos": [
        4566,
        4624
      ]
    },
    {
      "content": "This method allows you to enable Remote Desktop for the application during development.",
      "pos": [
        4626,
        4713
      ]
    },
    {
      "content": "This approach requires encrypted passwords be stored in your service configuration file and any updates to the remote desktop configuration would require a redeployment of the application.",
      "pos": [
        4714,
        4902
      ]
    },
    {
      "content": "If you want to avoid these downsides you should use the remote desktop extension based approach described above.",
      "pos": [
        4903,
        5015
      ]
    },
    {
      "content": "You can use Visual Studio to <bpt id=\"p1\">[</bpt>enable a remote desktop connection<ept id=\"p1\">](https://msdn.microsoft.com/library/gg443832.aspx)</ept> using the service definition file approach.",
      "pos": [
        5019,
        5178
      ]
    },
    {
      "content": "The steps below describe the changes needed to the service model files to enable remote desktop.",
      "pos": [
        5181,
        5277
      ]
    },
    {
      "content": "Visual Studio will automatically makes these changes when publishing.",
      "pos": [
        5278,
        5347
      ]
    },
    {
      "content": "Set up the connection in the service model",
      "pos": [
        5353,
        5395
      ]
    },
    {
      "pos": [
        5397,
        5579
      ],
      "content": "Use the <bpt id=\"p1\">**</bpt>Imports<ept id=\"p1\">**</ept> element to import the <bpt id=\"p2\">**</bpt>RemoteAccess<ept id=\"p2\">**</ept> module and the <bpt id=\"p3\">**</bpt>RemoteForwarder<ept id=\"p3\">**</ept> module to the <bpt id=\"p4\">[</bpt>ServiceDefinition.csdef<ept id=\"p4\">](cloud-services-model-and-package.md#csdef)</ept> file."
    },
    {
      "pos": [
        5581,
        5687
      ],
      "content": "The service definition file should be similar to the following example with the <ph id=\"ph1\">`&lt;Imports&gt;`</ph> element added."
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt>ServiceConfiguration.cscfg<ept id=\"p1\">](cloud-services-model-and-package.md#cscfg)</ept> file should be similar to the following example, note the <ph id=\"ph1\">`&lt;ConfigurationSettings&gt;`</ph> and <ph id=\"ph2\">`&lt;Certificates&gt;`</ph> elements.",
      "pos": [
        6450,
        6640
      ]
    },
    {
      "content": "The Certificate specified must be <bpt id=\"p1\">[</bpt>uploaded to the cloud service<ept id=\"p1\">](cloud-services-how-to-create-deploy/#how-to-upload-a-certificate-for-a-cloud-service)</ept>.",
      "pos": [
        6641,
        6793
      ]
    },
    {
      "content": "Additional Resources",
      "pos": [
        8002,
        8022
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>How to Configure Cloud Services<ept id=\"p1\">](cloud-services-how-to-configure.md)</ept>",
      "pos": [
        8024,
        8093
      ]
    },
    {
      "content": "test",
      "pos": [
        8094,
        8098
      ]
    }
  ],
  "content": "<properties \npageTitle=\"Enable Remote Desktop Connection for a Role in Azure Cloud Services\" \ndescription=\"How to configure your azure cloud service application to allow remote desktop connections\" \nservices=\"cloud-services\" \ndocumentationCenter=\"\" \nauthors=\"sbtron\" \nmanager=\"timlt\" \neditor=\"\"/>\n<tags \nms.service=\"cloud-services\" \nms.workload=\"tbd\" \nms.tgt_pltfrm=\"na\" \nms.devlang=\"na\" \nms.topic=\"article\" \nms.date=\"07/06/2015\" \nms.author=\"saurabh\"/>\n\n# Enable Remote Desktop Connection for a Role in Azure Cloud Services\n\n>[AZURE.SELECTOR]\n- [Azure Portal](cloud-services-role-enable-remote-desktop.md)\n- [PowerShell](cloud-services-role-enable-remote-desktop-powershell.md)\n- [Visual Studio](https://msdn.microsoft.com/library/gg443832.aspx)\n\n\nRemote Desktop enables you to access the desktop of a role running in Azure. You can use a Remote Desktop connection to troubleshoot and diagnose problems with your application while it is running. \n\nYou can enable a Remote Desktop connection in your role during development by including the Remote Desktop modules in your service definition or you can choose to enable Remote Desktop through the Remote Desktop Extension. The preferred approach is to use the Remote Desktop extension as you can enable Remote Desktop even after the application is deployed without having to redeploy your application. \n\n\n## Configure Remote Desktop from the portal\nThe portal uses the Remote Desktop Extension approach so you can enable Remote Desktop even after the application is deployed. The **Configure** page for your cloud service allows you to enable Remote Desktop, change the local Administrator account used to connect to the virtual machines, the certificate used in authentication and set the expiration date. \n\n\n1. Click **Cloud Services**, click the name of the cloud service, and then click **Configure**.\n\n2. Click **Remote**.\n    \n    ![Cloud services remote](./media/cloud-services-role-enable-remote-desktop/CloudServices_Remote.png)\n    \n    > [AZURE.WARNING] All role instances will be restarted when you first enable Remote Desktop and click OK (checkmark). To prevent a reboot, the certificate used to encrypt the password must be installed on the role. To prevent a restart, [upload a certificate for the cloud service](cloud-services-how-to-create-deploy/#how-to-upload-a-certificate-for-a-cloud-service) and then return to this dialog.\n    \n\n3. In **Roles**, select the role you want to update or select **All** for all roles.\n\n4. Make any of the following changes:\n    \n    - To enable Remote Desktop, select the **Enable Remote Desktop** check box. To disable Remote Desktop, clear the check box.\n    \n    - Create an account to use in Remote Desktop connections to the role instances.\n    \n    - Update the password for the existing account.\n    \n    - Select an uploaded certificate to use for authentication (upload the certificate using **Upload** on the **Certificates** page) or create a new certificate. \n    \n    - Change the expiration date for the Remote Desktop configuration.\n\n5. When you finish your configuration updates, click **OK** (checkmark).\n\n\n## Remote into role instances\nOnce Remote Desktop is enabled on the roles you can remote into a role instance through various tools.\n\nTo connect to a role instance from the portal:\n    \n  1.   Click **Instances** to open the **Instances** page.\n  2.   Select a role instance that has Remote Desktop configured.\n  3.   Click **Connect**, and follow the instructions to open the desktop. \n  4.   Click **Open** and then **Connect** to start the Remote Desktop connection. \n\n\n### Use Visual Studio to remote into a role instance\n\nIn Visual Studio, Server Explorer:\n\n1. Expand the **Azure\\\\Cloud Services\\\\[cloud service name]** node.\n2. Expand either **Staging** or **Production**.\n3. Expand the individual role.\n4. Right-click one of the role instances, click **Connect using Remote Desktop...**, and then enter the user name and password. \n\n![Server explorer remote desktop](./media/cloud-services-role-enable-remote-desktop/ServerExplorer_RemoteDesktop.png)\n\n\n### Use PowerShell to get the RDP file\nYou can use the [Get-AzureRemoteDesktopFile](https://msdn.microsoft.com/library/azure/dn495261.aspx) cmdlet to retrieve the RDP file. You can then use the RDP file with Remote Desktop Connection to access the cloud service.\n\n### Programmatically download the RDP file through the Service Management REST API\nYou can use the [Download RDP File](https://msdn.microsoft.com/library/jj157183.aspx) REST operation to download the RDP file. \n\n\n\n## To configure Remote Desktop in the service definition file\n\nThis method allows you to enable Remote Desktop for the application during development. This approach requires encrypted passwords be stored in your service configuration file and any updates to the remote desktop configuration would require a redeployment of the application. If you want to avoid these downsides you should use the remote desktop extension based approach described above.  \n\nYou can use Visual Studio to [enable a remote desktop connection](https://msdn.microsoft.com/library/gg443832.aspx) using the service definition file approach.  \nThe steps below describe the changes needed to the service model files to enable remote desktop. Visual Studio will automatically makes these changes when publishing.\n\n### Set up the connection in the service model \nUse the **Imports** element to import the **RemoteAccess** module and the **RemoteForwarder** module to the [ServiceDefinition.csdef](cloud-services-model-and-package.md#csdef) file.\n\nThe service definition file should be similar to the following example with the `<Imports>` element added.\n\n```xml\n<ServiceDefinition name=\"<name-of-cloud-service>\" xmlns=\"http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition\" schemaVersion=\"2013-03.2.0\">\n    <WebRole name=\"WebRole1\" vmsize=\"Small\">\n        <Sites>\n            <Site name=\"Web\">\n                <Bindings>\n                    <Binding name=\"Endpoint1\" endpointName=\"Endpoint1\" />\n                </Bindings>\n            </Site>\n        </Sites>\n        <Endpoints>\n            <InputEndpoint name=\"Endpoint1\" protocol=\"http\" port=\"80\" />\n        </Endpoints>\n        <Imports>\n            <Import moduleName=\"Diagnostics\" />\n            <Import moduleName=\"RemoteAccess\" />\n            <Import moduleName=\"RemoteForwarder\" />\n        </Imports>\n    </WebRole>\n</ServiceDefinition>\n```\nThe [ServiceConfiguration.cscfg](cloud-services-model-and-package.md#cscfg) file should be similar to the following example, note the `<ConfigurationSettings>` and `<Certificates>` elements. The Certificate specified must be [uploaded to the cloud service](cloud-services-how-to-create-deploy/#how-to-upload-a-certificate-for-a-cloud-service).\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<ServiceConfiguration serviceName=\"<name-of-cloud-service>\" xmlns=\"http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceConfiguration\" osFamily=\"3\" osVersion=\"*\" schemaVersion=\"2013-03.2.0\">\n    <Role name=\"WebRole1\">\n        <Instances count=\"2\" />\n        <ConfigurationSettings>\n            <Setting name=\"Microsoft.WindowsAzure.Plugins.RemoteAccess.Enabled\" value=\"true\" />\n            <Setting name=\"Microsoft.WindowsAzure.Plugins.RemoteAccess.AccountUsername\" value=\"[name-of-user-account]\" />\n            <Setting name=\"Microsoft.WindowsAzure.Plugins.RemoteAccess.AccountEncryptedPassword\" value=\"[base-64-encrypted-user-password]\" />\n            <Setting name=\"Microsoft.WindowsAzure.Plugins.RemoteAccess.AccountExpiration\" value=\"[certificate-expiration]\" />\n            <Setting name=\"Microsoft.WindowsAzure.Plugins.RemoteForwarder.Enabled\" value=\"true\" />\n        </ConfigurationSettings>\n        <Certificates>\n            <Certificate name=\"Microsoft.WindowsAzure.Plugins.RemoteAccess.PasswordEncryption\" thumbprint=\"[certificate-thumbprint]\" thumbprintAlgorithm=\"sha1\" />\n        </Certificates>\n    </Role>\n</ServiceConfiguration>\n```\n\n\n## Additional Resources\n\n[How to Configure Cloud Services](cloud-services-how-to-configure.md)\ntest\n"
}