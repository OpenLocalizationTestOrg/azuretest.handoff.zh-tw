{
  "nodes": [
    {
      "content": "Provision HBase clusters on a Virtual Network | Microsoft Azure",
      "pos": [
        27,
        90
      ]
    },
    {
      "content": "Get started using HBase in Azure HDInsight.",
      "pos": [
        109,
        152
      ]
    },
    {
      "content": "Learn how to create HDInsight HBase clusters on Azure Virtual Network.",
      "pos": [
        153,
        223
      ]
    },
    {
      "content": "Provision HBase clusters on Azure Virtual Network",
      "pos": [
        548,
        597
      ]
    },
    {
      "pos": [
        599,
        683
      ],
      "content": "Learn how to create Azure HDInsight HBase clusters on an <bpt id=\"p1\">[</bpt>Azure Virtual Network<ept id=\"p1\">][1]</ept>."
    },
    {
      "content": "Provision HBase clusters on Azure Virtual Network",
      "pos": [
        772,
        821
      ]
    },
    {
      "content": "With virtual network integration, HBase clusters can be deployed to the same virtual network as your applications so that applications can communicate with HBase directly.",
      "pos": [
        859,
        1030
      ]
    },
    {
      "content": "The benefits include:",
      "pos": [
        1031,
        1052
      ]
    },
    {
      "content": "Direct connectivity of the web application to the nodes of the HBase cluster, which enables communication via HBase Java remote procedure call (RPC) APIs.",
      "pos": [
        1056,
        1210
      ]
    },
    {
      "content": "Improved performance by not having your traffic go over multiple gateways and load-balancers.",
      "pos": [
        1213,
        1306
      ]
    },
    {
      "content": "The ability to process sensitive information in a more secure manner without exposing a public endpoint.",
      "pos": [
        1309,
        1413
      ]
    },
    {
      "content": "Prerequisites",
      "pos": [
        1417,
        1430
      ]
    },
    {
      "content": "Before you begin this tutorial, you must have the following:",
      "pos": [
        1431,
        1491
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>An Azure subscription<ept id=\"p1\">**</ept>.",
      "pos": [
        1495,
        1521
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>Get Azure free trial<ept id=\"p1\">](http://azure.microsoft.com/documentation/videos/get-azure-free-trial-for-testing-hadoop-in-hdinsight/)</ept>.",
      "pos": [
        1522,
        1652
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>A workstation with Azure PowerShell<ept id=\"p1\">**</ept>.",
      "pos": [
        1656,
        1696
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>Install and use Azure PowerShell<ept id=\"p1\">](http://azure.microsoft.com/documentation/videos/install-and-use-azure-powershell/)</ept>.",
      "pos": [
        1697,
        1819
      ]
    },
    {
      "content": "For instructions, see <bpt id=\"p1\">[</bpt>Install and configure Azure PowerShell<ept id=\"p1\">](../install-configure-powershell.md)</ept>.",
      "pos": [
        1820,
        1919
      ]
    },
    {
      "content": "To execute Azure PowerShell scripts, you must run Azure PowerShell as administrator and set the execution policy to <bpt id=\"p1\">*</bpt>RemoteSigned<ept id=\"p1\">*</ept>.",
      "pos": [
        1920,
        2051
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>Using the Set-ExecutionPolicy cmdlet<ept id=\"p1\">][2]</ept>.",
      "pos": [
        2052,
        2098
      ]
    },
    {
      "content": "Before running Azure PowerShell scripts, make sure you are connected to your Azure subscription by using the following cmdlet:",
      "pos": [
        2104,
        2230
      ]
    },
    {
      "content": "If you have multiple Azure subscriptions, use the following cmdlet to set the current subscription:",
      "pos": [
        2262,
        2361
      ]
    },
    {
      "content": "Provision an HBase cluster into a virtual network",
      "pos": [
        2424,
        2473
      ]
    },
    {
      "content": "Before provisioning an HBase cluster, you need to have an Azure virtual network.",
      "pos": [
        2475,
        2555
      ]
    },
    {
      "content": "To create a virtual network by using the Azure portal",
      "pos": [
        2559,
        2612
      ]
    },
    {
      "pos": [
        2619,
        2663
      ],
      "content": "Sign in to the <bpt id=\"p1\">[</bpt>Azure portal<ept id=\"p1\">][azure-portal]</ept>."
    },
    {
      "pos": [
        2667,
        2795
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>NEW<ept id=\"p1\">**</ept> in the bottom-left corner, click <bpt id=\"p2\">**</bpt>NETWORK SERVICES<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>VIRTUAL NETWORK<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>QUICK CREATE<ept id=\"p4\">**</ept>."
    },
    {
      "content": "Type or select the following values:",
      "pos": [
        2799,
        2835
      ]
    },
    {
      "pos": [
        2843,
        2887
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> - The name of your virtual network."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Address space<ept id=\"p1\">**</ept> - Choose an address space for the virtual network that is large enough to provide addresses for all nodes in the cluster.",
      "pos": [
        2894,
        3033
      ]
    },
    {
      "content": "Otherwise the provision will fail.",
      "pos": [
        3034,
        3068
      ]
    },
    {
      "content": "For walking through this tutorial, you can pick any of the three choices.",
      "pos": [
        3069,
        3142
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Maximum VM count<ept id=\"p1\">**</ept> - Choose one of the maximum virtual machine (VM) counts.",
      "pos": [
        3149,
        3226
      ]
    },
    {
      "content": "This value determines the number of possible hosts (VMs) that can be created under the address space.",
      "pos": [
        3227,
        3328
      ]
    },
    {
      "content": "For walking through this tutorial, <bpt id=\"p1\">**</bpt>4096 [CIDR: /20]<ept id=\"p1\">**</ept> is sufficient.",
      "pos": [
        3329,
        3399
      ]
    },
    {
      "pos": [
        3406,
        3493
      ],
      "content": "<bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> - The location must be the same as the HBase cluster that you will create."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>DNS server<ept id=\"p1\">**</ept> - This tutorial uses an internal Domain Name System (DNS) server provided by Azure, so you can choose <bpt id=\"p2\">**</bpt>None<ept id=\"p2\">**</ept>.",
      "pos": [
        3500,
        3626
      ]
    },
    {
      "content": "More advanced networking configurations with custom DNS servers are also supported.",
      "pos": [
        3627,
        3710
      ]
    },
    {
      "content": "For detailed guidance, see <bpt id=\"p1\">[</bpt>Name Resolution (DNS)<ept id=\"p1\">](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md)</ept>.",
      "pos": [
        3711,
        3845
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>CREATE A VIRTUAL NETWORK<ept id=\"p1\">**</ept> in the lower-right corner.",
      "pos": [
        3849,
        3910
      ]
    },
    {
      "content": "The new virtual network name will appear in the list.",
      "pos": [
        3911,
        3964
      ]
    },
    {
      "content": "Wait until the Status column shows <bpt id=\"p1\">**</bpt>Created<ept id=\"p1\">**</ept>.",
      "pos": [
        3965,
        4012
      ]
    },
    {
      "content": "In the main pane, click the virtual network you just created.",
      "pos": [
        4016,
        4077
      ]
    },
    {
      "pos": [
        4081,
        4124
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>DASHBOARD<ept id=\"p1\">**</ept> on the top of the page."
    },
    {
      "content": "Under <bpt id=\"p1\">**</bpt>quick glance<ept id=\"p1\">**</ept>, make a note of the virtual network ID.",
      "pos": [
        4128,
        4190
      ]
    },
    {
      "content": "You will need it when provisioning the HBase cluster.",
      "pos": [
        4191,
        4244
      ]
    },
    {
      "pos": [
        4248,
        4291
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>CONFIGURE<ept id=\"p1\">**</ept> on the top of the page."
    },
    {
      "content": "On the bottom of the page, the default subnet name is <bpt id=\"p1\">**</bpt>Subnet-1<ept id=\"p1\">**</ept>.",
      "pos": [
        4295,
        4362
      ]
    },
    {
      "content": "You can optionally rename the subnet or add a new subnet for the HBase cluster.",
      "pos": [
        4363,
        4442
      ]
    },
    {
      "content": "Make a note of the subnet name; you will need it when provisioning the cluster.",
      "pos": [
        4443,
        4522
      ]
    },
    {
      "content": "Verify <bpt id=\"p1\">**</bpt>CIDR(ADDRESS COUNT)<ept id=\"p1\">**</ept> for the subnet that will be used for the cluster.",
      "pos": [
        4527,
        4607
      ]
    },
    {
      "content": "The address count must be greater than the number of worker nodes plus seven (gateway: 2, head node: 2, Zookeeper: 3).",
      "pos": [
        4608,
        4726
      ]
    },
    {
      "content": "For example, if you need a 10-node HBase cluster, the address count for the subnet must be greater than 17 (10+7).",
      "pos": [
        4727,
        4841
      ]
    },
    {
      "content": "Otherwise the deployment will fail.",
      "pos": [
        4842,
        4877
      ]
    },
    {
      "pos": [
        4882,
        4962
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> on the bottom of the page, if you have updated the subnet values."
    },
    {
      "content": "To add a DNS server virtual machine to the virtual network",
      "pos": [
        4967,
        5025
      ]
    },
    {
      "content": "A DNS server is optional, but necessary in some cases.",
      "pos": [
        5029,
        5083
      ]
    },
    {
      "content": "The procedure has been documented in <bpt id=\"p1\">[</bpt>Configure DNS between two Azure virtual networks<ept id=\"p1\">][hdinsight-hbase-replication-dns]</ept>.",
      "pos": [
        5085,
        5206
      ]
    },
    {
      "content": "Basically, you will need to perform these steps:",
      "pos": [
        5207,
        5255
      ]
    },
    {
      "content": "add an Azure virtual machine to the virtual network",
      "pos": [
        5260,
        5311
      ]
    },
    {
      "content": "set a static IP address for the virtual machine",
      "pos": [
        5315,
        5362
      ]
    },
    {
      "content": "add the DNS server role to the virtual machine",
      "pos": [
        5366,
        5412
      ]
    },
    {
      "content": "Assign the DNS server to the virtual network",
      "pos": [
        5416,
        5460
      ]
    },
    {
      "content": "To create an Azure Storage account and a Blob storage container to be used by the cluster",
      "pos": [
        5465,
        5554
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> HDInsight clusters use Azure Blob storage for storing data.",
      "pos": [
        5560,
        5632
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Use Azure Blob storage with Hadoop in HDInsight<ept id=\"p1\">](../hdinsight-use-blob-storage.md)</ept>.",
      "pos": [
        5633,
        5743
      ]
    },
    {
      "content": "You will need a storage account and a Blob storage container.",
      "pos": [
        5744,
        5805
      ]
    },
    {
      "content": "The storage account location must match the virtual network location and the cluster location.",
      "pos": [
        5806,
        5900
      ]
    },
    {
      "content": "Like other HDInsight clusters, HBase cluster requires an Azure Storage account and a Blob storage container as the default file system.",
      "pos": [
        5902,
        6037
      ]
    },
    {
      "content": "The storage account location must match the virtual network location and the cluster location.",
      "pos": [
        6038,
        6132
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Use Azure Blob storage with Hadoop in HDInsight<ept id=\"p1\">][hdinsight-storage]</ept>.",
      "pos": [
        6133,
        6228
      ]
    },
    {
      "content": "When you provision an HBase cluster, you have the options to create new or use existing ones.",
      "pos": [
        6229,
        6322
      ]
    },
    {
      "content": "This procedure shows you how to create a storage account and a Blob storage container using the Azure portal.",
      "pos": [
        6323,
        6432
      ]
    },
    {
      "pos": [
        6437,
        6481
      ],
      "content": "Sign in to the <bpt id=\"p1\">[</bpt>Azure portal<ept id=\"p1\">][azure-portal]</ept>."
    },
    {
      "pos": [
        6485,
        6607
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>NEW<ept id=\"p1\">**</ept> in the lower-left corner, point to <bpt id=\"p2\">**</bpt>DATA SERVICES<ept id=\"p2\">**</ept>, point to <bpt id=\"p3\">**</bpt>STORAGE<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>QUICK CREATE<ept id=\"p4\">**</ept>."
    },
    {
      "content": "Type or select the following values:",
      "pos": [
        6612,
        6648
      ]
    },
    {
      "pos": [
        6656,
        6698
      ],
      "content": "<bpt id=\"p1\">**</bpt>URL<ept id=\"p1\">**</ept> - The name of the Storage account."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>LOCATION<ept id=\"p1\">**</ept> - The location of the Storage account.",
      "pos": [
        6705,
        6756
      ]
    },
    {
      "content": "Make sure it matches the virtual network location.",
      "pos": [
        6757,
        6807
      ]
    },
    {
      "content": "Affinity groups are not supported.",
      "pos": [
        6808,
        6842
      ]
    },
    {
      "pos": [
        6849,
        6934
      ],
      "content": "<bpt id=\"p1\">**</bpt>REPLICATION<ept id=\"p1\">**</ept> - For testing purposes, use <bpt id=\"p2\">**</bpt>Locally Redundant<ept id=\"p2\">**</ept> to reduce the cost."
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>CREATE STORAGE ACCOUNT<ept id=\"p1\">**</ept>.",
      "pos": [
        6939,
        6972
      ]
    },
    {
      "content": "You will see the new Storage account in the storage list.",
      "pos": [
        6973,
        7030
      ]
    },
    {
      "pos": [
        7034,
        7109
      ],
      "content": "Wait until the <bpt id=\"p1\">**</bpt>STATUS<ept id=\"p1\">**</ept> of the new Storage account changes to <bpt id=\"p2\">**</bpt>Online<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Click the new Storage account from the list to select it.",
      "pos": [
        7113,
        7170
      ]
    },
    {
      "pos": [
        7174,
        7231
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>MANAGE ACCESS KEYS<ept id=\"p1\">**</ept> from the bottom of the page."
    },
    {
      "content": "Make a note of the Storage account name and the primary access key (or the secondary access key; either of the keys works).",
      "pos": [
        7235,
        7358
      ]
    },
    {
      "content": "You will need them later in the tutorial.",
      "pos": [
        7359,
        7400
      ]
    },
    {
      "pos": [
        7404,
        7450
      ],
      "content": "From the top of the page, click <bpt id=\"p1\">**</bpt>CONTAINER<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        7455,
        7498
      ],
      "content": "From the bottom of the page, click <bpt id=\"p1\">**</bpt>ADD<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Enter the container name.",
      "pos": [
        7503,
        7528
      ]
    },
    {
      "content": "This container will be used as the default container for the HBase cluster.",
      "pos": [
        7529,
        7604
      ]
    },
    {
      "content": "By default, the default container name matches the cluster name.",
      "pos": [
        7605,
        7669
      ]
    },
    {
      "content": "Keep the <bpt id=\"p1\">**</bpt>ACCESS<ept id=\"p1\">**</ept> field as <bpt id=\"p2\">**</bpt>Private<ept id=\"p2\">**</ept>.",
      "pos": [
        7670,
        7711
      ]
    },
    {
      "content": "Click the checkmark to create the container.",
      "pos": [
        7718,
        7762
      ]
    },
    {
      "content": "To provision an HBase cluster by using the Azure portal",
      "pos": [
        7766,
        7821
      ]
    },
    {
      "pos": [
        7827,
        7988
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> For information on provisioning a new HBase cluster by using Azure PowerShell, see <bpt id=\"p1\">[</bpt>Provision an HBase cluster using Azure PowerShell<ept id=\"p1\">](#powershell)</ept>."
    },
    {
      "pos": [
        7993,
        8037
      ],
      "content": "Sign in to the <bpt id=\"p1\">[</bpt>Azure portal<ept id=\"p1\">][azure-portal]</ept>."
    },
    {
      "pos": [
        8042,
        8167
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>NEW<ept id=\"p1\">**</ept> in the lower-left corner, point to <bpt id=\"p2\">**</bpt>DATA SERVICES<ept id=\"p2\">**</ept>, point to <bpt id=\"p3\">**</bpt>HDINSIGHT<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>CUSTOM CREATE<ept id=\"p4\">**</ept>."
    },
    {
      "content": "Enter a cluster name, select HBase as the cluster type, select the Windows Server 2012 operating system, select the HDInsight version, and then click the right button.",
      "pos": [
        8172,
        8339
      ]
    },
    {
      "content": "Provide details for the HBase cluster",
      "pos": [
        8347,
        8384
      ]
    },
    {
      "pos": [
        8510,
        8575
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Configure Cluster<ept id=\"p1\">**</ept> page, enter or select the following:"
    },
    {
      "content": "Provide details for the HBase cluster",
      "pos": [
        8583,
        8620
      ]
    },
    {
      "pos": [
        8684,
        9592
      ],
      "content": "<table border='1'>\n     <tr><th>Property</th><th>Value</th></tr>\n     <tr><td>Data Nodes</td><td>Select the number of data nodes you want to deploy. For testing purposes, create a single-node cluster. <br />The cluster size limit varies for Azure subscriptions. Contact Azure billing support to increase the limit.</td></tr>\n     <tr><td>Region/Virtual Network</td><td><p>Select a region or an Azure virtual network, if you have one already created. For this tutorial, select the network that you created earlier, and then select a corresponding subnet. The default name is <b>Subnet-1</b>.</p></td></tr>\n     <tr><td>Head Node Size</td><td><p>Select a VM size for the head node.</p></td></tr>\n     <tr><td>Data Node Size</td><td><p>Select a VM size for the data nodes.</p></td></tr>\n     <tr><td>Zookeeper Size</td><td><p>Select a VM size for the Zookeeper node.</p></td></tr>\n </table>",
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "nodes": [
        {
          "content": "Property",
          "pos": [
            32,
            40
          ]
        },
        {
          "content": "Value",
          "pos": [
            49,
            54
          ]
        },
        {
          "content": "Data Nodes",
          "pos": [
            78,
            88
          ]
        },
        {
          "content": "Select the number of data nodes you want to deploy. For testing purposes, create a single-node cluster. ",
          "pos": [
            97,
            201
          ],
          "nodes": [
            {
              "content": "Select the number of data nodes you want to deploy.",
              "pos": [
                0,
                51
              ]
            },
            {
              "content": "For testing purposes, create a single-node cluster.",
              "pos": [
                52,
                103
              ]
            }
          ]
        },
        {
          "content": "The cluster size limit varies for Azure subscriptions. Contact Azure billing support to increase the limit.",
          "pos": [
            207,
            314
          ],
          "nodes": [
            {
              "content": "The cluster size limit varies for Azure subscriptions.",
              "pos": [
                0,
                54
              ]
            },
            {
              "content": "Contact Azure billing support to increase the limit.",
              "pos": [
                55,
                107
              ]
            }
          ]
        },
        {
          "content": "Region/Virtual Network",
          "pos": [
            338,
            360
          ]
        },
        {
          "content": "Select a region or an Azure virtual network, if you have one already created. For this tutorial, select the network that you created earlier, and then select a corresponding subnet. The default name is <b>Subnet-1</b>.",
          "pos": [
            372,
            590
          ],
          "nodes": [
            {
              "content": "Select a region or an Azure virtual network, if you have one already created.",
              "pos": [
                0,
                77
              ]
            },
            {
              "content": "For this tutorial, select the network that you created earlier, and then select a corresponding subnet.",
              "pos": [
                78,
                181
              ]
            },
            {
              "content": "The default name is <ph id=\"ph1\">&lt;b&gt;</ph>Subnet-1<ph id=\"ph2\">&lt;/b&gt;</ph>.",
              "pos": [
                182,
                218
              ]
            }
          ]
        },
        {
          "content": "Head Node Size",
          "pos": [
            618,
            632
          ]
        },
        {
          "content": "Select a VM size for the head node.",
          "pos": [
            644,
            679
          ]
        },
        {
          "content": "Data Node Size",
          "pos": [
            707,
            721
          ]
        },
        {
          "content": "Select a VM size for the data nodes.",
          "pos": [
            733,
            769
          ]
        },
        {
          "content": "Zookeeper Size",
          "pos": [
            797,
            811
          ]
        },
        {
          "content": "Select a VM size for the Zookeeper node.",
          "pos": [
            823,
            863
          ]
        }
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Based on the choice of VMs, your cost might vary.",
      "pos": [
        9599,
        9661
      ]
    },
    {
      "content": "HDInsight uses all standard-tier VMs for cluster nodes.",
      "pos": [
        9662,
        9717
      ]
    },
    {
      "content": "For information on how VM sizes affect your prices, see <ph id=\"ph1\">&lt;a href=\"http://azure.microsoft.com/pricing/details/hdinsight/\" target=\"_blank\"&gt;</ph>HDInsight Pricing<ph id=\"ph2\">&lt;/a&gt;</ph>.",
      "pos": [
        9718,
        9876
      ]
    },
    {
      "content": "Click the right button.",
      "pos": [
        9882,
        9905
      ]
    },
    {
      "content": "Enter the Hadoop user name and password to use for this cluster, and then click the right button.",
      "pos": [
        9910,
        10007
      ]
    },
    {
      "content": "Provide Storage account for Hadoop HDInsight cluster",
      "pos": [
        10015,
        10067
      ]
    },
    {
      "pos": [
        10131,
        10896
      ],
      "content": "<table border='1'>\n     <tr><th>Property</th><th>Value</th></tr>\n     <tr><td>HTTP User Name</td>\n         <td>Specify the HDInsight cluster user name.</td></tr>\n     <tr><td>HTTP Password/Confirm Password</td>\n         <td>Specify the HDInsight cluster user password.</td></tr>\n     <tr><td>Enable remote desktop for cluster</td>\n         <td>Select this check box to specify a username, password, and expiry date for a remote desktop user that can remote into the cluster nodes, once it is provisioned. You can also enable remote desktop later, after the cluster is provisioned. For instructions, see <a href=\"hdinsight-administer-use-management-portal/#rdp\" target=\"_blank\">Connect to HDInsight clusters using RDP</a>.</td></tr>\n </table>",
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "nodes": [
        {
          "content": "Property",
          "pos": [
            32,
            40
          ]
        },
        {
          "content": "Value",
          "pos": [
            49,
            54
          ]
        },
        {
          "content": "HTTP User Name",
          "pos": [
            78,
            92
          ]
        },
        {
          "content": "Specify the HDInsight cluster user name.",
          "pos": [
            111,
            151
          ]
        },
        {
          "content": "HTTP Password/Confirm Password",
          "pos": [
            175,
            205
          ]
        },
        {
          "content": "Specify the HDInsight cluster user password.",
          "pos": [
            224,
            268
          ]
        },
        {
          "content": "Enable remote desktop for cluster",
          "pos": [
            292,
            325
          ]
        },
        {
          "content": "Select this check box to specify a username, password, and expiry date for a remote desktop user that can remote into the cluster nodes, once it is provisioned. You can also enable remote desktop later, after the cluster is provisioned. For instructions, see <a href=\"hdinsight-administer-use-management-portal/#rdp\" target=\"_blank\">Connect to HDInsight clusters using RDP</a>.",
          "pos": [
            344,
            721
          ],
          "nodes": [
            {
              "content": "Select this check box to specify a username, password, and expiry date for a remote desktop user that can remote into the cluster nodes, once it is provisioned.",
              "pos": [
                0,
                160
              ]
            },
            {
              "content": "You can also enable remote desktop later, after the cluster is provisioned.",
              "pos": [
                161,
                236
              ]
            },
            {
              "content": "For instructions, see <ph id=\"ph1\">&lt;a href=\"hdinsight-administer-use-management-portal/#rdp\" target=\"_blank\"&gt;</ph>Connect to HDInsight clusters using RDP<ph id=\"ph2\">&lt;/a&gt;</ph>.",
              "pos": [
                237,
                377
              ]
            }
          ]
        }
      ]
    },
    {
      "pos": [
        10901,
        10963
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Storage Account<ept id=\"p1\">**</ept> page, provide the following values:"
    },
    {
      "content": "Provide Storage account for Hadoop HDInsight cluster",
      "pos": [
        10971,
        11023
      ]
    },
    {
      "pos": [
        11087,
        13917
      ],
      "content": "<table border='1'>\n     <tr><th>Property</th><th>Value</th></tr>\n     <tr><td>Storage Account</td>\n         <td>Specify the Azure Storage account that will be used as the default file system for the HDInsight cluster. You can choose one of the three options:\n         <ul>\n             <li><strong>Use Existing Storage</strong></li>\n             <li><strong>Create New Storage</strong></li>\n             <li><strong>Use Storage From Another Subscription</strong></li>\n         </ul>\n         </td></tr>\n     <tr><td>Account Name</td>\n         <td><ul>\n             <li>If you chose to use existing storage, for <strong>Account Name</strong>, select an existing storage account. The drop-down lists only the Storage accounts located in the same data center where you chose to provision the cluster.</li>\n             <li>If you chose the <strong>Create New Storage</strong> or <strong>Use Storage From Another Subscription</strong> option, you must provide the Storage account name.</li>\n         </ul></td></tr>\n     <tr><td>Account Key</td>\n         <td>If you chose the <strong>Use Storage From Another Subscription</strong> option, specify the account key for that Storage account.</td></tr>\n     <tr><td>Default Container</td>\n         <td><p>Specify the default container on the Storage account that is used as the default file system for the HDInsight cluster. If you chose <strong>Use Existing Storage</strong> for the <strong>Storage Account</strong> field, and there are no existing containers in that account, the container is created by default with the same name as the cluster name. If a container with the name of the cluster already exists, a sequence number will be appended to the container name. For example, mycontainer1, mycontainer2, and so on. However, if the existing Storage account has a container with a name different from the cluster name you specified, you can use that container as well.</p>\n         <p>If you chose to create a new storage or use storage from another Azure subscription, you must specify the default container name.</p>\n     </td></tr>\n     <tr><td>Additional Storage Accounts</td>\n         <td>If required, specify additional Storage accounts for the cluster. HDInsight supports multiple Storage accounts. There is no limit on the additional Storage accounts that can be used by a cluster. However, if you create a cluster by using the Azure portal, you have a limit of seven due to the UI constraints. Each additional Storage account you specify adds an extra <strong>Storage Account</strong> page to the wizard where you can specify the account information. For example, in the screenshot above, no additional storage account is selected, and hence an extra page is not added to the wizard.</td></tr>\n </table>",
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "nodes": [
        {
          "content": "Property",
          "pos": [
            32,
            40
          ]
        },
        {
          "content": "Value",
          "pos": [
            49,
            54
          ]
        },
        {
          "content": "Storage Account",
          "pos": [
            78,
            93
          ]
        },
        {
          "content": "Specify the Azure Storage account that will be used as the default file system for the HDInsight cluster. You can choose one of the three options:",
          "pos": [
            112,
            258
          ],
          "nodes": [
            {
              "content": "Specify the Azure Storage account that will be used as the default file system for the HDInsight cluster.",
              "pos": [
                0,
                105
              ]
            },
            {
              "content": "You can choose one of the three options:",
              "pos": [
                106,
                146
              ]
            }
          ]
        },
        {
          "content": "<ph id=\"ph1\">&lt;strong&gt;</ph>Use Existing Storage<ph id=\"ph2\">&lt;/strong&gt;</ph>",
          "pos": [
            290,
            327
          ]
        },
        {
          "content": "<ph id=\"ph1\">&lt;strong&gt;</ph>Create New Storage<ph id=\"ph2\">&lt;/strong&gt;</ph>",
          "pos": [
            350,
            385
          ]
        },
        {
          "content": "<ph id=\"ph1\">&lt;strong&gt;</ph>Use Storage From Another Subscription<ph id=\"ph2\">&lt;/strong&gt;</ph>",
          "pos": [
            408,
            462
          ]
        },
        {
          "content": "Account Name",
          "pos": [
            516,
            528
          ]
        },
        {
          "content": "If you chose to use existing storage, for <strong>Account Name</strong>, select an existing storage account. The drop-down lists only the Storage accounts located in the same data center where you chose to provision the cluster.",
          "pos": [
            569,
            797
          ],
          "nodes": [
            {
              "content": "If you chose to use existing storage, for <ph id=\"ph1\">&lt;strong&gt;</ph>Account Name<ph id=\"ph2\">&lt;/strong&gt;</ph>, select an existing storage account.",
              "pos": [
                0,
                108
              ]
            },
            {
              "content": "The drop-down lists only the Storage accounts located in the same data center where you chose to provision the cluster.",
              "pos": [
                109,
                228
              ]
            }
          ]
        },
        {
          "content": "If you chose the <ph id=\"ph1\">&lt;strong&gt;</ph>Create New Storage<ph id=\"ph2\">&lt;/strong&gt;</ph> or <ph id=\"ph3\">&lt;strong&gt;</ph>Use Storage From Another Subscription<ph id=\"ph4\">&lt;/strong&gt;</ph> option, you must provide the Storage account name.",
          "pos": [
            820,
            981
          ]
        },
        {
          "content": "Account Key",
          "pos": [
            1025,
            1036
          ]
        },
        {
          "content": "If you chose the <ph id=\"ph1\">&lt;strong&gt;</ph>Use Storage From Another Subscription<ph id=\"ph2\">&lt;/strong&gt;</ph> option, specify the account key for that Storage account.",
          "pos": [
            1055,
            1184
          ]
        },
        {
          "content": "Default Container",
          "pos": [
            1208,
            1225
          ]
        },
        {
          "content": "Specify the default container on the Storage account that is used as the default file system for the HDInsight cluster. If you chose <strong>Use Existing Storage</strong> for the <strong>Storage Account</strong> field, and there are no existing containers in that account, the container is created by default with the same name as the cluster name. If a container with the name of the cluster already exists, a sequence number will be appended to the container name. For example, mycontainer1, mycontainer2, and so on. However, if the existing Storage account has a container with a name different from the cluster name you specified, you can use that container as well.",
          "pos": [
            1247,
            1917
          ],
          "nodes": [
            {
              "content": "Specify the default container on the Storage account that is used as the default file system for the HDInsight cluster.",
              "pos": [
                0,
                119
              ]
            },
            {
              "content": "If you chose <ph id=\"ph1\">&lt;strong&gt;</ph>Use Existing Storage<ph id=\"ph2\">&lt;/strong&gt;</ph> for the <ph id=\"ph3\">&lt;strong&gt;</ph>Storage Account<ph id=\"ph4\">&lt;/strong&gt;</ph> field, and there are no existing containers in that account, the container is created by default with the same name as the cluster name.",
              "pos": [
                120,
                348
              ]
            },
            {
              "content": "If a container with the name of the cluster already exists, a sequence number will be appended to the container name.",
              "pos": [
                349,
                466
              ]
            },
            {
              "content": "For example, mycontainer1, mycontainer2, and so on.",
              "pos": [
                467,
                518
              ]
            },
            {
              "content": "However, if the existing Storage account has a container with a name different from the cluster name you specified, you can use that container as well.",
              "pos": [
                519,
                670
              ]
            }
          ]
        },
        {
          "content": "If you chose to create a new storage or use storage from another Azure subscription, you must specify the default container name.",
          "pos": [
            1934,
            2063
          ]
        },
        {
          "content": "Additional Storage Accounts",
          "pos": [
            2097,
            2124
          ]
        },
        {
          "content": "If required, specify additional Storage accounts for the cluster. HDInsight supports multiple Storage accounts. There is no limit on the additional Storage accounts that can be used by a cluster. However, if you create a cluster by using the Azure portal, you have a limit of seven due to the UI constraints. Each additional Storage account you specify adds an extra <strong>Storage Account</strong> page to the wizard where you can specify the account information. For example, in the screenshot above, no additional storage account is selected, and hence an extra page is not added to the wizard.",
          "pos": [
            2143,
            2741
          ],
          "nodes": [
            {
              "content": "If required, specify additional Storage accounts for the cluster.",
              "pos": [
                0,
                65
              ]
            },
            {
              "content": "HDInsight supports multiple Storage accounts.",
              "pos": [
                66,
                111
              ]
            },
            {
              "content": "There is no limit on the additional Storage accounts that can be used by a cluster.",
              "pos": [
                112,
                195
              ]
            },
            {
              "content": "However, if you create a cluster by using the Azure portal, you have a limit of seven due to the UI constraints.",
              "pos": [
                196,
                308
              ]
            },
            {
              "content": "Each additional Storage account you specify adds an extra <ph id=\"ph1\">&lt;strong&gt;</ph>Storage Account<ph id=\"ph2\">&lt;/strong&gt;</ph> page to the wizard where you can specify the account information.",
              "pos": [
                309,
                465
              ]
            },
            {
              "content": "For example, in the screenshot above, no additional storage account is selected, and hence an extra page is not added to the wizard.",
              "pos": [
                466,
                598
              ]
            }
          ]
        }
      ]
    },
    {
      "content": "Click the right arrow.",
      "pos": [
        13923,
        13945
      ]
    },
    {
      "content": "On the <bpt id=\"p1\">**</bpt>Script Actions<ept id=\"p1\">**</ept> page, select the checkmark in the lower-right corner.",
      "pos": [
        13950,
        14029
      ]
    },
    {
      "content": "Do not click the <bpt id=\"p1\">**</bpt>add script action<ept id=\"p1\">**</ept> button, as this tutorial does not require a customized cluster setup.",
      "pos": [
        14030,
        14138
      ]
    },
    {
      "content": "Configure Script Action to customize an HDInsight HBase cluster",
      "pos": [
        14146,
        14209
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> This page can be used to customize the cluster during setup.",
      "pos": [
        14247,
        14320
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p1\">](hdinsight-hadoop-customize-cluster.md)</ept>.",
      "pos": [
        14321,
        14437
      ]
    },
    {
      "pos": [
        14439,
        14607
      ],
      "content": "To begin working with your new HBase cluster, you can use the procedures found in <bpt id=\"p1\">[</bpt>Get started using HBase with Hadoop in HDInsight<ept id=\"p1\">](../hdinsight-hbase-get-started.md)</ept>."
    },
    {
      "content": "Connect to the HBase cluster provisioned in the virtual network by using HBase Java RPC APIs",
      "pos": [
        14611,
        14703
      ]
    },
    {
      "content": "Provision an infrastructure as a service (IaaS) virtual machine into the same Azure virtual network and the same subnet.",
      "pos": [
        14709,
        14829
      ]
    },
    {
      "content": "So both the virtual machine and the HBase cluster use the same internal DNS server to resolve host names.",
      "pos": [
        14830,
        14935
      ]
    },
    {
      "content": "To do so, you must choose the <bpt id=\"p1\">**</bpt>From Gallery<ept id=\"p1\">**</ept> option, and select the virtual network instead of a data center.",
      "pos": [
        14936,
        15047
      ]
    },
    {
      "content": "For instructions, see <bpt id=\"p1\">[</bpt>Create a Virtual Machine Running Windows Server<ept id=\"p1\">](../virtual-machines-windows-tutorial.md)</ept>.",
      "pos": [
        15048,
        15161
      ]
    },
    {
      "content": "A standard Windows Server 2012 image with a small VM size is sufficient.",
      "pos": [
        15162,
        15234
      ]
    },
    {
      "content": "When using a Java application to connect to HBase remotely, you must use the fully qualified domain name (FQDN).",
      "pos": [
        15240,
        15352
      ]
    },
    {
      "content": "To determine this, you must get the connection-specific DNS suffix of the HBase cluster.",
      "pos": [
        15353,
        15441
      ]
    },
    {
      "content": "To do that, use Curl to query Ambari, or use Remote Desktop to connect to the cluster.",
      "pos": [
        15442,
        15528
      ]
    },
    {
      "pos": [
        15536,
        15573
      ],
      "content": "<bpt id=\"p1\">**</bpt>Curl<ept id=\"p1\">**</ept> - Use the following command:"
    },
    {
      "content": "In the JavaScript Object Notation (JSON) data returned, find the \"host_name\" entry.",
      "pos": [
        15759,
        15842
      ]
    },
    {
      "content": "This will contain the FQDN for the nodes in the cluster.",
      "pos": [
        15843,
        15899
      ]
    },
    {
      "content": "For example:",
      "pos": [
        15900,
        15912
      ]
    },
    {
      "content": "The portion of the domain name beginning with the cluster name is the DNS suffix.",
      "pos": [
        16024,
        16105
      ]
    },
    {
      "content": "For example, mycluster.b1.cloudapp.net.",
      "pos": [
        16106,
        16145
      ]
    },
    {
      "pos": [
        16153,
        16309
      ],
      "content": "<bpt id=\"p1\">**</bpt>Azure PowerShell<ept id=\"p1\">**</ept> - Use the following Azure PowerShell script to register the <bpt id=\"p2\">**</bpt>Get-ClusterDetail<ept id=\"p2\">**</ept> function, which can be used to return the DNS suffix:"
    },
    {
      "content": "After running the Azure PowerShell script, use the following command to return the DNS suffix by using the <bpt id=\"p1\">**</bpt>Get-ClusterDetail<ept id=\"p1\">**</ept> function.",
      "pos": [
        21695,
        21833
      ]
    },
    {
      "content": "Specify your HDInsight HBase cluster name, admin name, and admin password when using this command.",
      "pos": [
        21834,
        21932
      ]
    },
    {
      "content": "This will return the DNS suffix.",
      "pos": [
        22090,
        22122
      ]
    },
    {
      "content": "For example, <bpt id=\"p1\">**</bpt>yourclustername.b4.internal.cloudapp.net<ept id=\"p1\">**</ept>.",
      "pos": [
        22123,
        22181
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You can also use Remote Desktop to connect to the HBase cluster (you will be connected to the head node) and run <bpt id=\"p1\">**</bpt>ipconfig<ept id=\"p1\">**</ept> from a command prompt to obtain the DNS suffix.",
      "pos": [
        22189,
        22375
      ]
    },
    {
      "content": "For instructions on enabling Remote Desktop Protocol (RDP) and connecting to the cluster by using RDP, see <bpt id=\"p1\">[</bpt>Manage Hadoop clusters in HDInsight using the Azure portal<ept id=\"p1\">][hdinsight-admin-portal]</ept>.",
      "pos": [
        22376,
        22568
      ]
    },
    {
      "content": "hdinsight.hbase.dns.surffix",
      "pos": [
        22583,
        22610
      ]
    },
    {
      "content": "To verify that the virtual machine can communicate with the HBase cluster, use the command <ph id=\"ph1\">`ping headnode0.&lt;dns suffix&gt;`</ph> from the virtual machine.",
      "pos": [
        23430,
        23576
      ]
    },
    {
      "content": "For example, ping headnode0.mycluster.b1.cloudapp.net.",
      "pos": [
        23577,
        23631
      ]
    },
    {
      "content": "To use this information in a Java application, you can follow the steps in <bpt id=\"p1\">[</bpt>Use Maven to build Java applications that use HBase with HDInsight (Hadoop)<ept id=\"p1\">](hdinsight-hbase-build-java-maven.md)</ept> to create an application.",
      "pos": [
        23633,
        23848
      ]
    },
    {
      "content": "To have the application connect to a remote HBase server, modify the <bpt id=\"p1\">**</bpt>hbase-site.xml<ept id=\"p1\">**</ept> file in this example to use the FQDN for Zookeeper.",
      "pos": [
        23849,
        23988
      ]
    },
    {
      "content": "For example:",
      "pos": [
        23989,
        24001
      ]
    },
    {
      "pos": [
        24176,
        24409
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> For more information on name resolution in Azure virtual networks, including how to use your own DNS server, see <bpt id=\"p1\">[</bpt>Name Resolution (DNS)<ept id=\"p1\">](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md)</ept>."
    },
    {
      "content": "Provision an HBase cluster by using Azure PowerShell",
      "pos": [
        24413,
        24465
      ]
    },
    {
      "content": "To provision an HBase cluster by using Azure PowerShell",
      "pos": [
        24469,
        24524
      ]
    },
    {
      "content": "Open the Azure PowerShell Integrated Scripting Environment (ISE).",
      "pos": [
        24531,
        24596
      ]
    },
    {
      "content": "Copy and paste the following into the script pane:",
      "pos": [
        24600,
        24650
      ]
    },
    {
      "pos": [
        26153,
        26191
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Run Script<ept id=\"p1\">**</ept>, or press <bpt id=\"p2\">**</bpt>F5<ept id=\"p2\">**</ept>."
    },
    {
      "content": "To validate the cluster, you can either check the cluster from the Azure portal, or run the following Azure PowerShell cmdlet from the bottom pane:",
      "pos": [
        26195,
        26342
      ]
    },
    {
      "content": "Get-AzureHDInsightCluster",
      "pos": [
        26348,
        26373
      ]
    },
    {
      "content": "Next steps",
      "pos": [
        26377,
        26387
      ]
    },
    {
      "content": "In this tutorial you learned how to provision an HBase cluster.",
      "pos": [
        26389,
        26452
      ]
    },
    {
      "content": "To learn more, see:",
      "pos": [
        26453,
        26472
      ]
    },
    {
      "content": "Get started with HDInsight",
      "pos": [
        26477,
        26503
      ]
    },
    {
      "content": "Configure HBase replication in HDInsight",
      "pos": [
        26537,
        26577
      ]
    },
    {
      "content": "Provision Hadoop clusters in HDInsight",
      "pos": [
        26618,
        26656
      ]
    },
    {
      "content": "Get started using HBase with Hadoop in HDInsight",
      "pos": [
        26694,
        26742
      ]
    },
    {
      "content": "Analyze Twitter sentiment with HBase in HDInsight",
      "pos": [
        26782,
        26831
      ]
    },
    {
      "content": "Virtual Network Overview",
      "pos": [
        26877,
        26901
      ]
    },
    {
      "content": "test",
      "pos": [
        29194,
        29198
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Provision HBase clusters on a Virtual Network | Microsoft Azure\"\n    description=\"Get started using HBase in Azure HDInsight. Learn how to create HDInsight HBase clusters on Azure Virtual Network.\"\n    keywords=\"\"\n    services=\"hdinsight,virtual-network\"\n    documentationCenter=\"\"\n    authors=\"mumian\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"/>\n\n<tags\n   ms.service=\"hdinsight\"\n   ms.devlang=\"na\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"big-data\"\n   ms.date=\"08/07/2015\"\n   ms.author=\"jgao\"/>\n\n# Provision HBase clusters on Azure Virtual Network\n\nLearn how to create Azure HDInsight HBase clusters on an [Azure Virtual Network][1].\n\n[AZURE.INCLUDE [hdinsight-azure-portal](../../includes/hdinsight-azure-portal.md)]\n\n* [Provision HBase clusters on Azure Virtual Network](hdinsight-hbase-provision-vnet.md)\n\nWith virtual network integration, HBase clusters can be deployed to the same virtual network as your applications so that applications can communicate with HBase directly. The benefits include:\n\n- Direct connectivity of the web application to the nodes of the HBase cluster, which enables communication via HBase Java remote procedure call (RPC) APIs.\n- Improved performance by not having your traffic go over multiple gateways and load-balancers.\n- The ability to process sensitive information in a more secure manner without exposing a public endpoint.\n\n##Prerequisites\nBefore you begin this tutorial, you must have the following:\n\n- **An Azure subscription**. See [Get Azure free trial](http://azure.microsoft.com/documentation/videos/get-azure-free-trial-for-testing-hadoop-in-hdinsight/).\n\n- **A workstation with Azure PowerShell**. See [Install and use Azure PowerShell](http://azure.microsoft.com/documentation/videos/install-and-use-azure-powershell/). For instructions, see [Install and configure Azure PowerShell](../install-configure-powershell.md). To execute Azure PowerShell scripts, you must run Azure PowerShell as administrator and set the execution policy to *RemoteSigned*. See [Using the Set-ExecutionPolicy cmdlet][2].\n\n    Before running Azure PowerShell scripts, make sure you are connected to your Azure subscription by using the following cmdlet:\n\n        Add-AzureAccount\n\n    If you have multiple Azure subscriptions, use the following cmdlet to set the current subscription:\n\n        Select-AzureSubscription <AzureSubscriptionName>\n\n\n##Provision an HBase cluster into a virtual network\n\nBefore provisioning an HBase cluster, you need to have an Azure virtual network.\n\n**To create a virtual network by using the Azure portal**\n\n1. Sign in to the [Azure portal][azure-portal].\n2. Click **NEW** in the bottom-left corner, click **NETWORK SERVICES**, click **VIRTUAL NETWORK**, and then click **QUICK CREATE**.\n3. Type or select the following values:\n\n    - **Name** - The name of your virtual network.\n    - **Address space** - Choose an address space for the virtual network that is large enough to provide addresses for all nodes in the cluster. Otherwise the provision will fail. For walking through this tutorial, you can pick any of the three choices.\n    - **Maximum VM count** - Choose one of the maximum virtual machine (VM) counts. This value determines the number of possible hosts (VMs) that can be created under the address space. For walking through this tutorial, **4096 [CIDR: /20]** is sufficient.\n    - **Location** - The location must be the same as the HBase cluster that you will create.\n    - **DNS server** - This tutorial uses an internal Domain Name System (DNS) server provided by Azure, so you can choose **None**. More advanced networking configurations with custom DNS servers are also supported. For detailed guidance, see [Name Resolution (DNS)](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md).\n4. Click **CREATE A VIRTUAL NETWORK** in the lower-right corner. The new virtual network name will appear in the list. Wait until the Status column shows **Created**.\n5. In the main pane, click the virtual network you just created.\n6. Click **DASHBOARD** on the top of the page.\n7. Under **quick glance**, make a note of the virtual network ID. You will need it when provisioning the HBase cluster.\n8. Click **CONFIGURE** on the top of the page.\n9. On the bottom of the page, the default subnet name is **Subnet-1**. You can optionally rename the subnet or add a new subnet for the HBase cluster. Make a note of the subnet name; you will need it when provisioning the cluster.\n10. Verify **CIDR(ADDRESS COUNT)** for the subnet that will be used for the cluster. The address count must be greater than the number of worker nodes plus seven (gateway: 2, head node: 2, Zookeeper: 3). For example, if you need a 10-node HBase cluster, the address count for the subnet must be greater than 17 (10+7). Otherwise the deployment will fail.\n11. Click **Save** on the bottom of the page, if you have updated the subnet values.\n\n\n**To add a DNS server virtual machine to the virtual network**\n\nA DNS server is optional, but necessary in some cases.  The procedure has been documented in [Configure DNS between two Azure virtual networks][hdinsight-hbase-replication-dns]. Basically, you will need to perform these steps:\n\n1. add an Azure virtual machine to the virtual network\n2. set a static IP address for the virtual machine\n3. add the DNS server role to the virtual machine\n4. Assign the DNS server to the virtual network\n\n\n**To create an Azure Storage account and a Blob storage container to be used by the cluster**\n\n> [AZURE.NOTE] HDInsight clusters use Azure Blob storage for storing data. For more information, see [Use Azure Blob storage with Hadoop in HDInsight](../hdinsight-use-blob-storage.md). You will need a storage account and a Blob storage container. The storage account location must match the virtual network location and the cluster location.\n\nLike other HDInsight clusters, HBase cluster requires an Azure Storage account and a Blob storage container as the default file system. The storage account location must match the virtual network location and the cluster location. For more information, see [Use Azure Blob storage with Hadoop in HDInsight][hdinsight-storage]. When you provision an HBase cluster, you have the options to create new or use existing ones. This procedure shows you how to create a storage account and a Blob storage container using the Azure portal.\n\n1. Sign in to the [Azure portal][azure-portal].\n2. Click **NEW** in the lower-left corner, point to **DATA SERVICES**, point to **STORAGE**, and then click **QUICK CREATE**.\n\n3. Type or select the following values:\n\n    - **URL** - The name of the Storage account.\n    - **LOCATION** - The location of the Storage account. Make sure it matches the virtual network location. Affinity groups are not supported.\n    - **REPLICATION** - For testing purposes, use **Locally Redundant** to reduce the cost.\n\n4. Click **CREATE STORAGE ACCOUNT**. You will see the new Storage account in the storage list.\n5. Wait until the **STATUS** of the new Storage account changes to **Online**.\n6. Click the new Storage account from the list to select it.\n7. Click **MANAGE ACCESS KEYS** from the bottom of the page.\n8. Make a note of the Storage account name and the primary access key (or the secondary access key; either of the keys works). You will need them later in the tutorial.\n9. From the top of the page, click **CONTAINER**.\n10. From the bottom of the page, click **ADD**.\n11. Enter the container name. This container will be used as the default container for the HBase cluster. By default, the default container name matches the cluster name. Keep the **ACCESS** field as **Private**.  \n12. Click the checkmark to create the container.\n\n**To provision an HBase cluster by using the Azure portal**\n\n> [AZURE.NOTE] For information on provisioning a new HBase cluster by using Azure PowerShell, see [Provision an HBase cluster using Azure PowerShell](#powershell).\n\n1. Sign in to the [Azure portal][azure-portal].\n\n2. Click **NEW** in the lower-left corner, point to **DATA SERVICES**, point to **HDINSIGHT**, and then click **CUSTOM CREATE**.\n\n3. Enter a cluster name, select HBase as the cluster type, select the Windows Server 2012 operating system, select the HDInsight version, and then click the right button.\n\n    ![Provide details for the HBase cluster][img-provision-cluster-page1]\n\n\n    > [AZURE.NOTE] For an HBase cluster, Windows Server is the only available OS option.\n\n4. On the **Configure Cluster** page, enter or select the following:\n\n    ![Provide details for the HBase cluster](./media/hdinsight-hbase-provision-vnet/hbasewizard2.png)\n\n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>Data Nodes</td><td>Select the number of data nodes you want to deploy. For testing purposes, create a single-node cluster. <br />The cluster size limit varies for Azure subscriptions. Contact Azure billing support to increase the limit.</td></tr>\n        <tr><td>Region/Virtual Network</td><td><p>Select a region or an Azure virtual network, if you have one already created. For this tutorial, select the network that you created earlier, and then select a corresponding subnet. The default name is <b>Subnet-1</b>.</p></td></tr>\n        <tr><td>Head Node Size</td><td><p>Select a VM size for the head node.</p></td></tr>\n        <tr><td>Data Node Size</td><td><p>Select a VM size for the data nodes.</p></td></tr>\n        <tr><td>Zookeeper Size</td><td><p>Select a VM size for the Zookeeper node.</p></td></tr>\n    </table>\n\n    >[AZURE.NOTE] Based on the choice of VMs, your cost might vary. HDInsight uses all standard-tier VMs for cluster nodes. For information on how VM sizes affect your prices, see <a href=\"http://azure.microsoft.com/pricing/details/hdinsight/\" target=\"_blank\">HDInsight Pricing</a>.\n\n    Click the right button.\n\n5. Enter the Hadoop user name and password to use for this cluster, and then click the right button.\n\n    ![Provide Storage account for Hadoop HDInsight cluster](./media/hdinsight-hbase-provision-vnet/hbasewizard3.png)\n\n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>HTTP User Name</td>\n            <td>Specify the HDInsight cluster user name.</td></tr>\n        <tr><td>HTTP Password/Confirm Password</td>\n            <td>Specify the HDInsight cluster user password.</td></tr>\n        <tr><td>Enable remote desktop for cluster</td>\n            <td>Select this check box to specify a username, password, and expiry date for a remote desktop user that can remote into the cluster nodes, once it is provisioned. You can also enable remote desktop later, after the cluster is provisioned. For instructions, see <a href=\"hdinsight-administer-use-management-portal/#rdp\" target=\"_blank\">Connect to HDInsight clusters using RDP</a>.</td></tr>\n    </table>\n\n6. On the **Storage Account** page, provide the following values:\n\n    ![Provide Storage account for Hadoop HDInsight cluster](./media/hdinsight-hbase-provision-vnet/hbasewizard4.png)\n\n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>Storage Account</td>\n            <td>Specify the Azure Storage account that will be used as the default file system for the HDInsight cluster. You can choose one of the three options:\n            <ul>\n                <li><strong>Use Existing Storage</strong></li>\n                <li><strong>Create New Storage</strong></li>\n                <li><strong>Use Storage From Another Subscription</strong></li>\n            </ul>\n            </td></tr>\n        <tr><td>Account Name</td>\n            <td><ul>\n                <li>If you chose to use existing storage, for <strong>Account Name</strong>, select an existing storage account. The drop-down lists only the Storage accounts located in the same data center where you chose to provision the cluster.</li>\n                <li>If you chose the <strong>Create New Storage</strong> or <strong>Use Storage From Another Subscription</strong> option, you must provide the Storage account name.</li>\n            </ul></td></tr>\n        <tr><td>Account Key</td>\n            <td>If you chose the <strong>Use Storage From Another Subscription</strong> option, specify the account key for that Storage account.</td></tr>\n        <tr><td>Default Container</td>\n            <td><p>Specify the default container on the Storage account that is used as the default file system for the HDInsight cluster. If you chose <strong>Use Existing Storage</strong> for the <strong>Storage Account</strong> field, and there are no existing containers in that account, the container is created by default with the same name as the cluster name. If a container with the name of the cluster already exists, a sequence number will be appended to the container name. For example, mycontainer1, mycontainer2, and so on. However, if the existing Storage account has a container with a name different from the cluster name you specified, you can use that container as well.</p>\n            <p>If you chose to create a new storage or use storage from another Azure subscription, you must specify the default container name.</p>\n        </td></tr>\n        <tr><td>Additional Storage Accounts</td>\n            <td>If required, specify additional Storage accounts for the cluster. HDInsight supports multiple Storage accounts. There is no limit on the additional Storage accounts that can be used by a cluster. However, if you create a cluster by using the Azure portal, you have a limit of seven due to the UI constraints. Each additional Storage account you specify adds an extra <strong>Storage Account</strong> page to the wizard where you can specify the account information. For example, in the screenshot above, no additional storage account is selected, and hence an extra page is not added to the wizard.</td></tr>\n    </table>\n\n    Click the right arrow.\n\n7. On the **Script Actions** page, select the checkmark in the lower-right corner. Do not click the **add script action** button, as this tutorial does not require a customized cluster setup.\n\n    ![Configure Script Action to customize an HDInsight HBase cluster][img-provision-cluster-page5]\n\n    > [AZURE.NOTE] This page can be used to customize the cluster during setup. For more information, see [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md).\n\nTo begin working with your new HBase cluster, you can use the procedures found in [Get started using HBase with Hadoop in HDInsight](../hdinsight-hbase-get-started.md).\n\n##Connect to the HBase cluster provisioned in the virtual network by using HBase Java RPC APIs\n\n1.  Provision an infrastructure as a service (IaaS) virtual machine into the same Azure virtual network and the same subnet. So both the virtual machine and the HBase cluster use the same internal DNS server to resolve host names. To do so, you must choose the **From Gallery** option, and select the virtual network instead of a data center. For instructions, see [Create a Virtual Machine Running Windows Server](../virtual-machines-windows-tutorial.md). A standard Windows Server 2012 image with a small VM size is sufficient.\n\n2.  When using a Java application to connect to HBase remotely, you must use the fully qualified domain name (FQDN). To determine this, you must get the connection-specific DNS suffix of the HBase cluster. To do that, use Curl to query Ambari, or use Remote Desktop to connect to the cluster.\n\n    * **Curl** - Use the following command:\n\n            curl -u <username>:<password> -k https://<clustername>.azurehdinsight.net/ambari/api/v1/clusters/<clustername>.azurehdinsight.net/services/hbase/components/hbrest\n\n        In the JavaScript Object Notation (JSON) data returned, find the \"host_name\" entry. This will contain the FQDN for the nodes in the cluster. For example:\n\n            ...\n            \"host_name\": \"wordkernode0.<clustername>.b1.cloudapp.net\n            ...\n\n        The portion of the domain name beginning with the cluster name is the DNS suffix. For example, mycluster.b1.cloudapp.net.\n\n    * **Azure PowerShell** - Use the following Azure PowerShell script to register the **Get-ClusterDetail** function, which can be used to return the DNS suffix:\n\n            function Get-ClusterDetail(\n                [String]\n                [Parameter( Position=0, Mandatory=$true )]\n                $ClusterDnsName,\n                [String]\n                [Parameter( Position=1, Mandatory=$true )]\n                $Username,\n                [String]\n                [Parameter( Position=2, Mandatory=$true )]\n                $Password,\n                [String]\n                [Parameter( Position=3, Mandatory=$true )]\n                $PropertyName\n                )\n            {\n            <#\n                .SYNOPSIS\n                 Displays information to facilitate an HDInsight cluster-to-cluster scenario within the same virtual network.\n                .Description\n                 This command shows the following 4 properties of an HDInsight cluster:\n                 1. ZookeeperQuorum (supports only HBase type cluster)\n                    Shows the value of HBase property \"hbase.zookeeper.quorum\".\n                 2. ZookeeperClientPort (supports only HBase type cluster)\n                    Shows the value of HBase property \"hbase.zookeeper.property.clientPort\".\n                 3. HBaseRestServers (supports only HBase type cluster)\n                    Shows a list of host FQDNs that run the HBase REST server.\n                 4. FQDNSuffix (supports all cluster types)\n                    Shows the FQDN suffix of hosts in the cluster.\n                .EXAMPLE\n                 Get-ClusterDetail -ClusterDnsName {clusterDnsName} -Username {username} -Password {password} -PropertyName ZookeeperQuorum\n                 This command shows the value of HBase property \"hbase.zookeeper.quorum\".\n                .EXAMPLE\n                 Get-ClusterDetail -ClusterDnsName {clusterDnsName} -Username {username} -Password {password} -PropertyName ZookeeperClientPort\n                 This command shows the value of HBase property \"hbase.zookeeper.property.clientPort\".\n                .EXAMPLE\n                 Get-ClusterDetail -ClusterDnsName {clusterDnsName} -Username {username} -Password {password} -PropertyName HBaseRestServers\n                 This command shows a list of host FQDNs that run the HBase REST server.\n                .EXAMPLE\n                 Get-ClusterDetail -ClusterDnsName {clusterDnsName} -Username {username} -Password {password} -PropertyName FQDNSuffix\n                 This command shows the FQDN suffix of hosts in the cluster.\n            #>\n\n                $DnsSuffix = \".azurehdinsight.net\"\n\n                $ClusterFQDN = $ClusterDnsName + $DnsSuffix\n                $webclient = new-object System.Net.WebClient\n                $webclient.Credentials = new-object System.Net.NetworkCredential($Username, $Password)\n\n                if($PropertyName -eq \"ZookeeperQuorum\")\n                {\n                    $Url = \"https://\" + $ClusterFQDN + \"/ambari/api/v1/clusters/\" + $ClusterFQDN + \"/configurations?type=hbase-site&tag=default&fields=items/properties/hbase.zookeeper.quorum\"\n                    $Response = $webclient.DownloadString($Url)\n                    $JsonObject = $Response | ConvertFrom-Json\n                    Write-host $JsonObject.items[0].properties.'hbase.zookeeper.quorum'\n                }\n                if($PropertyName -eq \"ZookeeperClientPort\")\n                {\n                    $Url = \"https://\" + $ClusterFQDN + \"/ambari/api/v1/clusters/\" + $ClusterFQDN + \"/configurations?type=hbase-site&tag=default&fields=items/properties/hbase.zookeeper.property.clientPort\"\n                    $Response = $webclient.DownloadString($Url)\n                    $JsonObject = $Response | ConvertFrom-Json\n                    Write-host $JsonObject.items[0].properties.'hbase.zookeeper.property.clientPort'\n                }\n                if($PropertyName -eq \"HBaseRestServers\")\n                {\n                    $Url1 = \"https://\" + $ClusterFQDN + \"/ambari/api/v1/clusters/\" + $ClusterFQDN + \"/configurations?type=hbase-site&tag=default&fields=items/properties/hbase.rest.port\"\n                    $Response1 = $webclient.DownloadString($Url1)\n                    $JsonObject1 = $Response1 | ConvertFrom-Json\n                    $PortNumber = $JsonObject1.items[0].properties.'hbase.rest.port'\n\n                    $Url2 = \"https://\" + $ClusterFQDN + \"/ambari/api/v1/clusters/\" + $ClusterFQDN + \"/services/hbase/components/hbrest\"\n                    $Response2 = $webclient.DownloadString($Url2)\n                    $JsonObject2 = $Response2 | ConvertFrom-Json\n                    foreach ($host_component in $JsonObject2.host_components)\n                    {\n                        $ConnectionString = $host_component.HostRoles.host_name + \":\" + $PortNumber\n                        Write-host $ConnectionString\n                    }\n                }\n                if($PropertyName -eq \"FQDNSuffix\")\n                {\n                    $Url = \"https://\" + $ClusterFQDN + \"/ambari/api/v1/clusters/\" + $ClusterFQDN + \"/services/yarn/components/resourcemanager\"\n                    $Response = $webclient.DownloadString($Url)\n                    $JsonObject = $Response | ConvertFrom-Json\n                    $FQDN = $JsonObject.host_components[0].HostRoles.host_name\n                    $pos = $FQDN.IndexOf(\".\")\n                    $Suffix = $FQDN.Substring($pos + 1)\n                    Write-host $Suffix\n                }\n            }\n\n        After running the Azure PowerShell script, use the following command to return the DNS suffix by using the **Get-ClusterDetail** function. Specify your HDInsight HBase cluster name, admin name, and admin password when using this command.\n\n            Get-ClusterDetail -ClusterDnsName <yourclustername> -PropertyName FQDNSuffix -Username <clusteradmin> -Password <clusteradminpassword>\n\n        This will return the DNS suffix. For example, **yourclustername.b4.internal.cloudapp.net**.\n\n    > [AZURE.NOTE] You can also use Remote Desktop to connect to the HBase cluster (you will be connected to the head node) and run **ipconfig** from a command prompt to obtain the DNS suffix. For instructions on enabling Remote Desktop Protocol (RDP) and connecting to the cluster by using RDP, see [Manage Hadoop clusters in HDInsight using the Azure portal][hdinsight-admin-portal].\n    >\n    > ![hdinsight.hbase.dns.surffix][img-dns-surffix]\n\n\n<!--\n3.  Change the primary DNS suffix configuration of the virtual machine. This enables the virtual machine to automatically resolve the host name of the HBase cluster without explicit specification of the suffix. For example, the *workernode0* host name will be correctly resolved to workernode0 of the HBase cluster.\n\n    To make the configuration change:\n\n    1. RDP into the virtual machine.\n    2. Open **Local Group Policy Editor**. The executable is gpedit.msc.\n    3. Expand **Computer Configuration**, expand **Administrative Templates**, expand **Network**, and then click **DNS Client**.\n    - Set **Primary DNS Suffix** to the value obtained in step 2:\n\n        ![hdinsight.hbase.primary.dns.suffix][img-primary-dns-suffix]\n    4. Click **OK**.\n    5. Reboot the virtual machine.\n-->\n\nTo verify that the virtual machine can communicate with the HBase cluster, use the command `ping headnode0.<dns suffix>` from the virtual machine. For example, ping headnode0.mycluster.b1.cloudapp.net.\n\nTo use this information in a Java application, you can follow the steps in [Use Maven to build Java applications that use HBase with HDInsight (Hadoop)](hdinsight-hbase-build-java-maven.md) to create an application. To have the application connect to a remote HBase server, modify the **hbase-site.xml** file in this example to use the FQDN for Zookeeper. For example:\n\n    <property>\n        <name>hbase.zookeeper.quorum</name>\n        <value>zookeeper0.<dns suffix>,zookeeper1.<dns suffix>,zookeeper2.<dns suffix></value>\n    </property>\n\n> [AZURE.NOTE] For more information on name resolution in Azure virtual networks, including how to use your own DNS server, see [Name Resolution (DNS)](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md).\n\n##Provision an HBase cluster by using Azure PowerShell\n\n**To provision an HBase cluster by using Azure PowerShell**\n\n1. Open the Azure PowerShell Integrated Scripting Environment (ISE).\n2. Copy and paste the following into the script pane:\n\n        $hbaseClusterName = \"<HBaseClusterName>\"\n        $hadoopUserName = \"<HBaseClusterUsername>\"\n        $hadoopUserPassword = \"<HBaseClusterUserPassword>\"\n        $location = \"<HBaseClusterLocation>\"  #i.e. \"West US\"\n        $clusterSize = <HBaseClusterSize>  \n        $vnetID = \"<AzureVirtualNetworkID>\"\n        $subNetName = \"<AzureVirtualNetworkSubNetName>\"\n        $storageAccountName = \"<AzureStorageAccountName>\" # Do not use the full name here\n        $storageAccountKey = \"<AzureStorageAccountKey>\"\n        $storageContainerName = \"<AzureBlobStorageContainer>\"\n\n        $password = ConvertTo-SecureString $hadoopUserPassword -AsPlainText -Force\n        $creds = New-Object System.Management.Automation.PSCredential ($hadoopUserName, $password)\n\n        New-AzureHDInsightCluster -Name $hbaseClusterName `\n                                  -ClusterType HBase `\n                                  -Version 3.1 `\n                                  -Location $location `\n                                  -ClusterSizeInNodes $clusterSize `\n                                  -Credential $creds `\n                                  -VirtualNetworkId $vnetID `\n                                  -SubnetName $subNetName `\n                                  -DefaultStorageAccountName \"$storageAccountName.blob.core.windows.net\" `\n                                  -DefaultStorageAccountKey $storageAccountKey `\n                                  -DefaultStorageContainerName $storageContainerName\n\n\n3. Click **Run Script**, or press **F5**.\n4. To validate the cluster, you can either check the cluster from the Azure portal, or run the following Azure PowerShell cmdlet from the bottom pane:\n\n    Get-AzureHDInsightCluster\n\n##Next steps\n\nIn this tutorial you learned how to provision an HBase cluster. To learn more, see:\n\n- [Get started with HDInsight](../hdinsight-get-started.md)\n- [Configure HBase replication in HDInsight](hdinsight-hbase-geo-replication.md)\n- [Provision Hadoop clusters in HDInsight](hdinsight-provision-clusters.md)\n- [Get started using HBase with Hadoop in HDInsight](../hdinsight-hbase-get-started.md)\n- [Analyze Twitter sentiment with HBase in HDInsight](../hdinsight-hbase-twitter-sentiment.md)\n- [Virtual Network Overview][vnet-overview]\n\n\n[1]: http://azure.microsoft.com/services/virtual-network/\n[2]: http://technet.microsoft.com/library/ee176961.aspx\n[3]: http://technet.microsoft.com/library/hh847889.aspx\n\n[hbase-get-started]: ../hdinsight-hbase-get-started.md\n[hbase-twitter-sentiment]: ../hdinsight-hbase-twitter-sentiment.md\n[vnet-overview]: ../virtual-network/virtual-networks-overview.md\n[vm-create]: ../virtual-machines-windows-tutorial.md\n\n[azure-portal]: https://management.windowsazure.com\n[azure-create-storageaccount]: ../storage-create-storage-account.md\n[azure-purchase-options]: http://azure.microsoft.com/pricing/purchase-options/\n[azure-member-offers]: http://azure.microsoft.com/pricing/member-offers/\n[azure-free-trial]: http://azure.microsoft.com/pricing/free-trial/\n\n[hdinsight-admin-powershell]: hdinsight-administer-use-powershell.md\n[hdinsight-admin-portal]: hdinsight-administer-use-management-portal.md#rdp\n\n[hdinsight-powershell-reference]: https://msdn.microsoft.com/library/dn858087.aspx\n\n\n[twitter-streaming-api]: https://dev.twitter.com/docs/streaming-apis\n[twitter-statuses-filter]: https://dev.twitter.com/docs/api/1.1/post/statuses/filter\n\n\n[powershell-install]: ../install-configure-powershell.md\n\n\n[hdinsight-customize-cluster]: hdinsight-hadoop-customize-cluster.md\n[hdinsight-provision]: hdinsight-provision-clusters.md\n[hdinsight-get-started]: ../hdinsight-get-started.md\n[hdinsight-storage-powershell]: ../hdinsight-use-blob-storage.md#powershell\n[hdinsight-analyze-flight-delay-data]: hdinsight-analyze-flight-delay-data.md\n[hdinsight-storage]: ../hdinsight-use-blob-storage.md\n[hdinsight-use-sqoop]: hdinsight-use-sqoop.md\n[hdinsight-power-query]: hdinsight-connect-excel-power-query.md\n[hdinsight-hive-odbc]: hdinsight-connect-excel-hive-ODBC-driver.md\n[hdinsight-hbase-replication-dns]: hdinsight-hbase-geo-replication-configure-DNS.md\n\n[img-dns-surffix]: ./media/hdinsight-hbase-provision-vnet/DNSSuffix.png\n[img-primary-dns-suffix]: ./media/hdinsight-hbase-provision-vnet/PrimaryDNSSuffix.png\n[img-provision-cluster-page1]: ./media/hdinsight-hbase-provision-vnet/hbasewizard1.png \"Provision details for the new HBase cluster\"\n[img-provision-cluster-page5]: ./media/hdinsight-hbase-provision-vnet/hbasewizard5.png \"Use Script Action to customize an HBase cluster\"\n\ntest\n"
}