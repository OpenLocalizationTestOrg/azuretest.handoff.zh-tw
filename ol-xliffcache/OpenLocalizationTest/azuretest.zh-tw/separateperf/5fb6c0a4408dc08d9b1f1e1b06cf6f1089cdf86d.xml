{
  "nodes": [
    {
      "content": "How to: Configure Firewall Settings | Microsoft Azure",
      "pos": [
        27,
        80
      ]
    },
    {
      "content": "Configure the firewall for IP addresses that access Azure SQL databases.",
      "pos": [
        99,
        171
      ]
    },
    {
      "content": "How to: Configure firewall settings on SQL Database",
      "pos": [
        485,
        536
      ]
    },
    {
      "content": "Microsoft Azure SQL Database uses firewall rules to allow connections to your servers and databases.",
      "pos": [
        539,
        639
      ]
    },
    {
      "content": "You can define server-level and database-level firewall settings for the master or a user database in your Azure SQL Database server to selectively allow access to the database.",
      "pos": [
        640,
        817
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  To allow applications from Azure to connect to your database server, Azure connections must be enabled.",
      "pos": [
        819,
        937
      ]
    },
    {
      "content": "For more information about firewall rules and enabling connections from Azure, see <bpt id=\"p1\">[</bpt>Azure SQL Database Firewall<ept id=\"p1\">](sql-database-firewall-configure.md)</ept>",
      "pos": [
        938,
        1086
      ]
    },
    {
      "content": "Server-Level Firewall Rules",
      "pos": [
        1092,
        1119
      ]
    },
    {
      "content": "Server-level firewall rules can be created and managed through the Microsoft Azure Management Portal, Transact-SQL, Azure PowerShell, or REST API.",
      "pos": [
        1121,
        1267
      ]
    },
    {
      "content": "Manage Server-Level Firewall Rules through the New Azure Portal",
      "pos": [
        1273,
        1336
      ]
    },
    {
      "content": "Visit the Azure Portal at https://portal.azure.com and sign-in with your Azure Administrator or Contributor account.",
      "pos": [
        1340,
        1456
      ]
    },
    {
      "content": "On the left banner, click BROWSE ALL, scroll down, and then click SQL servers.",
      "pos": [
        1460,
        1538
      ]
    },
    {
      "content": "Click the server that you want to configure firewall rules for in the list of SQL Server displayed.",
      "pos": [
        1542,
        1641
      ]
    },
    {
      "content": "![firewall][1]",
      "pos": [
        1647,
        1661
      ]
    },
    {
      "content": "In the server blade, click Settings at the top of the blade, and then click Firewall to open the Firewall Settings blade for the server.",
      "pos": [
        1666,
        1802
      ]
    },
    {
      "content": "Add or change a firewall rule.",
      "pos": [
        1806,
        1836
      ]
    },
    {
      "pos": [
        1844,
        1939
      ],
      "content": "To add the IP address of the current computer, click <bpt id=\"p1\">**</bpt>Add Client IP<ept id=\"p1\">**</ept> at the top of the blade."
    },
    {
      "pos": [
        1946,
        2050
      ],
      "content": "To add additional IP addresses, type in the <bpt id=\"p1\">**</bpt>RULE NAME<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>START IP<ept id=\"p2\">**</ept> address, and <bpt id=\"p3\">**</bpt>END IP<ept id=\"p3\">**</ept> address."
    },
    {
      "content": "To modify an existing rule, click and change any of the fields in the rule.",
      "pos": [
        2057,
        2132
      ]
    },
    {
      "pos": [
        2139,
        2255
      ],
      "content": "To delete an existing rule, click the rule, click the ellipsis (…) at the end of the row, and then click <bpt id=\"p1\">**</bpt>Delete<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        2259,
        2357
      ],
      "content": "Click Save at the top of the Firewall Settings blade to save the changes.\n ![firewall blade][2]",
      "leadings": [
        "",
        "   "
      ],
      "nodes": [
        {
          "content": "Click Save at the top of the Firewall Settings blade to save the changes.",
          "pos": [
            0,
            73
          ]
        },
        {
          "content": "![firewall blade][2]",
          "pos": [
            75,
            95
          ]
        }
      ]
    },
    {
      "content": "Manage Server-Level Firewall Rules through Management Portal",
      "pos": [
        2363,
        2423
      ]
    },
    {
      "content": "From the Management Portal, click <bpt id=\"p1\">**</bpt>SQL Databases<ept id=\"p1\">**</ept>.",
      "pos": [
        2429,
        2481
      ]
    },
    {
      "content": "All databases and their corresponding servers are listed here.",
      "pos": [
        2482,
        2544
      ]
    },
    {
      "pos": [
        2548,
        2589
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept> at the top of the page."
    },
    {
      "content": "Click the arrow beside the server for which you want to manage firewall rules.",
      "pos": [
        2593,
        2671
      ]
    },
    {
      "pos": [
        2675,
        2718
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Configure<ept id=\"p1\">**</ept> at the top of the page."
    },
    {
      "content": "To add the current computer, click Add to the Allowed IP Addresses.",
      "pos": [
        2727,
        2794
      ]
    },
    {
      "content": "To add additional IP addresses, type in the Rule Name, Start IP Address, and End IP Address.",
      "pos": [
        2802,
        2894
      ]
    },
    {
      "content": "To modify an existing rule, click any of the fields in the rule and modify.",
      "pos": [
        2902,
        2977
      ]
    },
    {
      "content": "To delete an existing rule, hover over the rule until the X appears at the end of the row.",
      "pos": [
        2985,
        3075
      ]
    },
    {
      "content": "Click X to remove the rule.",
      "pos": [
        3076,
        3103
      ]
    },
    {
      "pos": [
        3107,
        3168
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> at the bottom of the page to save the changes."
    },
    {
      "content": "Manage Server-Level Firewall Rules through Transact-SQL",
      "pos": [
        3173,
        3228
      ]
    },
    {
      "content": "Launch a query window through the Management Portal or through SQL Server Management Studio.",
      "pos": [
        3233,
        3325
      ]
    },
    {
      "content": "Verify you are connected to the master database.",
      "pos": [
        3329,
        3377
      ]
    },
    {
      "content": "Server-level firewall rules can be selected, created, updated, or deleted from within the query window.",
      "pos": [
        3381,
        3484
      ]
    },
    {
      "content": "To create or update server-level firewall rules, execute the sp_set_firewall rule stored procedure.",
      "pos": [
        3488,
        3587
      ]
    },
    {
      "content": "The following example enables a range of IP addresses on the server Contoso.",
      "pos": [
        3588,
        3664
      ]
    },
    {
      "content": "Start by seeing what rules already exist.",
      "pos": [
        3669,
        3710
      ]
    },
    {
      "content": "Next, add a firewall rule.",
      "pos": [
        3782,
        3808
      ]
    },
    {
      "content": "To delete a server-level firewall rule, execute the sp_delete_firewall_rule stored procedure.",
      "pos": [
        3964,
        4057
      ]
    },
    {
      "content": "The following example deletes the rule named ContosoFirewallRule.",
      "pos": [
        4058,
        4123
      ]
    },
    {
      "content": "Manage Server-Level Firewall Rules through Azure PowerShell",
      "pos": [
        4202,
        4261
      ]
    },
    {
      "content": "Launch Azure PowerShell.",
      "pos": [
        4265,
        4289
      ]
    },
    {
      "content": "Server-level firewall rules can be created, updated, and deleted using Azure PowerShell.",
      "pos": [
        4293,
        4381
      ]
    },
    {
      "content": "To create a new server-level firewall rule, execute the New-AzureSqlDatabaseServerFirewallRule cmdlet.",
      "pos": [
        4388,
        4490
      ]
    },
    {
      "content": "The following example enables a range of IP addresses on the server Contoso.",
      "pos": [
        4491,
        4567
      ]
    },
    {
      "content": "To modify an existing server-level firewall rule, execute the Set-AzureSqlDatabaseServerFirewallRule cmdlet.",
      "pos": [
        4728,
        4836
      ]
    },
    {
      "content": "The following example changes the range of acceptable IP addresses for the rule named ContosoFirewallRule.",
      "pos": [
        4837,
        4943
      ]
    },
    {
      "content": "To delete an existing server-level firewall rule, execute the Remove-AzureSqlDatabaseServerFirewallRule cmdlet.",
      "pos": [
        5103,
        5214
      ]
    },
    {
      "content": "The following example deletes the rule named ContosoFirewallRule.",
      "pos": [
        5215,
        5280
      ]
    },
    {
      "content": "Manage Server-Level Firewall Rules through REST API",
      "pos": [
        5387,
        5438
      ]
    },
    {
      "content": "Managing firewall rules through REST API must be authenticated.",
      "pos": [
        5442,
        5505
      ]
    },
    {
      "content": "For information, see Authenticating Service Management Requests.",
      "pos": [
        5506,
        5570
      ]
    },
    {
      "content": "Server-level rules can be created, updated, or deleted using REST API",
      "pos": [
        5574,
        5643
      ]
    },
    {
      "content": "To create or update a server-level firewall rule, execute the POST method using the following:",
      "pos": [
        5649,
        5743
      ]
    },
    {
      "content": "Request Body",
      "pos": [
        5871,
        5883
      ]
    },
    {
      "content": "To remove an existing server-level firewall rule, execute the DELETE method using the following:",
      "pos": [
        6145,
        6241
      ]
    },
    {
      "content": "Database-Level Firewall Rules",
      "pos": [
        6389,
        6418
      ]
    },
    {
      "content": "After creating a server-level firewall for your IP address, launch a query window through the Management Portal or through SQL Server Management Studio.",
      "pos": [
        6423,
        6575
      ]
    },
    {
      "content": "Connect to the database for which you want to create a database-level firewall rule.",
      "pos": [
        6579,
        6663
      ]
    },
    {
      "content": "To create a new or update an existing database-level firewall rule, execute the sp_set_database_firewall_rule stored procedure.",
      "pos": [
        6669,
        6796
      ]
    },
    {
      "content": "The following example creates a new firewall rule named ContosoFirewallRule.",
      "pos": [
        6797,
        6873
      ]
    },
    {
      "content": "To delete an existing database-level firewall rule, execute the sp_delete_database_firewall_rule stored procedure.",
      "pos": [
        7026,
        7140
      ]
    },
    {
      "content": "The following example deletes the rule named ContosoFirewallRule.",
      "pos": [
        7141,
        7206
      ]
    },
    {
      "content": "Manage firewall rules using the Service Management REST API",
      "pos": [
        7291,
        7350
      ]
    },
    {
      "content": "Create Firewall Rule",
      "pos": [
        7355,
        7375
      ]
    },
    {
      "content": "Delete Firewall Rule",
      "pos": [
        7436,
        7456
      ]
    },
    {
      "content": "Get Firewall Rule",
      "pos": [
        7517,
        7534
      ]
    },
    {
      "content": "List Firewall Rules",
      "pos": [
        7595,
        7614
      ]
    },
    {
      "content": "Manage firewall rules using PowerShell",
      "pos": [
        7676,
        7714
      ]
    },
    {
      "content": "New-AzureSqlDatabaseServerFirewallRule",
      "pos": [
        7719,
        7757
      ]
    },
    {
      "content": "Remove-AzureSqlDatabaseServerFirewallRule",
      "pos": [
        7818,
        7859
      ]
    },
    {
      "content": "Set-AzureSqlDatabaseServerFirewallRule",
      "pos": [
        7920,
        7958
      ]
    },
    {
      "content": "Get-AzureSqlDatabaseServerFirewallRule",
      "pos": [
        8019,
        8057
      ]
    },
    {
      "content": "Next steps",
      "pos": [
        8120,
        8130
      ]
    },
    {
      "content": "For a tutorial on creating a database, see <bpt id=\"p1\">[</bpt>Create your first Azure SQL Database<ept id=\"p1\">](sql-database-get-started.md)</ept>.",
      "pos": [
        8132,
        8243
      ]
    },
    {
      "content": "For help in connecting to an Azure SQL database from open source or third-party applications, see <bpt id=\"p1\">[</bpt>Guidelines for Connecting to Azure SQL Database Programmatically<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/ee336282.aspx)</ept>.",
      "pos": [
        8244,
        8465
      ]
    },
    {
      "content": "To understand how to navigate to databases see <bpt id=\"p1\">[</bpt>Managing Databases and Logins in Azure SQL Database<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/ee336235.aspx)</ept>.",
      "pos": [
        8466,
        8623
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"How to: Configure Firewall Settings | Microsoft Azure\"\n    description=\"Configure the firewall for IP addresses that access Azure SQL databases.\"\n    services=\"sql-database\"\n    documentationCenter=\"\"\n    authors=\"BYHAM\"\n    manager=\"jeffreyg\"\n    editor=\"\"/>\n\n\n<tags\n    ms.service=\"sql-database\"\n    ms.workload=\"data-management\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"dotnet\"\n    ms.topic=\"article\" \n    ms.date=\"09/02/2015\"\n    ms.author=\"rickbyh\"/>\n\n\n# How to: Configure firewall settings on SQL Database\n\n Microsoft Azure SQL Database uses firewall rules to allow connections to your servers and databases. You can define server-level and database-level firewall settings for the master or a user database in your Azure SQL Database server to selectively allow access to the database.\n\n**Important**  To allow applications from Azure to connect to your database server, Azure connections must be enabled. For more information about firewall rules and enabling connections from Azure, see [Azure SQL Database Firewall](sql-database-firewall-configure.md)\n\n\n## Server-Level Firewall Rules\n\nServer-level firewall rules can be created and managed through the Microsoft Azure Management Portal, Transact-SQL, Azure PowerShell, or REST API.\n\n### Manage Server-Level Firewall Rules through the New Azure Portal\n1. Visit the Azure Portal at https://portal.azure.com and sign-in with your Azure Administrator or Contributor account.\n2. On the left banner, click BROWSE ALL, scroll down, and then click SQL servers.\n3. Click the server that you want to configure firewall rules for in the list of SQL Server displayed.\n\n    ![firewall][1]\n\n4. In the server blade, click Settings at the top of the blade, and then click Firewall to open the Firewall Settings blade for the server.\n5. Add or change a firewall rule.\n\n    * To add the IP address of the current computer, click **Add Client IP** at the top of the blade.\n    * To add additional IP addresses, type in the **RULE NAME**, **START IP** address, and **END IP** address.\n    * To modify an existing rule, click and change any of the fields in the rule.\n    * To delete an existing rule, click the rule, click the ellipsis (…) at the end of the row, and then click **Delete**.\n6. Click Save at the top of the Firewall Settings blade to save the changes.\n    ![firewall blade][2] \n\n## Manage Server-Level Firewall Rules through Management Portal \n\n1. From the Management Portal, click **SQL Databases**. All databases and their corresponding servers are listed here.\n2. Click **Servers** at the top of the page.\n3. Click the arrow beside the server for which you want to manage firewall rules.\n4. Click **Configure** at the top of the page.\n\n    *  To add the current computer, click Add to the Allowed IP Addresses.\n    *  To add additional IP addresses, type in the Rule Name, Start IP Address, and End IP Address.\n    *  To modify an existing rule, click any of the fields in the rule and modify.\n    *  To delete an existing rule, hover over the rule until the X appears at the end of the row. Click X to remove the rule.\n5. Click **Save** at the bottom of the page to save the changes.\n\n## Manage Server-Level Firewall Rules through Transact-SQL\n\n1. Launch a query window through the Management Portal or through SQL Server Management Studio.\n2. Verify you are connected to the master database.\n3. Server-level firewall rules can be selected, created, updated, or deleted from within the query window.\n4. To create or update server-level firewall rules, execute the sp_set_firewall rule stored procedure. The following example enables a range of IP addresses on the server Contoso.<br/>Start by seeing what rules already exist.\n\n        SELECT * FROM sys.database_firewall_rules ORDER BY name;\n\n    Next, add a firewall rule.\n\n        EXECUTE sp_set_firewall_rule @name = N'ContosoFirewallRule',\n            @start_ip_address = '192.168.1.1', @end_ip_address = '192.168.1.10'\n\n    To delete a server-level firewall rule, execute the sp_delete_firewall_rule stored procedure. The following example deletes the rule named ContosoFirewallRule.\n \n        EXECUTE sp_delete_firewall_rule @name = N'ContosoFirewallRule'\n \n## Manage Server-Level Firewall Rules through Azure PowerShell\n1. Launch Azure PowerShell.\n2. Server-level firewall rules can be created, updated, and deleted using Azure PowerShell. \n\n    To create a new server-level firewall rule, execute the New-AzureSqlDatabaseServerFirewallRule cmdlet. The following example enables a range of IP addresses on the server Contoso.\n \n        New-AzureSqlDatabaseServerFirewallRule –StartIPAddress 192.168.1.1 –EndIPAddress 192.168.1.10 –RuleName ContosoFirewallRule –ServerName Contoso\n \n    To modify an existing server-level firewall rule, execute the Set-AzureSqlDatabaseServerFirewallRule cmdlet. The following example changes the range of acceptable IP addresses for the rule named ContosoFirewallRule.\n \n        Set-AzureSqlDatabaseServerFirewallRule –StartIPAddress 192.168.1.4 –EndIPAddress 192.168.1.10 –RuleName ContosoFirewallRule –ServerName Contoso\n\n    To delete an existing server-level firewall rule, execute the Remove-AzureSqlDatabaseServerFirewallRule cmdlet. The following example deletes the rule named ContosoFirewallRule.\n\n        Remove-AzureSqlDatabaseServerFirewallRule –RuleName ContosoFirewallRule –ServerName Contoso\n \n## Manage Server-Level Firewall Rules through REST API\n1. Managing firewall rules through REST API must be authenticated. For information, see Authenticating Service Management Requests.\n2. Server-level rules can be created, updated, or deleted using REST API\n\n    To create or update a server-level firewall rule, execute the POST method using the following:\n \n        https://management.core.windows.net:8443/{subscriptionId}/services/sqlservers/servers/Contoso/firewallrules\n    \n    Request Body\n\n        <ServiceResource xmlns=\"http://schemas.microsoft.com/windowsazure\">\n          <Name>ContosoFirewallRule</Name>\n          <StartIPAddress>192.168.1.4</StartIPAddress>\n          <EndIPAddress>192.168.1.10</EndIPAddress>\n        </ServiceResource>\n \n\n    To remove an existing server-level firewall rule, execute the DELETE method using the following:\n     \n        https://management.core.windows.net:8443/{subscriptionId}/services/sqlservers/servers/Contoso/firewallrules/ContosoFirewallRule\n \n## Database-Level Firewall Rules\n\n1. After creating a server-level firewall for your IP address, launch a query window through the Management Portal or through SQL Server Management Studio.\n2. Connect to the database for which you want to create a database-level firewall rule.\n\n    To create a new or update an existing database-level firewall rule, execute the sp_set_database_firewall_rule stored procedure. The following example creates a new firewall rule named ContosoFirewallRule.\n \n        EXEC sp_set_database_firewall_rule @name = N'ContosoFirewallRule', @start_ip_address = '192.168.1.11', @end_ip_address = '192.168.1.11'\n \n    To delete an existing database-level firewall rule, execute the sp_delete_database_firewall_rule stored procedure. The following example deletes the rule named ContosoFirewallRule.\n \n        EXEC sp_delete_database_firewall_rule @name = N'ContosoFirewallRule'\n\n\n## Manage firewall rules using the Service Management REST API\n\n* [Create Firewall Rule](https://msdn.microsoft.com/library/azure/dn505712.aspx)\n* [Delete Firewall Rule](https://msdn.microsoft.com/library/azure/dn505706.aspx)\n* [Get Firewall Rule](https://msdn.microsoft.com/library/azure/dn505698.aspx)\n* [List Firewall Rules](https://msdn.microsoft.com/library/azure/dn505715.aspx)\n\n## Manage firewall rules using PowerShell\n\n* [New-AzureSqlDatabaseServerFirewallRule](https://msdn.microsoft.com/library/azure/dn546724.aspx)\n* [Remove-AzureSqlDatabaseServerFirewallRule](https://msdn.microsoft.com/library/azure/dn546727.aspx)\n* [Set-AzureSqlDatabaseServerFirewallRule](https://msdn.microsoft.com/library/azure/dn546739.aspx)\n* [Get-AzureSqlDatabaseServerFirewallRule](https://msdn.microsoft.com/library/azure/dn546731.aspx)\n \n## Next steps\n\nFor a tutorial on creating a database, see [Create your first Azure SQL Database](sql-database-get-started.md).\nFor help in connecting to an Azure SQL database from open source or third-party applications, see [Guidelines for Connecting to Azure SQL Database Programmatically](https://msdn.microsoft.com/library/azure/ee336282.aspx).\nTo understand how to navigate to databases see [Managing Databases and Logins in Azure SQL Database](https://msdn.microsoft.com/library/azure/ee336235.aspx).\n\n<!--Image references-->\n[1]: ./media/sql-database-configure-firewall-settings/AzurePortalBrowseForFirewall.png\n[2]: ./media/sql-database-configure-firewall-settings/AzurePortalFirewallSettings.png\n<!--anchors-->\n\n \n"
}