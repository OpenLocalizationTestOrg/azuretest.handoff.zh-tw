{
  "nodes": [
    {
      "content": "Configuring a Virtual Network for Expressroute | Microsoft Azure",
      "pos": [
        26,
        90
      ]
    },
    {
      "content": "This article walks you through setting up a virtual network (VNet) for ExpressRoute",
      "pos": [
        108,
        191
      ]
    },
    {
      "content": "Configure a Virtual Network for ExpressRoute",
      "pos": [
        509,
        553
      ]
    },
    {
      "content": "These steps will walk you through configuring a virtual network and a gateway for ExpressRoute.",
      "pos": [
        555,
        650
      ]
    },
    {
      "pos": [
        655,
        691
      ],
      "content": "Log in to the <bpt id=\"p1\">**</bpt>Management Portal<ept id=\"p1\">**</ept>."
    },
    {
      "content": "In the lower left-hand corner of the screen, click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept>.",
      "pos": [
        695,
        754
      ]
    },
    {
      "content": "In the navigation pane, click <bpt id=\"p1\">**</bpt>Network Services<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Virtual Network<ept id=\"p2\">**</ept>.",
      "pos": [
        755,
        842
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>Custom Create<ept id=\"p1\">**</ept> to begin the configuration wizard.",
      "pos": [
        843,
        901
      ]
    },
    {
      "pos": [
        905,
        974
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Virtual Network Details<ept id=\"p1\">**</ept> page, enter the information below."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> – Name your virtual network.",
      "pos": [
        982,
        1019
      ]
    },
    {
      "content": "You’ll use this virtual network name when you deploy your VMs and PaaS instances, so you may not want to make the name too complicated.",
      "pos": [
        1020,
        1155
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> – The location is directly related to the physical location (region) where you want your resources (VMs) to reside.",
      "pos": [
        1162,
        1290
      ]
    },
    {
      "content": "For example, if you want the VMs that you deploy to this virtual network to be physically located in East US, select that location.",
      "pos": [
        1291,
        1422
      ]
    },
    {
      "content": "You can’t change the region associated with your virtual network after you create it.",
      "pos": [
        1423,
        1508
      ]
    },
    {
      "pos": [
        1513,
        1645
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>DNS Servers and VPN Connectivity<ept id=\"p1\">**</ept> page, enter the following information, and then click the next arrow on the lower right."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>DNS Servers<ept id=\"p1\">**</ept> - Enter the DNS server name and IP address, or select a previously registered DNS server from the dropdown.",
      "pos": [
        1654,
        1777
      ]
    },
    {
      "content": "This setting does not create a DNS server, it allows you to specify the DNS servers that you want to use for name resolution for this virtual network.",
      "pos": [
        1778,
        1928
      ]
    },
    {
      "pos": [
        1935,
        2025
      ],
      "content": "<bpt id=\"p1\">**</bpt>Configure Site-To-Site VPN<ept id=\"p1\">**</ept> - Select the checkbox for <bpt id=\"p2\">**</bpt>Configure a site-to-site VPN<ept id=\"p2\">**</ept>."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Select ExpressRoute<ept id=\"p1\">**</ept> – Select the checkbox <bpt id=\"p2\">**</bpt>Use ExpressRoute<ept id=\"p2\">**</ept>.",
      "pos": [
        2032,
        2099
      ]
    },
    {
      "content": "This option only appears if you selected <bpt id=\"p1\">***</bpt>Configure a Site-to-Site VPN<ept id=\"p1\">***</ept> in the previous step.",
      "pos": [
        2100,
        2197
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Local Network<ept id=\"p1\">**</ept> - A local network represents your physical on-premises location.",
      "pos": [
        2204,
        2286
      ]
    },
    {
      "content": "You can select a local network that you’ve previously created, or you can create a new local network.",
      "pos": [
        2287,
        2388
      ]
    },
    {
      "content": "If you select an existing local network, skip step 5.",
      "pos": [
        2394,
        2447
      ]
    },
    {
      "content": "If you’re creating a new local network, you’ll see the <bpt id=\"p1\">**</bpt>Site-To-Site Connectivity<ept id=\"p1\">**</ept> page.",
      "pos": [
        2452,
        2542
      ]
    },
    {
      "content": "If you selected a local network that you previously created, this page will not appear in the wizard and you can move on to the next section.",
      "pos": [
        2543,
        2684
      ]
    },
    {
      "content": "To configure your local network, enter the following information and then click the next arrow.",
      "pos": [
        2685,
        2780
      ]
    },
    {
      "pos": [
        2789,
        2864
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> - The name you want to call your local (on-premises) network site."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Address space<ept id=\"p1\">**</ept> - including Starting IP and CIDR (Address Count).",
      "pos": [
        2871,
        2938
      ]
    },
    {
      "content": "You can specify any address range as long as it doesn't overlap with the address range for your virtual network.",
      "pos": [
        2939,
        3051
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Add address space<ept id=\"p1\">**</ept> - This setting is not relevant for ExpressRoute.",
      "pos": [
        3058,
        3128
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> You are required to create a local network site for ExpressRoute.",
      "pos": [
        3129,
        3204
      ]
    },
    {
      "content": "THe address prefixes specified for the local network site will be ignored.",
      "pos": [
        3205,
        3279
      ]
    },
    {
      "content": "Adress prefixes advertised to Microsoft through the ExpressRoute circuit will be used for routing purposes.",
      "pos": [
        3280,
        3387
      ]
    },
    {
      "pos": [
        3392,
        3546
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Virtual Network Address Spaces<ept id=\"p1\">**</ept> page, enter the following information and then click the checkmark on the lower right to configure your network."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Address space<ept id=\"p1\">**</ept> - including starting IP and address count.",
      "pos": [
        3555,
        3615
      ]
    },
    {
      "content": "Verify that the address spaces you specify don’t overlap any of the address spaces that you have on your local network.",
      "pos": [
        3616,
        3735
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Add subnet<ept id=\"p1\">**</ept> - including Starting IP and Address Count.",
      "pos": [
        3742,
        3799
      ]
    },
    {
      "content": "Additional subnets are not required, but you may want to create a separate subnet for VMs that will have dynamic IP addresses (DIPS).",
      "pos": [
        3800,
        3933
      ]
    },
    {
      "content": "Or you might want to have your VMs in a subnet that is separate from your PaaS instances.",
      "pos": [
        3934,
        4023
      ]
    },
    {
      "pos": [
        4030,
        4273
      ],
      "content": "**Add gateway subnet** - Click to add the gateway subnet. The gateway subnet is used only for the virtual network gateway and is required for this configuration. \n***Important:***  The gateway subnet for ExpressRoute must be /28 or larger.",
      "leadings": [
        "",
        "    "
      ],
      "nodes": [
        {
          "content": "**Add gateway subnet** - Click to add the gateway subnet. The gateway subnet is used only for the virtual network gateway and is required for this configuration.",
          "pos": [
            0,
            161
          ],
          "nodes": [
            {
              "content": "<bpt id=\"p1\">**</bpt>Add gateway subnet<ept id=\"p1\">**</ept> - Click to add the gateway subnet.",
              "pos": [
                0,
                57
              ]
            },
            {
              "content": "The gateway subnet is used only for the virtual network gateway and is required for this configuration.",
              "pos": [
                58,
                161
              ]
            }
          ]
        },
        {
          "content": "<bpt id=\"p1\">***</bpt>Important:<ept id=\"p1\">***</ept>  The gateway subnet for ExpressRoute must be /28 or larger.",
          "pos": [
            163,
            239
          ]
        }
      ]
    },
    {
      "content": "Click the checkmark on the bottom of the page and your virtual network will begin to create.",
      "pos": [
        4278,
        4370
      ]
    },
    {
      "content": "When it completes, you will see <bpt id=\"p1\">**</bpt>Created<ept id=\"p1\">**</ept> listed under <bpt id=\"p2\">**</bpt>Status<ept id=\"p2\">**</ept> on the <bpt id=\"p3\">**</bpt>Networks<ept id=\"p3\">**</ept> page in the Management Portal.",
      "pos": [
        4371,
        4489
      ]
    },
    {
      "pos": [
        4494,
        4594
      ],
      "content": "On the <bpt id=\"p1\">**</bpt>Networks<ept id=\"p1\">**</ept> page, click the virtual network that you just created, then click <bpt id=\"p2\">**</bpt>Dashboard<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        4598,
        4680
      ],
      "content": "On the bottom of the Dashboard page, click <bpt id=\"p1\">**</bpt>CREATE GATEWAY<ept id=\"p1\">**</ept>, then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."
    },
    {
      "content": "When the gateway starts creating, you’ll see a message letting you know that the gateway has been started.",
      "pos": [
        4686,
        4792
      ]
    },
    {
      "content": "It may take up to 15 minutes for the gateway to create.",
      "pos": [
        4793,
        4848
      ]
    },
    {
      "content": "Link your network to a circuit.",
      "pos": [
        4855,
        4886
      ]
    },
    {
      "content": "Proceed with the following instructions only after you have confirmed that your circuit has moved to the following state and status:",
      "pos": [
        4889,
        5021
      ]
    },
    {
      "content": "ServiceProviderState: Provisioned",
      "pos": [
        5030,
        5063
      ]
    },
    {
      "content": "Status: Enabled",
      "pos": [
        5070,
        5085
      ]
    },
    {
      "content": "Verify that you have at least one Azure Virtual Network with a gateway created.",
      "pos": [
        5091,
        5170
      ]
    },
    {
      "content": "The gateway subnet must be /28 or larger in order to work with an ExpressRoute connection and must be up and running.",
      "pos": [
        5171,
        5288
      ]
    },
    {
      "content": "Next Steps",
      "pos": [
        5441,
        5451
      ]
    },
    {
      "pos": [
        5452,
        5596
      ],
      "content": "If you want to add virtual machines to your virtual network, see <bpt id=\"p1\">[</bpt>How to Create a Custom Virtual Machine<ept id=\"p1\">](../virtual-machines-create-custom.md)</ept>."
    },
    {
      "pos": [
        5598,
        5712
      ],
      "content": "If you want to learn more about ExpressRoute, see <bpt id=\"p1\">[</bpt>ExpressRoute Technical Overview<ept id=\"p1\">](expressroute-introduction.md)</ept>."
    },
    {
      "content": "test",
      "pos": [
        5718,
        5722
      ]
    }
  ],
  "content": "<properties\n   pageTitle=\"Configuring a Virtual Network for Expressroute | Microsoft Azure\"\n   description=\"This article walks you through setting up a virtual network (VNet) for ExpressRoute\"\n   documentationCenter=\"na\"\n   services=\"expressroute\"\n   authors=\"cherylmc\"\n   manager=\"carolz\"\n   editor=\"tysonn\" />\n\n<tags \n   ms.service=\"expressroute\"\n   ms.devlang=\"na\"\n   ms.topic=\"article\" \n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"infrastructure-services\" \n   ms.date=\"07/28/2015\"\n   ms.author=\"cherylmc\"/>\n\n#  Configure a Virtual Network for ExpressRoute\n\nThese steps will walk you through configuring a virtual network and a gateway for ExpressRoute.\n\n1. Log in to the **Management Portal**.\n2. In the lower left-hand corner of the screen, click **New**. In the navigation pane, click **Network Services**, and then click **Virtual Network**. Click **Custom Create** to begin the configuration wizard.\n3. On the **Virtual Network Details** page, enter the information below.\n\n    - **Name** – Name your virtual network. You’ll use this virtual network name when you deploy your VMs and PaaS instances, so you may not want to make the name too complicated.\n    - **Location** – The location is directly related to the physical location (region) where you want your resources (VMs) to reside. For example, if you want the VMs that you deploy to this virtual network to be physically located in East US, select that location. You can’t change the region associated with your virtual network after you create it.\n\n4. On the **DNS Servers and VPN Connectivity** page, enter the following information, and then click the next arrow on the lower right. \n\n    - **DNS Servers** - Enter the DNS server name and IP address, or select a previously registered DNS server from the dropdown. This setting does not create a DNS server, it allows you to specify the DNS servers that you want to use for name resolution for this virtual network.\n    - **Configure Site-To-Site VPN** - Select the checkbox for **Configure a site-to-site VPN**.\n    - **Select ExpressRoute** – Select the checkbox **Use ExpressRoute**. This option only appears if you selected ***Configure a Site-to-Site VPN*** in the previous step.\n    - **Local Network** - A local network represents your physical on-premises location. You can select a local network that you’ve previously created, or you can create a new local network.\n\n    If you select an existing local network, skip step 5.\n\n5. If you’re creating a new local network, you’ll see the **Site-To-Site Connectivity** page. If you selected a local network that you previously created, this page will not appear in the wizard and you can move on to the next section. To configure your local network, enter the following information and then click the next arrow. \n\n    - **Name** - The name you want to call your local (on-premises) network site.\n    - **Address space** - including Starting IP and CIDR (Address Count). You can specify any address range as long as it doesn't overlap with the address range for your virtual network.\n    - **Add address space** - This setting is not relevant for ExpressRoute.\n**Note:** You are required to create a local network site for ExpressRoute. THe address prefixes specified for the local network site will be ignored. Adress prefixes advertised to Microsoft through the ExpressRoute circuit will be used for routing purposes.\n\n6. On the **Virtual Network Address Spaces** page, enter the following information and then click the checkmark on the lower right to configure your network. \n\n    - **Address space** - including starting IP and address count. Verify that the address spaces you specify don’t overlap any of the address spaces that you have on your local network.\n    - **Add subnet** - including Starting IP and Address Count. Additional subnets are not required, but you may want to create a separate subnet for VMs that will have dynamic IP addresses (DIPS). Or you might want to have your VMs in a subnet that is separate from your PaaS instances.\n    - **Add gateway subnet** - Click to add the gateway subnet. The gateway subnet is used only for the virtual network gateway and is required for this configuration. \n    ***Important:***  The gateway subnet for ExpressRoute must be /28 or larger.\n\n7. Click the checkmark on the bottom of the page and your virtual network will begin to create. When it completes, you will see **Created** listed under **Status** on the **Networks** page in the Management Portal.\n\n8. On the **Networks** page, click the virtual network that you just created, then click **Dashboard**.\n9. On the bottom of the Dashboard page, click **CREATE GATEWAY**, then click **Yes**.\n\n10. When the gateway starts creating, you’ll see a message letting you know that the gateway has been started. It may take up to 15 minutes for the gateway to create.\n11. **Link your network to a circuit.** Proceed with the following instructions only after you have confirmed that your circuit has moved to the following state and status: \n\n    - ServiceProviderState: Provisioned\n    - Status: Enabled\n\n    Verify that you have at least one Azure Virtual Network with a gateway created. The gateway subnet must be /28 or larger in order to work with an ExpressRoute connection and must be up and running.\n\n            PS C:\\> $Vnet = \"MyTestVNet\"\n            New-AzureDedicatedCircuitLink -ServiceKey $ServiceKey -VNetName $Vnet\n            Provisioned\n\n## Next Steps\nIf you want to add virtual machines to your virtual network, see [How to Create a Custom Virtual Machine](../virtual-machines-create-custom.md).\n\nIf you want to learn more about ExpressRoute, see [ExpressRoute Technical Overview](expressroute-introduction.md).\n\n\n \n\ntest\n"
}