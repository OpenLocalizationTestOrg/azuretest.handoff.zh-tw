{
  "nodes": [
    {
      "content": "Upload Files into a Media Services account using REST API",
      "pos": [
        28,
        85
      ]
    },
    {
      "content": "Learn how to get media content into Media Services by creating and uploading assets.",
      "pos": [
        105,
        189
      ]
    },
    {
      "content": "Upload Files into a Media Services account using REST API",
      "pos": [
        501,
        558
      ]
    },
    {
      "content": "In Media Services, you upload your digital files into an asset.",
      "pos": [
        674,
        737
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt>Asset<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/hh974277.aspx)</ept> entity can contain video, audio, images, thumbnail collections, text tracks and closed caption files (and the metadata about these files.)  Once the files are uploaded into the asset, your content is stored securely in the cloud for further processing and streaming.",
      "pos": [
        738,
        1072
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>Media Services uses the value of the IAssetFile.Name property when building URLs for the streaming content (for example, http://{AMSAccount}.origin.mediaservices.windows.net/{GUID}/{IAssetFile.Name}/streamingParameters.) For this reason, percent-encoding is not allowed.",
      "pos": [
        1077,
        1359
      ]
    },
    {
      "content": "The value of the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> property cannot have any of the following <bpt id=\"p2\">[</bpt>percent-encoding-reserved characters<ept id=\"p2\">](http://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_reserved_characters)</ept>: !*'();:@&amp;=+$,/?%#[]\".",
      "pos": [
        1360,
        1573
      ]
    },
    {
      "content": "Also, there can only be one ‘.’",
      "pos": [
        1574,
        1605
      ]
    },
    {
      "content": "for the file name extension.",
      "pos": [
        1606,
        1634
      ]
    },
    {
      "content": "The basic workflow for ingesting Assets is divided into the following sections:",
      "pos": [
        1636,
        1715
      ]
    },
    {
      "content": "Create an Asset",
      "pos": [
        1719,
        1734
      ]
    },
    {
      "content": "Encrypt an Asset (Optional)",
      "pos": [
        1737,
        1764
      ]
    },
    {
      "content": "Upload a file to blob storage",
      "pos": [
        1767,
        1796
      ]
    },
    {
      "content": "Create an asset",
      "pos": [
        1801,
        1816
      ]
    },
    {
      "pos": [
        1819,
        1914
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> When working with the Media Services REST API, the following considerations apply:"
    },
    {
      "content": "When accessing entities in Media Services, you must set specific header fields and values in your HTTP requests.",
      "pos": [
        1918,
        2030
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Setup for Media Services REST API Development<ept id=\"p1\">](media-services-rest-how-to-use.md)</ept>.",
      "pos": [
        2031,
        2140
      ]
    },
    {
      "content": "After successfully connecting to https://media.windows.net, you will receive a 301 redirect specifying another Media Services URI.",
      "pos": [
        2143,
        2273
      ]
    },
    {
      "content": "You must make subsequent calls to the new URI as described in <bpt id=\"p1\">[</bpt>Connecting to Media Services using REST API<ept id=\"p1\">](media-services-rest-connect_programmatically.md)</ept>.",
      "pos": [
        2274,
        2431
      ]
    },
    {
      "content": "An asset is a container for multiple types or sets of objects in Media Services, including video, audio, images, thumbnail collections, text tracks, and closed caption files.",
      "pos": [
        2435,
        2609
      ]
    },
    {
      "content": "In the REST API, creating an Asset requires sending POST request to Media Services and placing any property information about your asset in the request body.",
      "pos": [
        2610,
        2767
      ]
    },
    {
      "content": "One of the properties that you can specify when creating an asset is <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept>.",
      "pos": [
        2769,
        2850
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> is an enumeration value that describes the encryption options that an Asset can be created with.",
      "pos": [
        2851,
        2959
      ]
    },
    {
      "content": "A valid value is one of the values from the list below, not a combination of values.",
      "pos": [
        2960,
        3044
      ]
    },
    {
      "pos": [
        3049,
        3297
      ],
      "content": "**None** = **0**: No encryption will be used. This is the default value. Note that when using this option your content is not protected in transit or at rest in storage.\n  If you plan to deliver an MP4 using progressive download, use this option.",
      "leadings": [
        "",
        "  "
      ],
      "nodes": [
        {
          "content": "**None** = **0**: No encryption will be used. This is the default value. Note that when using this option your content is not protected in transit or at rest in storage.",
          "pos": [
            0,
            169
          ],
          "nodes": [
            {
              "content": "<bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>0<ept id=\"p2\">**</ept>: No encryption will be used.",
              "pos": [
                0,
                45
              ]
            },
            {
              "content": "This is the default value.",
              "pos": [
                46,
                72
              ]
            },
            {
              "content": "Note that when using this option your content is not protected in transit or at rest in storage.",
              "pos": [
                73,
                169
              ]
            }
          ]
        },
        {
          "content": "If you plan to deliver an MP4 using progressive download, use this option.",
          "pos": [
            172,
            246
          ]
        }
      ]
    },
    {
      "pos": [
        3302,
        3434
      ],
      "content": "<bpt id=\"p1\">**</bpt>StorageEncrypted<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>1<ept id=\"p2\">**</ept>: Specify if you want for your files to be encrypted with AES-256 bit encryption for upload and storage."
    },
    {
      "content": "If your asset is storage encrypted, you must configure asset delivery policy.",
      "pos": [
        3440,
        3517
      ]
    },
    {
      "content": "For more information see <bpt id=\"p1\">[</bpt>Configuring asset delivery policy<ept id=\"p1\">](media-services-rest-configure-asset-delivery-policy.md)</ept>.",
      "pos": [
        3518,
        3635
      ]
    },
    {
      "pos": [
        3639,
        3775
      ],
      "content": "<bpt id=\"p1\">**</bpt>CommonEncryptionProtected<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>2<ept id=\"p2\">**</ept>: Specify if you are uploading files protected with a common encryption method (such as PlayReady)."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>EnvelopeEncryptionProtected<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>4<ept id=\"p2\">**</ept>: Specify if you are uploading HLS encrypted with AES files.",
      "pos": [
        3780,
        3879
      ]
    },
    {
      "content": "Note that the files must have been encoded and encrypted by Transform Manager.",
      "pos": [
        3880,
        3958
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph>If your asset will use encryption, you must create a <bpt id=\"p1\">**</bpt>ContentKey<ept id=\"p1\">**</ept> and link it to your asset as described in the following topic:<bpt id=\"p2\">[</bpt>How to create a ContentKey<ept id=\"p2\">](media-services-rest-create-contentkey.md)</ept>.",
      "pos": [
        3961,
        4174
      ]
    },
    {
      "content": "Note that after you upload the files into the asset, you need to update the encryption properties on the <bpt id=\"p1\">**</bpt>AssetFile<ept id=\"p1\">**</ept> entity with the values you got during the <bpt id=\"p2\">**</bpt>Asset<ept id=\"p2\">**</ept> encryption.",
      "pos": [
        4175,
        4357
      ]
    },
    {
      "content": "Do it by using the <bpt id=\"p1\">**</bpt>MERGE<ept id=\"p1\">**</ept> HTTP request.",
      "pos": [
        4358,
        4400
      ]
    },
    {
      "content": "The following example shows how to create an asset.",
      "pos": [
        4404,
        4455
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        4459,
        4471
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        5333,
        5346
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        5350,
        5391
      ]
    },
    {
      "content": "Create an AssetFile",
      "pos": [
        6613,
        6632
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt>AssetFile<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974275.aspx)</ept> entity represents a video or audio file that is stored in a blob container.",
      "pos": [
        6634,
        6780
      ]
    },
    {
      "content": "An asset file is always associated with an asset, and an asset may contain one or many asset files.",
      "pos": [
        6781,
        6880
      ]
    },
    {
      "content": "The Media Services Encoder task fails if an asset file object is not associated with a digital file in a blob container.",
      "pos": [
        6881,
        7001
      ]
    },
    {
      "content": "Note that the <bpt id=\"p1\">**</bpt>AssetFile<ept id=\"p1\">**</ept> instance and the actual media file are two distinct objects.",
      "pos": [
        7003,
        7091
      ]
    },
    {
      "content": "The AssetFile instance contains metadata about the media file, while the media file contains the actual media content.",
      "pos": [
        7092,
        7210
      ]
    },
    {
      "pos": [
        7212,
        7409
      ],
      "content": "After you upload your digital media file into a blob container, you will use the <bpt id=\"p1\">**</bpt>MERGE<ept id=\"p1\">**</ept> HTTP request to update the AssetFile with information about your media file (as shown later in the topic)."
    },
    {
      "content": "HTTP Request",
      "pos": [
        7414,
        7426
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        8486,
        8499
      ]
    },
    {
      "content": "Creating the AccessPolicy with write permission.",
      "pos": [
        9806,
        9854
      ]
    },
    {
      "content": "Before uploading any files into blob storage, set the access policy rights for writing to an asset.",
      "pos": [
        9857,
        9956
      ]
    },
    {
      "content": "To do that, POST an HTTP request to the AccessPolicies entity set.",
      "pos": [
        9957,
        10023
      ]
    },
    {
      "content": "Define a DurationInMinutes value upon creation or you will receive a 500 Internal Server error message back in response.",
      "pos": [
        10024,
        10144
      ]
    },
    {
      "content": "For more information on AccessPolicies, see <bpt id=\"p1\">[</bpt>AccessPolicy<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974297.aspx)</ept>.",
      "pos": [
        10145,
        10259
      ]
    },
    {
      "content": "The following example shows how to create an AccessPolicy:",
      "pos": [
        10261,
        10319
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        10331,
        10343
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        11254,
        11266
      ]
    },
    {
      "content": "Get the Upload URL",
      "pos": [
        12323,
        12341
      ]
    },
    {
      "content": "To receive the actual upload URL, create a SAS Locator.",
      "pos": [
        12343,
        12398
      ]
    },
    {
      "content": "Locators define the start time and type of connection endpoint for clients that want to access Files in an Asset.",
      "pos": [
        12399,
        12512
      ]
    },
    {
      "content": "You can create multiple Locator entities for a given AccessPolicy and Asset pair to handle different client requests and needs.",
      "pos": [
        12513,
        12640
      ]
    },
    {
      "content": "Each of these Locators use the StartTime value plus the DurationInMinutes value of the AccessPolicy to determine the length of time a URL can be used.",
      "pos": [
        12641,
        12791
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Locator<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974308.aspx)</ept>.",
      "pos": [
        12792,
        12883
      ]
    },
    {
      "content": "A SAS URL has the following format:",
      "pos": [
        12886,
        12921
      ]
    },
    {
      "content": "Some considerations apply:",
      "pos": [
        13017,
        13043
      ]
    },
    {
      "content": "You cannot have more than five unique Locators associated with a given Asset at one time.",
      "pos": [
        13047,
        13136
      ]
    },
    {
      "content": "For more information, see Locator.",
      "pos": [
        13137,
        13171
      ]
    },
    {
      "content": "If you need to upload your files immediately, you should set your StartTime value to five minutes before the current time.",
      "pos": [
        13174,
        13296
      ]
    },
    {
      "content": "This is because there may be clock skew between your client machine and Media Services.",
      "pos": [
        13297,
        13384
      ]
    },
    {
      "content": "Also, your StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").",
      "pos": [
        13385,
        13513
      ]
    },
    {
      "content": "There may be a 30-40 second delay after a Locator is created to when it is available for use.",
      "pos": [
        13519,
        13612
      ]
    },
    {
      "content": "This issue applies to both SAS URL and Origin Locators.",
      "pos": [
        13613,
        13668
      ]
    },
    {
      "content": "The following example shows how to create a SAS URL Locator, as defined by the Type property in the request body (\"1\" for a SAS locator and \"2\" for an On-Demand origin locator).",
      "pos": [
        13670,
        13847
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> property returned contains the URL that you must use to upload your file.",
      "pos": [
        13848,
        13934
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        13942,
        13954
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        14998,
        15011
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        15015,
        15065
      ]
    },
    {
      "content": "Upload a file into a blob storage container",
      "pos": [
        16763,
        16806
      ]
    },
    {
      "content": "Once you have the AccessPolicy and Locator set, the actual file is uploaded to an Azure Blob Storage container using the Azure Storage REST APIs.",
      "pos": [
        16812,
        16957
      ]
    },
    {
      "content": "You can either upload in page or block blobs.",
      "pos": [
        16958,
        17003
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You must add the file name for the file you want to upload to the Locator <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> value received in the previous section.",
      "pos": [
        17007,
        17142
      ]
    },
    {
      "content": "For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4?",
      "pos": [
        17143,
        17268
      ]
    },
    {
      "content": ".",
      "pos": [
        17269,
        17270
      ]
    },
    {
      "content": ".",
      "pos": [
        17271,
        17272
      ]
    },
    {
      "content": ".",
      "pos": [
        17273,
        17274
      ]
    },
    {
      "pos": [
        17277,
        17418
      ],
      "content": "For more information on working with Azure storage blobs, see <bpt id=\"p1\">[</bpt>Blob Service REST API<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/dd135733.aspx)</ept>."
    },
    {
      "content": "Update the AssetFile",
      "pos": [
        17424,
        17444
      ]
    },
    {
      "content": "Now that you've uploaded your file, update the FileAsset size (and other) information.",
      "pos": [
        17447,
        17533
      ]
    },
    {
      "content": "For example:",
      "pos": [
        17534,
        17546
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        18681,
        18694
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        18698,
        18739
      ]
    },
    {
      "content": "HTTP/1.1 204 No Content",
      "pos": [
        18744,
        18767
      ]
    },
    {
      "content": "Delete the Locator and AccessPolicy",
      "pos": [
        18772,
        18807
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        18812,
        18824
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        19673,
        19686
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        19690,
        19731
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        19773,
        19785
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        20634,
        20647
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        20651,
        20692
      ]
    },
    {
      "content": "test",
      "pos": [
        20806,
        20810
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Upload Files into a Media Services account using REST API\" \n    description=\"Learn how to get media content into Media Services by creating and uploading assets.\" \n    services=\"media-services\" \n    documentationCenter=\"\" \n    authors=\"Juliako\" \n    manager=\"dwrede\" \n    editor=\"\"/>\n\n<tags \n    ms.service=\"media-services\" \n    ms.workload=\"media\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"08/11/2015\"\n    ms.author=\"juliako\"/>\n\n\n#Upload Files into a Media Services account using REST API\n\n[AZURE.INCLUDE [media-services-selector-upload-files](../../includes/media-services-selector-upload-files.md)]\n \n\nIn Media Services, you upload your digital files into an asset. The [Asset](https://msdn.microsoft.com/library/azure/hh974277.aspx) entity can contain video, audio, images, thumbnail collections, text tracks and closed caption files (and the metadata about these files.)  Once the files are uploaded into the asset, your content is stored securely in the cloud for further processing and streaming. \n\n\n>[AZURE.NOTE]Media Services uses the value of the IAssetFile.Name property when building URLs for the streaming content (for example, http://{AMSAccount}.origin.mediaservices.windows.net/{GUID}/{IAssetFile.Name}/streamingParameters.) For this reason, percent-encoding is not allowed. The value of the **Name** property cannot have any of the following [percent-encoding-reserved characters](http://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_reserved_characters): !*'();:@&=+$,/?%#[]\". Also, there can only be one ‘.’ for the file name extension.\n\nThe basic workflow for ingesting Assets is divided into the following sections:\n\n- Create an Asset\n- Encrypt an Asset (Optional)\n- Upload a file to blob storage\n\n\n##Create an asset\n\n>[AZURE.NOTE] When working with the Media Services REST API, the following considerations apply:\n>\n>When accessing entities in Media Services, you must set specific header fields and values in your HTTP requests. For more information, see [Setup for Media Services REST API Development](media-services-rest-how-to-use.md).\n\n>After successfully connecting to https://media.windows.net, you will receive a 301 redirect specifying another Media Services URI. You must make subsequent calls to the new URI as described in [Connecting to Media Services using REST API](media-services-rest-connect_programmatically.md). \n \nAn asset is a container for multiple types or sets of objects in Media Services, including video, audio, images, thumbnail collections, text tracks, and closed caption files. In the REST API, creating an Asset requires sending POST request to Media Services and placing any property information about your asset in the request body.\n\nOne of the properties that you can specify when creating an asset is **Options**. **Options** is an enumeration value that describes the encryption options that an Asset can be created with. A valid value is one of the values from the list below, not a combination of values. \n\n- **None** = **0**: No encryption will be used. This is the default value. Note that when using this option your content is not protected in transit or at rest in storage.\n    If you plan to deliver an MP4 using progressive download, use this option. \n\n- **StorageEncrypted** = **1**: Specify if you want for your files to be encrypted with AES-256 bit encryption for upload and storage.\n\n    If your asset is storage encrypted, you must configure asset delivery policy. For more information see [Configuring asset delivery policy](media-services-rest-configure-asset-delivery-policy.md).\n\n- **CommonEncryptionProtected** = **2**: Specify if you are uploading files protected with a common encryption method (such as PlayReady). \n\n- **EnvelopeEncryptionProtected** = **4**: Specify if you are uploading HLS encrypted with AES files. Note that the files must have been encoded and encrypted by Transform Manager.\n\n>[AZURE.NOTE]If your asset will use encryption, you must create a **ContentKey** and link it to your asset as described in the following topic:[How to create a ContentKey](media-services-rest-create-contentkey.md). Note that after you upload the files into the asset, you need to update the encryption properties on the **AssetFile** entity with the values you got during the **Asset** encryption. Do it by using the **MERGE** HTTP request. \n\n\nThe following example shows how to create an asset.\n\n**HTTP Request**\n\n    POST https://media.windows.net/api/Assets HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-2233-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n    \n    {\"Name\":\"BigBuckBunny.mp4\"}\n    \n\n**HTTP Response**\n\nIf successful, the following is returned:\n    \n    HTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 452\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Assets('nb%3Acid%3AUUID%3A9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1')\n    Server: Microsoft-IIS/8.5\n    x-ms-client-request-id: c59de965-bc89-4295-9a57-75d897e5221e\n    request-id: e98be122-ae09-473a-8072-0ccd234a0657\n    x-ms-request-id: e98be122-ae09-473a-8072-0ccd234a0657\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sun, 18 Jan 2015 22:06:40 GMT\n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Assets/@Element\",\n       \"Id\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"State\":0,\n       \"Created\":\"2015-01-18T22:06:40.6010903Z\",\n       \"LastModified\":\"2015-01-18T22:06:40.6010903Z\",\n       \"AlternateId\":null,\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"Options\":0,\n       \"Uri\":\"https://storagetestaccount001.blob.core.windows.net/asset-9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StorageAccountName\":\"storagetestaccount001\"\n    }\n    \n##Create an AssetFile\n\nThe [AssetFile](http://msdn.microsoft.com/library/azure/hh974275.aspx) entity represents a video or audio file that is stored in a blob container. An asset file is always associated with an asset, and an asset may contain one or many asset files. The Media Services Encoder task fails if an asset file object is not associated with a digital file in a blob container.\n\nNote that the **AssetFile** instance and the actual media file are two distinct objects. The AssetFile instance contains metadata about the media file, while the media file contains the actual media content.\n\nAfter you upload your digital media file into a blob container, you will use the **MERGE** HTTP request to update the AssetFile with information about your media file (as shown later in the topic). \n\n**HTTP Request**\n\n    POST https://media.windows.net/api/Files HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-4ca2-2233-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n    Content-Length: 164\n    \n    {  \n       \"IsEncrypted\":\"false\",\n       \"IsPrimary\":\"false\",\n       \"MimeType\":\"video/mp4\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\"\n    }\n\n\n**HTTP Response**\n\n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 535\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Files('nb%3Acid%3AUUID%3Af13a0137-0a62-9d4c-b3b9-ca944b5142c5')\n    Server: Microsoft-IIS/8.5\n    request-id: 98a30e2d-f379-4495-988e-0b79edc9b80e\n    x-ms-request-id: 98a30e2d-f379-4495-988e-0b79edc9b80e\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 00:34:07 GMT\n    \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Files/@Element\",\n       \"Id\":\"nb:cid:UUID:f13a0137-0a62-9d4c-b3b9-ca944b5142c5\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ContentFileSize\":\"0\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"EncryptionVersion\":null,\n       \"EncryptionScheme\":null,\n       \"IsEncrypted\":false,\n       \"EncryptionKeyId\":null,\n       \"InitializationVector\":null,\n       \"IsPrimary\":false,\n       \"LastModified\":\"2015-01-19T00:34:08.1934137Z\",\n       \"Created\":\"2015-01-19T00:34:08.1934137Z\",\n       \"MimeType\":\"video/mp4\",\n       \"ContentChecksum\":null\n    }\n\n\n## Creating the AccessPolicy with write permission. \n\nBefore uploading any files into blob storage, set the access policy rights for writing to an asset. To do that, POST an HTTP request to the AccessPolicies entity set. Define a DurationInMinutes value upon creation or you will receive a 500 Internal Server error message back in response. For more information on AccessPolicies, see [AccessPolicy](http://msdn.microsoft.com/library/azure/hh974297.aspx).\n\nThe following example shows how to create an AccessPolicy:\n        \n**HTTP Request**\n\n    POST https://media.windows.net/api/AccessPolicies HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-2233-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n    \n    {\"Name\":\"NewUploadPolicy\", \"DurationInMinutes\":\"440\", \"Permissions\":\"2\"} \n\n**HTTP Request**\n\n    If successful, the following response is returned:\n    \n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 312\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/AccessPolicies('nb%3Apid%3AUUID%3Abe0ac48d-af7d-4877-9d60-1805d68bffae')\n    Server: Microsoft-IIS/8.5\n    request-id: 74c74545-7e0a-4cd6-a440-c1c48074a970\n    x-ms-request-id: 74c74545-7e0a-4cd6-a440-c1c48074a970\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sun, 18 Jan 2015 22:18:06 GMT\n\n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#AccessPolicies/@Element\",\n       \"Id\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"Created\":\"2015-01-18T22:18:06.6370575Z\",\n       \"LastModified\":\"2015-01-18T22:18:06.6370575Z\",\n       \"Name\":\"NewUploadPolicy\",\n       \"DurationInMinutes\":440.0,\n       \"Permissions\":2\n    }\n\n##Get the Upload URL\n\nTo receive the actual upload URL, create a SAS Locator. Locators define the start time and type of connection endpoint for clients that want to access Files in an Asset. You can create multiple Locator entities for a given AccessPolicy and Asset pair to handle different client requests and needs. Each of these Locators use the StartTime value plus the DurationInMinutes value of the AccessPolicy to determine the length of time a URL can be used. For more information, see [Locator](http://msdn.microsoft.com/library/azure/hh974308.aspx).\n\n\nA SAS URL has the following format:\n\n    {https://myaccount.blob.core.windows.net}/{asset name}/{video file name}?{SAS signature}\n\nSome considerations apply:\n\n- You cannot have more than five unique Locators associated with a given Asset at one time. For more information, see Locator.\n- If you need to upload your files immediately, you should set your StartTime value to five minutes before the current time. This is because there may be clock skew between your client machine and Media Services. Also, your StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").   \n- There may be a 30-40 second delay after a Locator is created to when it is available for use. This issue applies to both SAS URL and Origin Locators.\n\nThe following example shows how to create a SAS URL Locator, as defined by the Type property in the request body (\"1\" for a SAS locator and \"2\" for an On-Demand origin locator). The **Path** property returned contains the URL that you must use to upload your file.\n    \n**HTTP Request**\n    \n    POST https://media.windows.net/api/Locators HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-4ca2-2233-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n    {  \n       \"AccessPolicyId\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"AssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StartTime\":\"2015-02-18T16:45:53\",\n       \"Type\":1\n    }\n\n\n**HTTP Response**\n\nIf successful, the following response is returned:\n        \n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 949\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Locators('nb%3Alid%3AUUID%3Aaf57bdd8-6751-4e84-b403-f3c140444b54')\n    Server: Microsoft-IIS/8.5\n    request-id: 2adeb1f8-89c5-4cc8-aa4f-08cdfef33ae0\n    x-ms-request-id: 2adeb1f8-89c5-4cc8-aa4f-08cdfef33ae0\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 03:01:29 GMT\n    \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Locators/@Element\",\n       \"Id\":\"nb:lid:UUID:af57bdd8-6751-4e84-b403-f3c140444b54\",\n       \"ExpirationDateTime\":\"2015-02-19T00:05:53\",\n       \"Type\":1,\n       \"Path\":\"https://storagetestaccount001.blob.core.windows.net/asset-f438649c-313c-46e2-8d68-7d2550288247?sv=2012-02-12&sr=c&si=af57bdd8-6751-4e84-b403-f3c140444b54&sig=fE4btwEfZtVQFeC0Wh3Kwks2OFPQfzl5qTMW5YytiuY%3D&st=2015-02-18T16%3A45%3A53Z&se=2015-02-19T00%3A05%3A53Z\",\n       \"BaseUri\":\"https://storagetestaccount001.blob.core.windows.net/asset-f438649c-313c-46e2-8d68-7d2550288247\",\n       \"ContentAccessComponent\":\"?sv=2012-02-12&sr=c&si=af57bdd8-6751-4e84-b403-f3c140444b54&sig=fE4btwEfZtVQFeC0Wh3Kwks2OFPQfzl5qTMW5YytiuY%3D&st=2015-02-18T16%3A45%3A53Z&se=2015-02-19T00%3A05%3A53Z\",\n       \"AccessPolicyId\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"AssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StartTime\":\"2015-02-18T16:45:53\",\n       \"Name\":null\n    }\n\n## Upload a file into a blob storage container\n    \nOnce you have the AccessPolicy and Locator set, the actual file is uploaded to an Azure Blob Storage container using the Azure Storage REST APIs. You can either upload in page or block blobs. \n\n>[AZURE.NOTE] You must add the file name for the file you want to upload to the Locator **Path** value received in the previous section. For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4? . . . \n\nFor more information on working with Azure storage blobs, see [Blob Service REST API](http://msdn.microsoft.com/library/azure/dd135733.aspx).\n\n\n## Update the AssetFile \n\nNow that you've uploaded your file, update the FileAsset size (and other) information. For example:\n    \n    MERGE https://media.windows.net/api/Files('nb%3Acid%3AUUID%3Af13a0137-0a62-9d4c-b3b9-ca944b5142c5') HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-4ca2-2233-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n    \n    {  \n       \"ContentFileSize\":\"1186540\",\n       \"Id\":\"nb:cid:UUID:f13a0137-0a62-9d4c-b3b9-ca944b5142c5\",\n       \"MimeType\":\"video/mp4\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\"\n    }\n\n\n**HTTP Response**\n\nIf successful, the following is returned:\n    HTTP/1.1 204 No Content\n\n## Delete the Locator and AccessPolicy \n\n**HTTP Request**\n\n\n    DELETE https://media.windows.net/api/Locators('nb%3Alid%3AUUID%3Aaf57bdd8-6751-4e84-b403-f3c140444b54') HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-2233-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n\n    \n**HTTP Response**\n\nIf successful, the following is returned:\n\n    HTTP/1.1 204 No Content \n    ...\n\n**HTTP Request**\n\n    DELETE https://media.windows.net/api/AccessPolicies('nb%3Apid%3AUUID%3Abe0ac48d-af7d-4877-9d60-1805d68bffae') HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-6753-2233-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: media.windows.net\n\n**HTTP Response**\n\nIf successful, the following is returned:\n\n    HTTP/1.1 204 No Content \n    ...\n\n \n[How to Get a Media Processor]: media-services-get-media-processor.md\n \ntest\n"
}