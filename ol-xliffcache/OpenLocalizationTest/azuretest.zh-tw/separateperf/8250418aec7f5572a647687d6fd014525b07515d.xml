{
  "nodes": [
    {
      "content": "How to Use Twilio for Voice and SMS (Ruby) | Microsoft Azure",
      "pos": [
        28,
        88
      ]
    },
    {
      "content": "Learn how to make a phone call and send a SMS message with the Twilio API service on Azure.",
      "pos": [
        108,
        199
      ]
    },
    {
      "content": "Code samples written in Ruby.",
      "pos": [
        200,
        229
      ]
    },
    {
      "content": "How to Use Twilio for Voice and SMS Capabilities in Ruby",
      "pos": [
        549,
        605
      ]
    },
    {
      "content": "This guide demonstrates how to perform common programming tasks with the Twilio API service on Azure.",
      "pos": [
        606,
        707
      ]
    },
    {
      "content": "The scenarios covered include making a phone call and sending a Short Message Service (SMS) message.",
      "pos": [
        708,
        808
      ]
    },
    {
      "content": "For more information on Twilio and using voice and SMS in your applications, see the <bpt id=\"p1\">[</bpt>Next Steps<ept id=\"p1\">](#NextSteps)</ept> section.",
      "pos": [
        809,
        927
      ]
    },
    {
      "pos": [
        932,
        966
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"WhatIs\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>What is Twilio?"
    },
    {
      "content": "Twilio is a telephony web-service API that lets you use your existing web languages and skills to build voice and SMS applications.",
      "pos": [
        967,
        1098
      ]
    },
    {
      "content": "Twilio is a third-party service (not an Azure feature and not a Microsoft product).",
      "pos": [
        1099,
        1182
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Twilio Voice<ept id=\"p1\">**</ept> allows your applications to make and receive phone calls.",
      "pos": [
        1184,
        1258
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Twilio SMS<ept id=\"p1\">**</ept> allows your applications to make and receive SMS messages.",
      "pos": [
        1259,
        1332
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Twilio Client<ept id=\"p1\">**</ept> allows your applications to enable voice communication using existing Internet connections, including mobile connections.",
      "pos": [
        1333,
        1472
      ]
    },
    {
      "pos": [
        1477,
        1530
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"Pricing\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Twilio Pricing and Special Offers"
    },
    {
      "content": "Information about Twilio pricing is available at <bpt id=\"p1\">[</bpt>Twilio Pricing<ept id=\"p1\">] [twilio_pricing]</ept>.",
      "pos": [
        1531,
        1614
      ]
    },
    {
      "content": "Azure customers receive a <bpt id=\"p1\">[</bpt>special offer<ept id=\"p1\">][special_offer]</ept>: a free credit of 1000 texts or 1000 inbound minutes.",
      "pos": [
        1615,
        1725
      ]
    },
    {
      "content": "To sign up for this offer or get more information, please visit <bpt id=\"p1\">[</bpt>http://ahoy.twilio.com/azure<ept id=\"p1\">][special_offer]</ept>.",
      "pos": [
        1726,
        1836
      ]
    },
    {
      "pos": [
        1843,
        1872
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"Concepts\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Concepts"
    },
    {
      "content": "The Twilio API is a RESTful API that provides voice and SMS functionality for applications.",
      "pos": [
        1873,
        1964
      ]
    },
    {
      "content": "Client libraries are available in multiple languages; for a list, see <bpt id=\"p1\">[</bpt>Twilio API Libraries<ept id=\"p1\">] [twilio_libraries]</ept>.",
      "pos": [
        1965,
        2077
      ]
    },
    {
      "pos": [
        2083,
        2106
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"TwiML\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>TwiML"
    },
    {
      "content": "TwiML is a set of XML-based instructions that inform Twilio of how to process a call or SMS.",
      "pos": [
        2107,
        2199
      ]
    },
    {
      "pos": [
        2201,
        2285
      ],
      "content": "As an example, the following TwiML would convert the text <bpt id=\"p1\">**</bpt>Hello World<ept id=\"p1\">**</ept> to speech."
    },
    {
      "content": "All TwiML documents have <ph id=\"ph1\">`&lt;Response&gt;`</ph> as their root element.",
      "pos": [
        2393,
        2453
      ]
    },
    {
      "content": "From there, you use Twilio Verbs to define the behavior of your application.",
      "pos": [
        2454,
        2530
      ]
    },
    {
      "pos": [
        2536,
        2565
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"Verbs\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>TwiML Verbs"
    },
    {
      "content": "Twilio Verbs are XML tags that tell Twilio what to <bpt id=\"p1\">**</bpt>do<ept id=\"p1\">**</ept>.",
      "pos": [
        2566,
        2624
      ]
    },
    {
      "content": "For example, the <bpt id=\"p1\">**</bpt>&amp;lt;Say&amp;gt;<ept id=\"p1\">**</ept> verb instructs Twilio to audibly deliver a message on a call.",
      "pos": [
        2625,
        2719
      ]
    },
    {
      "content": "The following is a list of Twilio verbs.",
      "pos": [
        2722,
        2762
      ]
    },
    {
      "pos": [
        2766,
        2821
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Dial&amp;gt;<ept id=\"p1\">**</ept>: Connects the caller to another phone."
    },
    {
      "pos": [
        2824,
        2900
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Gather&amp;gt;<ept id=\"p1\">**</ept>: Collects numeric digits entered on the telephone keypad."
    },
    {
      "pos": [
        2903,
        2935
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Hangup&amp;gt;<ept id=\"p1\">**</ept>: Ends a call."
    },
    {
      "pos": [
        2938,
        2976
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Play&amp;gt;<ept id=\"p1\">**</ept>: Plays an audio file."
    },
    {
      "pos": [
        2979,
        3047
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Pause&amp;gt;<ept id=\"p1\">**</ept>: Waits silently for a specified number of seconds."
    },
    {
      "pos": [
        3050,
        3153
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Record&amp;gt;<ept id=\"p1\">**</ept>: Records the caller's voice and returns a URL of a file that contains the recording."
    },
    {
      "pos": [
        3156,
        3245
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Redirect&amp;gt;<ept id=\"p1\">**</ept>: Transfers control of a call or SMS to the TwiML at a different URL."
    },
    {
      "pos": [
        3248,
        3334
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Reject&amp;gt;<ept id=\"p1\">**</ept>: Rejects an incoming call to your Twilio number without billing you"
    },
    {
      "pos": [
        3337,
        3401
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Say&amp;gt;<ept id=\"p1\">**</ept>: Converts text to speech that is made on a call."
    },
    {
      "pos": [
        3404,
        3442
      ],
      "content": "<bpt id=\"p1\">**</bpt>&amp;lt;Sms&amp;gt;<ept id=\"p1\">**</ept>: Sends an SMS message."
    },
    {
      "content": "For more information about Twilio verbs, their attributes, and TwiML, see <bpt id=\"p1\">[</bpt>TwiML<ept id=\"p1\">] [twiml]</ept>.",
      "pos": [
        3444,
        3534
      ]
    },
    {
      "content": "For additional information about the Twilio API, see <bpt id=\"p1\">[</bpt>Twilio API<ept id=\"p1\">] [twilio_api]</ept>.",
      "pos": [
        3535,
        3614
      ]
    },
    {
      "pos": [
        3619,
        3668
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"CreateAccount\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Create a Twilio Account"
    },
    {
      "content": "When you're ready to get a Twilio account, sign up at <bpt id=\"p1\">[</bpt>Try Twilio<ept id=\"p1\">] [try_twilio]</ept>.",
      "pos": [
        3669,
        3749
      ]
    },
    {
      "content": "You can start with a free account, and upgrade your account later.",
      "pos": [
        3750,
        3816
      ]
    },
    {
      "content": "When you sign up for a Twilio account, you'll get a free phone number for your application.",
      "pos": [
        3818,
        3909
      ]
    },
    {
      "content": "You'll also receive an account SID and an auth token.",
      "pos": [
        3910,
        3963
      ]
    },
    {
      "content": "Both will be needed to make Twilio API calls.",
      "pos": [
        3964,
        4009
      ]
    },
    {
      "content": "To prevent unauthorized access to your account, keep your authentication token secure.",
      "pos": [
        4010,
        4096
      ]
    },
    {
      "content": "Your account SID and auth token are viewable at the <bpt id=\"p1\">[</bpt>Twilio account page<ept id=\"p1\">][twilio_account]</ept>, in the fields labeled <bpt id=\"p2\">**</bpt>ACCOUNT SID<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>AUTH TOKEN<ept id=\"p3\">**</ept>, respectively.",
      "pos": [
        4097,
        4259
      ]
    },
    {
      "pos": [
        4265,
        4316
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"VerifyPhoneNumbers\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Verify Phone Numbers"
    },
    {
      "content": "In addition to the number you are given by Twilio, you can also verify numbers that you control (i.e. your cell phone or home phone number) for use in your applications.",
      "pos": [
        4317,
        4486
      ]
    },
    {
      "pos": [
        4489,
        4574
      ],
      "content": "For information on how to verify a phone number, see <bpt id=\"p1\">[</bpt>Manage Numbers<ept id=\"p1\">] [verify_phone]</ept>."
    },
    {
      "pos": [
        4579,
        4627
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"create_app\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Create a Ruby Application"
    },
    {
      "content": "A Ruby application that uses the Twilio service and is running in Azure is no different than any other Ruby application that uses the Twilio service.",
      "pos": [
        4628,
        4777
      ]
    },
    {
      "content": "While Twilio services are RESTful and can be called from Ruby in several ways, this article will focus on how to use Twilio services with <bpt id=\"p1\">[</bpt>Twilio helper library for Ruby<ept id=\"p1\">][twilio_ruby]</ept>.",
      "pos": [
        4778,
        4962
      ]
    },
    {
      "content": "First, <bpt id=\"p1\">[</bpt>set-up a new Azure Linux VM<ept id=\"p1\">][azure_vm_setup]</ept> to act as a host for your new Ruby web application.",
      "pos": [
        4964,
        5068
      ]
    },
    {
      "content": "Ignore the steps involving the creation of a Rails app, just set-up the VM.",
      "pos": [
        5069,
        5144
      ]
    },
    {
      "content": "Make sure you create an Endpoint with an external port of 80 and an internal port of 5000.",
      "pos": [
        5145,
        5235
      ]
    },
    {
      "content": "In the examples below, we will be using <bpt id=\"p1\">[</bpt>Sinatra<ept id=\"p1\">][sinatra]</ept>, a very simple web framework for Ruby.",
      "pos": [
        5237,
        5334
      ]
    },
    {
      "content": "But you can certainly use the Twilio helper library for Ruby with any other web framework, including Ruby on Rails.",
      "pos": [
        5335,
        5450
      ]
    },
    {
      "content": "SSH into your new VM and create a directory for your new app.",
      "pos": [
        5452,
        5513
      ]
    },
    {
      "content": "Inside that directory, create a file called Gemfile and copy the following code into it:",
      "pos": [
        5514,
        5602
      ]
    },
    {
      "content": "On the command line run <ph id=\"ph1\">`bundle install`</ph>.",
      "pos": [
        5672,
        5713
      ]
    },
    {
      "content": "This will install the dependencies above.",
      "pos": [
        5714,
        5755
      ]
    },
    {
      "content": "Next create a file called <ph id=\"ph1\">`web.rb`</ph>.",
      "pos": [
        5756,
        5791
      ]
    },
    {
      "content": "This will be where the code for your web app lives.",
      "pos": [
        5792,
        5843
      ]
    },
    {
      "content": "Paste the following code into it:",
      "pos": [
        5844,
        5877
      ]
    },
    {
      "content": "At this point you should be able the run the command <ph id=\"ph1\">`ruby web.rb -p 5000`</ph>.",
      "pos": [
        5950,
        6025
      ]
    },
    {
      "content": "This will spin-up a small web server on port 5000.",
      "pos": [
        6026,
        6076
      ]
    },
    {
      "content": "You should be able to browse to this app in your browser by visiting the URL you set-up for your Azure VM.",
      "pos": [
        6077,
        6183
      ]
    },
    {
      "content": "Once you can reach your web app in the browser, you're ready to start building a Twilio app.",
      "pos": [
        6184,
        6276
      ]
    },
    {
      "pos": [
        6281,
        6347
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"configure_app\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Configure Your Application to Use Twilio"
    },
    {
      "pos": [
        6348,
        6453
      ],
      "content": "You can configure your web app to use the Twilio library by updating your <ph id=\"ph1\">`Gemfile`</ph> to include this line:"
    },
    {
      "content": "On the command line, run <ph id=\"ph1\">`bundle install`</ph>.",
      "pos": [
        6478,
        6520
      ]
    },
    {
      "content": "Now open <ph id=\"ph1\">`web.rb`</ph> and including this line at the top:",
      "pos": [
        6521,
        6574
      ]
    },
    {
      "content": "You're now all set to use the Twilio helper library for Ruby in your web app.",
      "pos": [
        6603,
        6680
      ]
    },
    {
      "pos": [
        6685,
        6742
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"howto_make_call\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Make an outgoing call"
    },
    {
      "content": "The following shows how to make an outgoing call.",
      "pos": [
        6743,
        6792
      ]
    },
    {
      "content": "Key concepts include using the Twilio helper library for Ruby to make REST API calls and rendering TwiML.",
      "pos": [
        6793,
        6898
      ]
    },
    {
      "content": "Substitute your values for the <bpt id=\"p1\">**</bpt>From<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>To<ept id=\"p2\">**</ept> phone numbers, and ensure that you verify the <bpt id=\"p3\">**</bpt>From<ept id=\"p3\">**</ept> phone number for your Twilio account prior to running the code.",
      "pos": [
        6899,
        7068
      ]
    },
    {
      "pos": [
        7070,
        7100
      ],
      "content": "Add this function to <ph id=\"ph1\">`web.md`</ph>:"
    },
    {
      "content": "If you open-up <ph id=\"ph1\">`http://yourdomain.cloudapp.net/make_call`</ph> in a browser, that will trigger the call to the Twilio API to make the phone call.",
      "pos": [
        7911,
        8051
      ]
    },
    {
      "content": "The first two parameters in <ph id=\"ph1\">`client.account.calls.create`</ph> are fairly self-explanatory: the number the call is <ph id=\"ph2\">`from`</ph> and the number the call is <ph id=\"ph3\">`to`</ph>.",
      "pos": [
        8052,
        8201
      ]
    },
    {
      "content": "The third parameter (<ph id=\"ph1\">`url`</ph>) is the URL that Twilio requests to get instructions on what to do once the call is connected.",
      "pos": [
        8204,
        8325
      ]
    },
    {
      "content": "In this case we set-up a URL (<ph id=\"ph1\">`http://yourdomain.cloudapp.net`</ph>) that returns a simple TwiML document and uses the <ph id=\"ph2\">`&lt;Say&gt;`</ph> verb to do some text-to-speech and say \"Hello Monkey\" to the person recieving the call.",
      "pos": [
        8326,
        8535
      ]
    },
    {
      "pos": [
        8540,
        8600
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"howto_recieve_sms\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Recieve an SMS message"
    },
    {
      "content": "In the previous example we initiated an <bpt id=\"p1\">**</bpt>outgoing<ept id=\"p1\">**</ept> phone call.",
      "pos": [
        8601,
        8665
      ]
    },
    {
      "content": "This time, let's use the phone number that Twilio gave us during sign-up to process an <bpt id=\"p1\">**</bpt>incoming<ept id=\"p1\">**</ept> SMS message.",
      "pos": [
        8666,
        8778
      ]
    },
    {
      "content": "First, log-in to your <bpt id=\"p1\">[</bpt>Twilio dashboard<ept id=\"p1\">][twilio_account]</ept>.",
      "pos": [
        8780,
        8837
      ]
    },
    {
      "content": "Click on \"Numbers\" in the top nav and then click on the Twilio number you were provided.",
      "pos": [
        8838,
        8926
      ]
    },
    {
      "content": "You'll see two URLs that you can configure.",
      "pos": [
        8927,
        8970
      ]
    },
    {
      "content": "A Voice Request URL and an SMS Request URL.",
      "pos": [
        8971,
        9014
      ]
    },
    {
      "content": "These are the URLs that Twilio calls whenever a phone call is made or an SMS is sent to your number.",
      "pos": [
        9015,
        9115
      ]
    },
    {
      "content": "The URLs are also known as \"web hooks\".",
      "pos": [
        9116,
        9155
      ]
    },
    {
      "content": "We would like to process incoming SMS messages, so let's update the URL to <ph id=\"ph1\">`http://yourdomain.cloudapp.net/sms_url`</ph>.",
      "pos": [
        9157,
        9273
      ]
    },
    {
      "content": "Go ahead and click Save Changes at the bottom of the page.",
      "pos": [
        9274,
        9332
      ]
    },
    {
      "content": "Now, back in <ph id=\"ph1\">`web.rb`</ph> let's program our application to handle this:",
      "pos": [
        9333,
        9400
      ]
    },
    {
      "content": "After making the change, make sure to re-start your web app.",
      "pos": [
        9549,
        9609
      ]
    },
    {
      "content": "Now, take out your phone and send an SMS to your Twilio number.",
      "pos": [
        9610,
        9673
      ]
    },
    {
      "content": "You should promptly get an SMS response that says \"Hey, thanks for the ping!",
      "pos": [
        9674,
        9750
      ]
    },
    {
      "content": "Twilio and Azure rock!\".",
      "pos": [
        9751,
        9775
      ]
    },
    {
      "pos": [
        9780,
        9850
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"additional_services\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>How to: Use Additional Twilio Services"
    },
    {
      "content": "In addition to the examples shown here, Twilio offers web-based APIs that you can use to leverage additional Twilio functionality from your Azure application.",
      "pos": [
        9851,
        10009
      ]
    },
    {
      "content": "For full details, see the <bpt id=\"p1\">[</bpt>Twilio API documentation<ept id=\"p1\">] [twilio_api_documentation]</ept>.",
      "pos": [
        10010,
        10090
      ]
    },
    {
      "pos": [
        10096,
        10128
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"NextSteps\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Next Steps"
    },
    {
      "content": "Now that you've learned the basics of the Twilio service, follow these links to learn more:",
      "pos": [
        10129,
        10220
      ]
    },
    {
      "content": "Twilio Security Guidelines",
      "pos": [
        10225,
        10251
      ]
    },
    {
      "content": "Twilio HowTos and Example Code",
      "pos": [
        10285,
        10315
      ]
    },
    {
      "content": "Twilio Quickstart Tutorials",
      "pos": [
        10336,
        10363
      ]
    },
    {
      "content": "Twilio on GitHub",
      "pos": [
        10389,
        10405
      ]
    },
    {
      "content": "Talk to Twilio Support",
      "pos": [
        10429,
        10451
      ]
    },
    {
      "content": "test",
      "pos": [
        11408,
        11412
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"How to Use Twilio for Voice and SMS (Ruby) | Microsoft Azure\" \n    description=\"Learn how to make a phone call and send a SMS message with the Twilio API service on Azure. Code samples written in Ruby.\" \n    services=\"\" \n    documentationCenter=\"ruby\" \n    authors=\"devinrader\" \n    manager=\"twilio\" \n    editor=\"\"/>\n\n<tags \n    ms.service=\"multiple\" \n    ms.workload=\"na\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"ruby\" \n    ms.topic=\"article\" \n    ms.date=\"11/25/2014\" \n    ms.author=\"MicrosoftHelp@twilio.com\"/>\n\n\n\n\n\n# How to Use Twilio for Voice and SMS Capabilities in Ruby\nThis guide demonstrates how to perform common programming tasks with the Twilio API service on Azure. The scenarios covered include making a phone call and sending a Short Message Service (SMS) message. For more information on Twilio and using voice and SMS in your applications, see the [Next Steps](#NextSteps) section.\n\n## <a id=\"WhatIs\"></a>What is Twilio?\nTwilio is a telephony web-service API that lets you use your existing web languages and skills to build voice and SMS applications. Twilio is a third-party service (not an Azure feature and not a Microsoft product).\n\n**Twilio Voice** allows your applications to make and receive phone calls. **Twilio SMS** allows your applications to make and receive SMS messages. **Twilio Client** allows your applications to enable voice communication using existing Internet connections, including mobile connections.\n\n## <a id=\"Pricing\"></a>Twilio Pricing and Special Offers\nInformation about Twilio pricing is available at [Twilio Pricing] [twilio_pricing]. Azure customers receive a [special offer][special_offer]: a free credit of 1000 texts or 1000 inbound minutes. To sign up for this offer or get more information, please visit [http://ahoy.twilio.com/azure][special_offer].  \n\n## <a id=\"Concepts\"></a>Concepts\nThe Twilio API is a RESTful API that provides voice and SMS functionality for applications. Client libraries are available in multiple languages; for a list, see [Twilio API Libraries] [twilio_libraries].\n\n### <a id=\"TwiML\"></a>TwiML\nTwiML is a set of XML-based instructions that inform Twilio of how to process a call or SMS.\n\nAs an example, the following TwiML would convert the text **Hello World** to speech.\n\n    <?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n    <Response>\n       <Say>Hello World</Say>\n    </Response>\n\nAll TwiML documents have `<Response>` as their root element. From there, you use Twilio Verbs to define the behavior of your application.\n\n### <a id=\"Verbs\"></a>TwiML Verbs\nTwilio Verbs are XML tags that tell Twilio what to **do**. For example, the **&lt;Say&gt;** verb instructs Twilio to audibly deliver a message on a call. \n\nThe following is a list of Twilio verbs.\n\n* **&lt;Dial&gt;**: Connects the caller to another phone.\n* **&lt;Gather&gt;**: Collects numeric digits entered on the telephone keypad.\n* **&lt;Hangup&gt;**: Ends a call.\n* **&lt;Play&gt;**: Plays an audio file.\n* **&lt;Pause&gt;**: Waits silently for a specified number of seconds.\n* **&lt;Record&gt;**: Records the caller's voice and returns a URL of a file that contains the recording.\n* **&lt;Redirect&gt;**: Transfers control of a call or SMS to the TwiML at a different URL.\n* **&lt;Reject&gt;**: Rejects an incoming call to your Twilio number without billing you\n* **&lt;Say&gt;**: Converts text to speech that is made on a call.\n* **&lt;Sms&gt;**: Sends an SMS message.\n\nFor more information about Twilio verbs, their attributes, and TwiML, see [TwiML] [twiml]. For additional information about the Twilio API, see [Twilio API] [twilio_api].\n\n## <a id=\"CreateAccount\"></a>Create a Twilio Account\nWhen you're ready to get a Twilio account, sign up at [Try Twilio] [try_twilio]. You can start with a free account, and upgrade your account later.\n\nWhen you sign up for a Twilio account, you'll get a free phone number for your application. You'll also receive an account SID and an auth token. Both will be needed to make Twilio API calls. To prevent unauthorized access to your account, keep your authentication token secure. Your account SID and auth token are viewable at the [Twilio account page][twilio_account], in the fields labeled **ACCOUNT SID** and **AUTH TOKEN**, respectively.\n\n### <a id=\"VerifyPhoneNumbers\"></a>Verify Phone Numbers\nIn addition to the number you are given by Twilio, you can also verify numbers that you control (i.e. your cell phone or home phone number) for use in your applications. \n\nFor information on how to verify a phone number, see [Manage Numbers] [verify_phone].\n\n## <a id=\"create_app\"></a>Create a Ruby Application\nA Ruby application that uses the Twilio service and is running in Azure is no different than any other Ruby application that uses the Twilio service. While Twilio services are RESTful and can be called from Ruby in several ways, this article will focus on how to use Twilio services with [Twilio helper library for Ruby][twilio_ruby].\n\nFirst, [set-up a new Azure Linux VM][azure_vm_setup] to act as a host for your new Ruby web application. Ignore the steps involving the creation of a Rails app, just set-up the VM. Make sure you create an Endpoint with an external port of 80 and an internal port of 5000.\n\nIn the examples below, we will be using [Sinatra][sinatra], a very simple web framework for Ruby. But you can certainly use the Twilio helper library for Ruby with any other web framework, including Ruby on Rails.\n\nSSH into your new VM and create a directory for your new app. Inside that directory, create a file called Gemfile and copy the following code into it:\n\n    source 'https://rubygems.org'\n    gem 'sinatra'\n    gem 'thin'\n\nOn the command line run `bundle install`. This will install the dependencies above. Next create a file called `web.rb`. This will be where the code for your web app lives. Paste the following code into it:\n\n    require 'sinatra'\n\n    get '/' do\n        \"Hello Monkey!\"\n    end\n\nAt this point you should be able the run the command `ruby web.rb -p 5000`. This will spin-up a small web server on port 5000. You should be able to browse to this app in your browser by visiting the URL you set-up for your Azure VM. Once you can reach your web app in the browser, you're ready to start building a Twilio app.\n\n## <a id=\"configure_app\"></a>Configure Your Application to Use Twilio\nYou can configure your web app to use the Twilio library by updating your `Gemfile` to include this line:\n\n    gem 'twilio-ruby'\n\nOn the command line, run `bundle install`. Now open `web.rb` and including this line at the top:\n\n    require 'twilio-ruby'\n\nYou're now all set to use the Twilio helper library for Ruby in your web app.\n\n## <a id=\"howto_make_call\"></a>How to: Make an outgoing call\nThe following shows how to make an outgoing call. Key concepts include using the Twilio helper library for Ruby to make REST API calls and rendering TwiML. Substitute your values for the **From** and **To** phone numbers, and ensure that you verify the **From** phone number for your Twilio account prior to running the code.\n\nAdd this function to `web.md`:\n\n    # Set your account ID and authentication token.\n    sid = \"your_twilio_account_sid\";\n    token = \"your_twilio_authentication_token\";\n\n    # The number of the phone initiating the the call.\n    # This should either be a Twilio number or a number that you've verified\n    from = \"NNNNNNNNNNN\";\n\n    # The number of the phone receiving call.\n    to = \"NNNNNNNNNNN\";\n\n    # Use the Twilio-provided site for the TwiML response.\n    url = \"http://yourdomain.cloudapp.net/voice_url\";\n      \n    get '/make_call' do\n      # Create the call client.\n      client = Twilio::REST::Client.new(sid, token);\n      \n      # Make the call\n      client.account.calls.create(to: to, from: from, url: url)\n    end\n\n    post '/voice_url' do\n      \"<Response>\n         <Say>Hello Monkey!</Say>\n       </Response>\"\n    end\n    \nIf you open-up `http://yourdomain.cloudapp.net/make_call` in a browser, that will trigger the call to the Twilio API to make the phone call. The first two parameters in `client.account.calls.create` are fairly self-explanatory: the number the call is `from` and the number the call is `to`. \n\nThe third parameter (`url`) is the URL that Twilio requests to get instructions on what to do once the call is connected. In this case we set-up a URL (`http://yourdomain.cloudapp.net`) that returns a simple TwiML document and uses the `<Say>` verb to do some text-to-speech and say \"Hello Monkey\" to the person recieving the call.\n\n## <a id=\"howto_recieve_sms\"></a>How to: Recieve an SMS message\nIn the previous example we initiated an **outgoing** phone call. This time, let's use the phone number that Twilio gave us during sign-up to process an **incoming** SMS message.\n\nFirst, log-in to your [Twilio dashboard][twilio_account]. Click on \"Numbers\" in the top nav and then click on the Twilio number you were provided. You'll see two URLs that you can configure. A Voice Request URL and an SMS Request URL. These are the URLs that Twilio calls whenever a phone call is made or an SMS is sent to your number. The URLs are also known as \"web hooks\".\n\nWe would like to process incoming SMS messages, so let's update the URL to `http://yourdomain.cloudapp.net/sms_url`. Go ahead and click Save Changes at the bottom of the page. Now, back in `web.rb` let's program our application to handle this:\n\n    post '/sms_url' do\n      \"<Response>\n         <Message>Hey, thanks for the ping! Twilio and Azure rock!</Message>\n       </Response>\"\n    end\n\nAfter making the change, make sure to re-start your web app. Now, take out your phone and send an SMS to your Twilio number. You should promptly get an SMS response that says \"Hey, thanks for the ping! Twilio and Azure rock!\".\n\n## <a id=\"additional_services\"></a>How to: Use Additional Twilio Services\nIn addition to the examples shown here, Twilio offers web-based APIs that you can use to leverage additional Twilio functionality from your Azure application. For full details, see the [Twilio API documentation] [twilio_api_documentation].\n\n### <a id=\"NextSteps\"></a>Next Steps\nNow that you've learned the basics of the Twilio service, follow these links to learn more:\n\n* [Twilio Security Guidelines] [twilio_security_guidelines]\n* [Twilio HowTos and Example Code] [twilio_howtos]\n* [Twilio Quickstart Tutorials][twilio_quickstarts] \n* [Twilio on GitHub] [twilio_on_github]\n* [Talk to Twilio Support] [twilio_support]\n\n[twilio_ruby]: https://www.twilio.com/docs/ruby/install\n\n\n\n\n\n[twilio_pricing]: http://www.twilio.com/pricing\n[special_offer]: http://ahoy.twilio.com/azure\n[twilio_libraries]: https://www.twilio.com/docs/libraries\n[twiml]: http://www.twilio.com/docs/api/twiml\n[twilio_api]: http://www.twilio.com/api\n[try_twilio]: https://www.twilio.com/try-twilio\n[twilio_account]:  https://www.twilio.com/user/account\n[verify_phone]: https://www.twilio.com/user/account/phone-numbers/verified#\n[twilio_api_documentation]: http://www.twilio.com/api\n[twilio_security_guidelines]: http://www.twilio.com/docs/security\n[twilio_howtos]: http://www.twilio.com/docs/howto\n[twilio_on_github]: https://github.com/twilio\n[twilio_support]: http://www.twilio.com/help/contact\n[twilio_quickstarts]: http://www.twilio.com/docs/quickstart\n[sinatra]: http://www.sinatrarb.com/\n[azure_vm_setup]: http://www.windowsazure.com/develop/ruby/tutorials/web-app-with-linux-vm/\n\ntest\n"
}