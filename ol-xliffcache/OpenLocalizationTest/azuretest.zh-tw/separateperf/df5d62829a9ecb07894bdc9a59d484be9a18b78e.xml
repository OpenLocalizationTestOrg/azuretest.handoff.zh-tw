{
  "nodes": [
    {
      "content": "Get started with Application Insights in a Java web project | Microsoft Azure",
      "pos": [
        27,
        104
      ]
    },
    {
      "content": "Monitor performance and usage of your Java website with Application Insights",
      "pos": [
        123,
        199
      ]
    },
    {
      "content": "Get started with Application Insights in a Java web project",
      "pos": [
        522,
        581
      ]
    },
    {
      "content": "Application Insights is in Preview.",
      "pos": [
        584,
        619
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>Application Insights<ept id=\"p1\">](https://azure.microsoft.com/services/application-insights/)</ept> is an extensible analytics service that helps you understand the performance and usage of your live application.",
      "pos": [
        728,
        923
      ]
    },
    {
      "content": "Use it to <bpt id=\"p1\">[</bpt>detect and diagnose performance issues and exceptions<ept id=\"p1\">](app-insights-detect-triage-diagnose.md)</ept>, and [write code][api] to track what users do with your app.",
      "pos": [
        924,
        1090
      ]
    },
    {
      "content": "sample data",
      "pos": [
        1094,
        1105
      ]
    },
    {
      "content": "[Application Insights web tests][availability] monitor your application's availability.",
      "pos": [
        1161,
        1248
      ]
    },
    {
      "content": "You'll need:",
      "pos": [
        1250,
        1262
      ]
    },
    {
      "content": "Oracle JRE 1.6 or later, or Zulu JRE 1.6 or later",
      "pos": [
        1266,
        1315
      ]
    },
    {
      "content": "A subscription to <bpt id=\"p1\">[</bpt>Microsoft Azure<ept id=\"p1\">](http://azure.microsoft.com/)</ept>.",
      "pos": [
        1318,
        1383
      ]
    },
    {
      "content": "(You could start with the <bpt id=\"p1\">[</bpt>free trial<ept id=\"p1\">](http://azure.microsoft.com/pricing/free-trial/)</ept>.)",
      "pos": [
        1384,
        1472
      ]
    },
    {
      "content": "If you have a web app that's already live, you could follow the alternative procedure to <bpt id=\"p1\">[</bpt>add the SDK at runtime in the web server<ept id=\"p1\">](app-insights-java-live.md)</ept>.",
      "pos": [
        1475,
        1634
      ]
    },
    {
      "content": "That alternative avoids rebuilding the code, but you don't get the option to write code to track user activity.",
      "pos": [
        1635,
        1746
      ]
    },
    {
      "content": "1. Get an Application Insights instrumentation key",
      "pos": [
        1753,
        1803
      ]
    },
    {
      "pos": [
        1808,
        1874
      ],
      "content": "Sign in to the <bpt id=\"p1\">[</bpt>Microsoft Azure Portal<ept id=\"p1\">](https://portal.azure.com)</ept>."
    },
    {
      "content": "Create a new Application Insights resource.",
      "pos": [
        1878,
        1921
      ]
    },
    {
      "content": "Click + and choose Application Insights",
      "pos": [
        1929,
        1968
      ]
    },
    {
      "content": "Set the application type to Java web application.",
      "pos": [
        2026,
        2075
      ]
    },
    {
      "content": "Fill a name, choose Java web app, and click Create",
      "pos": [
        2083,
        2133
      ]
    },
    {
      "content": "Find the instrumentation key of the new resource.",
      "pos": [
        2191,
        2240
      ]
    },
    {
      "content": "You'll need to paste this into your code project shortly.",
      "pos": [
        2241,
        2298
      ]
    },
    {
      "content": "In the new resource overview, click Properties and copy the Instrumentation Key",
      "pos": [
        2306,
        2385
      ]
    },
    {
      "content": "2. Add the Application Insights SDK for Java to your project",
      "pos": [
        2441,
        2501
      ]
    },
    {
      "content": "Choose the appropriate way for your project.",
      "pos": [
        2504,
        2548
      ]
    },
    {
      "content": "If you're creating a Dynamic Web project in Eclipse...",
      "pos": [
        2556,
        2610
      ]
    },
    {
      "content": "Use the [Application Insights SDK for Java plug-in][eclipse].",
      "pos": [
        2612,
        2673
      ]
    },
    {
      "content": "If you're using Maven...",
      "pos": [
        2680,
        2704
      ]
    },
    {
      "content": "If your project is already set up to use Maven for build, merge the following code to your pom.xml file.",
      "pos": [
        2706,
        2810
      ]
    },
    {
      "content": "Then, refresh the project dependencies to get the binaries downloaded.",
      "pos": [
        2812,
        2882
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>Build or checksum validation errors?<ept id=\"p1\">*</ept> Try using a specific version, such as: <ph id=\"ph1\">`&lt;version&gt;1.0.n&lt;/version&gt;`</ph>.",
      "pos": [
        3352,
        3457
      ]
    },
    {
      "content": "You'll find the latest version in the <bpt id=\"p1\">[</bpt>SDK release notes<ept id=\"p1\">](app-insights-release-notes-java.md)</ept> or in our <bpt id=\"p2\">[</bpt>Maven artifacts<ept id=\"p2\">](http://search.maven.org/#search%7Cga%7C1%7Capplicationinsights)</ept>.",
      "pos": [
        3458,
        3644
      ]
    },
    {
      "pos": [
        3647,
        3714
      ],
      "content": "<bpt id=\"p1\">*</bpt>Need to update to a new SDK?<ept id=\"p1\">*</ept> Refresh your project's dependencies."
    },
    {
      "content": "If you're using Gradle...",
      "pos": [
        3721,
        3746
      ]
    },
    {
      "content": "If your project is already set up to use Gradle for build, merge the following code to your build.gradle file.",
      "pos": [
        3748,
        3858
      ]
    },
    {
      "content": "Then refresh the project dependencies to get the binaries downloaded.",
      "pos": [
        3860,
        3929
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>Build or checksum validation errors? Try using a specific version, such as:<ept id=\"p1\">*</ept> <ph id=\"ph1\">`version:'1.0.n'`</ph>.",
      "pos": [
        4148,
        4244
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>You'll find the latest version in the <bpt id=\"p2\">[</bpt>SDK release notes<ept id=\"p2\">](app-insights-release-notes-java.md)</ept>.<ept id=\"p1\">*</ept>",
      "pos": [
        4245,
        4341
      ]
    },
    {
      "content": "To update to a new SDK",
      "pos": [
        4345,
        4367
      ]
    },
    {
      "content": "Refresh your project's dependencies.",
      "pos": [
        4372,
        4408
      ]
    },
    {
      "content": "Otherwise ...",
      "pos": [
        4415,
        4428
      ]
    },
    {
      "content": "Manually add the SDK:",
      "pos": [
        4430,
        4451
      ]
    },
    {
      "pos": [
        4456,
        4573
      ],
      "content": "Download the <bpt id=\"p1\">[</bpt>Application Insights SDK for Java<ept id=\"p1\">](http://dl.windowsazure.com/lib/applicationinsights/javabin/sdk.zip)</ept>."
    },
    {
      "content": "Extract the binaries from the zip file and add them to your project.",
      "pos": [
        4577,
        4645
      ]
    },
    {
      "content": "Questions...",
      "pos": [
        4651,
        4663
      ]
    },
    {
      "pos": [
        4668,
        4745
      ],
      "content": "What's the relationship between the <ph id=\"ph1\">`-core`</ph> and <ph id=\"ph2\">`-web`</ph> components in the zip?"
    },
    {
      "content": "<ph id=\"ph1\">`applicationinsights-core`</ph> gives you the bare API.",
      "pos": [
        4751,
        4801
      ]
    },
    {
      "content": "You always need this.",
      "pos": [
        4802,
        4823
      ]
    },
    {
      "content": "<ph id=\"ph1\">`applicationinsights-web`</ph> gives you metrics that track HTTP request counts and response times.",
      "pos": [
        4827,
        4921
      ]
    },
    {
      "content": "You can omit this if you don't want this telemetry automatically collected.",
      "pos": [
        4922,
        4997
      ]
    },
    {
      "content": "For example, if you want to write your own.",
      "pos": [
        4998,
        5041
      ]
    },
    {
      "content": "To update the SDK when we publish changes",
      "pos": [
        5046,
        5087
      ]
    },
    {
      "pos": [
        5092,
        5241
      ],
      "content": "Download the latest <bpt id=\"p1\">[</bpt>Application Insights SDK for Java<ept id=\"p1\">](http://dl.windowsazure.com/lib/applicationinsights/javabin/sdk.zip)</ept> and replace the old ones."
    },
    {
      "pos": [
        5245,
        5330
      ],
      "content": "Changes are described in the <bpt id=\"p1\">[</bpt>SDK release notes<ept id=\"p1\">](app-insights-release-notes-java.md)</ept>."
    },
    {
      "content": "3. Add an Application Insights .xml file",
      "pos": [
        5337,
        5377
      ]
    },
    {
      "content": "Add ApplicationInsights.xml to the resources folder in your project, or make sure it is added to your project’s deployment class path.",
      "pos": [
        5379,
        5513
      ]
    },
    {
      "content": "Copy the following XML into it.",
      "pos": [
        5514,
        5545
      ]
    },
    {
      "content": "Substitute the instrumentation key that you got from the Azure portal.",
      "pos": [
        5547,
        5617
      ]
    },
    {
      "content": "The instrumentation key is sent along with every item of telemetry and tells Application Insights to display it in your resource.",
      "pos": [
        7195,
        7324
      ]
    },
    {
      "content": "The HTTP Request component is optional.",
      "pos": [
        7327,
        7366
      ]
    },
    {
      "content": "It automatically sends telemetry about requests and response times to the portal.",
      "pos": [
        7367,
        7448
      ]
    },
    {
      "content": "Events correlation is an addition to the HTTP request component.",
      "pos": [
        7451,
        7515
      ]
    },
    {
      "content": "It assigns an identifier to each request received by the server, and adds this as a property to every item of telemetry as the property 'Operation.Id'.",
      "pos": [
        7516,
        7667
      ]
    },
    {
      "content": "It allows you to correlate the telemetry associated with each request by setting a filter in [diagnostic search][diagnostic].",
      "pos": [
        7668,
        7793
      ]
    },
    {
      "content": "4. Add an HTTP filter",
      "pos": [
        7798,
        7819
      ]
    },
    {
      "content": "The last configuration step allows the HTTP request component to log each web request.",
      "pos": [
        7821,
        7907
      ]
    },
    {
      "content": "(Not required if you just want the bare API.)",
      "pos": [
        7908,
        7953
      ]
    },
    {
      "content": "Locate and open the web.xml file in your project, and merge the following code under the web-app node, where your application filters are configured.",
      "pos": [
        7955,
        8104
      ]
    },
    {
      "content": "To get the most accurate results, the filter should be mapped before all other filters.",
      "pos": [
        8106,
        8193
      ]
    },
    {
      "content": "If you're using MVC 3.1 or later",
      "pos": [
        8556,
        8588
      ]
    },
    {
      "content": "Edit these elements to include the Application Insights package:",
      "pos": [
        8590,
        8654
      ]
    },
    {
      "content": "If you're using Struts 2",
      "pos": [
        9022,
        9046
      ]
    },
    {
      "content": "Add this item to the Struts configuration file (usually named struts.xml or struts-default.xml):",
      "pos": [
        9048,
        9144
      ]
    },
    {
      "content": "(If you have interceptors defined in a default stack, the interceptor can simply be added to that stack.)",
      "pos": [
        9418,
        9523
      ]
    },
    {
      "content": "5. Install on the server",
      "pos": [
        9528,
        9552
      ]
    },
    {
      "content": "On Windows servers, install:",
      "pos": [
        9554,
        9582
      ]
    },
    {
      "content": "Microsoft Visual C++ Redistributable",
      "pos": [
        9587,
        9623
      ]
    },
    {
      "content": "(This enables performance counters.)",
      "pos": [
        9683,
        9719
      ]
    },
    {
      "content": "6. Run your application",
      "pos": [
        9724,
        9747
      ]
    },
    {
      "content": "Either run it in debug mode on your development machine, or publish to your server.",
      "pos": [
        9749,
        9832
      ]
    },
    {
      "content": "7. View your telemetry in Application Insights",
      "pos": [
        9837,
        9883
      ]
    },
    {
      "pos": [
        9885,
        9984
      ],
      "content": "Return to your Application Insights resource in <bpt id=\"p1\">[</bpt>Microsoft Azure Portal<ept id=\"p1\">](https://portal.azure.com)</ept>."
    },
    {
      "content": "HTTP requests data will appear on the overview blade.",
      "pos": [
        9986,
        10039
      ]
    },
    {
      "content": "(If it isn't there, wait a few seconds and then click Refresh.)",
      "pos": [
        10040,
        10103
      ]
    },
    {
      "content": "sample data",
      "pos": [
        10107,
        10118
      ]
    },
    {
      "content": "Click through any chart to see more detailed metrics.",
      "pos": [
        10175,
        10228
      ]
    },
    {
      "content": "And when viewing the properties of a request, you can see the telemetry events associated with it such as requests and exceptions.",
      "pos": [
        10291,
        10421
      ]
    },
    {
      "content": "[Learn more about metrics.][metrics]",
      "pos": [
        10484,
        10520
      ]
    },
    {
      "content": "Smart address name calculation",
      "pos": [
        10527,
        10557
      ]
    },
    {
      "pos": [
        10559,
        10665
      ],
      "content": "Application Insights assumes the format of HTTP requests for MVC applications is: <ph id=\"ph1\">`VERB controller/action`</ph>"
    },
    {
      "pos": [
        10668,
        10810
      ],
      "content": "For example, <ph id=\"ph1\">`GET Home/Product/f9anuh81`</ph>, <ph id=\"ph2\">`GET Home/Product/2dffwrf5`</ph> and <ph id=\"ph3\">`GET Home/Product/sdf96vws`</ph> will be grouped into <ph id=\"ph4\">`GET Home/Product`</ph>."
    },
    {
      "content": "This enables meaningful aggregations of requests, such as number of requests and average execution time for requests.",
      "pos": [
        10812,
        10929
      ]
    },
    {
      "content": "Exceptions and request failures",
      "pos": [
        10934,
        10965
      ]
    },
    {
      "content": "Unhandled exceptions are collected:",
      "pos": [
        10967,
        11002
      ]
    },
    {
      "content": "To collect data on other exceptions, you have two options:",
      "pos": [
        11066,
        11124
      ]
    },
    {
      "content": "[Insert calls to TrackException in your code][apiexceptions].",
      "pos": [
        11128,
        11189
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>Install the Java Agent on your server<ept id=\"p1\">](app-insights-java-agent.md)</ept>.",
      "pos": [
        11192,
        11260
      ]
    },
    {
      "content": "You specify the methods you want to watch.",
      "pos": [
        11261,
        11303
      ]
    },
    {
      "content": "Monitor method calls and external dependencies",
      "pos": [
        11309,
        11355
      ]
    },
    {
      "pos": [
        11357,
        11490
      ],
      "content": "<bpt id=\"p1\">[</bpt>Install the Java Agent<ept id=\"p1\">](app-insights-java-agent.md)</ept> to log specified internal methods and calls made through JDBC, with timing data."
    },
    {
      "content": "Performance counters",
      "pos": [
        11496,
        11516
      ]
    },
    {
      "pos": [
        11518,
        11593
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept> tile, and you'll see a range of performance counters."
    },
    {
      "content": "Customize performance counter collection",
      "pos": [
        11665,
        11705
      ]
    },
    {
      "content": "To disable collection of the standard set of performance counters, add the following code under the root node of the ApplicationInsights.xml file:",
      "pos": [
        11707,
        11853
      ]
    },
    {
      "content": "Collect additional performance counters",
      "pos": [
        11951,
        11990
      ]
    },
    {
      "content": "You can specify additional performance counters to be collected.",
      "pos": [
        11992,
        12056
      ]
    },
    {
      "content": "JMX counters (exposed by the Java Virtual Machine)",
      "pos": [
        12063,
        12113
      ]
    },
    {
      "pos": [
        12458,
        12528
      ],
      "content": "<ph id=\"ph1\">`displayName`</ph> – The name displayed in the Application Insights portal."
    },
    {
      "pos": [
        12533,
        12568
      ],
      "content": "<ph id=\"ph1\">`objectName`</ph> – The JMX object name."
    },
    {
      "pos": [
        12573,
        12632
      ],
      "content": "<ph id=\"ph1\">`attribute`</ph> – The attribute of the JMX object name to fetch"
    },
    {
      "pos": [
        12637,
        12692
      ],
      "content": "<ph id=\"ph1\">`type`</ph> (optional) - The type of JMX object’s attribute:"
    },
    {
      "content": "Default: a simple type such as int or long.",
      "pos": [
        12697,
        12740
      ]
    },
    {
      "pos": [
        12745,
        12816
      ],
      "content": "<ph id=\"ph1\">`composite`</ph>: the perf counter data is in the format of 'Attribute.Data'"
    },
    {
      "pos": [
        12821,
        12885
      ],
      "content": "<ph id=\"ph1\">`tabular`</ph>: the perf counter data is in the format of a table row"
    },
    {
      "content": "Windows performance counters",
      "pos": [
        12894,
        12922
      ]
    },
    {
      "content": "Each <bpt id=\"p1\">[</bpt>Windows performance counter<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa373083.aspx)</ept> is a member of a category (in the same way that a field is a member of a class).",
      "pos": [
        12924,
        13105
      ]
    },
    {
      "content": "Categories can either be global, or can have numbered or named instances.",
      "pos": [
        13106,
        13179
      ]
    },
    {
      "content": "displayName – The name displayed in the Application Insights portal.",
      "pos": [
        13525,
        13593
      ]
    },
    {
      "content": "categoryName – The performance counter category (performance object) with which this performance counter is associated.",
      "pos": [
        13598,
        13717
      ]
    },
    {
      "content": "counterName – The name of the performance counter.",
      "pos": [
        13722,
        13772
      ]
    },
    {
      "content": "instanceName – The name of the performance counter category instance, or an empty string (\"\"), if the category contains a single instance.",
      "pos": [
        13777,
        13915
      ]
    },
    {
      "content": "If the categoryName is Process, and the performance counter you'd like to collect is from the current JVM process on which your app is running, specify <ph id=\"ph1\">`\"__SELF__\"`</ph>.",
      "pos": [
        13916,
        14081
      ]
    },
    {
      "content": "Your performance counters are visible as custom metrics in [Metrics Explorer][metrics].",
      "pos": [
        14083,
        14170
      ]
    },
    {
      "content": "Unix performance counters",
      "pos": [
        14241,
        14266
      ]
    },
    {
      "pos": [
        14270,
        14406
      ],
      "content": "<bpt id=\"p1\">[</bpt>Install collectd with the Application Insights plugin<ept id=\"p1\">](app-insights-java-collectd.md)</ept> to get a wide variety of system and network data."
    },
    {
      "content": "Get user and session data",
      "pos": [
        14411,
        14436
      ]
    },
    {
      "content": "OK, you're sending telemetry from your web server.",
      "pos": [
        14438,
        14488
      ]
    },
    {
      "content": "Now to get the full 360-degree view of your application, you can add more monitoring:",
      "pos": [
        14489,
        14574
      ]
    },
    {
      "content": "[Add telemetry to your web pages][usage] to monitor page views and user metrics.",
      "pos": [
        14578,
        14658
      ]
    },
    {
      "content": "[Set up web tests][availability] to make sure your application stays live and responsive.",
      "pos": [
        14661,
        14750
      ]
    },
    {
      "content": "Capture log traces",
      "pos": [
        14755,
        14773
      ]
    },
    {
      "content": "You can use Application Insights to slice and dice logs from Log4J, Logback or other logging frameworks.",
      "pos": [
        14775,
        14879
      ]
    },
    {
      "content": "You can correlate the logs with HTTP requests and other telemetry.",
      "pos": [
        14880,
        14946
      ]
    },
    {
      "content": "[Learn how][javalogs].",
      "pos": [
        14947,
        14969
      ]
    },
    {
      "content": "Send your own telemetry",
      "pos": [
        14974,
        14997
      ]
    },
    {
      "content": "Now that you've installed the SDK, you can use the API to send your own telemetry.",
      "pos": [
        14999,
        15081
      ]
    },
    {
      "content": "[Track custom events and metrics][api] to learn what users are doing with your application.",
      "pos": [
        15085,
        15176
      ]
    },
    {
      "content": "[Search events and logs][diagnostic] to help diagnose problems.",
      "pos": [
        15179,
        15242
      ]
    },
    {
      "content": "Questions?",
      "pos": [
        15252,
        15262
      ]
    },
    {
      "content": "Problems?",
      "pos": [
        15263,
        15272
      ]
    },
    {
      "content": "Troubleshooting Java",
      "pos": [
        15275,
        15295
      ]
    },
    {
      "content": "test",
      "pos": [
        15762,
        15766
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Get started with Application Insights in a Java web project | Microsoft Azure\"\n    description=\"Monitor performance and usage of your Java website with Application Insights\"\n    services=\"application-insights\"\n    documentationCenter=\"java\"\n    authors=\"alancameronwills\"\n    manager=\"douge\"/>\n\n<tags\n    ms.service=\"application-insights\"\n    ms.workload=\"tbd\"\n    ms.tgt_pltfrm=\"ibiza\"\n    ms.devlang=\"na\"\n    ms.topic=\"get-started-article\"\n    ms.date=\"06/30/2015\"\n    ms.author=\"awills\"/>\n\n# Get started with Application Insights in a Java web project\n\n*Application Insights is in Preview.*\n\n[AZURE.INCLUDE [app-insights-selector-get-started](../../includes/app-insights-selector-get-started.md)]\n\n[Application Insights](https://azure.microsoft.com/services/application-insights/) is an extensible analytics service that helps you understand the performance and usage of your live application. Use it to [detect and diagnose performance issues and exceptions](app-insights-detect-triage-diagnose.md), and [write code][api] to track what users do with your app.\n\n![sample data](./media/app-insights-java-get-started/5-results.png)\n\n[Application Insights web tests][availability] monitor your application's availability.\n\nYou'll need:\n\n* Oracle JRE 1.6 or later, or Zulu JRE 1.6 or later\n* A subscription to [Microsoft Azure](http://azure.microsoft.com/). (You could start with the [free trial](http://azure.microsoft.com/pricing/free-trial/).)\n\n*If you have a web app that's already live, you could follow the alternative procedure to [add the SDK at runtime in the web server](app-insights-java-live.md). That alternative avoids rebuilding the code, but you don't get the option to write code to track user activity.*\n\n\n## 1. Get an Application Insights instrumentation key\n\n1. Sign in to the [Microsoft Azure Portal](https://portal.azure.com).\n2. Create a new Application Insights resource.\n\n    ![Click + and choose Application Insights](./media/app-insights-java-get-started/01-create.png)\n3. Set the application type to Java web application.\n\n    ![Fill a name, choose Java web app, and click Create](./media/app-insights-java-get-started/02-create.png)\n4. Find the instrumentation key of the new resource. You'll need to paste this into your code project shortly.\n\n    ![In the new resource overview, click Properties and copy the Instrumentation Key](./media/app-insights-java-get-started/03-key.png)\n\n## 2. Add the Application Insights SDK for Java to your project\n\n*Choose the appropriate way for your project.*\n\n#### If you're creating a Dynamic Web project in Eclipse...\n\nUse the [Application Insights SDK for Java plug-in][eclipse].\n\n#### If you're using Maven...\n\nIf your project is already set up to use Maven for build, merge the following code to your pom.xml file.\n\nThen, refresh the project dependencies to get the binaries downloaded.\n\n    <repositories>\n       <repository>\n          <id>central</id>\n          <name>Central</name>\n          <url>http://repo1.maven.org/maven2</url>\n       </repository>\n    </repositories>\n\n    <dependencies>\n      <dependency>\n        <groupId>com.microsoft.azure</groupId>\n        <artifactId>applicationinsights-web</artifactId>\n        <!-- or applicationinsights-core for bare API -->\n        <version>[1.0,)</version>\n      </dependency>\n    </dependencies>\n\n\n* *Build or checksum validation errors?* Try using a specific version, such as: `<version>1.0.n</version>`. You'll find the latest version in the [SDK release notes](app-insights-release-notes-java.md) or in our [Maven artifacts](http://search.maven.org/#search%7Cga%7C1%7Capplicationinsights).\n* *Need to update to a new SDK?* Refresh your project's dependencies.\n\n#### If you're using Gradle...\n\nIf your project is already set up to use Gradle for build, merge the following code to your build.gradle file.\n\nThen refresh the project dependencies to get the binaries downloaded.\n\n    repositories {\n      mavenCentral()\n    }\n\n    dependencies {\n      compile group: 'com.microsoft.azure', name: 'applicationinsights-web', version: '1.+'\n      // or applicationinsights-core for bare API\n    }\n\n* *Build or checksum validation errors? Try using a specific version, such as:* `version:'1.0.n'`. *You'll find the latest version in the [SDK release notes](app-insights-release-notes-java.md).*\n* *To update to a new SDK*\n * Refresh your project's dependencies.\n\n#### Otherwise ...\n\nManually add the SDK:\n\n1. Download the [Application Insights SDK for Java](http://dl.windowsazure.com/lib/applicationinsights/javabin/sdk.zip).\n2. Extract the binaries from the zip file and add them to your project.\n\n### Questions...\n\n* *What's the relationship between the `-core` and `-web` components in the zip?*\n\n * `applicationinsights-core` gives you the bare API. You always need this.\n * `applicationinsights-web` gives you metrics that track HTTP request counts and response times. You can omit this if you don't want this telemetry automatically collected. For example, if you want to write your own.\n\n* *To update the SDK when we publish changes*\n * Download the latest [Application Insights SDK for Java](http://dl.windowsazure.com/lib/applicationinsights/javabin/sdk.zip) and replace the old ones.\n * Changes are described in the [SDK release notes](app-insights-release-notes-java.md).\n\n\n\n## 3. Add an Application Insights .xml file\n\nAdd ApplicationInsights.xml to the resources folder in your project, or make sure it is added to your project’s deployment class path. Copy the following XML into it.\n\nSubstitute the instrumentation key that you got from the Azure portal.\n\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <ApplicationInsights xmlns=\"http://schemas.microsoft.com/ApplicationInsights/2013/Settings\" schemaVersion=\"2014-05-30\">\n\n\n      <!-- The key from the portal: -->\n\n      <InstrumentationKey>** Your instrumentation key **</InstrumentationKey>\n\n\n      <!-- HTTP request component (not required for bare API) -->\n\n      <TelemetryModules>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.modules.WebRequestTrackingTelemetryModule\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.modules.WebSessionTrackingTelemetryModule\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.modules.WebUserTrackingTelemetryModule\"/>\n      </TelemetryModules>\n\n      <!-- Events correlation (not required for bare API) -->\n      <!-- These initializers add context data to each event -->\n\n      <TelemetryInitializers>\n        <Add   type=\"com.microsoft.applicationinsights.web.extensibility.initializers.WebOperationIdTelemetryInitializer\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.initializers.WebOperationNameTelemetryInitializer\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.initializers.WebSessionTelemetryInitializer\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.initializers.WebUserTelemetryInitializer\"/>\n        <Add type=\"com.microsoft.applicationinsights.web.extensibility.initializers.WebUserAgentTelemetryInitializer\"/>\n\n      </TelemetryInitializers>\n    </ApplicationInsights>\n\n\n* The instrumentation key is sent along with every item of telemetry and tells Application Insights to display it in your resource.\n* The HTTP Request component is optional. It automatically sends telemetry about requests and response times to the portal.\n* Events correlation is an addition to the HTTP request component. It assigns an identifier to each request received by the server, and adds this as a property to every item of telemetry as the property 'Operation.Id'. It allows you to correlate the telemetry associated with each request by setting a filter in [diagnostic search][diagnostic].\n\n## 4. Add an HTTP filter\n\nThe last configuration step allows the HTTP request component to log each web request. (Not required if you just want the bare API.)\n\nLocate and open the web.xml file in your project, and merge the following code under the web-app node, where your application filters are configured.\n\nTo get the most accurate results, the filter should be mapped before all other filters.\n\n    <filter>\n      <filter-name>ApplicationInsightsWebFilter</filter-name>\n      <filter-class>\n        com.microsoft.applicationinsights.web.internal.WebRequestTrackingFilter\n      </filter-class>\n    </filter>\n    <filter-mapping>\n       <filter-name>ApplicationInsightsWebFilter</filter-name>\n       <url-pattern>/*</url-pattern>\n    </filter-mapping>\n\n#### If you're using MVC 3.1 or later\n\nEdit these elements to include the Application Insights package:\n\n    <context:component-scan base-package=\" com.springapp.mvc, com.microsoft.applicationinsights.web.spring\"/>\n\n    <mvc:interceptors>\n        <mvc:interceptor>\n            <mvc:mapping path=\"/**\"/>\n            <bean class=\"com.microsoft.applicationinsights.web.spring.RequestNameHandlerInterceptorAdapter\" />\n        </mvc:interceptor>\n    </mvc:interceptors>\n\n#### If you're using Struts 2\n\nAdd this item to the Struts configuration file (usually named struts.xml or struts-default.xml):\n\n     <interceptors>\n       <interceptor name=\"ApplicationInsightsRequestNameInterceptor\" class=\"com.microsoft.applicationinsights.web.struts.RequestNameInterceptor\" />\n     </interceptors>\n     <default-interceptor-ref name=\"ApplicationInsightsRequestNameInterceptor\" />\n\n(If you have interceptors defined in a default stack, the interceptor can simply be added to that stack.)\n\n## 5. Install on the server\n\nOn Windows servers, install:\n\n* [Microsoft Visual C++ Redistributable](http://www.microsoft.com/download/details.aspx?id=40784)\n\n(This enables performance counters.)\n\n## 6. Run your application\n\nEither run it in debug mode on your development machine, or publish to your server.\n\n## 7. View your telemetry in Application Insights\n\nReturn to your Application Insights resource in [Microsoft Azure Portal](https://portal.azure.com).\n\nHTTP requests data will appear on the overview blade. (If it isn't there, wait a few seconds and then click Refresh.)\n\n![sample data](./media/app-insights-java-get-started/5-results.png)\n\n\nClick through any chart to see more detailed metrics.\n\n![](./media/app-insights-java-get-started/6-barchart.png)\n\n\n\nAnd when viewing the properties of a request, you can see the telemetry events associated with it such as requests and exceptions.\n\n![](./media/app-insights-java-get-started/7-instance.png)\n\n\n\n[Learn more about metrics.][metrics]\n\n#### Smart address name calculation\n\nApplication Insights assumes the format of HTTP requests for MVC applications is: `VERB controller/action`\n\n\nFor example, `GET Home/Product/f9anuh81`, `GET Home/Product/2dffwrf5` and `GET Home/Product/sdf96vws` will be grouped into `GET Home/Product`.\n\nThis enables meaningful aggregations of requests, such as number of requests and average execution time for requests.\n\n## Exceptions and request failures\n\nUnhandled exceptions are collected:\n\n![](./media/app-insights-java-get-started/21-exceptions.png)\n\nTo collect data on other exceptions, you have two options:\n\n* [Insert calls to TrackException in your code][apiexceptions].\n* [Install the Java Agent on your server](app-insights-java-agent.md). You specify the methods you want to watch.\n\n\n## Monitor method calls and external dependencies\n\n[Install the Java Agent](app-insights-java-agent.md) to log specified internal methods and calls made through JDBC, with timing data.\n\n\n## Performance counters\n\nClick the **Servers** tile, and you'll see a range of performance counters.\n\n\n![](./media/app-insights-java-get-started/11-perf-counters.png)\n\n### Customize performance counter collection\n\nTo disable collection of the standard set of performance counters, add the following code under the root node of the ApplicationInsights.xml file:\n\n    <PerformanceCounters>\n       <UseBuiltIn>False</UseBuiltIn>\n    </PerformanceCounters>\n\n### Collect additional performance counters\n\nYou can specify additional performance counters to be collected.\n\n#### JMX counters (exposed by the Java Virtual Machine)\n\n    <PerformanceCounters>\n      <Jmx>\n        <Add objectName=\"java.lang:type=ClassLoading\" attribute=\"TotalLoadedClassCount\" displayName=\"Loaded Class Count\"/>\n        <Add objectName=\"java.lang:type=Memory\" attribute=\"HeapMemoryUsage.used\" displayName=\"Heap Memory Usage-used\" type=\"composite\"/>\n      </Jmx>\n    </PerformanceCounters>\n\n*   `displayName` – The name displayed in the Application Insights portal.\n*   `objectName` – The JMX object name.\n*   `attribute` – The attribute of the JMX object name to fetch\n*   `type` (optional) - The type of JMX object’s attribute:\n *  Default: a simple type such as int or long.\n *  `composite`: the perf counter data is in the format of 'Attribute.Data'\n *  `tabular`: the perf counter data is in the format of a table row\n\n\n\n#### Windows performance counters\n\nEach [Windows performance counter](https://msdn.microsoft.com/library/windows/desktop/aa373083.aspx) is a member of a category (in the same way that a field is a member of a class). Categories can either be global, or can have numbered or named instances.\n\n    <PerformanceCounters>\n      <Windows>\n        <Add displayName=\"Process User Time\" categoryName=\"Process\" counterName=\"%User Time\" instanceName=\"__SELF__\" />\n        <Add displayName=\"Bytes Printed per Second\" categoryName=\"Print Queue\" counterName=\"Bytes Printed/sec\" instanceName=\"Fax\" />\n      </Windows>\n    </PerformanceCounters>\n\n*   displayName – The name displayed in the Application Insights portal.\n*   categoryName – The performance counter category (performance object) with which this performance counter is associated.\n*   counterName – The name of the performance counter.\n*   instanceName – The name of the performance counter category instance, or an empty string (\"\"), if the category contains a single instance. If the categoryName is Process, and the performance counter you'd like to collect is from the current JVM process on which your app is running, specify `\"__SELF__\"`.\n\nYour performance counters are visible as custom metrics in [Metrics Explorer][metrics].\n\n![](./media/app-insights-java-get-started/12-custom-perfs.png)\n\n\n### Unix performance counters\n\n* [Install collectd with the Application Insights plugin](app-insights-java-collectd.md) to get a wide variety of system and network data.\n\n## Get user and session data\n\nOK, you're sending telemetry from your web server. Now to get the full 360-degree view of your application, you can add more monitoring:\n\n* [Add telemetry to your web pages][usage] to monitor page views and user metrics.\n* [Set up web tests][availability] to make sure your application stays live and responsive.\n\n## Capture log traces\n\nYou can use Application Insights to slice and dice logs from Log4J, Logback or other logging frameworks. You can correlate the logs with HTTP requests and other telemetry. [Learn how][javalogs].\n\n## Send your own telemetry\n\nNow that you've installed the SDK, you can use the API to send your own telemetry.\n\n* [Track custom events and metrics][api] to learn what users are doing with your application.\n* [Search events and logs][diagnostic] to help diagnose problems.\n\n\n\n\n\n\n## Questions? Problems?\n\n[Troubleshooting Java](app-insights-java-troubleshoot.md)\n\n\n\n<!--Link references-->\n\n[api]: app-insights-api-custom-events-metrics.md\n[apiexceptions]: app-insights-api-custom-events-metrics.md#track-exception\n[availability]: app-insights-monitor-web-app-availability.md\n[diagnostic]: app-insights-diagnostic-search.md\n[eclipse]: app-insights-java-eclipse.md\n[javalogs]: app-insights-java-trace-logs.md\n[metrics]: app-insights-metrics-explorer.md\n[usage]: app-insights-web-track-usage.md\n\ntest\n"
}