{
  "nodes": [
    {
      "content": "Using the Office 365 Connector in Logic Apps | Microsoft Azure App Service",
      "pos": [
        26,
        100
      ]
    },
    {
      "content": "How to create and configure the Office 365 Connector or API app and use it in a logic app in Azure App Service",
      "pos": [
        118,
        228
      ]
    },
    {
      "content": "Get started with the Office 365 Connector and add it to your Logic App",
      "pos": [
        558,
        628
      ]
    },
    {
      "content": "Connect to your Office 365 account to send and receive emails, and manage your calendar and contacts.",
      "pos": [
        629,
        730
      ]
    },
    {
      "content": "You can perform various actions such as send, receive and get emails, create and delete events in your calendar and create, update, get and delete your contacts.",
      "pos": [
        731,
        892
      ]
    },
    {
      "content": "Logic apps can trigger based on a variety of data sources and offer connectors to get and process data as a part of the flow.",
      "pos": [
        894,
        1019
      ]
    },
    {
      "content": "You can add the Office 365 connector to your business workflow and process data as part of this workflow within a Logic App.",
      "pos": [
        1020,
        1144
      ]
    },
    {
      "content": "Basic Actions",
      "pos": [
        1149,
        1162
      ]
    },
    {
      "content": "New Mail (Trigger)",
      "pos": [
        1168,
        1186
      ]
    },
    {
      "content": "Send Mail",
      "pos": [
        1189,
        1198
      ]
    },
    {
      "content": "Reply To Mail",
      "pos": [
        1201,
        1214
      ]
    },
    {
      "content": "Send Event",
      "pos": [
        1217,
        1227
      ]
    },
    {
      "content": "Add Contact",
      "pos": [
        1230,
        1241
      ]
    },
    {
      "content": "Create the O365 Connector API App",
      "pos": [
        1246,
        1279
      ]
    },
    {
      "content": "A connector can be created within a logic app or be created directly from the Azure Marketplace.",
      "pos": [
        1280,
        1376
      ]
    },
    {
      "content": "To create a connector from the Marketplace:",
      "pos": [
        1377,
        1420
      ]
    },
    {
      "pos": [
        1427,
        1475
      ],
      "content": "In the Azure startboard, select <bpt id=\"p1\">**</bpt>Marketplace<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        1479,
        1547
      ],
      "content": "Search for “Office 365 Connector”, select it, and select <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Configure the Office 365 Connector by providing the details for Hosting Plan, the resource group and selecting the name of the API App:",
      "pos": [
        1552,
        1687
      ]
    },
    {
      "content": "![][21]",
      "pos": [
        1690,
        1697
      ]
    },
    {
      "content": "Create a Logic App",
      "pos": [
        1703,
        1721
      ]
    },
    {
      "content": "Let us create a simple logic app that gets triggered when an email is received (at your sales enquiry email id - say sales@contoso.com).",
      "pos": [
        1722,
        1858
      ]
    },
    {
      "content": "And, it creates an event, adds a contact with the sender's details, sends an email to your personal account and finally sends a reply with an acknowledgment.",
      "pos": [
        1859,
        2016
      ]
    },
    {
      "content": "Sign in to Azure Portal and click on ‘New -&gt; Web + mobile -&gt; Logic App’:",
      "pos": [
        2022,
        2094
      ]
    },
    {
      "content": "![][1]",
      "pos": [
        2097,
        2103
      ]
    },
    {
      "content": "In the ‘Create logic app’ page, provide the required details such as name, app service plan and location:",
      "pos": [
        2109,
        2214
      ]
    },
    {
      "content": "![][2]",
      "pos": [
        2217,
        2223
      ]
    },
    {
      "content": "Click on ‘Triggers and Actions’ and the Logic App editor opens:",
      "pos": [
        2229,
        2292
      ]
    },
    {
      "content": "![][3]",
      "pos": [
        2295,
        2301
      ]
    },
    {
      "content": "Select the Office 365 trigger from the 'API Apps in this resource group' section in the gallery to add it to the flow:",
      "pos": [
        2307,
        2425
      ]
    },
    {
      "content": "![][4]",
      "pos": [
        2428,
        2434
      ]
    },
    {
      "content": "Connecting to Office 365 requires you to authorize the Logic App to be able to access your account.",
      "pos": [
        2440,
        2539
      ]
    },
    {
      "content": "Click on ‘Authorize’ to provide Office 365 login credentials:",
      "pos": [
        2540,
        2601
      ]
    },
    {
      "content": "![][5]",
      "pos": [
        2604,
        2610
      ]
    },
    {
      "content": "You are redirected to Office 365 sign in page and you can authenticate with your Office 365 account credentials:",
      "pos": [
        2616,
        2728
      ]
    },
    {
      "content": "![][6]",
      "pos": [
        2731,
        2737
      ]
    },
    {
      "content": "![][7]",
      "pos": [
        2740,
        2746
      ]
    },
    {
      "content": "Once the authorization is complete, Office 365 triggers are displayed:",
      "pos": [
        2752,
        2822
      ]
    },
    {
      "content": "![][8]",
      "pos": [
        2825,
        2831
      ]
    },
    {
      "content": "Select ‘New Email’ trigger and the input parameters are displayed.",
      "pos": [
        2837,
        2903
      ]
    },
    {
      "content": "Change the trigger frequency to 'Minutes' and click ✓:",
      "pos": [
        2910,
        2964
      ]
    },
    {
      "content": "![][9]",
      "pos": [
        2967,
        2973
      ]
    },
    {
      "content": "The Office 365 'New Email' trigger is configured and you can see the output parameters also displayed:",
      "pos": [
        2979,
        3081
      ]
    },
    {
      "content": "![][10]",
      "pos": [
        3084,
        3091
      ]
    },
    {
      "content": "Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.",
      "pos": [
        3097,
        3216
      ]
    },
    {
      "content": "Select ‘Send Event’ from the list of actions and the input parameters of ‘Send Event’ action are displayed:",
      "pos": [
        3222,
        3329
      ]
    },
    {
      "content": "![][11]",
      "pos": [
        3332,
        3339
      ]
    },
    {
      "content": "Specify the event details and click ✓:",
      "pos": [
        3345,
        3383
      ]
    },
    {
      "content": "![][12]",
      "pos": [
        3386,
        3393
      ]
    },
    {
      "content": "Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.",
      "pos": [
        3399,
        3518
      ]
    },
    {
      "content": "Select ‘Add Contact’ from the list of actions and the input parameters of ‘Add Contact’ action are displayed:",
      "pos": [
        3524,
        3633
      ]
    },
    {
      "content": "![][13]",
      "pos": [
        3636,
        3643
      ]
    },
    {
      "content": "Click on '+' next to 'Email Address' field and select the 'From' output field value from the trigger:",
      "pos": [
        3649,
        3750
      ]
    },
    {
      "content": "![][14]",
      "pos": [
        3753,
        3760
      ]
    },
    {
      "content": "Click on ✓ and the action configuration is complete:",
      "pos": [
        3766,
        3818
      ]
    },
    {
      "content": "![][15]",
      "pos": [
        3821,
        3828
      ]
    },
    {
      "content": "Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.",
      "pos": [
        3834,
        3953
      ]
    },
    {
      "content": "Select ‘Send Email’ from the list of actions and the input parameters of ‘Send Email’ action are displayed:",
      "pos": [
        3960,
        4067
      ]
    },
    {
      "content": "![][19]",
      "pos": [
        4070,
        4077
      ]
    },
    {
      "content": "Provide the details required to send the email.",
      "pos": [
        4083,
        4130
      ]
    },
    {
      "content": "You can construct a message by typing something like below.",
      "pos": [
        4131,
        4190
      ]
    },
    {
      "content": "Once the 'Send Email' action is configured, click on ✓:",
      "pos": [
        4191,
        4246
      ]
    },
    {
      "content": "![][20]",
      "pos": [
        4340,
        4347
      ]
    },
    {
      "content": "Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.",
      "pos": [
        4352,
        4471
      ]
    },
    {
      "content": "Select ‘Reply To’ from the list of actions and the input parameters of ‘Reply To’ action are displayed:",
      "pos": [
        4478,
        4581
      ]
    },
    {
      "content": "![][16]",
      "pos": [
        4584,
        4591
      ]
    },
    {
      "content": "Click '+' next to 'From' field and select the value from trigger's output message id and click ✓:",
      "pos": [
        4597,
        4694
      ]
    },
    {
      "content": "![][17]",
      "pos": [
        4697,
        4704
      ]
    },
    {
      "content": "Click on OK on Logic app editor screen and then click 'Create'.",
      "pos": [
        4710,
        4773
      ]
    },
    {
      "content": "It will take approximately 30 seconds for the creation to complete.",
      "pos": [
        4774,
        4841
      ]
    },
    {
      "content": "Send an email to the account you configured your trigger with and you should see an email in your personal mail account, calendar event and contact in your office mail account.",
      "pos": [
        4847,
        5023
      ]
    },
    {
      "content": "Also, you should get a reply back acknowledging that the sales enquiry will be responded shortly.",
      "pos": [
        5024,
        5121
      ]
    },
    {
      "content": "Do more with your Connector",
      "pos": [
        5126,
        5153
      ]
    },
    {
      "content": "Now that the connector is created, you can add it to a business workflow using a Logic App.",
      "pos": [
        5154,
        5245
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>What are Logic Apps?<ept id=\"p1\">](app-service-logic-what-are-logic-apps.md)</ept>.",
      "pos": [
        5246,
        5315
      ]
    },
    {
      "pos": [
        5317,
        5441
      ],
      "content": "View the Swagger REST API reference at <bpt id=\"p1\">[</bpt>Connectors and API Apps Reference<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=529766)</ept>."
    },
    {
      "content": "You can also review performance statistics and control security to the connector.",
      "pos": [
        5443,
        5524
      ]
    },
    {
      "content": "See <bpt id=\"p1\">[</bpt>Manage and Monitor your built-in API Apps and Connectors<ept id=\"p1\">](app-service-logic-monitor-your-connectors.md)</ept>.",
      "pos": [
        5525,
        5634
      ]
    },
    {
      "content": "test",
      "pos": [
        7403,
        7407
      ]
    }
  ],
  "content": "<properties\n   pageTitle=\"Using the Office 365 Connector in Logic Apps | Microsoft Azure App Service\"\n   description=\"How to create and configure the Office 365 Connector or API app and use it in a logic app in Azure App Service\"\n   services=\"app-service\\logic\"\n   documentationCenter=\".net,nodejs,java\"\n   authors=\"anuragdalmia\"\n   manager=\"dwrede\"\n   editor=\"\"/>\n\n<tags\n   ms.service=\"app-service-logic\"\n   ms.devlang=\"multiple\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"integration\"\n   ms.date=\"08/23/2015\"\n   ms.author=\"sameerch\"/>\n\n\n# Get started with the Office 365 Connector and add it to your Logic App\nConnect to your Office 365 account to send and receive emails, and manage your calendar and contacts. You can perform various actions such as send, receive and get emails, create and delete events in your calendar and create, update, get and delete your contacts.\n\nLogic apps can trigger based on a variety of data sources and offer connectors to get and process data as a part of the flow. You can add the Office 365 connector to your business workflow and process data as part of this workflow within a Logic App. \n\n**Basic Actions**\n\n- New Mail (Trigger)\n- Send Mail\n- Reply To Mail\n- Send Event\n- Add Contact\n\n## Create the O365 Connector API App\nA connector can be created within a logic app or be created directly from the Azure Marketplace. To create a connector from the Marketplace:  \n\n1. In the Azure startboard, select **Marketplace**.\n2. Search for “Office 365 Connector”, select it, and select **Create**.\n3.  Configure the Office 365 Connector by providing the details for Hosting Plan, the resource group and selecting the name of the API App:  \n![][21]\n\n\n## Create a Logic App\nLet us create a simple logic app that gets triggered when an email is received (at your sales enquiry email id - say sales@contoso.com). And, it creates an event, adds a contact with the sender's details, sends an email to your personal account and finally sends a reply with an acknowledgment.\n\n1.  Sign in to Azure Portal and click on ‘New -> Web + mobile -> Logic App’:  \n![][1]\n\n2.  In the ‘Create logic app’ page, provide the required details such as name, app service plan and location:  \n![][2]\n\n3.  Click on ‘Triggers and Actions’ and the Logic App editor opens:  \n![][3]\n\n4.  Select the Office 365 trigger from the 'API Apps in this resource group' section in the gallery to add it to the flow:  \n![][4]\n\n6.  Connecting to Office 365 requires you to authorize the Logic App to be able to access your account. Click on ‘Authorize’ to provide Office 365 login credentials:  \n![][5]\n\n7.  You are redirected to Office 365 sign in page and you can authenticate with your Office 365 account credentials:  \n![][6]  \n![][7]\n\n8.  Once the authorization is complete, Office 365 triggers are displayed:  \n![][8]\n\n9.  Select ‘New Email’ trigger and the input parameters are displayed.\n\n\n10. Change the trigger frequency to 'Minutes' and click ✓:  \n![][9]\n\n11. The Office 365 'New Email' trigger is configured and you can see the output parameters also displayed:  \n![][10]\n\n12. Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.\n\n13. Select ‘Send Event’ from the list of actions and the input parameters of ‘Send Event’ action are displayed:  \n![][11]\n\n14. Specify the event details and click ✓:  \n![][12]\n\n15. Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.\n\n16. Select ‘Add Contact’ from the list of actions and the input parameters of ‘Add Contact’ action are displayed:  \n![][13]\n\n17. Click on '+' next to 'Email Address' field and select the 'From' output field value from the trigger:  \n![][14]\n\n18. Click on ✓ and the action configuration is complete:  \n![][15]\n\n19. Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.\n\n\n20. Select ‘Send Email’ from the list of actions and the input parameters of ‘Send Email’ action are displayed:  \n![][19]\n\n21. Provide the details required to send the email. You can construct a message by typing something like below. Once the 'Send Email' action is configured, click on ✓:\n\n        Body - @concat('You got a new sales enquiry from',triggers().output.body.From)\n\n    ![][20]\n22. Select ‘Office 365 Connector’ from the ‘Recently Used’ section in the gallery and a new 'Office 365' action gets added.\n\n\n23. Select ‘Reply To’ from the list of actions and the input parameters of ‘Reply To’ action are displayed:  \n![][16]\n\n24. Click '+' next to 'From' field and select the value from trigger's output message id and click ✓:  \n![][17]\n\n25. Click on OK on Logic app editor screen and then click 'Create'. It will take approximately 30 seconds for the creation to complete.\n\n26. Send an email to the account you configured your trigger with and you should see an email in your personal mail account, calendar event and contact in your office mail account. Also, you should get a reply back acknowledging that the sales enquiry will be responded shortly.\n\n## Do more with your Connector\nNow that the connector is created, you can add it to a business workflow using a Logic App. See [What are Logic Apps?](app-service-logic-what-are-logic-apps.md).\n\nView the Swagger REST API reference at [Connectors and API Apps Reference](http://go.microsoft.com/fwlink/p/?LinkId=529766).\n\nYou can also review performance statistics and control security to the connector. See [Manage and Monitor your built-in API Apps and Connectors](app-service-logic-monitor-your-connectors.md).\n\n<!--Image references-->\n[1]: ./media/app-service-logic-connector-office365/1_New_Logic_App.png\n[2]: ./media/app-service-logic-connector-office365/2_Logic_App_Settings.png\n[3]: ./media/app-service-logic-connector-office365/3_Logic_App_Editor.png\n[4]: ./media/app-service-logic-connector-office365/4_Select_Office365_Gallery.png\n[5]: ./media/app-service-logic-connector-office365/5_Office365_Authorize.png\n[6]: ./media/app-service-logic-connector-office365/6_Office365_Login.png\n[7]: ./media/app-service-logic-connector-office365/7_Office365_User_Consent.png\n[8]: ./media/app-service-logic-connector-office365/8_Office365_Trigger.png\n[9]: ./media/app-service-logic-connector-office365/9_Office365_Trigger_Settings.png\n[10]: ./media/app-service-logic-connector-office365/10_Office365_Trigger_Configured.png\n[11]: ./media/app-service-logic-connector-office365/11_Office365_Actions_List.png\n[12]: ./media/app-service-logic-connector-office365/12_Office365_Create_Event_Inputs.png\n[13]: ./media/app-service-logic-connector-office365/13_Office365_Add_Contact_Inputs.png\n[14]: ./media/app-service-logic-connector-office365/14_Office365_Add_Contact_Email_FromTrigger.png\n[15]: ./media/app-service-logic-connector-office365/15_Office365_Add_Contacts_Configured.png\n[16]: ./media/app-service-logic-connector-office365/16_Office365_Reply_To_Inputs.png\n[17]: ./media/app-service-logic-connector-office365/17_Office365_Reply_To_MessageId.png\n[18]: ./media/app-service-logic-connector-office365/18_Office365_Reply_To_Configured.png\n[19]: ./media/app-service-logic-connector-office365/19_Office365_Send_Inputs.png\n[20]: ./media/app-service-logic-connector-office365/20_Office365_Send_Configured.png\n[21]: ./media/app-service-logic-connector-office365/21-create-new-o365-api-app.png\n\ntest\n"
}