{
  "nodes": [
    {
      "content": "How to use SQL Azure (Java) | Microsoft Azure",
      "pos": [
        28,
        73
      ]
    },
    {
      "content": "Learn how to use the Azure SQL Database from Java code.",
      "pos": [
        93,
        148
      ]
    },
    {
      "content": "How to Use Azure SQL Database in Java",
      "pos": [
        481,
        518
      ]
    },
    {
      "content": "The following steps show you how to use Azure SQL Database with Java.",
      "pos": [
        520,
        589
      ]
    },
    {
      "content": "Command line examples are shown for simplicity, but highly similar steps would be appropriate for web applications, either hosted on-premise, within Azure, or in other environments.",
      "pos": [
        590,
        771
      ]
    },
    {
      "content": "This guide covers creating a server and creating a database from the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://windows.azure.com)</ept>.",
      "pos": [
        772,
        894
      ]
    },
    {
      "content": "What is Azure SQL Database",
      "pos": [
        899,
        925
      ]
    },
    {
      "content": "Azure SQL Database provides a relational database management system for Azure, and is based on SQL Server technology.",
      "pos": [
        927,
        1044
      ]
    },
    {
      "content": "With a SQL Database instance, you can easily provision and deploy relational database solutions to the cloud, and take advantage of a distributed data center that provides enterprise-class availability, scalability, and security with the benefits of built-in data protection and self-healing.",
      "pos": [
        1045,
        1337
      ]
    },
    {
      "content": "Concepts",
      "pos": [
        1344,
        1352
      ]
    },
    {
      "content": "Because Azure SQL Database is built on SQL Server technologies, accessing SQL Database from Java is very similar to accessing SQL Server from Java.",
      "pos": [
        1353,
        1500
      ]
    },
    {
      "content": "You can develop an application locally (using SQL Server) and then connect to SQL Database by changing only the connection string.",
      "pos": [
        1501,
        1631
      ]
    },
    {
      "content": "You can use a SQL Server JDBC driver for your application.",
      "pos": [
        1632,
        1690
      ]
    },
    {
      "content": "However, there are some differences between SQL Database and SQL Server that could affect your application.",
      "pos": [
        1691,
        1798
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Guidelines and Limitations (SQL Database)<ept id=\"p1\">](http://msdn.microsoft.com/library/windowsazure/ff394102.aspx)</ept>.",
      "pos": [
        1799,
        1931
      ]
    },
    {
      "pos": [
        1933,
        2007
      ],
      "content": "For additional resources for SQL Database, see the <bpt id=\"p1\">[</bpt>Next steps<ept id=\"p1\">][]</ept> section."
    },
    {
      "content": "Prerequisites",
      "pos": [
        2012,
        2025
      ]
    },
    {
      "content": "The following are prerequisites if you intend to use SQL Database with Java.",
      "pos": [
        2027,
        2103
      ]
    },
    {
      "content": "A Java Developer Kit (JDK), v 1.6 or later.",
      "pos": [
        2107,
        2150
      ]
    },
    {
      "pos": [
        2153,
        2251
      ],
      "content": "An Azure subscription, which can be acquired from <bpt id=\"p1\">&lt;</bpt><ept id=\"p1\">http://www.microsoft.com/windowsazure/offers/&gt;</ept>."
    },
    {
      "content": "If you are using Eclipse, you'll need Eclipse IDE for Java EE Developers, Indigo or later.",
      "pos": [
        2254,
        2344
      ]
    },
    {
      "content": "This can be downloaded from <bpt id=\"p1\">&lt;</bpt><ept id=\"p1\">http://www.eclipse.org/downloads/&gt;</ept>.",
      "pos": [
        2345,
        2409
      ]
    },
    {
      "content": "You will also need the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies).",
      "pos": [
        2410,
        2501
      ]
    },
    {
      "content": "During installation of this plugin, ensure that Microsoft JDBC Driver 4.0 for SQL Server is included.",
      "pos": [
        2502,
        2603
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Installing the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies)<ept id=\"p1\">](http://msdn.microsoft.com/library/windowsazure/hh690946.aspx)</ept>.",
      "pos": [
        2604,
        2777
      ]
    },
    {
      "pos": [
        2780,
        2956
      ],
      "content": "If you are not using Eclipse, you will need the Microsoft JDBC Driver 4.0 for SQL Server, which you can download from <bpt id=\"p1\">&lt;</bpt><ept id=\"p1\">http://www.microsoft.com/download/details.aspx?id=11774&gt;</ept>."
    },
    {
      "content": "Creating an Azure SQL Database",
      "pos": [
        2961,
        2991
      ]
    },
    {
      "content": "Before using Azure SQL Database in Java code, you will need to create an Azure SQL Database server.",
      "pos": [
        2993,
        3092
      ]
    },
    {
      "pos": [
        3097,
        3169
      ],
      "content": "Login to the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        3173,
        3187
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Create new SQL database",
      "pos": [
        3195,
        3218
      ]
    },
    {
      "pos": [
        3236,
        3293
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>SQL database<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Custom create<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Create custom SQL database",
      "pos": [
        3301,
        3327
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Database settings<ept id=\"p1\">**</ept> dialog, specify your database name.",
      "pos": [
        3352,
        3416
      ]
    },
    {
      "content": "For purposes of this guide, use <bpt id=\"p1\">**</bpt>gettingstarted<ept id=\"p1\">**</ept> as the database name.",
      "pos": [
        3417,
        3489
      ]
    },
    {
      "content": "For <bpt id=\"p1\">**</bpt>Server<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>New SQL Database Server<ept id=\"p2\">**</ept>.",
      "pos": [
        3493,
        3544
      ]
    },
    {
      "content": "Use the default values for the other fields.",
      "pos": [
        3545,
        3589
      ]
    },
    {
      "content": "SQL database settings",
      "pos": [
        3597,
        3618
      ]
    },
    {
      "content": "Click the next arrow.",
      "pos": [
        3650,
        3671
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Server settings<ept id=\"p1\">**</ept> dialog, specify a SQL Server login name.",
      "pos": [
        3679,
        3746
      ]
    },
    {
      "content": "For purposes of this guide, <bpt id=\"p1\">**</bpt>MySQLAdmin<ept id=\"p1\">**</ept> was used.",
      "pos": [
        3747,
        3799
      ]
    },
    {
      "content": "Specify and confirm a password.",
      "pos": [
        3800,
        3831
      ]
    },
    {
      "content": "Specify a region, and ensure that <bpt id=\"p1\">**</bpt>Allow Azure Services to access the server<ept id=\"p1\">**</ept> is checked.",
      "pos": [
        3832,
        3923
      ]
    },
    {
      "content": "SQL server settings",
      "pos": [
        3931,
        3950
      ]
    },
    {
      "content": "Click the completion button.",
      "pos": [
        3980,
        4008
      ]
    },
    {
      "content": "Determining the SQL Database connection string",
      "pos": [
        4013,
        4059
      ]
    },
    {
      "pos": [
        4064,
        4136
      ],
      "content": "Login to the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        4140,
        4164
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>SQL Databases<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Click the database that you want to use.",
      "pos": [
        4168,
        4208
      ]
    },
    {
      "pos": [
        4212,
        4246
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Show connection strings<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        4250,
        4308
      ],
      "content": "Highlight the contents for the <bpt id=\"p1\">**</bpt>JDBC<ept id=\"p1\">**</ept> connection string."
    },
    {
      "content": "Determine JDBC connection string",
      "pos": [
        4316,
        4348
      ]
    },
    {
      "pos": [
        4382,
        4472
      ],
      "content": "Right-click the highlighted contents of the <bpt id=\"p1\">**</bpt>JDBC<ept id=\"p1\">**</ept> connection string and click <bpt id=\"p2\">**</bpt>Copy<ept id=\"p2\">**</ept>."
    },
    {
      "content": "You can now paste this value into your code file to create a connection string of the following form.",
      "pos": [
        4476,
        4577
      ]
    },
    {
      "content": "Replace <bpt id=\"p1\">*</bpt>your_server<ept id=\"p1\">*</ept> (in two places) with the text you copied in the previous step, and replace <bpt id=\"p2\">*</bpt>your_password<ept id=\"p2\">*</ept> with the password value you specified when you created your SQL Database account.",
      "pos": [
        4578,
        4772
      ]
    },
    {
      "content": "(Also replace the values assigned to <bpt id=\"p1\">**</bpt>database=<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>user=<ept id=\"p2\">**</ept> if you did not use <bpt id=\"p3\">**</bpt>gettingstarted<ept id=\"p3\">**</ept> and <bpt id=\"p4\">**</bpt>MySQLAdmin<ept id=\"p4\">**</ept>, respectively.)",
      "pos": [
        4773,
        4910
      ]
    },
    {
      "pos": [
        4917,
        5273
      ],
      "content": "String connectionString =\n     \"jdbc:sqlserver://*your_server*.database.windows.net:1433\" + \";\" +  \n     \"database=gettingstarted\" + \";\" + \n     \"user=MySQLAdmin@*your_server*\" + \";\" +  \n     \"password=*your_password*\" + \";\" +  \n     \"encrypt=true\" + \";\" +\n     \"hostNameInCertificate=*.int.mscds.com\" + \";\" +  \n     \"loginTimeout=30\";",
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "nodes": [
        {
          "content": "String connectionString =",
          "pos": [
            0,
            25
          ]
        },
        {
          "content": "\"jdbc:sqlserver://<bpt id=\"p1\">*</bpt>your_server<ept id=\"p1\">*</ept>.database.windows.net:1433\" + \";\" +",
          "pos": [
            31,
            97
          ]
        },
        {
          "content": "\"database=gettingstarted\" + \";\" +",
          "pos": [
            105,
            138
          ]
        },
        {
          "content": "\"user=MySQLAdmin@<bpt id=\"p1\">*</bpt>your_server<ept id=\"p1\">*</ept>\" + \";\" +",
          "pos": [
            145,
            184
          ]
        },
        {
          "content": "\"password=<bpt id=\"p1\">*</bpt>your_password<ept id=\"p1\">*</ept>\" + \";\" +",
          "pos": [
            192,
            226
          ]
        },
        {
          "content": "\"encrypt=true\" + \";\" +",
          "pos": [
            234,
            256
          ]
        },
        {
          "content": "\"hostNameInCertificate=*.int.mscds.com\" + \";\" +",
          "pos": [
            262,
            309
          ]
        },
        {
          "content": "\"loginTimeout=30\";",
          "pos": [
            317,
            335
          ]
        }
      ]
    },
    {
      "content": "We'll actually use this string later in this guide, for now you know the steps to determine the connection string.",
      "pos": [
        5275,
        5389
      ]
    },
    {
      "content": "Also, depending on your application needs, you may not need to use the <bpt id=\"p1\">**</bpt>encrypt<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>hostNameInCertificate<ept id=\"p2\">**</ept> settings, and you may need to modify the <bpt id=\"p3\">**</bpt>loginTimeout<ept id=\"p3\">**</ept> setting.",
      "pos": [
        5390,
        5569
      ]
    },
    {
      "content": "To allow access to a range of IP addresses",
      "pos": [
        5574,
        5616
      ]
    },
    {
      "pos": [
        5621,
        5687
      ],
      "content": "Login to the <bpt id=\"p1\">[</bpt>Management Portal<ept id=\"p1\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        5691,
        5715
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>SQL Databases<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        5719,
        5737
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Click the server that you want to use.",
      "pos": [
        5741,
        5779
      ]
    },
    {
      "pos": [
        5783,
        5800
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Manage<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        5804,
        5824
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Configure<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Under <bpt id=\"p1\">**</bpt>Allowed IP addresses<ept id=\"p1\">**</ept>, enter the name of a new IP rule.",
      "pos": [
        5828,
        5892
      ]
    },
    {
      "content": "Specify the beginning and ending range of the IP addresses.",
      "pos": [
        5893,
        5952
      ]
    },
    {
      "content": "For your convenience, the current client IP address is shown.",
      "pos": [
        5953,
        6014
      ]
    },
    {
      "content": "The following example allows in a single client IP address (your IP address will be different).",
      "pos": [
        6015,
        6110
      ]
    },
    {
      "content": "Allowed IP addresses dialog",
      "pos": [
        6118,
        6145
      ]
    },
    {
      "content": "Click the completion button.",
      "pos": [
        6171,
        6199
      ]
    },
    {
      "content": "The IP addresses that you specify will now be allowed access to your database server.",
      "pos": [
        6200,
        6285
      ]
    },
    {
      "content": "To use Azure SQL Database in Java",
      "pos": [
        6290,
        6323
      ]
    },
    {
      "content": "Create a Java project.",
      "pos": [
        6328,
        6350
      ]
    },
    {
      "content": "For purposes of this tutorial, call it <bpt id=\"p1\">**</bpt>HelloSQLAzure<ept id=\"p1\">**</ept>.",
      "pos": [
        6351,
        6408
      ]
    },
    {
      "pos": [
        6412,
        6478
      ],
      "content": "Add a Java class file named <bpt id=\"p1\">**</bpt>HelloSQLAzure.java<ept id=\"p1\">**</ept> to the project."
    },
    {
      "pos": [
        6482,
        6550
      ],
      "content": "Add the <bpt id=\"p1\">**</bpt>Microsoft JDBC Driver for SQL Server<ept id=\"p1\">**</ept> to your build path."
    },
    {
      "content": "If you are using Eclipse:",
      "pos": [
        6555,
        6580
      ]
    },
    {
      "pos": [
        6589,
        6691
      ],
      "content": "Within Eclipse's Project Explorer, right-click the <bpt id=\"p1\">**</bpt>HelloSQLAzure<ept id=\"p1\">**</ept> project and click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        6699,
        6777
      ],
      "content": "In the left-hand pane of the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Java Build Path<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        6785,
        6845
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Libraries<ept id=\"p1\">**</ept> tab, and then click <bpt id=\"p2\">**</bpt>Add Library<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        6853,
        6979
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Add Library<ept id=\"p1\">**</ept> dialog, select <bpt id=\"p2\">**</bpt>Microsoft JDBC Driver 4.0 for SQL Server<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Finish<ept id=\"p4\">**</ept>."
    },
    {
      "pos": [
        6987,
        7035
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> dialog."
    },
    {
      "content": "If you are not using Eclipse, add the Microsoft JDBC Driver 4.0 for SQL Server JAR to your class path.",
      "pos": [
        7041,
        7143
      ]
    },
    {
      "content": "For related information, see <bpt id=\"p1\">[</bpt>Using the JDBC Driver<ept id=\"p1\">](http://msdn.microsoft.com/library/ms378526.aspx)</ept>.",
      "pos": [
        7144,
        7246
      ]
    },
    {
      "pos": [
        7251,
        7345
      ],
      "content": "Within your <bpt id=\"p1\">**</bpt>HelloSQLAzure.java<ept id=\"p1\">**</ept> code, add in <ph id=\"ph1\">`import`</ph> statements as shown in the following:"
    },
    {
      "content": "Specify your connection string.",
      "pos": [
        7425,
        7456
      ]
    },
    {
      "content": "Following is an example.",
      "pos": [
        7457,
        7481
      ]
    },
    {
      "content": "As above, replace <bpt id=\"p1\">*</bpt>your_server<ept id=\"p1\">*</ept> (in two places), <bpt id=\"p2\">*</bpt>your_user<ept id=\"p2\">*</ept> and <bpt id=\"p3\">*</bpt>your_password<ept id=\"p3\">*</ept> with the values appropriate for your SQL Database server.",
      "pos": [
        7482,
        7620
      ]
    },
    {
      "content": "You're now ready to add in code that will communicate with your SQL Database server.",
      "pos": [
        7876,
        7960
      ]
    },
    {
      "content": "Communicating with Azure SQL Database from your code",
      "pos": [
        7965,
        8017
      ]
    },
    {
      "content": "The remainder of this topic shows examples that do the following:",
      "pos": [
        8019,
        8084
      ]
    },
    {
      "content": "Connect to the SQL Database server.",
      "pos": [
        8089,
        8124
      ]
    },
    {
      "content": "Define a SQL statement, for example, to create or drop a table, insert/select/delete rows, etc.",
      "pos": [
        8128,
        8223
      ]
    },
    {
      "pos": [
        8227,
        8317
      ],
      "content": "Execute the SQL statement, either through a call to <bpt id=\"p1\">**</bpt>executeUpdate<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>executeQuery<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Display query results, if appropriate.",
      "pos": [
        8321,
        8359
      ]
    },
    {
      "content": "The following sections are intended to be read (sampled) in order.",
      "pos": [
        8361,
        8427
      ]
    },
    {
      "content": "The first snippet is a complete sample; the others would rely on part of the framework in the complete sample, such as the <bpt id=\"p1\">**</bpt>import<ept id=\"p1\">**</ept> statements, <bpt id=\"p2\">**</bpt>class<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>main<ept id=\"p3\">**</ept> declarations, error handling and resource closing.",
      "pos": [
        8428,
        8647
      ]
    },
    {
      "content": "To create a table",
      "pos": [
        8652,
        8669
      ]
    },
    {
      "pos": [
        8671,
        8739
      ],
      "content": "The following code shows you how to create a table named <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept>."
    },
    {
      "content": "To create an index on a table",
      "pos": [
        11742,
        11771
      ]
    },
    {
      "pos": [
        11773,
        11897
      ],
      "content": "The following code shows you how to create an index named <bpt id=\"p1\">**</bpt>index1<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Person<ept id=\"p2\">**</ept> table, using the <bpt id=\"p3\">**</bpt>PersonID<ept id=\"p3\">**</ept> column."
    },
    {
      "content": "To insert rows",
      "pos": [
        13380,
        13394
      ]
    },
    {
      "pos": [
        13396,
        13465
      ],
      "content": "The following code shows you how to add rows to the <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept> table."
    },
    {
      "content": "To retrieve rows",
      "pos": [
        15274,
        15290
      ]
    },
    {
      "pos": [
        15292,
        15368
      ],
      "content": "The following code shows you how to retrieve rows from the <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept> table."
    },
    {
      "content": "The code above selected the top 10 rows from the <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept> table.",
      "pos": [
        17211,
        17277
      ]
    },
    {
      "content": "If you want to return all rows, modify the SQL statement to the following:",
      "pos": [
        17278,
        17352
      ]
    },
    {
      "content": "To retrieve rows using a WHERE clause",
      "pos": [
        17407,
        17444
      ]
    },
    {
      "content": "To retrieve rows using a clause, use the code as shown above, except change the SQL statement to include a clause.",
      "pos": [
        17446,
        17560
      ]
    },
    {
      "content": "The following SQL statement includes a clause for rows whose <bpt id=\"p1\">**</bpt>FirstName<ept id=\"p1\">**</ept> value equals <bpt id=\"p2\">**</bpt>Jim<ept id=\"p2\">**</ept>.",
      "pos": [
        17561,
        17657
      ]
    },
    {
      "content": "WHERE clauses can also be used when retrieving counts, updating rows, or deleting rows.",
      "pos": [
        17763,
        17850
      ]
    },
    {
      "content": "To retrieve a count of rows",
      "pos": [
        17855,
        17882
      ]
    },
    {
      "pos": [
        17884,
        17971
      ],
      "content": "The following code shows you how to retrieve a count of rows from the <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept> table."
    },
    {
      "content": "To update rows",
      "pos": [
        19683,
        19697
      ]
    },
    {
      "content": "The following code shows you how to update rows.",
      "pos": [
        19699,
        19747
      ]
    },
    {
      "content": "In this example, the <bpt id=\"p1\">**</bpt>LastName<ept id=\"p1\">**</ept> value is changed to <bpt id=\"p2\">**</bpt>Kim<ept id=\"p2\">**</ept> for any rows where the <bpt id=\"p3\">**</bpt>FirstName<ept id=\"p3\">**</ept> value is <bpt id=\"p4\">**</bpt>Jim<ept id=\"p4\">**</ept>.",
      "pos": [
        19748,
        19864
      ]
    },
    {
      "content": "To delete rows",
      "pos": [
        21358,
        21372
      ]
    },
    {
      "content": "The following code shows you how to delete rows.",
      "pos": [
        21374,
        21422
      ]
    },
    {
      "content": "In this example, any rows where the <bpt id=\"p1\">**</bpt>FirstName<ept id=\"p1\">**</ept> value is <bpt id=\"p2\">**</bpt>Jim<ept id=\"p2\">**</ept> are deleted.",
      "pos": [
        21423,
        21502
      ]
    },
    {
      "content": "To check whether a table exists",
      "pos": [
        22996,
        23027
      ]
    },
    {
      "content": "The following code shows you how to determine whether a table exists.",
      "pos": [
        23029,
        23098
      ]
    },
    {
      "content": "To drop an index",
      "pos": [
        24929,
        24945
      ]
    },
    {
      "pos": [
        24947,
        25038
      ],
      "content": "The following code shows you how to drop an index named <bpt id=\"p1\">**</bpt>index1<ept id=\"p1\">**</ept> on the <bpt id=\"p2\">**</bpt>Person<ept id=\"p2\">**</ept> table."
    },
    {
      "content": "To drop a table",
      "pos": [
        26510,
        26525
      ]
    },
    {
      "pos": [
        26527,
        26593
      ],
      "content": "The following code shows you how to drop a table named <bpt id=\"p1\">**</bpt>Person<ept id=\"p1\">**</ept>."
    },
    {
      "content": "Using SQL Database in Java within an Azure Deployment",
      "pos": [
        28023,
        28076
      ]
    },
    {
      "content": "To use SQL Database in Java within an Azure deployment, in addition to having Microsoft JDBC Driver 4.0 for SQL Server as a library in your class path as shown above, you'll need to package it with your deployment.",
      "pos": [
        28078,
        28292
      ]
    },
    {
      "content": "Packaging the Microsoft JDBC Driver 4.0 SQL Server if you are using Eclipse",
      "pos": [
        28297,
        28372
      ]
    },
    {
      "pos": [
        28379,
        28464
      ],
      "content": "Within Eclipse's Project Explorer, right-click your project and click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        28468,
        28574
      ],
      "content": "In the left-hand pane of the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Deployment Assembly<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        28578,
        28678
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>New Assembly Directive<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Java Build Path Entries<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        28682,
        28756
      ],
      "content": "Select <bpt id=\"p1\">**</bpt>Microsoft JDBC Driver 4.0 SQL Server<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."
    },
    {
      "pos": [
        28760,
        28808
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> dialog."
    },
    {
      "content": "Export your project's WAR file to your approot folder, and rebuild your Azure project, per the steps documented at <bpt id=\"p1\">[</bpt>Creating a Hello World Application Using the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies)<ept id=\"p1\">](http://msdn.microsoft.com/library/windowsazure/hh690944.aspx)</ept>.",
      "pos": [
        28812,
        29104
      ]
    },
    {
      "content": "That topic also describes how to run your application in the compute emulator, and in Azure.",
      "pos": [
        29105,
        29197
      ]
    },
    {
      "content": "Packaging the Microsoft JDBC Driver 4.0 SQL Server if you are not using Eclipse",
      "pos": [
        29201,
        29280
      ]
    },
    {
      "content": "Ensure the Microsoft JDBC Driver 4.0 SQL Server library is included within the same Azure role as your Java application, and added to the class path of your application.",
      "pos": [
        29286,
        29455
      ]
    },
    {
      "content": "Next steps",
      "pos": [
        29460,
        29470
      ]
    },
    {
      "content": "To learn more about Microsoft JDBC Driver for SQL Server, see <bpt id=\"p1\">[</bpt>Overview of the JDBC Driver<ept id=\"p1\">](http://msdn.microsoft.com/library/ms378749.aspx)</ept>.",
      "pos": [
        29472,
        29613
      ]
    },
    {
      "content": "To learn more about SQL Database, see <bpt id=\"p1\">[</bpt>SQL Database Overview<ept id=\"p1\">](http://msdn.microsoft.com/library/windowsazure/ee336241.aspx)</ept>.",
      "pos": [
        29614,
        29738
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"How to use SQL Azure (Java) | Microsoft Azure\" \n    description=\"Learn how to use the Azure SQL Database from Java code.\" \n    services=\"sql-database\" \n    documentationCenter=\"java\" \n    authors=\"rmcmurray\" \n    manager=\"jeffreyg\" \n    editor=\"jimbe\"/>\n\n<tags \n    ms.service=\"sql-database\" \n    ms.workload=\"data-management\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"Java\" \n    ms.topic=\"article\" \n    ms.date=\"06/03/2015\" \n    ms.author=\"robmcm\"/>\n\n# How to Use Azure SQL Database in Java\n\nThe following steps show you how to use Azure SQL Database with Java. Command line examples are shown for simplicity, but highly similar steps would be appropriate for web applications, either hosted on-premise, within Azure, or in other environments. This guide covers creating a server and creating a database from the [Azure Management Portal](https://windows.azure.com).\n\n## What is Azure SQL Database\n\nAzure SQL Database provides a relational database management system for Azure, and is based on SQL Server technology. With a SQL Database instance, you can easily provision and deploy relational database solutions to the cloud, and take advantage of a distributed data center that provides enterprise-class availability, scalability, and security with the benefits of built-in data protection and self-healing.\n\n\n\n## Concepts\nBecause Azure SQL Database is built on SQL Server technologies, accessing SQL Database from Java is very similar to accessing SQL Server from Java. You can develop an application locally (using SQL Server) and then connect to SQL Database by changing only the connection string. You can use a SQL Server JDBC driver for your application. However, there are some differences between SQL Database and SQL Server that could affect your application. For more information, see [Guidelines and Limitations (SQL Database)](http://msdn.microsoft.com/library/windowsazure/ff394102.aspx).\n\nFor additional resources for SQL Database, see the [Next steps][] section.\n\n## Prerequisites\n\nThe following are prerequisites if you intend to use SQL Database with Java.\n\n* A Java Developer Kit (JDK), v 1.6 or later.\n* An Azure subscription, which can be acquired from <http://www.microsoft.com/windowsazure/offers/>.\n* If you are using Eclipse, you'll need Eclipse IDE for Java EE Developers, Indigo or later. This can be downloaded from <http://www.eclipse.org/downloads/>. You will also need the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies). During installation of this plugin, ensure that Microsoft JDBC Driver 4.0 for SQL Server is included. For more information, see [Installing the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies)](http://msdn.microsoft.com/library/windowsazure/hh690946.aspx).\n* If you are not using Eclipse, you will need the Microsoft JDBC Driver 4.0 for SQL Server, which you can download from <http://www.microsoft.com/download/details.aspx?id=11774>.\n\n## Creating an Azure SQL Database\n\nBefore using Azure SQL Database in Java code, you will need to create an Azure SQL Database server.\n\n1. Login to the [Azure Management Portal](https://manage.windowsazure.com).\n2. Click **New**.\n\n    ![Create new SQL database][create_new]\n\n3. Click **SQL database**, and then click **Custom create**.\n\n    ![Create custom SQL database][create_new_sql_db]\n\n4. In the **Database settings** dialog, specify your database name. For purposes of this guide, use **gettingstarted** as the database name.\n5. For **Server**, select **New SQL Database Server**. Use the default values for the other fields.\n\n    ![SQL database settings][create_database_settings]\n\n6. Click the next arrow.    \n7. In the **Server settings** dialog, specify a SQL Server login name. For purposes of this guide, **MySQLAdmin** was used. Specify and confirm a password. Specify a region, and ensure that **Allow Azure Services to access the server** is checked.\n\n    ![SQL server settings][create_server_settings]\n\n8. Click the completion button.\n\n## Determining the SQL Database connection string\n\n1. Login to the [Azure Management Portal](https://manage.windowsazure.com).\n2. Click **SQL Databases**.\n3. Click the database that you want to use.\n4. Click **Show connection strings**.\n5. Highlight the contents for the **JDBC** connection string.\n\n    ![Determine JDBC connection string][get_jdbc_connection_string]\n\n6. Right-click the highlighted contents of the **JDBC** connection string and click **Copy**.\n7. You can now paste this value into your code file to create a connection string of the following form. Replace *your_server* (in two places) with the text you copied in the previous step, and replace *your_password* with the password value you specified when you created your SQL Database account. (Also replace the values assigned to **database=** and **user=** if you did not use **gettingstarted** and **MySQLAdmin**, respectively.) \n\n    String connectionString =\n        \"jdbc:sqlserver://*your_server*.database.windows.net:1433\" + \";\" +  \n        \"database=gettingstarted\" + \";\" + \n        \"user=MySQLAdmin@*your_server*\" + \";\" +  \n        \"password=*your_password*\" + \";\" +  \n        \"encrypt=true\" + \";\" +\n        \"hostNameInCertificate=*.int.mscds.com\" + \";\" +  \n        \"loginTimeout=30\";\n\nWe'll actually use this string later in this guide, for now you know the steps to determine the connection string. Also, depending on your application needs, you may not need to use the **encrypt** and **hostNameInCertificate** settings, and you may need to modify the **loginTimeout** setting.\n\n## To allow access to a range of IP addresses\n\n1. Login to the [Management Portal](https://manage.windowsazure.com).\n2. Click **SQL Databases**.\n3. Click **Servers**.\n4. Click the server that you want to use.\n5. Click **Manage**.\n6. Click **Configure**.\n7. Under **Allowed IP addresses**, enter the name of a new IP rule. Specify the beginning and ending range of the IP addresses. For your convenience, the current client IP address is shown. The following example allows in a single client IP address (your IP address will be different).\n\n    ![Allowed IP addresses dialog][allowed_ips_dialog]\n\n8. Click the completion button. The IP addresses that you specify will now be allowed access to your database server.\n\n## To use Azure SQL Database in Java\n\n1. Create a Java project. For purposes of this tutorial, call it **HelloSQLAzure**.\n2. Add a Java class file named **HelloSQLAzure.java** to the project.\n3. Add the **Microsoft JDBC Driver for SQL Server** to your build path.\n\n   If you are using Eclipse:\n\n    1. Within Eclipse's Project Explorer, right-click the **HelloSQLAzure** project and click **Properties**.\n    2. In the left-hand pane of the **Properties** dialog, click **Java Build Path**.\n    3. Click the **Libraries** tab, and then click **Add Library**.\n    4. In the **Add Library** dialog, select **Microsoft JDBC Driver 4.0 for SQL Server**, click **Next**, and then click **Finish**.\n    5. Click **OK** to close the **Properties** dialog.\n\n    If you are not using Eclipse, add the Microsoft JDBC Driver 4.0 for SQL Server JAR to your class path. For related information, see [Using the JDBC Driver](http://msdn.microsoft.com/library/ms378526.aspx).\n\n4. Within your **HelloSQLAzure.java** code, add in `import` statements as shown in the following:\n\n        import java.sql.*;\n        import com.microsoft.sqlserver.jdbc.*;\n\n5. Specify your connection string. Following is an example. As above, replace *your_server* (in two places), *your_user* and *your_password* with the values appropriate for your SQL Database server.\n\n        String connectionString =\n            \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n                \"database=master\" + \";\" + \n                \"user=your_user@your_server\" + \";\" +  \n                \"password=your_password\";\n\nYou're now ready to add in code that will communicate with your SQL Database server.\n\n## Communicating with Azure SQL Database from your code\n\nThe remainder of this topic shows examples that do the following:\n\n1. Connect to the SQL Database server.\n2. Define a SQL statement, for example, to create or drop a table, insert/select/delete rows, etc.\n3. Execute the SQL statement, either through a call to **executeUpdate** or **executeQuery**.\n4. Display query results, if appropriate.\n\nThe following sections are intended to be read (sampled) in order. The first snippet is a complete sample; the others would rely on part of the framework in the complete sample, such as the **import** statements, **class** and **main** declarations, error handling and resource closing.\n\n## To create a table\n\nThe following code shows you how to create a table named **Person**.\n\n    import java.sql.*;\n    import com.microsoft.sqlserver.jdbc.*;\n    \n    public class HelloSQLAzure {\n    \n        public static void main(String[] args) \n        {\n    \n            // Connection string for your SQL Database server.\n            // Change the values assigned to your_server, \n            // your_user@your_server,\n            // and your_password.\n            String connectionString = \n                \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n                    \"database=gettingstarted\" + \";\" + \n                    \"user=your_user@your_server\" + \";\" +  \n                    \"password=your_password\";\n            \n            // The types for the following variables are\n            // defined in the java.sql library.\n            Connection connection = null;  // For making the connection\n            Statement statement = null;    // For the SQL statement\n            ResultSet resultSet = null;    // For the result set, if applicable\n            \n            try\n            {\n                // Ensure the SQL Server driver class is available.\n                Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n            \n                // Establish the connection.\n                connection = DriverManager.getConnection(connectionString);\n            \n                // Define the SQL string.\n                String sqlString = \n                    \"CREATE TABLE Person (\" + \n                        \"[PersonID] [int] IDENTITY(1,1) NOT NULL,\" +\n                        \"[LastName] [nvarchar](50) NOT NULL,\" + \n                        \"[FirstName] [nvarchar](50) NOT NULL)\";\n            \n                // Use the connection to create the SQL statement.\n                statement = connection.createStatement();\n            \n                // Execute the statement.\n                statement.executeUpdate(sqlString);\n            \n                // Provide a message when processing is complete.\n                System.out.println(\"Processing complete.\");\n            \n            }\n            // Exception handling\n            catch (ClassNotFoundException cnfe)  \n            {\n                \n                System.out.println(\"ClassNotFoundException \" +\n                                   cnfe.getMessage());\n            }\n            catch (Exception e)\n            {\n                System.out.println(\"Exception \" + e.getMessage());\n                e.printStackTrace();\n            }\n            finally\n            {\n                try\n                {\n                    // Close resources.\n                    if (null != connection) connection.close();\n                    if (null != statement) statement.close();\n                    if (null != resultSet) resultSet.close();\n                }\n                catch (SQLException sqlException)\n                {\n                    // No additional action if close() statements fail.\n                }\n            }\n            \n        }\n    \n    }\n    \n\n## To create an index on a table\n\nThe following code shows you how to create an index named **index1** on the **Person** table, using the **PersonID** column.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"CREATE CLUSTERED INDEX index1 \" + \"ON Person (PersonID)\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n\n\n## To insert rows\n\nThe following code shows you how to add rows to the **Person** table.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"SET IDENTITY_INSERT Person ON \" + \n                \"INSERT INTO Person \" + \n                \"(PersonID, LastName, FirstName) \" + \n                \"VALUES(1, 'Abercrombie', 'Kim'),\" + \n                      \"(2, 'Goeschl', 'Gerhard'),\" + \n                      \"(3, 'Grachev', 'Nikolay'),\" + \n                      \"(4, 'Yee', 'Tai'),\" + \n                      \"(5, 'Wilson', 'Jim')\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n \n## To retrieve rows\n\nThe following code shows you how to retrieve rows from the **Person** table.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \"SELECT TOP 10 * FROM Person\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        resultSet = statement.executeQuery(sqlString);\n    \n        // Loop through the results\n        while (resultSet.next())\n        {\n            // Print out the row data\n            System.out.println(\n                \"Person with ID \" + \n                resultSet.getString(\"PersonID\") + \n                \" has name \" +\n                resultSet.getString(\"FirstName\") + \" \" +\n                resultSet.getString(\"LastName\"));\n            }\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n The code above selected the top 10 rows from the **Person** table. If you want to return all rows, modify the SQL statement to the following:\n\n    String sqlString = \"SELECT * FROM Person\";\n\n \n## To retrieve rows using a WHERE clause\n\nTo retrieve rows using a clause, use the code as shown above, except change the SQL statement to include a clause. The following SQL statement includes a clause for rows whose **FirstName** value equals **Jim**.\n\n    // Define the SQL string.\n    String sqlString = \"SELECT * FROM Person WHERE FirstName='Jim'\";\n    \nWHERE clauses can also be used when retrieving counts, updating rows, or deleting rows.\n\n## To retrieve a count of rows\n\nThe following code shows you how to retrieve a count of rows from the **Person** table.\n \n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n    // Define the SQL string.\n        String sqlString = \"SELECT COUNT (PersonID) FROM Person\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        resultSet = statement.executeQuery(sqlString);\n    \n        // Print out the returned number of rows.\n        while (resultSet.next())\n        {\n            System.out.println(\"There were \" + \n                             resultSet.getInt(1) +\n                             \" rows returned.\");\n        }\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n## To update rows\n\nThe following code shows you how to update rows. In this example, the **LastName** value is changed to **Kim** for any rows where the **FirstName** value is **Jim**.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"UPDATE Person \" + \"SET LastName = 'Kim' \" + \"WHERE FirstName='Jim'\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n        \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }// Exception handling and resource closing not shown...\n\n \n\n## To delete rows\n\nThe following code shows you how to delete rows. In this example, any rows where the **FirstName** value is **Jim** are deleted.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"DELETE from Person \" + \n                \"WHERE FirstName='Jim'\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n    \n \n## To check whether a table exists\n\nThe following code shows you how to determine whether a table exists.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"IF EXISTS (SELECT 1 \" +\n                \"FROM sysobjects \" + \n                \"WHERE xtype='u' AND name='Person') \" +\n                \"SELECT 'Person table exists.'\" +\n                \"ELSE  \" +\n                \"SELECT 'Person table does not exist.'\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        resultSet = statement.executeQuery(sqlString);\n    \n        // Display the result.\n        while (resultSet.next())\n        {\n            System.out.println(resultSet.getString(1));\n        }\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n## To drop an index\n\nThe following code shows you how to drop an index named **index1** on the **Person** table.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +\n            \"database=gettingstarted\" + \";\" +\n            \"user=your_user@your_server\" + \";\" +\n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \n            \"DROP INDEX index1 \" + \n                \"ON Person\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n \n## To drop a table\n\nThe following code shows you how to drop a table named **Person**.\n\n    // Connection string for your SQL Database server.\n    // Change the values assigned to your_server, \n    // your_user@your_server,\n    // and your_password.\n    String connectionString = \n        \"jdbc:sqlserver://your_server.database.windows.net:1433\" + \";\" +  \n            \"database=gettingstarted\" + \";\" + \n            \"user=your_user@your_server\" + \";\" +  \n            \"password=your_password\";\n    \n    // The types for the following variables are\n    // defined in the java.sql library.\n    Connection connection = null;  // For making the connection\n    Statement statement = null;    // For the SQL statement\n    ResultSet resultSet = null;    // For the result set, if applicable\n    \n    try\n    {\n        // Ensure the SQL Server driver class is available.\n        Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n    \n        // Establish the connection.\n        connection = DriverManager.getConnection(connectionString);\n    \n        // Define the SQL string.\n        String sqlString = \"DROP TABLE Person\";\n    \n        // Use the connection to create the SQL statement.\n        statement = connection.createStatement();\n    \n        // Execute the statement.\n        statement.executeUpdate(sqlString);\n    \n        // Provide a message when processing is complete.\n        System.out.println(\"Processing complete.\");\n    \n    }\n    // Exception handling and resource closing not shown...\n\n## Using SQL Database in Java within an Azure Deployment\n\nTo use SQL Database in Java within an Azure deployment, in addition to having Microsoft JDBC Driver 4.0 for SQL Server as a library in your class path as shown above, you'll need to package it with your deployment.\n\n\n**Packaging the Microsoft JDBC Driver 4.0 SQL Server if you are using Eclipse**\n\n1. Within Eclipse's Project Explorer, right-click your project and click **Properties**.\n2. In the left-hand pane of the **Properties** dialog, click **Deployment Assembly**, and then click **Add**.\n3. In the **New Assembly Directive** dialog, click **Java Build Path Entries** and then click **Next**.\n4. Select **Microsoft JDBC Driver 4.0 SQL Server** and then click **Finish**.\n5. Click **OK** to close the **Properties** dialog.\n6. Export your project's WAR file to your approot folder, and rebuild your Azure project, per the steps documented at [Creating a Hello World Application Using the Azure Plugin for Eclipse with Java (by Microsoft Open Technologies)](http://msdn.microsoft.com/library/windowsazure/hh690944.aspx). That topic also describes how to run your application in the compute emulator, and in Azure.\n\n**Packaging the Microsoft JDBC Driver 4.0 SQL Server if you are not using Eclipse**\n\n* Ensure the Microsoft JDBC Driver 4.0 SQL Server library is included within the same Azure role as your Java application, and added to the class path of your application.\n\n## Next steps\n\nTo learn more about Microsoft JDBC Driver for SQL Server, see [Overview of the JDBC Driver](http://msdn.microsoft.com/library/ms378749.aspx). To learn more about SQL Database, see [SQL Database Overview](http://msdn.microsoft.com/library/windowsazure/ee336241.aspx).\n\n[Concepts]:#concepts\n[Prerequisites]:#prerequisites\n[Creating an Azure SQL Database]:#create_db\n[Determining the SQL Database connection string]:#determine_connection_string\n[To allow access to a range of IP addresses]:#specify_allowed_ips\n[To use Azure SQL Database in Java]:#use_sql_azure_in_java\n[Communicating with Azure SQL Database from your code]:#communicate_from_code\n[To create a table]:#to_create_table\n[To create an index on a table]:#to_create_index\n[To insert rows]:#to_insert_rows\n[To retrieve rows]:#to_retrieve_rows\n[To retrieve rows using a WHERE clause]:#to_retrieve_rows_using_where\n[To retrieve a count of rows]:#to_retrieve_row_count\n[To update rows]:#to_update_rows\n[To delete rows]:#to_delete_rows\n[To check whether a table exists]:#to_check_table_existence\n[To drop an index]:#to_drop_index\n[To drop a table]:#to_drop_table\n[Using SQL Database in Java within an Azure Deployment]:#using_in_azure\n[Next steps]:#nextsteps\n[create_new]: ./media/sql-data-java-how-to-use-sql-database/WA_New.png\n[create_new_sql_db]: ./media/sql-data-java-how-to-use-sql-database/WA_SQL_DB_Create.png\n[create_database_settings]: ./media/sql-data-java-how-to-use-sql-database/WA_CustomCreate_1.png\n[create_server_settings]: ./media/sql-data-java-how-to-use-sql-database/WA_CustomCreate_2.png\n[get_jdbc_connection_string]: ./media/sql-data-java-how-to-use-sql-database/WA_SQL_JDBC_ConnectionString.png\n[allowed_ips_dialog]: ./media/sql-data-java-how-to-use-sql-database/WA_Allowed_IPs.png\n \n"
}