{
  "nodes": [
    {
      "content": "Windows Universal Apps Reach SDK Integration",
      "pos": [
        28,
        72
      ]
    },
    {
      "content": "How to Integrate Azure Mobile Engagement Reach with Windows Universal Apps",
      "pos": [
        92,
        166
      ]
    },
    {
      "content": "Windows Universal Apps Reach SDK Integration",
      "pos": [
        516,
        560
      ]
    },
    {
      "pos": [
        562,
        753
      ],
      "content": "You must follow the integration procedure described in the <bpt id=\"p1\">[</bpt>Windows Universal Engagement SDK Integration<ept id=\"p1\">](mobile-engagement-windows-store-integrate-engagement.md)</ept> before following this guide."
    },
    {
      "content": "Embed the Engagement Reach SDK into your Windows Universal project",
      "pos": [
        757,
        823
      ]
    },
    {
      "content": "You do not have anything to add.",
      "pos": [
        825,
        857
      ]
    },
    {
      "content": "<ph id=\"ph1\">`EngagementReach`</ph> references and resources are already in your project.",
      "pos": [
        858,
        929
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.TIP]</ph> You can customize images located in the <ph id=\"ph2\">`Resources`</ph> folder of your project, especially the brand icon (that default to the Engagement icon).",
      "pos": [
        933,
        1085
      ]
    },
    {
      "content": "On Universal Apps you can also move the <ph id=\"ph1\">`Resources`</ph> folder on your shared project to share its content between apps, but you will have to keep the <ph id=\"ph2\">`Resources\\EngagementConfiguration.xml`</ph> file on its default location as it is platform dependent.",
      "pos": [
        1086,
        1330
      ]
    },
    {
      "content": "Enable the Windows Notification Service",
      "pos": [
        1334,
        1373
      ]
    },
    {
      "content": "In order to use the <bpt id=\"p1\">**</bpt>Windows Notification Service<ept id=\"p1\">**</ept> (referred as WNS) in your <ph id=\"ph1\">`Package.appxmanifest`</ph> file on <ph id=\"ph2\">`Application UI`</ph> click on <ph id=\"ph3\">`All Image Assets`</ph> in the left bot box.",
      "pos": [
        1375,
        1550
      ]
    },
    {
      "content": "At the right of the box in <ph id=\"ph1\">`Notifications`</ph>, change <ph id=\"ph2\">`toast capable`</ph> from <ph id=\"ph3\">`(not set)`</ph> to <ph id=\"ph4\">`(Yes)`</ph>.",
      "pos": [
        1551,
        1646
      ]
    },
    {
      "content": "Moreover, you need to synchronize your app to your Microsoft account and to the engagement platform.",
      "pos": [
        1648,
        1748
      ]
    },
    {
      "content": "For this you need to create an account or log on <bpt id=\"p1\">[</bpt>windows dev center<ept id=\"p1\">](https://dev.windows.com)</ept>.",
      "pos": [
        1749,
        1844
      ]
    },
    {
      "content": "After that create a new application and find the SID and secret key.",
      "pos": [
        1845,
        1913
      ]
    },
    {
      "content": "On the engagement frontend, go on your app setting in <ph id=\"ph1\">`native push`</ph> and paste your credentials.",
      "pos": [
        1914,
        2009
      ]
    },
    {
      "content": "After that, right click on your project, select <ph id=\"ph1\">`store`</ph> and <ph id=\"ph2\">`Associate App with the Store...`</ph>.",
      "pos": [
        2010,
        2104
      ]
    },
    {
      "content": "You just need to select the application you have create before to synchronize it.",
      "pos": [
        2105,
        2186
      ]
    },
    {
      "content": "Initialize the Engagement Reach SDK",
      "pos": [
        2190,
        2225
      ]
    },
    {
      "pos": [
        2227,
        2252
      ],
      "content": "Modify the <ph id=\"ph1\">`App.xaml.cs`</ph>:"
    },
    {
      "pos": [
        2258,
        2290
      ],
      "content": "Add to your <ph id=\"ph1\">`using`</ph> statements :"
    },
    {
      "pos": [
        2339,
        2438
      ],
      "content": "Insert <ph id=\"ph1\">`EngagementReach.Instance.Init`</ph> just after <ph id=\"ph2\">`EngagementAgent.Instance.Init`</ph> in <ph id=\"ph3\">`OnLaunched`</ph> :"
    },
    {
      "pos": [
        2633,
        2783
      ],
      "content": "If you want to enable engagement reach when your app is activated by a command, another application or a custom scheme, override <ph id=\"ph1\">`OnActivated`</ph> method:"
    },
    {
      "content": "The <ph id=\"ph1\">`EngagementReach.Instance.Init`</ph> runs in a dedicated thread.",
      "pos": [
        2974,
        3037
      ]
    },
    {
      "content": "You do not have to do it yourself.",
      "pos": [
        3038,
        3072
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.TIP]</ph> You can specify the name of the WNS push channel of your application in the <ph id=\"ph2\">`Resources\\EngagementConfiguration.xml`</ph> file of your project on <ph id=\"ph3\">`&lt;channelName&gt;&lt;/channelName&gt;`</ph>.",
      "pos": [
        3076,
        3258
      ]
    },
    {
      "content": "By default, Engagement creates a name based on the appId.",
      "pos": [
        3259,
        3316
      ]
    },
    {
      "content": "You have no need to specify the name yourself, except if you plan to use the push channel outside of Engagement.",
      "pos": [
        3317,
        3429
      ]
    },
    {
      "content": "Integration",
      "pos": [
        3433,
        3444
      ]
    },
    {
      "content": "Engagement provides two ways to implement Reach notification and announcement: the Overlay integration and the Web View integration.",
      "pos": [
        3446,
        3578
      ]
    },
    {
      "content": "Overlay integration doesn't require a lot of code to write into your application.",
      "pos": [
        3580,
        3661
      ]
    },
    {
      "content": "You just need to tag your pages, xaml and cs files, with EngagementPageOverlay.",
      "pos": [
        3662,
        3741
      ]
    },
    {
      "content": "Moreover, if you customize the Engagement default view, your customization will be shared with all tagged pages and just defined once.",
      "pos": [
        3742,
        3876
      ]
    },
    {
      "content": "But if your pages need to inherit from an object other than EngagementPageOverlay, you are stuck and forced to use Web View integration.",
      "pos": [
        3877,
        4013
      ]
    },
    {
      "content": "Webview integration is more complicated to be implemented.",
      "pos": [
        4015,
        4073
      ]
    },
    {
      "content": "But if your App pages need to inherit from an object other than \"Page\", then you have to integrate the Web View and its behavior.",
      "pos": [
        4074,
        4203
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.TIP]</ph> You should consider adding a root level <ph id=\"ph2\">`&lt;Grid&gt;&lt;/Grid&gt;`</ph> element to surround all page content.",
      "pos": [
        4207,
        4312
      ]
    },
    {
      "content": "For Webview integration, just add Webview as child of this grid.",
      "pos": [
        4313,
        4377
      ]
    },
    {
      "content": "If you need to set Engagement component elsewhere, remember that you have to manage the display size yourself.",
      "pos": [
        4378,
        4488
      ]
    },
    {
      "content": "Overlay integration",
      "pos": [
        4494,
        4513
      ]
    },
    {
      "content": "Engagement provides an overlay for notification and announcement display.",
      "pos": [
        4515,
        4588
      ]
    },
    {
      "content": "If you want to use it, do not use webview integration.",
      "pos": [
        4590,
        4644
      ]
    },
    {
      "content": "In your .xaml file change EngagementPage reference to EngagementPageOverlay",
      "pos": [
        4646,
        4721
      ]
    },
    {
      "content": "Add to your namespaces declarations:",
      "pos": [
        4727,
        4763
      ]
    },
    {
      "pos": [
        4842,
        4918
      ],
      "content": "Replace <ph id=\"ph1\">`engagement:EngagementPage`</ph> with <ph id=\"ph2\">`engagement:EngagementPageOverlay`</ph>:"
    },
    {
      "content": "With EngagementPage:",
      "pos": [
        4922,
        4942
      ]
    },
    {
      "content": "With EngagementPageOverlay:",
      "pos": [
        5124,
        5151
      ]
    },
    {
      "content": "With EngagementPageOverlay for 8.1:",
      "pos": [
        5357,
        5392
      ]
    },
    {
      "content": "Then in your .cs file tag your page in \"EngagementPageOverlay\" instead of \"EngagementPage\" and import \"Microsoft.Azure.Engagement.Overlay\".",
      "pos": [
        5626,
        5765
      ]
    },
    {
      "pos": [
        5826,
        5880
      ],
      "content": "Replace <ph id=\"ph1\">`EngagementPage`</ph> with <ph id=\"ph2\">`EngagementPageOverlay`</ph>:"
    },
    {
      "content": "With EngagementPage:",
      "pos": [
        5884,
        5904
      ]
    },
    {
      "content": "With EngagementPageOverlay:",
      "pos": [
        6153,
        6180
      ]
    },
    {
      "content": "Now this page uses the engagement overlay mechanism, you don't have to insert a web view.",
      "pos": [
        6443,
        6532
      ]
    },
    {
      "content": "The Engagement overlay uses the first “Grid” element it finds in your xaml file to add two web views on your page.",
      "pos": [
        6534,
        6648
      ]
    },
    {
      "content": "If you want to locate where web views will be set, you can define a grid named “EngagementGrid” like this:",
      "pos": [
        6649,
        6755
      ]
    },
    {
      "content": "You can customize the overlay notification and announcement directly on their xaml and cs files:",
      "pos": [
        6808,
        6904
      ]
    },
    {
      "pos": [
        6910,
        6982
      ],
      "content": "<ph id=\"ph1\">`EngagementAnnouncement.html`</ph> : The <ph id=\"ph2\">`Announcement`</ph> web view html design."
    },
    {
      "pos": [
        6987,
        7057
      ],
      "content": "<ph id=\"ph1\">`EngagementOverlayAnnouncement.xaml`</ph> : The <ph id=\"ph2\">`Announcement`</ph> xaml design."
    },
    {
      "pos": [
        7062,
        7157
      ],
      "content": "<ph id=\"ph1\">`EngagementOverlayAnnouncement.xaml.cs`</ph> : The <ph id=\"ph2\">`EngagementOverlayAnnouncement.xaml`</ph> linked code."
    },
    {
      "pos": [
        7162,
        7234
      ],
      "content": "<ph id=\"ph1\">`EngagementNotification.html`</ph> : The <ph id=\"ph2\">`Notification`</ph> web view html design."
    },
    {
      "pos": [
        7239,
        7309
      ],
      "content": "<ph id=\"ph1\">`EngagementOverlayNotification.xaml`</ph> : The <ph id=\"ph2\">`Notification`</ph> xaml design."
    },
    {
      "pos": [
        7314,
        7409
      ],
      "content": "<ph id=\"ph1\">`EngagementOverlayNotification.xaml.cs`</ph> : The <ph id=\"ph2\">`EngagementOverlayNotification.xaml`</ph> linked code."
    },
    {
      "pos": [
        7414,
        7500
      ],
      "content": "<ph id=\"ph1\">`EngagementPageOverlay.cs`</ph> : The <ph id=\"ph2\">`Overlay`</ph> announcement and notification display code."
    },
    {
      "content": "Web View integration",
      "pos": [
        7506,
        7526
      ]
    },
    {
      "content": "If you want to use it, do not use Overlay integration.",
      "pos": [
        7528,
        7582
      ]
    },
    {
      "content": "To display engagement content, you need to integrate the two xaml WebView in each page and you need to display notification and announcement.",
      "pos": [
        7584,
        7725
      ]
    },
    {
      "content": "So add this code in your xaml file:",
      "pos": [
        7726,
        7761
      ]
    },
    {
      "content": "For 8.1 integration:",
      "pos": [
        8113,
        8133
      ]
    },
    {
      "content": "And your associate .cs file have to look like:",
      "pos": [
        8725,
        8771
      ]
    },
    {
      "content": "This implementation embedded WebView resizing when the device screen is turned.",
      "pos": [
        11817,
        11896
      ]
    },
    {
      "content": "Handle datapush (optional)",
      "pos": [
        11900,
        11926
      ]
    },
    {
      "content": "If you want your application to be able to receive Reach data pushes, you have to implement two events of the EngagementReach class:",
      "pos": [
        11928,
        12060
      ]
    },
    {
      "content": "In App.xaml.cs in \"Public App(){}\" add:",
      "pos": [
        12062,
        12101
      ]
    },
    {
      "content": "You can see that the callback of each method returns a boolean.",
      "pos": [
        12638,
        12701
      ]
    },
    {
      "content": "Engagement sends a feedback to its back-end after dispatching the data push.",
      "pos": [
        12702,
        12778
      ]
    },
    {
      "content": "If the callback returns false, the <ph id=\"ph1\">`exit`</ph> feedback will be send.",
      "pos": [
        12779,
        12843
      ]
    },
    {
      "content": "Otherwise, it will be <ph id=\"ph1\">`action`</ph>.",
      "pos": [
        12844,
        12875
      ]
    },
    {
      "content": "If no callback is set for the events, the <ph id=\"ph1\">`drop`</ph> feedback will be returned to Engagement.",
      "pos": [
        12876,
        12965
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.WARNING]</ph> Engagement is not able to receive multiples feedbacks for a data push.",
      "pos": [
        12969,
        13055
      ]
    },
    {
      "content": "If you plan to set several handlers on an event, be aware that the feedback will correspond to the last one sent.",
      "pos": [
        13056,
        13169
      ]
    },
    {
      "content": "In this case, we recommend to always returns the same value to avoid having confusing feedback on the front-end.",
      "pos": [
        13170,
        13282
      ]
    },
    {
      "content": "Customize UI (optional)",
      "pos": [
        13286,
        13309
      ]
    },
    {
      "content": "First step",
      "pos": [
        13315,
        13325
      ]
    },
    {
      "content": "We allow you to customize the reach UI.",
      "pos": [
        13327,
        13366
      ]
    },
    {
      "pos": [
        13368,
        13446
      ],
      "content": "To do so, you have to create a subclass of the <ph id=\"ph1\">`EngagementReachHandler`</ph> class."
    },
    {
      "content": "Sample Code :",
      "pos": [
        13450,
        13463
      ]
    },
    {
      "pos": [
        13773,
        13921
      ],
      "content": "Then, set the content of the <ph id=\"ph1\">`EngagementReach.Instance.Handler`</ph> field with your custom object in your <ph id=\"ph2\">`App.xaml.cs`</ph> class within the <ph id=\"ph3\">`App()`</ph> method."
    },
    {
      "content": "Sample Code :",
      "pos": [
        13925,
        13938
      ]
    },
    {
      "pos": [
        14228,
        14478
      ],
      "content": "[AZURE.NOTE] By default, Engagement uses its own implementation of `EngagementReachHandler`.\nYou don't have to create your own, and if you do so, you don't have to override every method. The default behavior is to select the Engagement base object.",
      "leadings": [
        "",
        "> "
      ],
      "nodes": [
        {
          "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> By default, Engagement uses its own implementation of <ph id=\"ph2\">`EngagementReachHandler`</ph>.",
          "pos": [
            0,
            92
          ]
        },
        {
          "content": "You don't have to create your own, and if you do so, you don't have to override every method. The default behavior is to select the Engagement base object.",
          "pos": [
            93,
            248
          ],
          "nodes": [
            {
              "content": "You don't have to create your own, and if you do so, you don't have to override every method.",
              "pos": [
                0,
                93
              ]
            },
            {
              "content": "The default behavior is to select the Engagement base object.",
              "pos": [
                94,
                155
              ]
            }
          ]
        }
      ]
    },
    {
      "content": "Web View",
      "pos": [
        14484,
        14492
      ]
    },
    {
      "content": "By default, Reach will use the embedded resources of the DLL to display the notifications and pages.",
      "pos": [
        14494,
        14594
      ]
    },
    {
      "content": "To provide a full customization possibilities we only use web view.",
      "pos": [
        14596,
        14663
      ]
    },
    {
      "content": "If you want to customize layouts, override directly the resources files <ph id=\"ph1\">`EngagementAnnouncement.html`</ph> and <ph id=\"ph2\">`EngagementNotification.html`</ph>.",
      "pos": [
        14664,
        14800
      ]
    },
    {
      "content": "Engagement needs all code in <ph id=\"ph1\">`&lt;body&gt;&lt;/body&gt;`</ph> to run correctly.",
      "pos": [
        14801,
        14863
      ]
    },
    {
      "content": "But you can add tag outer <ph id=\"ph1\">`engagement_webview_area`</ph>.",
      "pos": [
        14864,
        14916
      ]
    },
    {
      "content": "However, you can decide to use your own resources.",
      "pos": [
        14918,
        14968
      ]
    },
    {
      "pos": [
        14970,
        15128
      ],
      "content": "You can override <ph id=\"ph1\">`EngagementReachHandler`</ph> methods in your subclass to tell Engagement to use your layouts, but take care to embedded the engagement mechanism:"
    },
    {
      "content": "Sample Code :",
      "pos": [
        15132,
        15145
      ]
    },
    {
      "content": "By default, AnnouncementHTML is <ph id=\"ph1\">`ms-appx-web:///Resources/EngagementAnnouncement.html`</ph>.",
      "pos": [
        15774,
        15861
      ]
    },
    {
      "content": "It represents the html file that design the content of a push message (Text announcement, Web anoucement and Poll announcement).",
      "pos": [
        15862,
        15990
      ]
    },
    {
      "content": "AnnouncementName is <ph id=\"ph1\">`engagement_announcement_content`</ph>.",
      "pos": [
        15991,
        16045
      ]
    },
    {
      "content": "It is the name of the webview design in your xaml page.",
      "pos": [
        16046,
        16101
      ]
    },
    {
      "content": "NotfificationHTML is <ph id=\"ph1\">`ms-appx-web:///Resources/EngagementNotification.html`</ph>.",
      "pos": [
        16103,
        16179
      ]
    },
    {
      "content": "It represents the html file that design the notification of a push message.",
      "pos": [
        16180,
        16255
      ]
    },
    {
      "content": "NotfificationName is <ph id=\"ph1\">`engagement_notification_content`</ph>.",
      "pos": [
        16256,
        16311
      ]
    },
    {
      "content": "It is the name of the webview design in your xaml page.",
      "pos": [
        16312,
        16367
      ]
    },
    {
      "content": "Customization",
      "pos": [
        16373,
        16386
      ]
    },
    {
      "content": "You can customize notification and announcement web view has you want if you preserve Engagement object.",
      "pos": [
        16388,
        16492
      ]
    },
    {
      "content": "Take care that webview object is described three times - the first time in your xaml, second time in your .cs file in the \"setwebview()\" method, and third time in the html file.",
      "pos": [
        16493,
        16670
      ]
    },
    {
      "content": "In your xaml you describe the current graphical layout webview component.",
      "pos": [
        16676,
        16749
      ]
    },
    {
      "content": "In your .cs file you can define \"setwebview()\" in which you set the dimension of the two webview (notification, announcement).",
      "pos": [
        16754,
        16880
      ]
    },
    {
      "content": "It is very effective when the application is resizing.",
      "pos": [
        16881,
        16935
      ]
    },
    {
      "content": "In the Engagement html file we describe the webview content, design and the elements positions between each other.",
      "pos": [
        16940,
        17054
      ]
    },
    {
      "content": "Launch message",
      "pos": [
        17060,
        17074
      ]
    },
    {
      "content": "When a user clicks on a system notification (a toast), Engagement launches the application, load the content of the push messages, and display the page for the corresponding campaign.",
      "pos": [
        17076,
        17259
      ]
    },
    {
      "content": "There is a delay between the launch of the application and the display of the page (depending on the speed of your network).",
      "pos": [
        17261,
        17385
      ]
    },
    {
      "content": "To indicate to the user that something is loading, you should provide a visual information, like a progress bar or a progress indicator.",
      "pos": [
        17387,
        17523
      ]
    },
    {
      "content": "Engagement cannot handle that itself, but provides a few handlers for you.",
      "pos": [
        17524,
        17598
      ]
    },
    {
      "content": "To implement the callback, in App.xaml.cs in \"Public App(){}\" add:",
      "pos": [
        17600,
        17666
      ]
    },
    {
      "pos": [
        18477,
        18623
      ],
      "content": "You can set the callback in your \"Public App(){}\" method of your <ph id=\"ph1\">`App.xaml.cs`</ph> file, preferably before the <ph id=\"ph2\">`EngagementReach.Instance.Init()`</ph> call."
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.TIP]</ph> Each handler is called by the UI Thread.",
      "pos": [
        18627,
        18679
      ]
    },
    {
      "content": "You do not have to worry when using a MessageBox or something UI-related.",
      "pos": [
        18680,
        18753
      ]
    },
    {
      "content": "Custom scheme tip",
      "pos": [
        18757,
        18774
      ]
    },
    {
      "content": "We provide custom scheme use.",
      "pos": [
        18776,
        18805
      ]
    },
    {
      "content": "You can send different type of URI from engagement frontend to be used in your engagement application.",
      "pos": [
        18806,
        18908
      ]
    },
    {
      "content": "Default scheme like <ph id=\"ph1\">`http, ftp, ...`</ph> are manage by Windows, a window will prompt if they are no default application installed on device.",
      "pos": [
        18909,
        19045
      ]
    },
    {
      "content": "Other scheme like application scheme can be used.",
      "pos": [
        19046,
        19095
      ]
    },
    {
      "content": "Moreover, you can use a custom scheme for your application.",
      "pos": [
        19096,
        19155
      ]
    },
    {
      "content": "The simple way to set a custom scheme in your application is to open your <ph id=\"ph1\">`Package.appxmanifest`</ph> go in <ph id=\"ph2\">`Declarations`</ph> panel.",
      "pos": [
        19157,
        19281
      ]
    },
    {
      "content": "Select <ph id=\"ph1\">`Protocol`</ph> in the Available Declarations scroll box and add it.",
      "pos": [
        19282,
        19352
      ]
    },
    {
      "content": "Edit the <ph id=\"ph1\">`Name`</ph> field with your new protocol desired name.",
      "pos": [
        19353,
        19411
      ]
    },
    {
      "pos": [
        19413,
        19546
      ],
      "content": "Now to use this protocol, edit your <ph id=\"ph1\">`App.xaml.cs`</ph> with the <ph id=\"ph2\">`OnActivated`</ph> method, and don't forget to initialize engagement here also:"
    },
    {
      "content": "test",
      "pos": [
        20514,
        20518
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Windows Universal Apps Reach SDK Integration\" \n    description=\"How to Integrate Azure Mobile Engagement Reach with Windows Universal Apps\"\n    services=\"mobile-engagement\" \n    documentationCenter=\"mobile\" \n    authors=\"piyushjo\" \n    manager=\"dwrede\" \n    editor=\"\" />\n\n<tags \n    ms.service=\"mobile-engagement\" \n    ms.workload=\"mobile\" \n    ms.tgt_pltfrm=\"mobile-windows-store\" \n    ms.devlang=\"dotnet\" \n    ms.topic=\"article\" \n    ms.date=\"07/07/2015\" \n    ms.author=\"piyushjo\" />\n\n#Windows Universal Apps Reach SDK Integration\n\nYou must follow the integration procedure described in the [Windows Universal Engagement SDK Integration](mobile-engagement-windows-store-integrate-engagement.md) before following this guide.\n\n##Embed the Engagement Reach SDK into your Windows Universal project\n\nYou do not have anything to add. `EngagementReach` references and resources are already in your project.\n\n> [AZURE.TIP] You can customize images located in the `Resources` folder of your project, especially the brand icon (that default to the Engagement icon). On Universal Apps you can also move the `Resources` folder on your shared project to share its content between apps, but you will have to keep the `Resources\\EngagementConfiguration.xml` file on its default location as it is platform dependent.\n\n##Enable the Windows Notification Service\n\nIn order to use the **Windows Notification Service** (referred as WNS) in your `Package.appxmanifest` file on `Application UI` click on `All Image Assets` in the left bot box. At the right of the box in `Notifications`, change `toast capable` from `(not set)` to `(Yes)`.\n\nMoreover, you need to synchronize your app to your Microsoft account and to the engagement platform. For this you need to create an account or log on [windows dev center](https://dev.windows.com). After that create a new application and find the SID and secret key. On the engagement frontend, go on your app setting in `native push` and paste your credentials. After that, right click on your project, select `store` and `Associate App with the Store...`. You just need to select the application you have create before to synchronize it.\n\n##Initialize the Engagement Reach SDK\n\nModify the `App.xaml.cs`:\n\n-   Add to your `using` statements :\n\n        using Microsoft.Azure.Engagement;\n\n-   Insert `EngagementReach.Instance.Init` just after `EngagementAgent.Instance.Init` in `OnLaunched` :\n\n        protected override void OnLaunched(LaunchActivatedEventArgs args)\n        {\n          EngagementAgent.Instance.Init(args);\n          EngagementReach.Instance.Init(args);\n        }\n\n-   If you want to enable engagement reach when your app is activated by a command, another application or a custom scheme, override `OnActivated` method:\n\n        protected override void OnActivated(IActivatedEventArgs args)\n        {\n          EngagementAgent.Instance.Init(args);\n          EngagementReach.Instance.Init(args);\n        }\n\n    The `EngagementReach.Instance.Init` runs in a dedicated thread. You do not have to do it yourself.\n\n> [AZURE.TIP] You can specify the name of the WNS push channel of your application in the `Resources\\EngagementConfiguration.xml` file of your project on `<channelName></channelName>`. By default, Engagement creates a name based on the appId. You have no need to specify the name yourself, except if you plan to use the push channel outside of Engagement.\n\n##Integration\n\nEngagement provides two ways to implement Reach notification and announcement: the Overlay integration and the Web View integration.\n\nOverlay integration doesn't require a lot of code to write into your application. You just need to tag your pages, xaml and cs files, with EngagementPageOverlay. Moreover, if you customize the Engagement default view, your customization will be shared with all tagged pages and just defined once. But if your pages need to inherit from an object other than EngagementPageOverlay, you are stuck and forced to use Web View integration.\n\nWebview integration is more complicated to be implemented. But if your App pages need to inherit from an object other than \"Page\", then you have to integrate the Web View and its behavior.\n\n> [AZURE.TIP] You should consider adding a root level `<Grid></Grid>` element to surround all page content. For Webview integration, just add Webview as child of this grid. If you need to set Engagement component elsewhere, remember that you have to manage the display size yourself.\n\n### Overlay integration\n\nEngagement provides an overlay for notification and announcement display.\n\nIf you want to use it, do not use webview integration.\n\nIn your .xaml file change EngagementPage reference to EngagementPageOverlay\n\n-   Add to your namespaces declarations:\n\n            xmlns:engagement=\"using:Microsoft.Azure.Engagement.Overlay\"\n\n-   Replace `engagement:EngagementPage` with `engagement:EngagementPageOverlay`:\n\n**With EngagementPage:**\n\n        <engagement:EngagementPage \n            xmlns:engagement=\"using:Microsoft.Azure.Engagement\">\n        \n            <!-- layout -->\n        </engagement:EngagementPage>\n\n**With EngagementPageOverlay:**\n\n        <engagement:EngagementPageOverlay \n            xmlns:engagement=\"using:Microsoft.Azure.Engagement.Overlay\">\n        \n            <!-- layout -->\n        </engagement:EngagementPageOverlay>\n\n> **With EngagementPageOverlay for 8.1:**\n\n        <engagement:EngagementPageOverlay \n            xmlns:engagement=\"using:Microsoft.Azure.Engagement.Overlay\">\n            <Grid>\n              <!-- layout -->\n            </Grid>\n        </engagement:EngagementPageOverlay>\n\nThen in your .cs file tag your page in \"EngagementPageOverlay\" instead of \"EngagementPage\" and import \"Microsoft.Azure.Engagement.Overlay\".\n\n            using Microsoft.Azure.Engagement.Overlay;\n\n-   Replace `EngagementPage` with `EngagementPageOverlay`:\n\n**With EngagementPage:**\n\n            using Microsoft.Azure.Engagement;\n            \n            namespace Example\n            {\n              public sealed partial class ExamplePage : EngagementPage\n              {\n                [...]\n              }\n            }\n\n**With EngagementPageOverlay:**\n\n            using Microsoft.Azure.Engagement.Overlay;\n            \n            namespace Example\n            {\n              public sealed partial class ExamplePage : EngagementPageOverlay \n              {\n                [...]\n              }\n            }\n\nNow this page uses the engagement overlay mechanism, you don't have to insert a web view.\n\nThe Engagement overlay uses the first “Grid” element it finds in your xaml file to add two web views on your page. If you want to locate where web views will be set, you can define a grid named “EngagementGrid” like this:\n\n            <Grid x:Name=\"EngagementGrid\"></Grid>\n\nYou can customize the overlay notification and announcement directly on their xaml and cs files:\n\n-   `EngagementAnnouncement.html` : The `Announcement` web view html design.\n-   `EngagementOverlayAnnouncement.xaml` : The `Announcement` xaml design.\n-   `EngagementOverlayAnnouncement.xaml.cs` : The `EngagementOverlayAnnouncement.xaml` linked code.\n-   `EngagementNotification.html` : The `Notification` web view html design.\n-   `EngagementOverlayNotification.xaml` : The `Notification` xaml design.\n-   `EngagementOverlayNotification.xaml.cs` : The `EngagementOverlayNotification.xaml` linked code.\n-   `EngagementPageOverlay.cs` : The `Overlay` announcement and notification display code.\n\n### Web View integration\n\nIf you want to use it, do not use Overlay integration.\n\nTo display engagement content, you need to integrate the two xaml WebView in each page and you need to display notification and announcement. So add this code in your xaml file:\n\n            <WebView x:Name=\"engagement_notification_content\" Visibility=\"Collapsed\" ScriptNotify=\"scriptEvent\" Height=\"64\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Top\"/>\n            <WebView x:Name=\"engagement_announcement_content\" Visibility=\"Collapsed\" ScriptNotify=\"scriptEvent\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Top\"/> \n\n> **For 8.1 integration:**\n\n            <engagement:EngagementPage\n                xmlns:engagement=\"using:Microsoft.Azure.Engagement\">\n                <Grid>\n                  <WebView x:Name=\"engagement_notification_content\" Visibility=\"Collapsed\" ScriptNotify=\"scriptEvent\" Height=\"64\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Top\"/>\n                  <WebView x:Name=\"engagement_announcement_content\" Visibility=\"Collapsed\" ScriptNotify=\"scriptEvent\" HorizontalAlignment=\"Right\" VerticalAlignment=\"Top\"/> \n                  <!-- layout -->\n                </Grid>\n            </engagement:EngagementPage>\n\nAnd your associate .cs file have to look like:\n\n            /// <summary>\n            /// An empty page that can be used on its own or navigated to within a Frame.\n            /// </summary>\n            public sealed partial class ExampleEngagementReachPage : EngagementPage\n            {\n              public ExampleEngagementReachPage()\n              {\n                this.InitializeComponent();\n            \n               /* Set your webview elements to the correct size */\n                SetWebView(width, height);\n            \n                Window.Current.SizeChanged += DisplayProperties_OrientationChanged;\n              }\n            \n              #region to implement\n              /* Allow webview script to notify system */\n              private void scriptEvent(object sender, NotifyEventArgs e)\n              {\n              }\n            \n              /* When page is left ensure to detach SizeChanged handler */\n              protected override void OnNavigatedFrom(NavigationEventArgs e)\n              {\n                Window.Current.SizeChanged -= DisplayProperties_OrientationChanged;\n                base.OnNavigatedFrom(e);\n              }\n            \n              /* \"width\" is the current width of your application display */\n              double width = Window.Current.Bounds.Width;\n            \n              /* \"height\" is the current height of your application display */\n              double height = Window.Current.Bounds.Height;\n            \n              /// <summary>\n              /// Set your webview elements to the correct size\n              /// </summary>\n              /// <param name=\"width\">The width of your current display</param>\n              /// <param name=\"height\">The height of your current display</param>\n              private void SetWebView(double width, double height)\n              {\n                #pragma warning disable 4014\n                CoreApplication.MainView.CoreWindow.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal,\n                        () =>\n                        {\n                          this.engagement_notification_content.Width = width;\n                          this.engagement_announcement_content.Width = width;\n                          this.engagement_announcement_content.Height = height;\n                        });\n              }\n            \n              /// <summary>\n              /// Handler that take the Windows.Current.SizeChanged and indicate that webview have to be resized\n              /// </summary>\n              /// <param name=\"sender\">Original event trigger</param>\n              /// <param name=\"e\">Window Size Changed Event argument</param>\n              private void DisplayProperties_OrientationChanged(object sender, Windows.UI.Core.WindowSizeChangedEventArgs e)\n              {\n                double width = e.Size.Width;\n                double height = e.Size.Height;\n            \n                /* Set your webview elements to the correct size */\n                SetWebView(width, height);\n              }\n              #endregion\n            }\n\n> This implementation embedded WebView resizing when the device screen is turned.\n\n##Handle datapush (optional)\n\nIf you want your application to be able to receive Reach data pushes, you have to implement two events of the EngagementReach class:\n\nIn App.xaml.cs in \"Public App(){}\" add:\n\n            EngagementReach.Instance.DataPushStringReceived += (body) =>\n            {\n              Debug.WriteLine(\"String data push message received: \" + body);\n              return true;\n            };\n            \n            EngagementReach.Instance.DataPushBase64Received += (decodedBody, encodedBody) =>\n            {\n              Debug.WriteLine(\"Base64 data push message received: \" + encodedBody);\n              // Do something useful with decodedBody like updating an image view\n              return true;\n            };\n\nYou can see that the callback of each method returns a boolean. Engagement sends a feedback to its back-end after dispatching the data push. If the callback returns false, the `exit` feedback will be send. Otherwise, it will be `action`. If no callback is set for the events, the `drop` feedback will be returned to Engagement.\n\n> [AZURE.WARNING] Engagement is not able to receive multiples feedbacks for a data push. If you plan to set several handlers on an event, be aware that the feedback will correspond to the last one sent. In this case, we recommend to always returns the same value to avoid having confusing feedback on the front-end.\n\n##Customize UI (optional)\n\n### First step\n\nWe allow you to customize the reach UI.\n\nTo do so, you have to create a subclass of the `EngagementReachHandler` class.\n\n**Sample Code :**\n\n            using Microsoft.Azure.Engagement;\n            \n            namespace Example\n            {\n              internal class ExampleReachHandler : EngagementReachHandler\n              {\n               // Override EngagementReachHandler methods depending on your needs\n              }\n            }\n\nThen, set the content of the `EngagementReach.Instance.Handler` field with your custom object in your `App.xaml.cs` class within the `App()` method.\n\n**Sample Code :**\n\n            protected override void OnLaunched(LaunchActivatedEventArgs args)\n            {\n              // your app initialization \n              EngagementReach.Instance.Handler = new ExampleReachHandler();\n              // Engagement Agent and Reach initialization\n            }\n\n> [AZURE.NOTE] By default, Engagement uses its own implementation of `EngagementReachHandler`.\n> You don't have to create your own, and if you do so, you don't have to override every method. The default behavior is to select the Engagement base object.\n\n### Web View\n\nBy default, Reach will use the embedded resources of the DLL to display the notifications and pages.\n\nTo provide a full customization possibilities we only use web view. If you want to customize layouts, override directly the resources files `EngagementAnnouncement.html` and `EngagementNotification.html`. Engagement needs all code in `<body></body>` to run correctly. But you can add tag outer `engagement_webview_area`.\n\nHowever, you can decide to use your own resources.\n\nYou can override `EngagementReachHandler` methods in your subclass to tell Engagement to use your layouts, but take care to embedded the engagement mechanism:\n\n**Sample Code :**\n            \n            // In your subclass of EngagementReachHandler\n            \n            public override string GetAnnouncementHTML()\n            {\n              return base.GetAnnouncementHTML();\n            }\n            public override string GetAnnouncementName()\n            {\n              return base.GetAnnouncementName();\n            }\n            public override string GetNotfificationHTML()\n            {\n              return base.GetNotfificationHTML();\n            }\n            public override string GetNotfificationName()\n            {\n              return base.GetNotfificationName();\n            }\n\n\nBy default, AnnouncementHTML is `ms-appx-web:///Resources/EngagementAnnouncement.html`. It represents the html file that design the content of a push message (Text announcement, Web anoucement and Poll announcement). AnnouncementName is `engagement_announcement_content`. It is the name of the webview design in your xaml page.\n\nNotfificationHTML is `ms-appx-web:///Resources/EngagementNotification.html`. It represents the html file that design the notification of a push message. NotfificationName is `engagement_notification_content`. It is the name of the webview design in your xaml page.\n\n### Customization\n\nYou can customize notification and announcement web view has you want if you preserve Engagement object. Take care that webview object is described three times - the first time in your xaml, second time in your .cs file in the \"setwebview()\" method, and third time in the html file.\n\n-   In your xaml you describe the current graphical layout webview component.\n-   In your .cs file you can define \"setwebview()\" in which you set the dimension of the two webview (notification, announcement). It is very effective when the application is resizing.\n-   In the Engagement html file we describe the webview content, design and the elements positions between each other.\n\n### Launch message\n\nWhen a user clicks on a system notification (a toast), Engagement launches the application, load the content of the push messages, and display the page for the corresponding campaign.\n\nThere is a delay between the launch of the application and the display of the page (depending on the speed of your network).\n\nTo indicate to the user that something is loading, you should provide a visual information, like a progress bar or a progress indicator. Engagement cannot handle that itself, but provides a few handlers for you.\n\nTo implement the callback, in App.xaml.cs in \"Public App(){}\" add:\n\n            /* The application has launched and the content is loading.\n             * You should display an indicator here.\n             */\n            EngagementReach.Instance.RetrieveLaunchMessageStarted += () => { [...] };\n            \n            /* The application has finished loading the content and the page\n             * is about to be displayed.\n             * You should hide the indicator here.\n             */\n            EngagementReach.Instance.RetrieveLaunchMessageCompleted += () => { [...] };\n            \n            /* The content has been loaded, but an error has occurred.\n             * You can provide an information to the user.\n             * You should hide the indicator here.\n             */\n            EngagementReach.Instance.RetrieveLaunchMessageFailed += () => { [...] };\n\nYou can set the callback in your \"Public App(){}\" method of your `App.xaml.cs` file, preferably before the `EngagementReach.Instance.Init()` call.\n\n> [AZURE.TIP] Each handler is called by the UI Thread. You do not have to worry when using a MessageBox or something UI-related.\n\n##Custom scheme tip\n\nWe provide custom scheme use. You can send different type of URI from engagement frontend to be used in your engagement application. Default scheme like `http, ftp, ...` are manage by Windows, a window will prompt if they are no default application installed on device. Other scheme like application scheme can be used. Moreover, you can use a custom scheme for your application.\n\nThe simple way to set a custom scheme in your application is to open your `Package.appxmanifest` go in `Declarations` panel. Select `Protocol` in the Available Declarations scroll box and add it. Edit the `Name` field with your new protocol desired name.\n\nNow to use this protocol, edit your `App.xaml.cs` with the `OnActivated` method, and don't forget to initialize engagement here also:\n\n            /// <summary>\n            /// Enter point when app his called by another way than user click\n            /// </summary>\n            /// <param name=\"args\">Activation args</param>\n            protected override void OnActivated(IActivatedEventArgs args)\n            {\n              /* Init engagement like it was launch by a custom uri scheme */\n              EngagementAgent.Instance.Init(args);\n              EngagementReach.Instance.Init(args);\n            \n              //TODO design action to do when app is launch\n            \n              #region Custom scheme use\n              if (args.Kind == ActivationKind.Protocol)\n              {\n                ProtocolActivatedEventArgs myProtocol = (ProtocolActivatedEventArgs)args;\n            \n                if (myProtocol.Uri.Scheme.Equals(\"protocolName\"))\n                {\n                  string path = myProtocol.Uri.AbsolutePath;\n                }\n              }\n              #endregion\n \ntest\n"
}