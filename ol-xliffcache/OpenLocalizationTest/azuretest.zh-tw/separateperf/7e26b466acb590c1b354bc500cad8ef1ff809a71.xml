{
  "nodes": [
    {
      "content": "Reliable Actors Diagnostics and Performance Monitoring",
      "pos": [
        26,
        80
      ]
    },
    {
      "content": "This article describes the diagnostics and performance monitoring features in the Reliable Actors runtime, including the events and performance counters emitted by it.",
      "pos": [
        98,
        265
      ]
    },
    {
      "content": "Diagnostics and Performance Monitoring for Reliable Actors",
      "pos": [
        563,
        621
      ]
    },
    {
      "pos": [
        622,
        972
      ],
      "content": "Reliable Actors runtime emits <bpt id=\"p1\">[</bpt>EventSource<ept id=\"p1\">](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.aspx)</ept> events and <bpt id=\"p2\">[</bpt>performance counters<ept id=\"p2\">](https://msdn.microsoft.com/library/system.diagnostics.performancecounter.aspx)</ept> that provide insights into how the runtime is operating and help with troubleshooting and performance monitoring."
    },
    {
      "content": "EventSource events",
      "pos": [
        977,
        995
      ]
    },
    {
      "content": "The EventSource name for Reliable Actors runtime is \"Microsoft-ServiceFabric-Actors\".",
      "pos": [
        996,
        1081
      ]
    },
    {
      "content": "Events from this event source appear in the <bpt id=\"p1\">[</bpt>Diagnostics Events<ept id=\"p1\">](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md#view-service-fabric-system-events-in-visual-studio)</ept> window when the actor application is being <bpt id=\"p2\">[</bpt>debugged in Visual Studio<ept id=\"p2\">](service-fabric-debugging-your-application.md)</ept>.",
      "pos": [
        1082,
        1391
      ]
    },
    {
      "content": "Service Fabric also offers the option of directing these events to <bpt id=\"p1\">[</bpt>Application Insights<ept id=\"p1\">](http://azure.microsoft.com/services/application-insights/)</ept>.",
      "pos": [
        1393,
        1542
      ]
    },
    {
      "content": "For more information on this, please see the article on <bpt id=\"p1\">[</bpt>Application Insights setup for Service Fabric<ept id=\"p1\">](service-fabric-diagnostics-application-insights-setup.md)</ept>.",
      "pos": [
        1543,
        1705
      ]
    },
    {
      "pos": [
        1707,
        2121
      ],
      "content": "Other examples of tools and technologies that help in collecting and/or viewing EventSource events are <bpt id=\"p1\">[</bpt>PerfView<ept id=\"p1\">](http://www.microsoft.com/download/details.aspx?id=28567)</ept>, <bpt id=\"p2\">[</bpt>Azure Diagnostics<ept id=\"p2\">](../cloud-services-dotnet-diagnostics.md)</ept>, <bpt id=\"p3\">[</bpt>Semantic Logging<ept id=\"p3\">](https://msdn.microsoft.com/library/dn774980.aspx)</ept> and the <bpt id=\"p4\">[</bpt>Microsoft TraceEvent Library<ept id=\"p4\">](http://www.nuget.org/packages/Microsoft.Diagnostics.Tracing.TraceEvent)</ept>."
    },
    {
      "content": "Keywords",
      "pos": [
        2127,
        2135
      ]
    },
    {
      "content": "All events that belong to the Reliable Actors EventSource are associated with one or more keywords.",
      "pos": [
        2136,
        2235
      ]
    },
    {
      "content": "This enables filtering of events that are collected.",
      "pos": [
        2236,
        2288
      ]
    },
    {
      "content": "The following keywords bits are defined:",
      "pos": [
        2289,
        2329
      ]
    },
    {
      "content": "Bit",
      "pos": [
        2332,
        2335
      ]
    },
    {
      "content": "Description",
      "pos": [
        2336,
        2347
      ]
    },
    {
      "content": "0x1",
      "pos": [
        2360,
        2363
      ]
    },
    {
      "content": "Set of important events that summarize the operation of the Fabric Actors runtime",
      "pos": [
        2364,
        2445
      ]
    },
    {
      "content": "0x2",
      "pos": [
        2448,
        2451
      ]
    },
    {
      "content": "Set of events describing actor method calls.",
      "pos": [
        2452,
        2496
      ]
    },
    {
      "content": "For more information, please see the <bpt id=\"p1\">[</bpt>introductory topic on actors<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#actors)</ept>.",
      "pos": [
        2497,
        2620
      ]
    },
    {
      "content": "0x4",
      "pos": [
        2623,
        2626
      ]
    },
    {
      "content": "Set of events related to actor state.",
      "pos": [
        2627,
        2664
      ]
    },
    {
      "content": "For more information, please see the topic on <bpt id=\"p1\">[</bpt>stateful actors<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#stateful-actors)</ept>.",
      "pos": [
        2665,
        2793
      ]
    },
    {
      "content": "0x8",
      "pos": [
        2796,
        2799
      ]
    },
    {
      "content": "Set of events related to turn-based concurrency in the actor.",
      "pos": [
        2800,
        2861
      ]
    },
    {
      "content": "For more information, please see the topic on <bpt id=\"p1\">[</bpt>concurrency<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#concurrency)</ept>.",
      "pos": [
        2862,
        2982
      ]
    },
    {
      "content": "Performance counters",
      "pos": [
        2988,
        3008
      ]
    },
    {
      "content": "The Reliable Actors runtime defines the following performance counter categories.",
      "pos": [
        3009,
        3090
      ]
    },
    {
      "content": "Category",
      "pos": [
        3093,
        3101
      ]
    },
    {
      "content": "Description",
      "pos": [
        3102,
        3113
      ]
    },
    {
      "content": "Service Fabric Actor",
      "pos": [
        3126,
        3146
      ]
    },
    {
      "content": "Counters specific to Service Fabric actors.",
      "pos": [
        3147,
        3190
      ]
    },
    {
      "content": "e.g. time taken to save actor state.",
      "pos": [
        3191,
        3227
      ]
    },
    {
      "content": "Service Fabric Actor Method",
      "pos": [
        3230,
        3257
      ]
    },
    {
      "content": "Counters specific to methods implemented by Service Fabric actors.",
      "pos": [
        3258,
        3324
      ]
    },
    {
      "content": "e.g. how often an actor method is invoked.",
      "pos": [
        3325,
        3367
      ]
    },
    {
      "content": "Each of the above categories has one or more counters.",
      "pos": [
        3370,
        3424
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt>Windows Performance Monitor<ept id=\"p1\">](https://technet.microsoft.com/library/cc749249.aspx)</ept> application that is available by default in the Windows operating system can be used to collect and view performance counter data.",
      "pos": [
        3426,
        3643
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>Azure Diagnostics<ept id=\"p1\">](../cloud-services-dotnet-diagnostics.md)</ept> is another option for collecting performance counter data and uploading it to Azure tables.",
      "pos": [
        3644,
        3796
      ]
    },
    {
      "content": "Performance counter instance names",
      "pos": [
        3802,
        3836
      ]
    },
    {
      "content": "A cluster with a large number of actor services or actor service partitions will have a large number of actor performance counter instances.",
      "pos": [
        3837,
        3977
      ]
    },
    {
      "content": "The performance counter instances names can help in identifying the specific <bpt id=\"p1\">[</bpt>partition<ept id=\"p1\">](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-actors)</ept> and actor method (if applicable) that the performance counter instance is associated with.",
      "pos": [
        3978,
        4246
      ]
    },
    {
      "pos": [
        4253,
        4284
      ],
      "content": "<ph id=\"ph1\">`Service Fabric Actor`</ph> category"
    },
    {
      "pos": [
        4285,
        4381
      ],
      "content": "For the category <ph id=\"ph1\">`Service Fabric Actor`</ph>, the counter instance names are in the following format:"
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>ServiceFabricPartitionID<ept id=\"p1\">*</ept> - is the string representation of the Service Fabric partition ID that the performance counter instance is associated with.",
      "pos": [
        4435,
        4585
      ]
    },
    {
      "content": "The partition ID is a GUID and its string representation is generated using the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Guid.ToString`</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/97af8hh4.aspx)</ept> method with format specifier \"D\".",
      "pos": [
        4586,
        4767
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>ActorRuntimeInternalID<ept id=\"p1\">*</ept> - is the string representation of a 64-bit integer that is generated by the Fabric Actors runtime for its internal use.",
      "pos": [
        4769,
        4913
      ]
    },
    {
      "content": "This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.",
      "pos": [
        4914,
        5062
      ]
    },
    {
      "content": "Users should not try to interpret this portion of the performance counter instance name.",
      "pos": [
        5063,
        5151
      ]
    },
    {
      "content": "The following is an example of a counter instance name for a counter belonging to the 'Service Fabric Actor' category:",
      "pos": [
        5153,
        5271
      ]
    },
    {
      "pos": [
        5332,
        5548
      ],
      "content": "In the example above, <ph id=\"ph1\">`2740af29-78aa-44bc-a20b-7e60fb783264`</ph> is the string representation of the Service Fabric partition ID and <ph id=\"ph2\">`635650083799324046`</ph> is the 64-bit ID that is generated for the runtime's internal use."
    },
    {
      "pos": [
        5555,
        5593
      ],
      "content": "<ph id=\"ph1\">`Service Fabric Actor Method`</ph> category"
    },
    {
      "pos": [
        5594,
        5697
      ],
      "content": "For the category <ph id=\"ph1\">`Service Fabric Actor Method`</ph>, the counter instance names are in the following format:"
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>MethodName<ept id=\"p1\">*</ept> - is the name of the actor method that the performance counter instance is associated with.",
      "pos": [
        5784,
        5888
      ]
    },
    {
      "content": "The format of the method name is determined based on some logic in the Fabric Actors runtime that balances the readability of the name with constraints on the maximum length of the performance counter instance names on Windows.",
      "pos": [
        5889,
        6116
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>ActorsRuntimeMethodId<ept id=\"p1\">*</ept> - is the string representation of a 32-bit integer that is generated by the Fabric Actors runtime for its internal use.",
      "pos": [
        6118,
        6261
      ]
    },
    {
      "content": "This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.",
      "pos": [
        6262,
        6410
      ]
    },
    {
      "content": "Users should not try to interpret this portion of the performance counter instance name.",
      "pos": [
        6411,
        6499
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>ServiceFabricPartitionID<ept id=\"p1\">*</ept> - is the string representation of the Service Fabric partition ID that the performance counter instance is associated with.",
      "pos": [
        6501,
        6651
      ]
    },
    {
      "content": "The partition ID is a GUID and its string representation is generated using the <bpt id=\"p1\">[</bpt><ph id=\"ph1\">`Guid.ToString`</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/97af8hh4.aspx)</ept> method with format specifier \"D\".",
      "pos": [
        6652,
        6833
      ]
    },
    {
      "content": "<bpt id=\"p1\">*</bpt>ActorRuntimeInternalID<ept id=\"p1\">*</ept> - is the string representation of a 64-bit integer that is generated by the Fabric Actors runtime for its internal use.",
      "pos": [
        6835,
        6979
      ]
    },
    {
      "content": "This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names.",
      "pos": [
        6980,
        7128
      ]
    },
    {
      "content": "Users should not try to interpret this portion of the performance counter instance name.",
      "pos": [
        7129,
        7217
      ]
    },
    {
      "content": "The following is an example of a counter instance name for a counter belonging to the 'Service Fabric Actor Method' category:",
      "pos": [
        7219,
        7344
      ]
    },
    {
      "pos": [
        7444,
        7774
      ],
      "content": "In the example above, <ph id=\"ph1\">`ivoicemailboxactor.leavemessageasync`</ph> is the method name, <ph id=\"ph2\">`2`</ph> is the 32-bit ID generated for the runtime's internal use, <ph id=\"ph3\">`89383d32-e57e-4a9b-a6ad-57c6792aa521`</ph> is the string representation of the Service Fabric partition ID and <ph id=\"ph4\">`635650083804480486`</ph> is the 64-bit ID generated for the runtime's internal use."
    },
    {
      "content": "List of events and performance counters",
      "pos": [
        7779,
        7818
      ]
    },
    {
      "content": "Actor method events and performance counters",
      "pos": [
        7824,
        7868
      ]
    },
    {
      "pos": [
        7869,
        8006
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>actor methods<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#actors)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        8009,
        8019
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        8020,
        8028
      ]
    },
    {
      "content": "Level",
      "pos": [
        8029,
        8034
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        8035,
        8043
      ]
    },
    {
      "content": "Description",
      "pos": [
        8044,
        8055
      ]
    },
    {
      "content": "ActorMethodStart",
      "pos": [
        8080,
        8096
      ]
    },
    {
      "content": "7",
      "pos": [
        8097,
        8098
      ]
    },
    {
      "content": "Verbose",
      "pos": [
        8099,
        8106
      ]
    },
    {
      "content": "0x2",
      "pos": [
        8107,
        8110
      ]
    },
    {
      "content": "Actors runtime is about to invoke an actor method",
      "pos": [
        8111,
        8160
      ]
    },
    {
      "content": "ActorMethodStop",
      "pos": [
        8163,
        8178
      ]
    },
    {
      "content": "8",
      "pos": [
        8179,
        8180
      ]
    },
    {
      "content": "Verbose",
      "pos": [
        8181,
        8188
      ]
    },
    {
      "content": "0x2",
      "pos": [
        8189,
        8192
      ]
    },
    {
      "content": "An actor method has finished executing, i.e. the runtime's asynchronous call to the actor method has returned and the Task returned by the actor method has completed.",
      "pos": [
        8193,
        8359
      ]
    },
    {
      "content": "ActorMethodThrewException",
      "pos": [
        8362,
        8387
      ]
    },
    {
      "content": "9",
      "pos": [
        8388,
        8389
      ]
    },
    {
      "content": "Warning",
      "pos": [
        8390,
        8397
      ]
    },
    {
      "content": "0x3",
      "pos": [
        8398,
        8401
      ]
    },
    {
      "content": "An exception was thrown during the execution of an actor method, either during the runtime's asynchronous call to the actor method or during the execution of the Task returned by the actor method.",
      "pos": [
        8402,
        8598
      ]
    },
    {
      "content": "This event indicates some sort of failure in the actor code that needs investigation.",
      "pos": [
        8599,
        8684
      ]
    },
    {
      "content": "The Reliable Actors runtime publishes the following performance counters related to the execution of actor methods.",
      "pos": [
        8687,
        8802
      ]
    },
    {
      "content": "Category name",
      "pos": [
        8805,
        8818
      ]
    },
    {
      "content": "Counter name",
      "pos": [
        8819,
        8831
      ]
    },
    {
      "content": "Description",
      "pos": [
        8832,
        8843
      ]
    },
    {
      "content": "Service Fabric Actor Method",
      "pos": [
        8860,
        8887
      ]
    },
    {
      "content": "Invocations/Sec",
      "pos": [
        8888,
        8903
      ]
    },
    {
      "content": "Number of times the actor service method is invoked per second",
      "pos": [
        8904,
        8966
      ]
    },
    {
      "content": "Service Fabric Actor Method",
      "pos": [
        8969,
        8996
      ]
    },
    {
      "content": "Average milliseconds per invocation",
      "pos": [
        8997,
        9032
      ]
    },
    {
      "content": "Time taken to execute the actor service method in milliseconds",
      "pos": [
        9033,
        9095
      ]
    },
    {
      "content": "Service Fabric Actor Method",
      "pos": [
        9098,
        9125
      ]
    },
    {
      "content": "Exceptions thrown/Sec",
      "pos": [
        9126,
        9147
      ]
    },
    {
      "content": "Number of times the actor service method threw an exception per second",
      "pos": [
        9148,
        9218
      ]
    },
    {
      "content": "Concurrency events and performance counters",
      "pos": [
        9225,
        9268
      ]
    },
    {
      "pos": [
        9269,
        9409
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>concurrency<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#concurrency)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        9412,
        9422
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        9423,
        9431
      ]
    },
    {
      "content": "Level",
      "pos": [
        9432,
        9437
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        9438,
        9446
      ]
    },
    {
      "content": "Description",
      "pos": [
        9447,
        9458
      ]
    },
    {
      "content": "ActorMethodCallsWaitingForLock",
      "pos": [
        9483,
        9513
      ]
    },
    {
      "content": "12",
      "pos": [
        9514,
        9516
      ]
    },
    {
      "content": "Verbose",
      "pos": [
        9517,
        9524
      ]
    },
    {
      "content": "0x8",
      "pos": [
        9525,
        9528
      ]
    },
    {
      "content": "This event is written at the start of each new turn in an actor.",
      "pos": [
        9529,
        9593
      ]
    },
    {
      "content": "It contains  the number of pending actor calls waiting to acquire the per-actor lock that enforces turn-based concurrency.",
      "pos": [
        9594,
        9716
      ]
    },
    {
      "content": "The Reliable Actors runtime publishes the following performance counters related to concurrency.",
      "pos": [
        9719,
        9815
      ]
    },
    {
      "content": "Category name",
      "pos": [
        9818,
        9831
      ]
    },
    {
      "content": "Counter name",
      "pos": [
        9832,
        9844
      ]
    },
    {
      "content": "Description",
      "pos": [
        9845,
        9856
      ]
    },
    {
      "content": "Service Fabric Actor",
      "pos": [
        9873,
        9893
      ]
    },
    {
      "content": "of actor calls waiting for actor lock",
      "pos": [
        9896,
        9933
      ]
    },
    {
      "content": "Number of pending actor calls waiting to acquire the per-actor lock that enforces turn-based concurrency.",
      "pos": [
        9934,
        10039
      ]
    },
    {
      "content": "Actor state management events and performance counters",
      "pos": [
        10046,
        10100
      ]
    },
    {
      "pos": [
        10101,
        10263
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>actor state management<ept id=\"p1\">](service-fabric-reliable-actors-introduction.md#actor-state-management)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        10266,
        10276
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        10277,
        10285
      ]
    },
    {
      "content": "Level",
      "pos": [
        10286,
        10291
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        10292,
        10300
      ]
    },
    {
      "content": "Description",
      "pos": [
        10301,
        10312
      ]
    },
    {
      "content": "ActorSaveStateStart",
      "pos": [
        10337,
        10356
      ]
    },
    {
      "content": "10",
      "pos": [
        10357,
        10359
      ]
    },
    {
      "content": "Verbose",
      "pos": [
        10360,
        10367
      ]
    },
    {
      "content": "0x4",
      "pos": [
        10368,
        10371
      ]
    },
    {
      "content": "Actors runtime is about to save actor state.",
      "pos": [
        10372,
        10416
      ]
    },
    {
      "content": "ActorSaveStateStop",
      "pos": [
        10419,
        10437
      ]
    },
    {
      "content": "11",
      "pos": [
        10438,
        10440
      ]
    },
    {
      "content": "Verbose",
      "pos": [
        10441,
        10448
      ]
    },
    {
      "content": "0x4",
      "pos": [
        10449,
        10452
      ]
    },
    {
      "content": "Actors runtime has finished saving actor state.",
      "pos": [
        10453,
        10500
      ]
    },
    {
      "content": "The Reliable Actors runtime publishes the following performance counters related to actor state management.",
      "pos": [
        10503,
        10610
      ]
    },
    {
      "content": "Category name",
      "pos": [
        10613,
        10626
      ]
    },
    {
      "content": "Counter name",
      "pos": [
        10627,
        10639
      ]
    },
    {
      "content": "Description",
      "pos": [
        10640,
        10651
      ]
    },
    {
      "content": "Service Fabric Actor",
      "pos": [
        10668,
        10688
      ]
    },
    {
      "content": "Average milliseconds per save state operation",
      "pos": [
        10689,
        10734
      ]
    },
    {
      "content": "Time taken to save actor state in milliseconds",
      "pos": [
        10735,
        10781
      ]
    },
    {
      "content": "Events related to stateless actor instances",
      "pos": [
        10788,
        10831
      ]
    },
    {
      "pos": [
        10832,
        11025
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>stateless actor instances<ept id=\"p1\">](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-stateless-actors)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        11028,
        11038
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        11039,
        11047
      ]
    },
    {
      "content": "Level",
      "pos": [
        11048,
        11053
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        11054,
        11062
      ]
    },
    {
      "content": "Description",
      "pos": [
        11063,
        11074
      ]
    },
    {
      "content": "ServiceInstanceOpen",
      "pos": [
        11099,
        11118
      ]
    },
    {
      "content": "3",
      "pos": [
        11119,
        11120
      ]
    },
    {
      "content": "Informational",
      "pos": [
        11121,
        11134
      ]
    },
    {
      "content": "0x1",
      "pos": [
        11135,
        11138
      ]
    },
    {
      "content": "Stateless actor instance opened.",
      "pos": [
        11139,
        11171
      ]
    },
    {
      "content": "This implies that the actors for this partition can be created inside this instance (and possibly other instances too).",
      "pos": [
        11172,
        11291
      ]
    },
    {
      "content": "ServiceInstanceClose",
      "pos": [
        11294,
        11314
      ]
    },
    {
      "content": "4",
      "pos": [
        11315,
        11316
      ]
    },
    {
      "content": "Informational",
      "pos": [
        11317,
        11330
      ]
    },
    {
      "content": "0x1",
      "pos": [
        11331,
        11334
      ]
    },
    {
      "content": "Stateless actor instance closed.",
      "pos": [
        11335,
        11367
      ]
    },
    {
      "content": "This implies that the actors for this partition will no longer be created inside this instance.",
      "pos": [
        11368,
        11463
      ]
    },
    {
      "content": "No new requests will be delivered to actors already created within this instance.",
      "pos": [
        11464,
        11545
      ]
    },
    {
      "content": "The actors will be destroyed after any in-progress requests are completed.",
      "pos": [
        11546,
        11620
      ]
    },
    {
      "content": "Events related to stateful actor replicas",
      "pos": [
        11627,
        11668
      ]
    },
    {
      "pos": [
        11669,
        11859
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>stateful actor replicas<ept id=\"p1\">](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-stateful-actors)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        11862,
        11872
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        11873,
        11881
      ]
    },
    {
      "content": "Level",
      "pos": [
        11882,
        11887
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        11888,
        11896
      ]
    },
    {
      "content": "Description",
      "pos": [
        11897,
        11908
      ]
    },
    {
      "content": "ReplicaChangeRoleToPrimary",
      "pos": [
        11933,
        11959
      ]
    },
    {
      "content": "1",
      "pos": [
        11960,
        11961
      ]
    },
    {
      "content": "Informational",
      "pos": [
        11962,
        11975
      ]
    },
    {
      "content": "0x1",
      "pos": [
        11976,
        11979
      ]
    },
    {
      "content": "Stateful actor replica changed role to Primary.",
      "pos": [
        11980,
        12027
      ]
    },
    {
      "content": "This implies that the actors for this partition will be created inside this replica.",
      "pos": [
        12028,
        12112
      ]
    },
    {
      "content": "ReplicaChangeRoleFromPrimary",
      "pos": [
        12115,
        12143
      ]
    },
    {
      "content": "2",
      "pos": [
        12144,
        12145
      ]
    },
    {
      "content": "Informational",
      "pos": [
        12146,
        12159
      ]
    },
    {
      "content": "0x1",
      "pos": [
        12160,
        12163
      ]
    },
    {
      "content": "Stateful actor replica changed role to non-Primary.",
      "pos": [
        12164,
        12215
      ]
    },
    {
      "content": "This implies that the actors for this partition will no longer be created inside this replica.",
      "pos": [
        12216,
        12310
      ]
    },
    {
      "content": "No new requests will be delivered to actors already created within this replica.",
      "pos": [
        12311,
        12391
      ]
    },
    {
      "content": "The actors will be destroyed after any in-progress requests are completed.",
      "pos": [
        12392,
        12466
      ]
    },
    {
      "content": "Actor activation and deactivation events",
      "pos": [
        12473,
        12513
      ]
    },
    {
      "pos": [
        12514,
        12661
      ],
      "content": "The Reliable Actors runtime emits the following events related to <bpt id=\"p1\">[</bpt>actor activation and deactivation<ept id=\"p1\">](service-fabric-reliable-actors-lifecycle.md)</ept>."
    },
    {
      "content": "Event name",
      "pos": [
        12664,
        12674
      ]
    },
    {
      "content": "Event Id",
      "pos": [
        12675,
        12683
      ]
    },
    {
      "content": "Level",
      "pos": [
        12684,
        12689
      ]
    },
    {
      "content": "Keywords",
      "pos": [
        12690,
        12698
      ]
    },
    {
      "content": "Description",
      "pos": [
        12699,
        12710
      ]
    },
    {
      "content": "ActorActivated",
      "pos": [
        12735,
        12749
      ]
    },
    {
      "content": "5",
      "pos": [
        12750,
        12751
      ]
    },
    {
      "content": "Informational",
      "pos": [
        12752,
        12765
      ]
    },
    {
      "content": "0x1",
      "pos": [
        12766,
        12769
      ]
    },
    {
      "content": "An actor has been activated.",
      "pos": [
        12770,
        12798
      ]
    },
    {
      "content": "ActorDeactivated",
      "pos": [
        12801,
        12817
      ]
    },
    {
      "content": "6",
      "pos": [
        12818,
        12819
      ]
    },
    {
      "content": "Informational",
      "pos": [
        12820,
        12833
      ]
    },
    {
      "content": "0x1",
      "pos": [
        12834,
        12837
      ]
    },
    {
      "content": "An actor has been deactivated.",
      "pos": [
        12838,
        12868
      ]
    }
  ],
  "content": "<properties\n   pageTitle=\"Reliable Actors Diagnostics and Performance Monitoring\"\n   description=\"This article describes the diagnostics and performance monitoring features in the Reliable Actors runtime, including the events and performance counters emitted by it.\"\n   services=\"service-fabric\"\n   documentationCenter=\".net\"\n   authors=\"jessebenson\"\n   manager=\"timlt\"\n   editor=\"\"/>\n\n<tags\n   ms.service=\"service-fabric\"\n   ms.devlang=\"dotnet\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"NA\"\n   ms.workload=\"NA\"\n   ms.date=\"08/05/2015\"\n   ms.author=\"abhisram\"/>\n\n# Diagnostics and Performance Monitoring for Reliable Actors\nReliable Actors runtime emits [EventSource](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.aspx) events and [performance counters](https://msdn.microsoft.com/library/system.diagnostics.performancecounter.aspx) that provide insights into how the runtime is operating and help with troubleshooting and performance monitoring.\n\n## EventSource events\nThe EventSource name for Reliable Actors runtime is \"Microsoft-ServiceFabric-Actors\". Events from this event source appear in the [Diagnostics Events](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md#view-service-fabric-system-events-in-visual-studio) window when the actor application is being [debugged in Visual Studio](service-fabric-debugging-your-application.md).\n\nService Fabric also offers the option of directing these events to [Application Insights](http://azure.microsoft.com/services/application-insights/). For more information on this, please see the article on [Application Insights setup for Service Fabric](service-fabric-diagnostics-application-insights-setup.md).\n\nOther examples of tools and technologies that help in collecting and/or viewing EventSource events are [PerfView](http://www.microsoft.com/download/details.aspx?id=28567), [Azure Diagnostics](../cloud-services-dotnet-diagnostics.md), [Semantic Logging](https://msdn.microsoft.com/library/dn774980.aspx) and the [Microsoft TraceEvent Library](http://www.nuget.org/packages/Microsoft.Diagnostics.Tracing.TraceEvent).\n\n### Keywords\nAll events that belong to the Reliable Actors EventSource are associated with one or more keywords. This enables filtering of events that are collected. The following keywords bits are defined:\n\n|Bit|Description|\n|---|---|\n|0x1|Set of important events that summarize the operation of the Fabric Actors runtime|\n|0x2|Set of events describing actor method calls. For more information, please see the [introductory topic on actors](service-fabric-reliable-actors-introduction.md#actors).|\n|0x4|Set of events related to actor state. For more information, please see the topic on [stateful actors](service-fabric-reliable-actors-introduction.md#stateful-actors).|\n|0x8|Set of events related to turn-based concurrency in the actor. For more information, please see the topic on [concurrency](service-fabric-reliable-actors-introduction.md#concurrency).|\n\n## Performance counters\nThe Reliable Actors runtime defines the following performance counter categories.\n\n|Category|Description|\n|---|---|\n|Service Fabric Actor|Counters specific to Service Fabric actors. e.g. time taken to save actor state.|\n|Service Fabric Actor Method|Counters specific to methods implemented by Service Fabric actors. e.g. how often an actor method is invoked.|\n\nEach of the above categories has one or more counters.\n\nThe [Windows Performance Monitor](https://technet.microsoft.com/library/cc749249.aspx) application that is available by default in the Windows operating system can be used to collect and view performance counter data. [Azure Diagnostics](../cloud-services-dotnet-diagnostics.md) is another option for collecting performance counter data and uploading it to Azure tables.\n\n### Performance counter instance names\nA cluster with a large number of actor services or actor service partitions will have a large number of actor performance counter instances. The performance counter instances names can help in identifying the specific [partition](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-actors) and actor method (if applicable) that the performance counter instance is associated with.\n\n#### `Service Fabric Actor` category\nFor the category `Service Fabric Actor`, the counter instance names are in the following format:\n\n`ServiceFabricPartitionID_ActorsRuntimeInternalID`\n\n*ServiceFabricPartitionID* - is the string representation of the Service Fabric partition ID that the performance counter instance is associated with. The partition ID is a GUID and its string representation is generated using the [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) method with format specifier \"D\".\n\n*ActorRuntimeInternalID* - is the string representation of a 64-bit integer that is generated by the Fabric Actors runtime for its internal use. This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names. Users should not try to interpret this portion of the performance counter instance name.\n\nThe following is an example of a counter instance name for a counter belonging to the 'Service Fabric Actor' category:\n\n`2740af29-78aa-44bc-a20b-7e60fb783264_635650083799324046`\n\nIn the example above, `2740af29-78aa-44bc-a20b-7e60fb783264` is the string representation of the Service Fabric partition ID and `635650083799324046` is the 64-bit ID that is generated for the runtime's internal use.\n\n#### `Service Fabric Actor Method` category\nFor the category `Service Fabric Actor Method`, the counter instance names are in the following format:\n\n`MethodName_ActorsRuntimeMethodId_ServiceFabricPartitionID_ActorsRuntimeInternalID`\n\n*MethodName* - is the name of the actor method that the performance counter instance is associated with. The format of the method name is determined based on some logic in the Fabric Actors runtime that balances the readability of the name with constraints on the maximum length of the performance counter instance names on Windows.\n\n*ActorsRuntimeMethodId* - is the string representation of a 32-bit integer that is generated by the Fabric Actors runtime for its internal use. This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names. Users should not try to interpret this portion of the performance counter instance name.\n\n*ServiceFabricPartitionID* - is the string representation of the Service Fabric partition ID that the performance counter instance is associated with. The partition ID is a GUID and its string representation is generated using the [`Guid.ToString`](https://msdn.microsoft.com/library/97af8hh4.aspx) method with format specifier \"D\".\n\n*ActorRuntimeInternalID* - is the string representation of a 64-bit integer that is generated by the Fabric Actors runtime for its internal use. This is included in the performance counter instance name to ensure its uniqueness and avoid conflict with other performance counter instance names. Users should not try to interpret this portion of the performance counter instance name.\n\nThe following is an example of a counter instance name for a counter belonging to the 'Service Fabric Actor Method' category:\n\n`ivoicemailboxactor.leavemessageasync_2_89383d32-e57e-4a9b-a6ad-57c6792aa521_635650083804480486`\n\nIn the example above, `ivoicemailboxactor.leavemessageasync` is the method name, `2` is the 32-bit ID generated for the runtime's internal use, `89383d32-e57e-4a9b-a6ad-57c6792aa521` is the string representation of the Service Fabric partition ID and `635650083804480486` is the 64-bit ID generated for the runtime's internal use.\n\n## List of events and performance counters\n\n### Actor method events and performance counters\nThe Reliable Actors runtime emits the following events related to [actor methods](service-fabric-reliable-actors-introduction.md#actors).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ActorMethodStart|7|Verbose|0x2|Actors runtime is about to invoke an actor method|\n|ActorMethodStop|8|Verbose|0x2|An actor method has finished executing, i.e. the runtime's asynchronous call to the actor method has returned and the Task returned by the actor method has completed.|\n|ActorMethodThrewException|9|Warning|0x3|An exception was thrown during the execution of an actor method, either during the runtime's asynchronous call to the actor method or during the execution of the Task returned by the actor method. This event indicates some sort of failure in the actor code that needs investigation.|\n\nThe Reliable Actors runtime publishes the following performance counters related to the execution of actor methods.\n\n|Category name|Counter name|Description|\n|---|---|---|\n|Service Fabric Actor Method|Invocations/Sec|Number of times the actor service method is invoked per second|\n|Service Fabric Actor Method|Average milliseconds per invocation|Time taken to execute the actor service method in milliseconds|\n|Service Fabric Actor Method|Exceptions thrown/Sec|Number of times the actor service method threw an exception per second|\n\n### Concurrency events and performance counters\nThe Reliable Actors runtime emits the following events related to [concurrency](service-fabric-reliable-actors-introduction.md#concurrency).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ActorMethodCallsWaitingForLock|12|Verbose|0x8|This event is written at the start of each new turn in an actor. It contains  the number of pending actor calls waiting to acquire the per-actor lock that enforces turn-based concurrency.|\n\nThe Reliable Actors runtime publishes the following performance counters related to concurrency.\n\n|Category name|Counter name|Description|\n|---|---|---|\n|Service Fabric Actor|# of actor calls waiting for actor lock|Number of pending actor calls waiting to acquire the per-actor lock that enforces turn-based concurrency.|\n\n### Actor state management events and performance counters\nThe Reliable Actors runtime emits the following events related to [actor state management](service-fabric-reliable-actors-introduction.md#actor-state-management).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ActorSaveStateStart|10|Verbose|0x4|Actors runtime is about to save actor state.|\n|ActorSaveStateStop|11|Verbose|0x4|Actors runtime has finished saving actor state.|\n\nThe Reliable Actors runtime publishes the following performance counters related to actor state management.\n\n|Category name|Counter name|Description|\n|---|---|---|\n|Service Fabric Actor|Average milliseconds per save state operation|Time taken to save actor state in milliseconds|\n\n### Events related to stateless actor instances\nThe Reliable Actors runtime emits the following events related to [stateless actor instances](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-stateless-actors).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ServiceInstanceOpen|3|Informational|0x1|Stateless actor instance opened. This implies that the actors for this partition can be created inside this instance (and possibly other instances too).|\n|ServiceInstanceClose|4|Informational|0x1|Stateless actor instance closed. This implies that the actors for this partition will no longer be created inside this instance. No new requests will be delivered to actors already created within this instance. The actors will be destroyed after any in-progress requests are completed.|\n\n### Events related to stateful actor replicas\nThe Reliable Actors runtime emits the following events related to [stateful actor replicas](service-fabric-reliable-actors-platform.md#service-fabric-partition-concepts-for-stateful-actors).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ReplicaChangeRoleToPrimary|1|Informational|0x1|Stateful actor replica changed role to Primary. This implies that the actors for this partition will be created inside this replica.|\n|ReplicaChangeRoleFromPrimary|2|Informational|0x1|Stateful actor replica changed role to non-Primary. This implies that the actors for this partition will no longer be created inside this replica. No new requests will be delivered to actors already created within this replica. The actors will be destroyed after any in-progress requests are completed.|\n\n### Actor activation and deactivation events\nThe Reliable Actors runtime emits the following events related to [actor activation and deactivation](service-fabric-reliable-actors-lifecycle.md).\n\n|Event name|Event Id|Level|Keywords|Description|\n|---|---|---|---|---|\n|ActorActivated|5|Informational|0x1|An actor has been activated.|\n|ActorDeactivated|6|Informational|0x1|An actor has been deactivated.|\n"
}