{
  "nodes": [
    {
      "content": "Getting Started with Delivering Video on Demand (VoD) using REST APIs",
      "pos": [
        28,
        97
      ]
    },
    {
      "content": "This tutorial walks you through the steps of implementing a Video-on-Demand (VoD) content delivery application with Azure Media Services using REST APIs",
      "pos": [
        117,
        269
      ]
    },
    {
      "content": "Getting Started with Delivering Video on Demand (VoD) using REST APIs",
      "pos": [
        581,
        650
      ]
    },
    {
      "pos": [
        765,
        1060
      ],
      "content": "[AZURE.NOTE]\nTo complete this tutorial, you need an Azure account. If you don't have an account, you can create a free trial account in just a couple of minutes. For details, see <a href=\"http://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A8A8397B5\" target=\"_blank\">Azure Free Trial</a>.",
      "leadings": [
        "",
        "> "
      ],
      "nodes": [
        {
          "content": "To complete this tutorial, you need an Azure account. If you don't have an account, you can create a free trial account in just a couple of minutes. For details, see <a href=\"http://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A8A8397B5\" target=\"_blank\">Azure Free Trial</a>.",
          "pos": [
            13,
            293
          ],
          "nodes": [
            {
              "content": "To complete this tutorial, you need an Azure account.",
              "pos": [
                0,
                53
              ]
            },
            {
              "content": "If you don't have an account, you can create a free trial account in just a couple of minutes.",
              "pos": [
                54,
                148
              ]
            },
            {
              "content": "For details, see <ph id=\"ph1\">&lt;a href=\"http://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A8A8397B5\" target=\"_blank\"&gt;</ph>Azure Free Trial<ph id=\"ph2\">&lt;/a&gt;</ph>.",
              "pos": [
                149,
                280
              ]
            }
          ]
        }
      ]
    },
    {
      "content": "This quickstart walks you through the steps of implementing a Video-on-Demand (VoD) content delivery application using Azure Media Services (AMS) REST APIs.",
      "pos": [
        1062,
        1218
      ]
    },
    {
      "content": "The tutorial introduces the basic Media Services workflow and the most common programming objects and tasks required for Media Services development.",
      "pos": [
        1221,
        1369
      ]
    },
    {
      "content": "At the completion of the tutorial, you will be able to stream or progressively download a sample media file that you uploaded, encoded, and downloaded.",
      "pos": [
        1370,
        1521
      ]
    },
    {
      "content": "Prerequisites",
      "pos": [
        1528,
        1541
      ]
    },
    {
      "content": "The following prerequisites are required to start developing with Media Services with REST APIs.",
      "pos": [
        1542,
        1638
      ]
    },
    {
      "content": "Understanding of how to develop with Media Services REST API.",
      "pos": [
        1642,
        1703
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>media-services-rest-overview<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh973616.aspx)</ept>.",
      "pos": [
        1704,
        1816
      ]
    },
    {
      "content": "An application of your choice that can send HTTP requests and responses.",
      "pos": [
        1819,
        1891
      ]
    },
    {
      "content": "This tutorial uses <bpt id=\"p1\">[</bpt>Fiddler<ept id=\"p1\">](http://www.telerik.com/download/fiddler)</ept>.",
      "pos": [
        1892,
        1962
      ]
    },
    {
      "content": "The following tasks are shown in this quickstart.",
      "pos": [
        1965,
        2014
      ]
    },
    {
      "content": "Create a Media Services account using Portal.",
      "pos": [
        2020,
        2065
      ]
    },
    {
      "content": "Connect to the Media Services account with REST API.",
      "pos": [
        2070,
        2122
      ]
    },
    {
      "content": "Create a new asset and upload a video file with REST API.",
      "pos": [
        2127,
        2184
      ]
    },
    {
      "content": "Configure streaming units with REST API.",
      "pos": [
        2189,
        2229
      ]
    },
    {
      "content": "Encode the source file into a set of adaptive bitrate MP4 files with REST API.",
      "pos": [
        2234,
        2312
      ]
    },
    {
      "content": "Publish the asset and get streaming and progressive download URLs with REST API.",
      "pos": [
        2317,
        2397
      ]
    },
    {
      "content": "Play your content.",
      "pos": [
        2403,
        2421
      ]
    },
    {
      "pos": [
        2428,
        2495
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"create_ams\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Create a Media Services account using Portal"
    },
    {
      "pos": [
        2500,
        2602
      ],
      "content": "In the [Management Portal][], click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Media Service<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Quick Create<ept id=\"p3\">**</ept>."
    },
    {
      "content": "Media Services Quick Create",
      "pos": [
        2613,
        2640
      ]
    },
    {
      "content": "In <bpt id=\"p1\">**</bpt>NAME<ept id=\"p1\">**</ept>, enter the name of the new account.",
      "pos": [
        2708,
        2755
      ]
    },
    {
      "content": "A Media Services account name is all lower-case numbers or letters with no spaces, and is 3 - 24 characters in length.",
      "pos": [
        2756,
        2874
      ]
    },
    {
      "content": "In <bpt id=\"p1\">**</bpt>REGION<ept id=\"p1\">**</ept>, select the geographic region that will be used to store the metadata records for your Media Services account.",
      "pos": [
        2880,
        3004
      ]
    },
    {
      "content": "Only the available Media Services regions appear in the dropdown.",
      "pos": [
        3005,
        3070
      ]
    },
    {
      "content": "In <bpt id=\"p1\">**</bpt>STORAGE ACCOUNT<ept id=\"p1\">**</ept>, select a storage account to provide blob storage of the media content from your Media Services account.",
      "pos": [
        3076,
        3203
      ]
    },
    {
      "content": "You can select an existing storage account in the same geographic region as your Media Services account, or you can create a new storage account.",
      "pos": [
        3204,
        3349
      ]
    },
    {
      "content": "A new storage account is created in the same region.",
      "pos": [
        3350,
        3402
      ]
    },
    {
      "content": "If you created a new storage account, in <bpt id=\"p1\">**</bpt>NEW STORAGE ACCOUNT NAME<ept id=\"p1\">**</ept>, enter a name for the storage account.",
      "pos": [
        3408,
        3516
      ]
    },
    {
      "content": "The rules for storage account names are the same as for Media Services accounts.",
      "pos": [
        3517,
        3597
      ]
    },
    {
      "pos": [
        3602,
        3651
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>Quick Create<ept id=\"p1\">**</ept> at the bottom of the form."
    },
    {
      "content": "You can monitor the status of the process in the message area at the bottom of the window.",
      "pos": [
        3657,
        3747
      ]
    },
    {
      "content": "Once account is successfully created, the status changes to Active.",
      "pos": [
        3753,
        3820
      ]
    },
    {
      "content": "At the bottom of the page, the <bpt id=\"p1\">**</bpt>MANAGE KEYS<ept id=\"p1\">**</ept> button appears.",
      "pos": [
        3831,
        3893
      ]
    },
    {
      "content": "When you click on this button, a dialog with the Media Services account name and the primary and secondary keys is displayed.",
      "pos": [
        3894,
        4019
      ]
    },
    {
      "content": "You will need the account name and the primary key information to programmatically access the Media Services account.",
      "pos": [
        4020,
        4137
      ]
    },
    {
      "pos": [
        4533,
        4604
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"connect\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Connect to the Media Services account with REST API"
    },
    {
      "content": "Two things are required when accessing Azure Media Services: an access token provided by Azure Access Control Services (ACS), and the URI of Media Services itself.",
      "pos": [
        4606,
        4769
      ]
    },
    {
      "content": "You can use any means you want when creating these requests as long as you specify the correct header values and pass in the access token correctly when calling into Media Services.",
      "pos": [
        4770,
        4951
      ]
    },
    {
      "content": "The following steps describe the most common workflow when using the Media Services REST API to connect to Media Services:",
      "pos": [
        4953,
        5075
      ]
    },
    {
      "content": "Getting an access token.",
      "pos": [
        5080,
        5104
      ]
    },
    {
      "content": "Connecting to the Media Services URI.",
      "pos": [
        5109,
        5146
      ]
    },
    {
      "content": "After successfully connecting to https://media.windows.net, you will receive a 301 redirect specifying another Media Services URI.",
      "pos": [
        5175,
        5305
      ]
    },
    {
      "content": "You must make subsequent calls to the new URI.",
      "pos": [
        5306,
        5352
      ]
    },
    {
      "content": "You may also receive a HTTP/1.1 200 response that contains the ODATA API metadata description.",
      "pos": [
        5366,
        5460
      ]
    },
    {
      "content": "Posting your subsequent API calls to the new URL.",
      "pos": [
        5464,
        5513
      ]
    },
    {
      "content": "For example, if after trying to connect, you got the following:",
      "pos": [
        5524,
        5587
      ]
    },
    {
      "content": "You should post your subsequent API calls to https://wamsbayclus001rest-hs.cloudapp.net/api/.",
      "pos": [
        5707,
        5800
      ]
    },
    {
      "content": "Getting an access token",
      "pos": [
        5805,
        5828
      ]
    },
    {
      "content": "To access Media Services directly through the REST API, retrieve an access token from ACS and use it during every HTTP request you make into the service.",
      "pos": [
        5830,
        5983
      ]
    },
    {
      "content": "This token is similar to other tokens provided by ACS based on access claims provided in the header of an HTTP request and using the OAuth v2 protocol.",
      "pos": [
        5984,
        6135
      ]
    },
    {
      "content": "You do not need any other prerequisites before directly connecting to Media Services.",
      "pos": [
        6136,
        6221
      ]
    },
    {
      "content": "The following example shows the HTTP request header and body used to retrieve a token.",
      "pos": [
        6223,
        6309
      ]
    },
    {
      "pos": [
        6311,
        6322
      ],
      "content": "<bpt id=\"p1\">**</bpt>Header<ept id=\"p1\">**</ept>:"
    },
    {
      "pos": [
        6630,
        6639
      ],
      "content": "<bpt id=\"p1\">**</bpt>Body<ept id=\"p1\">**</ept>:"
    },
    {
      "content": "You need to proved the client_id and client_secret values in the body of this request; client_id and client_secret correspond to the AccountName and AccountKey values, respectively.",
      "pos": [
        6641,
        6822
      ]
    },
    {
      "content": "These values are provided to you by Media Services when you set up your account.",
      "pos": [
        6823,
        6903
      ]
    },
    {
      "content": "Note that the AccountKey for your Media Services account must be URL-encoded when using it as the client_secret value in your access token request.",
      "pos": [
        6906,
        7053
      ]
    },
    {
      "content": "For example:",
      "pos": [
        7198,
        7210
      ]
    },
    {
      "content": "The following example shows the HTTP response that contains the access token in the response body.",
      "pos": [
        7376,
        7474
      ]
    },
    {
      "content": "It is recommended to cache the \"access_token \" and \"expires_in \" values to an external storage.",
      "pos": [
        8580,
        8675
      ]
    },
    {
      "content": "The token data could later be retrieved from the storage and re-used in your Media Services REST API calls.",
      "pos": [
        8676,
        8783
      ]
    },
    {
      "content": "This is especially useful for scenarios where the token can be securely shared among multiple processes or computers.",
      "pos": [
        8784,
        8901
      ]
    },
    {
      "content": "Make sure to monitor the \"expires_in\" value of the access token and update your REST API calls with new tokens as needed.",
      "pos": [
        8903,
        9024
      ]
    },
    {
      "content": "Connecting to the Media Services URI",
      "pos": [
        9029,
        9065
      ]
    },
    {
      "content": "The root URI for Media Services is https://media.windows.net/.",
      "pos": [
        9067,
        9129
      ]
    },
    {
      "content": "You should initially connect to this URI, and if you get a 301 redirect back in response, you should make subsequent calls to the new URI.",
      "pos": [
        9130,
        9268
      ]
    },
    {
      "content": "In addition, do not use any auto-redirect/follow logic in your requests.",
      "pos": [
        9269,
        9341
      ]
    },
    {
      "content": "HTTP verbs and request bodies will not be forwarded to the new URI.",
      "pos": [
        9342,
        9409
      ]
    },
    {
      "content": "Note that the root URI for uploading and downloading Asset files is https://yourstorageaccount.blob.core.windows.net/ where the storage account name is the same one you used during your Media Services account setup.",
      "pos": [
        9411,
        9626
      ]
    },
    {
      "content": "The following example demonstrates HTTP request to the Media Services root URI (https://media.windows.net/).",
      "pos": [
        9628,
        9736
      ]
    },
    {
      "content": "The request gets a 301 redirect back in response.",
      "pos": [
        9737,
        9786
      ]
    },
    {
      "content": "The subsequent request is using the new URI (https://wamsbayclus001rest-hs.cloudapp.net/api/).",
      "pos": [
        9787,
        9881
      ]
    },
    {
      "pos": [
        9888,
        9905
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Request<ept id=\"p1\">**</ept>:"
    },
    {
      "pos": [
        10583,
        10601
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Response<ept id=\"p1\">**</ept>:"
    },
    {
      "pos": [
        11182,
        11219
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Request<ept id=\"p1\">**</ept> (using the new URI):"
    },
    {
      "pos": [
        11943,
        11961
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Response<ept id=\"p1\">**</ept>:"
    },
    {
      "pos": [
        13734,
        13801
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> From now on the new URI will be used in this tutorial."
    },
    {
      "pos": [
        13806,
        13881
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"upload\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Create a new asset and upload a video file with REST API"
    },
    {
      "content": "In Media Services, you upload your digital files into an asset.",
      "pos": [
        13883,
        13946
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Asset<ept id=\"p1\">**</ept> entity can contain video, audio, images, thumbnail collections, text tracks and closed caption files (and the metadata about these files.)  Once the files are uploaded into the asset, your content is stored securely in the cloud for further processing and streaming.",
      "pos": [
        13947,
        14227
      ]
    },
    {
      "content": "One of the values that you have to provide when creating an asset is asset creation options.",
      "pos": [
        14230,
        14322
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> property is an enumeration value that describes the encryption options that an Asset can be created with.",
      "pos": [
        14323,
        14444
      ]
    },
    {
      "content": "A valid value is one of the values from the list below, not a combination of values from this list:",
      "pos": [
        14445,
        14544
      ]
    },
    {
      "pos": [
        14550,
        14767
      ],
      "content": "**None** = **0** - No encryption is used. Note that when using this option your content is not protected in transit or at rest in storage.\n  If you plan to deliver an MP4 using progressive download, use this option.",
      "leadings": [
        "",
        "  "
      ],
      "nodes": [
        {
          "content": "**None** = **0** - No encryption is used. Note that when using this option your content is not protected in transit or at rest in storage.",
          "pos": [
            0,
            138
          ],
          "nodes": [
            {
              "content": "<bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>0<ept id=\"p2\">**</ept> - No encryption is used.",
              "pos": [
                0,
                41
              ]
            },
            {
              "content": "Note that when using this option your content is not protected in transit or at rest in storage.",
              "pos": [
                42,
                138
              ]
            }
          ]
        },
        {
          "content": "If you plan to deliver an MP4 using progressive download, use this option.",
          "pos": [
            141,
            215
          ]
        }
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>StorageEncrypted<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>1<ept id=\"p2\">**</ept> - Encrypts your clear content locally using AES-256 bit encryption and then uploads it to Azure Storage where it is stored encrypted at rest.",
      "pos": [
        14771,
        14941
      ]
    },
    {
      "content": "Assets protected with Storage Encryption are automatically unencrypted and placed in an encrypted file system prior to encoding, and optionally re-encrypted prior to uploading back as a new output asset.",
      "pos": [
        14942,
        15145
      ]
    },
    {
      "content": "The primary use case for Storage Encryption is when you want to secure your high quality input media files with strong encryption at rest on disk.",
      "pos": [
        15146,
        15292
      ]
    },
    {
      "pos": [
        15295,
        15527
      ],
      "content": "<bpt id=\"p1\">**</bpt>CommonEncryptionProtected<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>2<ept id=\"p2\">**</ept> - Use this option if you are uploading content that has already been encrypted and protected with Common Encryption or PlayReady DRM (for example, Smooth Streaming protected with PlayReady DRM)."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>EnvelopeEncryptionProtected<ept id=\"p1\">**</ept> = <bpt id=\"p2\">**</bpt>4<ept id=\"p2\">**</ept> – Use this option if you are uploading HLS encrypted with AES.",
      "pos": [
        15530,
        15632
      ]
    },
    {
      "content": "Note that the files must have been encoded and encrypted by Transform Manager.",
      "pos": [
        15633,
        15711
      ]
    },
    {
      "content": "Create an asset",
      "pos": [
        15717,
        15732
      ]
    },
    {
      "content": "An asset is a container for multiple types or sets of objects in Media Services, including video, audio, images, thumbnail collections, text tracks, and closed caption files.",
      "pos": [
        15734,
        15908
      ]
    },
    {
      "content": "In the REST API, creating an Asset requires sending POST request to Media Services and placing any property information about your asset in the request body.",
      "pos": [
        15909,
        16066
      ]
    },
    {
      "content": "The following example shows how to create an asset.",
      "pos": [
        16068,
        16119
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        16123,
        16135
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        17134,
        17147
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        17151,
        17192
      ]
    },
    {
      "content": "Create an AssetFile",
      "pos": [
        18452,
        18471
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt>AssetFile<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974275.aspx)</ept> entity represents a video or audio file that is stored in a blob container.",
      "pos": [
        18473,
        18619
      ]
    },
    {
      "content": "An asset file is always associated with an asset, and an asset may contain one or many AssetFiles.",
      "pos": [
        18620,
        18718
      ]
    },
    {
      "content": "The Media Services Encoder task fails if an asset file object is not associated with a digital file in a blob container.",
      "pos": [
        18719,
        18839
      ]
    },
    {
      "pos": [
        18841,
        19038
      ],
      "content": "After you upload your digital media file into a blob container, you will use the <bpt id=\"p1\">**</bpt>MERGE<ept id=\"p1\">**</ept> HTTP request to update the AssetFile with information about your media file (as shown later in the topic)."
    },
    {
      "content": "HTTP Request",
      "pos": [
        19043,
        19055
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        20149,
        20162
      ]
    },
    {
      "content": "Creating the AccessPolicy with write permission.",
      "pos": [
        21470,
        21518
      ]
    },
    {
      "content": "Before uploading any files into blob storage, set the access policy rights for writing to an asset.",
      "pos": [
        21521,
        21620
      ]
    },
    {
      "content": "To do that, POST an HTTP request to the AccessPolicies entity set.",
      "pos": [
        21621,
        21687
      ]
    },
    {
      "content": "Define a DurationInMinutes value upon creation or you will receive a 500 Internal Server error message back in response.",
      "pos": [
        21688,
        21808
      ]
    },
    {
      "content": "For more information on AccessPolicies, see <bpt id=\"p1\">[</bpt>AccessPolicy<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974297.aspx)</ept>.",
      "pos": [
        21809,
        21923
      ]
    },
    {
      "content": "The following example shows how to create an AccessPolicy:",
      "pos": [
        21925,
        21983
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        21995,
        22007
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        22975,
        22987
      ]
    },
    {
      "content": "Get the Upload URL",
      "pos": [
        24072,
        24090
      ]
    },
    {
      "content": "To receive the actual upload URL, create a SAS Locator.",
      "pos": [
        24092,
        24147
      ]
    },
    {
      "content": "Locators define the start time and type of connection endpoint for clients that want to access Files in an Asset.",
      "pos": [
        24148,
        24261
      ]
    },
    {
      "content": "You can create multiple Locator entities for a given AccessPolicy and Asset pair to handle different client requests and needs.",
      "pos": [
        24262,
        24389
      ]
    },
    {
      "content": "Each of these Locators use the StartTime value plus the DurationInMinutes value of the AccessPolicy to determine the length of time a URL can be used.",
      "pos": [
        24390,
        24540
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Locator<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974308.aspx)</ept>.",
      "pos": [
        24541,
        24632
      ]
    },
    {
      "content": "A SAS URL has the following format:",
      "pos": [
        24635,
        24670
      ]
    },
    {
      "content": "Some considerations apply:",
      "pos": [
        24766,
        24792
      ]
    },
    {
      "content": "You cannot have more than five unique Locators associated with a given Asset at one time.",
      "pos": [
        24796,
        24885
      ]
    },
    {
      "content": "For more information, see Locator.",
      "pos": [
        24886,
        24920
      ]
    },
    {
      "content": "If you need to upload your files immediately, you should set your StartTime value to five minutes before the current time.",
      "pos": [
        24923,
        25045
      ]
    },
    {
      "content": "This is because there may be clock skew between your client machine and Media Services.",
      "pos": [
        25046,
        25133
      ]
    },
    {
      "content": "Also, your StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").",
      "pos": [
        25134,
        25262
      ]
    },
    {
      "content": "There may be a 30-40 second delay after a Locator is created to when it is available for use.",
      "pos": [
        25268,
        25361
      ]
    },
    {
      "content": "This issue applies to both SAS URL and Origin Locators.",
      "pos": [
        25362,
        25417
      ]
    },
    {
      "content": "The following example shows how to create a SAS URL Locator, as defined by the Type property in the request body (\"1\" for a SAS locator and \"2\" for an On-Demand origin locator).",
      "pos": [
        25419,
        25596
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> property returned contains the URL that you must use to upload your file.",
      "pos": [
        25597,
        25683
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        25691,
        25703
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        26810,
        26823
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        26827,
        26877
      ]
    },
    {
      "content": "Upload a file into a blob storage container",
      "pos": [
        28576,
        28619
      ]
    },
    {
      "content": "Once you have the AccessPolicy and Locator set, the actual file is uploaded to an Azure Blob Storage container using the Azure Storage REST APIs.",
      "pos": [
        28625,
        28770
      ]
    },
    {
      "content": "You can either upload in page or block blobs.",
      "pos": [
        28771,
        28816
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You must add the file name for the file you want to upload to the Locator <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> value received in the previous section.",
      "pos": [
        28820,
        28955
      ]
    },
    {
      "content": "For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4?",
      "pos": [
        28956,
        29081
      ]
    },
    {
      "content": ".",
      "pos": [
        29082,
        29083
      ]
    },
    {
      "content": ".",
      "pos": [
        29084,
        29085
      ]
    },
    {
      "content": ".",
      "pos": [
        29086,
        29087
      ]
    },
    {
      "pos": [
        29090,
        29231
      ],
      "content": "For more information on working with Azure storage blobs, see <bpt id=\"p1\">[</bpt>Blob Service REST API<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/dd135733.aspx)</ept>."
    },
    {
      "content": "Update the AssetFile",
      "pos": [
        29238,
        29258
      ]
    },
    {
      "content": "Now that you've uploaded your file, update the FileAsset size (and other) information.",
      "pos": [
        29261,
        29347
      ]
    },
    {
      "content": "For example:",
      "pos": [
        29348,
        29360
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        30529,
        30542
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        30546,
        30587
      ]
    },
    {
      "content": "HTTP/1.1 204 No Content",
      "pos": [
        30592,
        30615
      ]
    },
    {
      "content": "Delete the Locator and AccessPolicy",
      "pos": [
        30620,
        30655
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        30660,
        30672
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        31555,
        31568
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        31572,
        31613
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        31655,
        31667
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        32550,
        32563
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        32567,
        32608
      ]
    },
    {
      "pos": [
        32653,
        32730
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"configure_streaming_units\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Configure streaming units with REST API"
    },
    {
      "content": "When working with Azure Media Services one of the most common scenarios is delivering adaptive bitrate streaming to your clients.",
      "pos": [
        32732,
        32861
      ]
    },
    {
      "content": "With adaptive bitrate streaming, the client can switch to a higher or lower bitrate stream as the video is displayed based on the current network bandwidth, CPU utilization, and other factors.",
      "pos": [
        32862,
        33054
      ]
    },
    {
      "content": "Media Services supports the following adaptive bitrate streaming technologies: HTTP Live Streaming (HLS), Smooth Streaming, MPEG DASH, and HDS (for Adobe PrimeTime/Access licensees only).",
      "pos": [
        33055,
        33242
      ]
    },
    {
      "content": "Media Services provides dynamic packaging which allows you to deliver your adaptive bitrate MP4 or Smooth Streaming encoded content in streaming formats supported by Media Services (MPEG DASH, HLS, Smooth Streaming, HDS) without you having to re-package into these streaming formats.",
      "pos": [
        33245,
        33528
      ]
    },
    {
      "content": "To take advantage of dynamic packaging, you need to do the following:",
      "pos": [
        33531,
        33600
      ]
    },
    {
      "content": "get at least one streaming unit for the **streaming endpoint **from which you plan to deliver your content (described in this section).",
      "pos": [
        33604,
        33739
      ]
    },
    {
      "content": "encode or transcode your mezzanine (source) file into a set of adaptive bitrate MP4 files or adaptive bitrate Smooth Streaming files (the encoding steps are demonstrated later in this tutorial),",
      "pos": [
        33742,
        33936
      ]
    },
    {
      "content": "With dynamic packaging you only need to store and pay for the files in single storage format and Media Services will build and serve the appropriate response based on requests from a client.",
      "pos": [
        33940,
        34130
      ]
    },
    {
      "pos": [
        34135,
        34271
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> For information about pricing details, see <bpt id=\"p1\">[</bpt>Media Services Pricing Details<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=275107)</ept>."
    },
    {
      "content": "To change the number of streaming reserved units, do the following:",
      "pos": [
        34273,
        34340
      ]
    },
    {
      "content": "Get the streaming endpoint you want to update",
      "pos": [
        34350,
        34395
      ]
    },
    {
      "content": "For example, let's get the first streaming endpoint in your account (you can have up to 2 streaming endpoints in running state at the same time.)",
      "pos": [
        34397,
        34542
      ]
    },
    {
      "pos": [
        34544,
        34561
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Request<ept id=\"p1\">**</ept>:"
    },
    {
      "content": "HTTP Response",
      "pos": [
        35408,
        35421
      ]
    },
    {
      "content": "If successful, the following is returned:",
      "pos": [
        35429,
        35470
      ]
    },
    {
      "content": "Scale the streaming endpoint",
      "pos": [
        35516,
        35544
      ]
    },
    {
      "pos": [
        35547,
        35564
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Request<ept id=\"p1\">**</ept>:"
    },
    {
      "content": "HTTP Response",
      "pos": [
        36567,
        36580
      ]
    },
    {
      "pos": [
        37116,
        37199
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"long_running_op_status\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph> Check on the status of a long-running operation"
    },
    {
      "content": "The allocation of any new units takes around 20 minutes to complete.",
      "pos": [
        37201,
        37269
      ]
    },
    {
      "content": "To check the status of the operation use the <bpt id=\"p1\">**</bpt>Operations<ept id=\"p1\">**</ept> method and specify the Id of the operation.",
      "pos": [
        37270,
        37373
      ]
    },
    {
      "content": "The operation Id was returned in the response to the <bpt id=\"p1\">**</bpt>Scale<ept id=\"p1\">**</ept> request.",
      "pos": [
        37374,
        37445
      ]
    },
    {
      "pos": [
        37517,
        37534
      ],
      "content": "<bpt id=\"p1\">**</bpt>HTTP Request<ept id=\"p1\">**</ept>:"
    },
    {
      "content": "HTTP Response",
      "pos": [
        38391,
        38404
      ]
    },
    {
      "pos": [
        39601,
        39683
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"encode\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Encode the source file into a set of adaptive bitrate MP4 files"
    },
    {
      "content": "After ingesting Assets into Media Services, media can be encoded, transmuxed, watermarked, and so on, before it is delivered to clients.",
      "pos": [
        39685,
        39821
      ]
    },
    {
      "content": "These activities are scheduled and run against multiple background role instances to ensure high performance and availability.",
      "pos": [
        39822,
        39948
      ]
    },
    {
      "content": "These activities are called Jobs and each <bpt id=\"p1\">[</bpt>Job<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/hh974289.aspx)</ept> is comprised of atomic Tasks that do the actual work on the Asset file.",
      "pos": [
        39949,
        40123
      ]
    },
    {
      "content": "As was mentioned earlier, when working with Azure Media Services one of the most common scenarios is delivering adaptive bitrate streaming to your clients.",
      "pos": [
        40126,
        40281
      ]
    },
    {
      "content": "Media Services can dynamically package a set of adaptive bitrate MP4 files into one of the following formats: HTTP Live Streaming (HLS), Smooth Streaming, MPEG DASH, and HDS (for Adobe PrimeTime/Access licensees only).",
      "pos": [
        40282,
        40500
      ]
    },
    {
      "content": "To take advantage of dynamic packaging, you need to do the following:",
      "pos": [
        40503,
        40572
      ]
    },
    {
      "content": "encode or transcode your mezzanine (source) file into a set of adaptive bitrate MP4 files or adaptive bitrate Smooth Streaming files,",
      "pos": [
        40576,
        40709
      ]
    },
    {
      "content": "get at least one streaming unit for the streaming endpoint from which you plan to deliver your content.",
      "pos": [
        40714,
        40817
      ]
    },
    {
      "content": "The following section shows how to create a job that contains one encoding task.",
      "pos": [
        40820,
        40900
      ]
    },
    {
      "content": "The task specifies to transcode the mezzanine file into a set of adaptive bitrate MP4s using <bpt id=\"p1\">**</bpt>Azure Media Encoder<ept id=\"p1\">**</ept>.",
      "pos": [
        40901,
        41018
      ]
    },
    {
      "content": "The section also shows how to monitor the job processing progress.",
      "pos": [
        41019,
        41085
      ]
    },
    {
      "content": "When the job is complete you you would be able to create locators that are needed to get access to your assets.",
      "pos": [
        41086,
        41197
      ]
    },
    {
      "content": "Get a media processor",
      "pos": [
        41204,
        41225
      ]
    },
    {
      "content": "In Media Services, a media processor is a component that handles a specific processing task, such as encoding, format conversion, encrypting, or decrypting media content.",
      "pos": [
        41227,
        41397
      ]
    },
    {
      "content": "For the encoding task shown in this tutorial we are going to use the Azure Media Encoder.",
      "pos": [
        41398,
        41487
      ]
    },
    {
      "content": "The following code requests the encoder's id.",
      "pos": [
        41489,
        41534
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        41539,
        41551
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        42429,
        42442
      ]
    },
    {
      "content": "Create a job",
      "pos": [
        43372,
        43384
      ]
    },
    {
      "content": "Each Job can have one or more Tasks depending on the type of processing that you want to accomplish.",
      "pos": [
        43386,
        43486
      ]
    },
    {
      "content": "Through the REST API, you can create Jobs and their related Tasks in one of two ways: Tasks can be defined inline through the Tasks navigation property on Job entities, or through OData batch processing.",
      "pos": [
        43487,
        43690
      ]
    },
    {
      "content": "The Media Services SDK uses batch processing; however, for the readability of the code examples in this topic, tasks are defined inline.",
      "pos": [
        43691,
        43827
      ]
    },
    {
      "content": "For information on batch processing, see <bpt id=\"p1\">[</bpt>Open Data Protocol (OData) Batch Processing<ept id=\"p1\">](http://www.odata.org/documentation/odata-version-3-0/batch-processing/)</ept>.",
      "pos": [
        43828,
        43987
      ]
    },
    {
      "content": "The following example shows you how to create and post a Job with one Task set to encode a video at a specific resolution and quality.",
      "pos": [
        43989,
        44123
      ]
    },
    {
      "content": "The following documentation section contains the list of all the <bpt id=\"p1\">[</bpt>task presets<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/dn619392.aspx)</ept> supported by the Azure Media Processor.",
      "pos": [
        44124,
        44298
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        44304,
        44316
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        45891,
        45904
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        45908,
        45958
      ]
    },
    {
      "content": "There are a few important things to note in any Job request:",
      "pos": [
        48315,
        48375
      ]
    },
    {
      "content": "TaskBody properties MUST use literal XML to define the number of input, or output assets that will be used by the Task.",
      "pos": [
        48379,
        48498
      ]
    },
    {
      "content": "The Task topic contains the XML Schema Definition for the XML.",
      "pos": [
        48499,
        48561
      ]
    },
    {
      "content": "In the TaskBody definition, each inner value for",
      "pos": [
        48564,
        48612
      ]
    },
    {
      "content": "and",
      "pos": [
        48626,
        48629
      ]
    },
    {
      "content": "must be set as JobInputAsset(value) or JobOutputAsset(value).",
      "pos": [
        48644,
        48705
      ]
    },
    {
      "content": "A task can have multiple output assets.",
      "pos": [
        48708,
        48747
      ]
    },
    {
      "content": "One JobOutputAsset(x) can only be used once as an output of a task in a job.",
      "pos": [
        48748,
        48824
      ]
    },
    {
      "content": "You can specify JobInputAsset or JobOutputAsset as an input asset of a task.",
      "pos": [
        48827,
        48903
      ]
    },
    {
      "content": "Tasks must not form a cycle.",
      "pos": [
        48906,
        48934
      ]
    },
    {
      "content": "The value parameter that you pass to JobInputAsset or JobOutputAsset represents the index value for an Asset.",
      "pos": [
        48937,
        49046
      ]
    },
    {
      "content": "The actual Assets are defined in the InputMediaAssets and OutputMediaAssets navigation properties on the Job entity definition.",
      "pos": [
        49047,
        49174
      ]
    },
    {
      "pos": [
        49178,
        49392
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Because Media Services is built on OData v3, the individual assets in InputMediaAssets and OutputMediaAssets navigation property collections are referenced through a \"__metadata : uri\" name-value pair."
    },
    {
      "content": "InputMediaAssets maps to one or more Assets you have created in Media Services.",
      "pos": [
        49397,
        49476
      ]
    },
    {
      "content": "OutputMediaAssets are created by the system.",
      "pos": [
        49477,
        49521
      ]
    },
    {
      "content": "They do not reference an existing asset.",
      "pos": [
        49522,
        49562
      ]
    },
    {
      "content": "OutputMediaAssets can be named using the assetName attribute.",
      "pos": [
        49565,
        49626
      ]
    },
    {
      "content": "If this attribute is not present, then the name of the OutputMediaAsset will be whatever the inner text value of the",
      "pos": [
        49627,
        49743
      ]
    },
    {
      "content": "element is with a suffix of either the Job Name value, or the Job Id value (in the case where the Name property isn't defined).",
      "pos": [
        49758,
        49885
      ]
    },
    {
      "content": "For example, if you set a value for assetName to \"Sample\", then the OutputMediaAsset Name property would be set to \"Sample\".",
      "pos": [
        49886,
        50010
      ]
    },
    {
      "content": "However, if you did not set a value for assetName, but did set the job name to \"NewJob\", then the OutputMediaAsset Name would be \"JobOutputAsset(value)_NewJob\".",
      "pos": [
        50011,
        50171
      ]
    },
    {
      "content": "The following example shows how to set the assetName attribute:",
      "pos": [
        50178,
        50241
      ]
    },
    {
      "content": "To enable task chaining:",
      "pos": [
        50446,
        50470
      ]
    },
    {
      "content": "A job must have at least 2 tasks",
      "pos": [
        50478,
        50510
      ]
    },
    {
      "content": "There must be at least one task whose input is output of another task in the job.",
      "pos": [
        50517,
        50598
      ]
    },
    {
      "pos": [
        50600,
        50741
      ],
      "content": "For more information see, <bpt id=\"p1\">[</bpt>Creating an Encoding Job with the Media Services REST API<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/jj129574.aspx)</ept>."
    },
    {
      "content": "Monitor Processing Progress",
      "pos": [
        50747,
        50774
      ]
    },
    {
      "content": "You can retrieve the Job status by using the State property, as shown in the following example.",
      "pos": [
        50776,
        50871
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        50876,
        50888
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        51798,
        51811
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        51815,
        51865
      ]
    },
    {
      "content": "Cancel a job",
      "pos": [
        52285,
        52297
      ]
    },
    {
      "content": "Media Services allows you to cancel running jobs through the CancelJob function.",
      "pos": [
        52299,
        52379
      ]
    },
    {
      "content": "This call will return a 400 error code if you try to cancel a Job when its state is canceled, canceling, error, or finished.",
      "pos": [
        52380,
        52504
      ]
    },
    {
      "content": "The following example shows how to call CancelJob.",
      "pos": [
        52506,
        52556
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        52561,
        52573
      ]
    },
    {
      "content": "If successful, a 204 response code is returned with no message body.",
      "pos": [
        53459,
        53527
      ]
    },
    {
      "pos": [
        53530,
        53655
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You must URL-encode the job id (normally nb:jid:UUID: somevalue) when passing it in as a parameter to CancelJob."
    },
    {
      "content": "Get the output asset",
      "pos": [
        53662,
        53682
      ]
    },
    {
      "content": "The following code shows how to request the output asset Id.",
      "pos": [
        53685,
        53745
      ]
    },
    {
      "content": "HTTP Request",
      "pos": [
        53751,
        53763
      ]
    },
    {
      "content": "HTTP Response",
      "pos": [
        54708,
        54721
      ]
    },
    {
      "pos": [
        55870,
        55978
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"publish_get_urls\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Publish the asset and get streaming and progressive download URLs with REST API"
    },
    {
      "content": "To stream or download an asset you first need to \"publish\" it by creating a locator.",
      "pos": [
        55980,
        56064
      ]
    },
    {
      "content": "Locators provide access to files contained in the asset.",
      "pos": [
        56065,
        56121
      ]
    },
    {
      "content": "Media Services supports two types of locators: OnDemandOrigin locators, used to stream media (for example, MPEG DASH, HLS, or Smooth Streaming) and Access Signature (SAS) locators, used to download media files.",
      "pos": [
        56122,
        56332
      ]
    },
    {
      "content": "Once you create the locators, you can build the URLs that are used to stream or download your files.",
      "pos": [
        56334,
        56434
      ]
    },
    {
      "content": "A streaming URL for Smooth Streaming has the following format:",
      "pos": [
        56438,
        56500
      ]
    },
    {
      "content": "A streaming URL for HLS has the following format:",
      "pos": [
        56634,
        56683
      ]
    },
    {
      "content": "A streaming URL for MPEG DASH has the following format:",
      "pos": [
        56835,
        56890
      ]
    },
    {
      "content": "A SAS URL used to download files has the following format:",
      "pos": [
        57046,
        57104
      ]
    },
    {
      "content": "This sections shows how to perform the following tasks necessary to \"publish\" your assets.",
      "pos": [
        57174,
        57264
      ]
    },
    {
      "content": "Creating the AccessPolicy with read permission",
      "pos": [
        57270,
        57316
      ]
    },
    {
      "content": "Creating a SAS URL for downloading content",
      "pos": [
        57320,
        57362
      ]
    },
    {
      "content": "Creating an origin URL for streaming content",
      "pos": [
        57366,
        57410
      ]
    },
    {
      "content": "Creating the AccessPolicy with read permission",
      "pos": [
        57416,
        57462
      ]
    },
    {
      "content": "Before downloading or streaming any media content, first define an AccessPolicy with read permissions and create the appropriate Locator entity that specifies the type of delivery mechanism you want to enable for your clients.",
      "pos": [
        57464,
        57690
      ]
    },
    {
      "content": "For more information on the properties available, see <bpt id=\"p1\">[</bpt>AccessPolicy Entity Properties<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/hh974297.aspx#accesspolicy_properties)</ept>.",
      "pos": [
        57691,
        57858
      ]
    },
    {
      "content": "The following example shows how to specify the AccessPolicy for read permissions for a given Asset.",
      "pos": [
        57860,
        57959
      ]
    },
    {
      "content": "If successful, a 201 success code is returned describing the AccessPolicy entity that you created.",
      "pos": [
        58889,
        58987
      ]
    },
    {
      "content": "You will then use the AccessPolicy Id along with the Asset Id of the asset that contains the file you want to deliver(such as an output asset) to create the Locator entity.",
      "pos": [
        58988,
        59160
      ]
    },
    {
      "content": "This basic workflow is the same as uploading a file when ingesting an Asset (as was discussed earlier in this topic).",
      "pos": [
        59176,
        59293
      ]
    },
    {
      "content": "Also, like uploading files, if you (or your clients) need to access your files immediately, set your StartTime value to five minutes before the current time.",
      "pos": [
        59294,
        59451
      ]
    },
    {
      "content": "This action is necessary because there may be clock skew between the client and Media Services.",
      "pos": [
        59452,
        59547
      ]
    },
    {
      "content": "The StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").",
      "pos": [
        59548,
        59669
      ]
    },
    {
      "content": "Creating a SAS URL for downloading content",
      "pos": [
        59675,
        59717
      ]
    },
    {
      "content": "The following code shows how to get a URL that can be used to download a media file created and uploaded previously.",
      "pos": [
        59720,
        59836
      ]
    },
    {
      "content": "The AccessPolicy has read permissions set and the Locator path refers to a SAS download URL.",
      "pos": [
        59837,
        59929
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        60961,
        61011
      ]
    },
    {
      "pos": [
        63003,
        63055
      ],
      "content": "The returned <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> property contains the SAS URL."
    },
    {
      "content": "If you download storage encrypted content, you must manually decrypt it before rendering it, or use the Storage Decryption MediaProcessor in a processing task to output processed files in the clear to an OutputAsset and then download from that Asset.",
      "pos": [
        63071,
        63321
      ]
    },
    {
      "content": "For more information on processing, see Creating an Encoding Job with the Media Services REST API.",
      "pos": [
        63322,
        63420
      ]
    },
    {
      "content": "Also, SAS URL Locators cannot be updated after they have been created.",
      "pos": [
        63421,
        63491
      ]
    },
    {
      "content": "For example, you cannot reuse the same Locator with an updated StartTime value.",
      "pos": [
        63492,
        63571
      ]
    },
    {
      "content": "This is because of the way SAS URLs are created.",
      "pos": [
        63572,
        63620
      ]
    },
    {
      "content": "If you want to access an asset for download after a Locator has expired, then you must create a new one with a new StartTime.",
      "pos": [
        63621,
        63746
      ]
    },
    {
      "content": "Download files",
      "pos": [
        63751,
        63765
      ]
    },
    {
      "content": "Once you have the AccessPolicy and Locator set, you can download files using the Azure Storage REST APIs.",
      "pos": [
        63767,
        63872
      ]
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> You must add the file name for the file you want to download to the Locator <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> value received in the previous section.",
      "pos": [
        63877,
        64014
      ]
    },
    {
      "content": "For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4?",
      "pos": [
        64015,
        64140
      ]
    },
    {
      "content": ".",
      "pos": [
        64141,
        64142
      ]
    },
    {
      "content": ".",
      "pos": [
        64143,
        64144
      ]
    },
    {
      "content": ".",
      "pos": [
        64145,
        64146
      ]
    },
    {
      "pos": [
        64149,
        64290
      ],
      "content": "For more information on working with Azure storage blobs, see <bpt id=\"p1\">[</bpt>Blob Service REST API<ept id=\"p1\">](http://msdn.microsoft.com/library/azure/dd135733.aspx)</ept>."
    },
    {
      "content": "As a result of the encoding job that you performed earlier (encoding into Adaptive MP4 set), you have multiple MP4 files that you can progressively download.",
      "pos": [
        64292,
        64449
      ]
    },
    {
      "content": "For example:",
      "pos": [
        64450,
        64462
      ]
    },
    {
      "content": "Creating an streaming URL for streaming content",
      "pos": [
        66762,
        66809
      ]
    },
    {
      "content": "The following code shows how to create a streaming URL Locator:",
      "pos": [
        66812,
        66875
      ]
    },
    {
      "content": "If successful, the following response is returned:",
      "pos": [
        67900,
        67950
      ]
    },
    {
      "content": "To stream a Smooth Streaming origin URL in a streaming media player, you must append the Path property with the name of the Smooth Streaming manifest file, followed by \"/manifest\".",
      "pos": [
        69755,
        69935
      ]
    },
    {
      "content": "To stream HLS, append (format=m3u8-aapl) after the \"/manifest\".",
      "pos": [
        70066,
        70129
      ]
    },
    {
      "content": "To stream MPEG DASH, append (format=mpd-time-csf) after the \"/manifest\".",
      "pos": [
        70278,
        70350
      ]
    },
    {
      "pos": [
        70506,
        70540
      ],
      "content": "<ph id=\"ph1\">&lt;a id=\"play\"&gt;</ph><ph id=\"ph2\">&lt;/a&gt;</ph>Play your content"
    },
    {
      "pos": [
        70544,
        70657
      ],
      "content": "To stream you video, use <bpt id=\"p1\">[</bpt>Azure Media Services Player<ept id=\"p1\">](http://amsplayer.azurewebsites.net/azuremediaplayer.html)</ept>."
    },
    {
      "content": "To test progressive download, paste a URL into a browser (for example, IE, Chrome, Safari).",
      "pos": [
        70659,
        70750
      ]
    },
    {
      "content": "Additional Resources",
      "pos": [
        70755,
        70775
      ]
    },
    {
      "pos": [
        70778,
        70941
      ],
      "content": "<ph id=\"ph1\">&lt;a href=\"http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-101-Get-your-video-online-now-\"&gt;</ph>Azure Media Services 101 - Get your video online now!<ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "pos": [
        70944,
        71127
      ],
      "content": "<ph id=\"ph1\">&lt;a href=\"http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-102-Dynamic-Packaging-and-Mobile-Devices\"&gt;</ph>Azure Media Services 102 - Dynamic Packaging and Mobile Devices<ph id=\"ph2\">&lt;/a&gt;</ph>"
    },
    {
      "content": "test",
      "pos": [
        71206,
        71210
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Getting Started with Delivering Video on Demand (VoD) using REST APIs\" \n    description=\"This tutorial walks you through the steps of implementing a Video-on-Demand (VoD) content delivery application with Azure Media Services using REST APIs\" \n    services=\"media-services\" \n    documentationCenter=\"\" \n    authors=\"Juliako\" \n    manager=\"dwrede\" \n    editor=\"\"/>\n\n<tags \n    ms.service=\"media-services\" \n    ms.workload=\"media\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"08/14/2015\" \n    ms.author=\"juliako\"/>\n\n#Getting Started with Delivering Video on Demand (VoD) using REST APIs \n\n[AZURE.INCLUDE [media-services-selector-get-started](../../includes/media-services-selector-get-started.md)]\n\n\n>[AZURE.NOTE]\n> To complete this tutorial, you need an Azure account. If you don't have an account, you can create a free trial account in just a couple of minutes. For details, see <a href=\"http://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A8A8397B5\" target=\"_blank\">Azure Free Trial</a>.\n\nThis quickstart walks you through the steps of implementing a Video-on-Demand (VoD) content delivery application using Azure Media Services (AMS) REST APIs. \n\nThe tutorial introduces the basic Media Services workflow and the most common programming objects and tasks required for Media Services development. At the completion of the tutorial, you will be able to stream or progressively download a sample media file that you uploaded, encoded, and downloaded.  \n\n## Prerequisites\nThe following prerequisites are required to start developing with Media Services with REST APIs.\n\n- Understanding of how to develop with Media Services REST API. For more information, see [media-services-rest-overview](http://msdn.microsoft.com/library/azure/hh973616.aspx).\n- An application of your choice that can send HTTP requests and responses. This tutorial uses [Fiddler](http://www.telerik.com/download/fiddler). \n\nThe following tasks are shown in this quickstart.\n\n1.  Create a Media Services account using Portal.\n1.  Connect to the Media Services account with REST API.\n1.  Create a new asset and upload a video file with REST API.\n1.  Configure streaming units with REST API.\n2.  Encode the source file into a set of adaptive bitrate MP4 files with REST API.\n1.  Publish the asset and get streaming and progressive download URLs with REST API. \n1.  Play your content. \n\n\n## <a id=\"create_ams\"></a>Create a Media Services account using Portal\n\n1. In the [Management Portal][], click **New**, click **Media Service**, and then click **Quick Create**.\n   \n    ![Media Services Quick Create](./media/media-services-rest-get-started/wams-QuickCreate.png)\n\n2. In **NAME**, enter the name of the new account. A Media Services account name is all lower-case numbers or letters with no spaces, and is 3 - 24 characters in length. \n\n3. In **REGION**, select the geographic region that will be used to store the metadata records for your Media Services account. Only the available Media Services regions appear in the dropdown. \n\n4. In **STORAGE ACCOUNT**, select a storage account to provide blob storage of the media content from your Media Services account. You can select an existing storage account in the same geographic region as your Media Services account, or you can create a new storage account. A new storage account is created in the same region. \n\n5. If you created a new storage account, in **NEW STORAGE ACCOUNT NAME**, enter a name for the storage account. The rules for storage account names are the same as for Media Services accounts.\n\n6. Click **Quick Create** at the bottom of the form.\n\n    You can monitor the status of the process in the message area at the bottom of the window.\n\n    Once account is successfully created, the status changes to Active. \n    \n    At the bottom of the page, the **MANAGE KEYS** button appears. When you click on this button, a dialog with the Media Services account name and the primary and secondary keys is displayed. You will need the account name and the primary key information to programmatically access the Media Services account. \n\n    \n    ![Media Services Page](./media/media-services-rest-get-started/wams-mediaservices-page.png)\n\n    When you double-click on the account name, the Quick Start page is displayed by default. This page enables you to do some management tasks that are also available on other pages of the portal. For example, you can upload a video file from this page, or do it from the CONTENT page.\n\n\n## <a id=\"connect\"></a>Connect to the Media Services account with REST API\n\nTwo things are required when accessing Azure Media Services: an access token provided by Azure Access Control Services (ACS), and the URI of Media Services itself. You can use any means you want when creating these requests as long as you specify the correct header values and pass in the access token correctly when calling into Media Services.\n\nThe following steps describe the most common workflow when using the Media Services REST API to connect to Media Services:\n\n1. Getting an access token. \n2. Connecting to the Media Services URI. \n    \n    >[AZURE.NOTE]\n    After successfully connecting to https://media.windows.net, you will receive a 301 redirect specifying another Media Services URI. You must make subsequent calls to the new URI.\n    > \n    > You may also receive a HTTP/1.1 200 response that contains the ODATA API metadata description.\n3. Posting your subsequent API calls to the new URL. \n    \n    For example, if after trying to connect, you got the following:\n        \n        HTTP/1.1 301 Moved Permanently\n        Location: https://wamsbayclus001rest-hs.cloudapp.net/api/\n\n    You should post your subsequent API calls to https://wamsbayclus001rest-hs.cloudapp.net/api/.\n\n###Getting an access token\n\nTo access Media Services directly through the REST API, retrieve an access token from ACS and use it during every HTTP request you make into the service. This token is similar to other tokens provided by ACS based on access claims provided in the header of an HTTP request and using the OAuth v2 protocol. You do not need any other prerequisites before directly connecting to Media Services.\n\nThe following example shows the HTTP request header and body used to retrieve a token.\n\n**Header**:\n\n    POST https://wamsprodglobal001acs.accesscontrol.windows.net/v2/OAuth2-13 HTTP/1.1\n    Content-Type: application/x-www-form-urlencoded\n    Host: wamsprodglobal001acs.accesscontrol.windows.net\n    Content-Length: 120\n    Expect: 100-continue\n    Connection: Keep-Alive\n    Accept: application/json\n\n    \n**Body**:\n\nYou need to proved the client_id and client_secret values in the body of this request; client_id and client_secret correspond to the AccountName and AccountKey values, respectively. These values are provided to you by Media Services when you set up your account. \n\nNote that the AccountKey for your Media Services account must be URL-encoded when using it as the client_secret value in your access token request.\n\n    grant_type=client_credentials&client_id=ams_account_name&client_secret=URL_encoded_ams_account_key&scope=urn%3aWindowsAzureMediaServices\n\n\nFor example: \n\n    grant_type=client_credentials&client_id=amstestaccount001&client_secret=wUNbKhNj07oqjqU3Ah9R9f4kqTJ9avPpfe6Pk3YZ7ng%3d&scope=urn%3aWindowsAzureMediaServices\n\n\nThe following example shows the HTTP response that contains the access token in the response body.\n\n    HTTP/1.1 200 OK\n    Cache-Control: no-cache, no-store\n    Pragma: no-cache\n    Content-Type: application/json; charset=utf-8\n    Expires: -1\n    request-id: a65150f5-2784-4a01-a4b7-33456187ad83\n    X-Content-Type-Options: nosniff\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Thu, 15 Jan 2015 08:07:20 GMT\n    Content-Length: 670\n    \n    {  \n       \"token_type\":\"http://schemas.xmlsoap.org/ws/2009/11/swt-token-profile-1.0\",\n       \"access_token\":\"http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421330840&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=uf69n82KlqZmkJDNxhJkOxpyIpA2HDyeGUTtSnq1vlE%3d\",\n       \"expires_in\":\"21600\",\n       \"scope\":\"urn:WindowsAzureMediaServices\"\n    }\n    \n\n>[AZURE.NOTE]\nIt is recommended to cache the \"access_token \" and \"expires_in \" values to an external storage. The token data could later be retrieved from the storage and re-used in your Media Services REST API calls. This is especially useful for scenarios where the token can be securely shared among multiple processes or computers.\n\nMake sure to monitor the \"expires_in\" value of the access token and update your REST API calls with new tokens as needed.\n\n###Connecting to the Media Services URI\n\nThe root URI for Media Services is https://media.windows.net/. You should initially connect to this URI, and if you get a 301 redirect back in response, you should make subsequent calls to the new URI. In addition, do not use any auto-redirect/follow logic in your requests. HTTP verbs and request bodies will not be forwarded to the new URI.\n\nNote that the root URI for uploading and downloading Asset files is https://yourstorageaccount.blob.core.windows.net/ where the storage account name is the same one you used during your Media Services account setup.\n\nThe following example demonstrates HTTP request to the Media Services root URI (https://media.windows.net/). The request gets a 301 redirect back in response. The subsequent request is using the new URI (https://wamsbayclus001rest-hs.cloudapp.net/api/).     \n\n**HTTP Request**:\n    \n    GET https://media.windows.net/ HTTP/1.1\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421500579&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=ElVWXOnMVggFQl%2ft9vhdcv1qH1n%2fE8l3hRef4zPmrzg%3d\n    x-ms-version: 2.11\n    Accept: application/json\n    Host: media.windows.net\n\n\n**HTTP Response**:\n    \n    HTTP/1.1 301 Moved Permanently\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/\n    Server: Microsoft-IIS/8.5\n    request-id: 987d7652-497a-44e5-b815-f492e02aef97\n    x-ms-request-id: 987d7652-497a-44e5-b815-f492e02aef97\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sat, 17 Jan 2015 07:44:53 GMT\n    Content-Length: 164\n    \n    <html><head><title>Object moved</title></head><body>\n    <h2>Object moved to <a href=\"https://wamsbayclus001rest-hs.cloudapp.net/api/\">here</a>.</h2>\n    </body></html>\n\n\n**HTTP Request** (using the new URI):\n            \n    GET https://wamsbayclus001rest-hs.cloudapp.net/api/ HTTP/1.1\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421500579&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=ElVWXOnMVggFQl%2ft9vhdcv1qH1n%2fE8l3hRef4zPmrzg%3d\n    x-ms-version: 2.11\n    Accept: application/json\n    Host: wamsbayclus001rest-hs.cloudapp.net\n\n\n**HTTP Response**:\n    \n    HTTP/1.1 200 OK\n    Cache-Control: no-cache\n    Content-Length: 1250\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Server: Microsoft-IIS/8.5\n    request-id: 5f52ea9d-177e-48fe-9709-24953d19f84a\n    x-ms-request-id: 5f52ea9d-177e-48fe-9709-24953d19f84a\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sat, 17 Jan 2015 07:44:52 GMT\n    \n    {\"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata\",\"value\":[{\"name\":\"AccessPolicies\",\"url\":\"AccessPolicies\"},{\"name\":\"Locators\",\"url\":\"Locators\"},{\"name\":\"ContentKeys\",\"url\":\"ContentKeys\"},{\"name\":\"ContentKeyAuthorizationPolicyOptions\",\"url\":\"ContentKeyAuthorizationPolicyOptions\"},{\"name\":\"ContentKeyAuthorizationPolicies\",\"url\":\"ContentKeyAuthorizationPolicies\"},{\"name\":\"Files\",\"url\":\"Files\"},{\"name\":\"Assets\",\"url\":\"Assets\"},{\"name\":\"AssetDeliveryPolicies\",\"url\":\"AssetDeliveryPolicies\"},{\"name\":\"IngestManifestFiles\",\"url\":\"IngestManifestFiles\"},{\"name\":\"IngestManifestAssets\",\"url\":\"IngestManifestAssets\"},{\"name\":\"IngestManifests\",\"url\":\"IngestManifests\"},{\"name\":\"StorageAccounts\",\"url\":\"StorageAccounts\"},{\"name\":\"Tasks\",\"url\":\"Tasks\"},{\"name\":\"NotificationEndPoints\",\"url\":\"NotificationEndPoints\"},{\"name\":\"Jobs\",\"url\":\"Jobs\"},{\"name\":\"TaskTemplates\",\"url\":\"TaskTemplates\"},{\"name\":\"JobTemplates\",\"url\":\"JobTemplates\"},{\"name\":\"MediaProcessors\",\"url\":\"MediaProcessors\"},{\"name\":\"EncodingReservedUnitTypes\",\"url\":\"EncodingReservedUnitTypes\"},{\"name\":\"Operations\",\"url\":\"Operations\"},{\"name\":\"StreamingEndpoints\",\"url\":\"StreamingEndpoints\"},{\"name\":\"Channels\",\"url\":\"Channels\"},{\"name\":\"Programs\",\"url\":\"Programs\"}]}\n     \n\n\n>[AZURE.NOTE] From now on the new URI will be used in this tutorial.\n\n## <a id=\"upload\"></a>Create a new asset and upload a video file with REST API\n\nIn Media Services, you upload your digital files into an asset. The **Asset** entity can contain video, audio, images, thumbnail collections, text tracks and closed caption files (and the metadata about these files.)  Once the files are uploaded into the asset, your content is stored securely in the cloud for further processing and streaming. \n\nOne of the values that you have to provide when creating an asset is asset creation options. The **Options** property is an enumeration value that describes the encryption options that an Asset can be created with. A valid value is one of the values from the list below, not a combination of values from this list:\n\n \n- **None** = **0** - No encryption is used. Note that when using this option your content is not protected in transit or at rest in storage.\n    If you plan to deliver an MP4 using progressive download, use this option. \n- **StorageEncrypted** = **1** - Encrypts your clear content locally using AES-256 bit encryption and then uploads it to Azure Storage where it is stored encrypted at rest. Assets protected with Storage Encryption are automatically unencrypted and placed in an encrypted file system prior to encoding, and optionally re-encrypted prior to uploading back as a new output asset. The primary use case for Storage Encryption is when you want to secure your high quality input media files with strong encryption at rest on disk.\n- **CommonEncryptionProtected** = **2** - Use this option if you are uploading content that has already been encrypted and protected with Common Encryption or PlayReady DRM (for example, Smooth Streaming protected with PlayReady DRM).\n- **EnvelopeEncryptionProtected** = **4** – Use this option if you are uploading HLS encrypted with AES. Note that the files must have been encoded and encrypted by Transform Manager.\n\n### Create an asset\n\nAn asset is a container for multiple types or sets of objects in Media Services, including video, audio, images, thumbnail collections, text tracks, and closed caption files. In the REST API, creating an Asset requires sending POST request to Media Services and placing any property information about your asset in the request body.\n\nThe following example shows how to create an asset.\n\n**HTTP Request**\n\n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/Assets HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    x-ms-client-request-id: c59de965-bc89-4295-9a57-75d897e5221e\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    Content-Length: 45\n    \n    {\"Name\":\"BigBuckBunny.mp4\", \"Options\":\"0\"}\n    \n\n**HTTP Response**\n\nIf successful, the following is returned:\n    \n    HTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 452\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Assets('nb%3Acid%3AUUID%3A9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1')\n    Server: Microsoft-IIS/8.5\n    x-ms-client-request-id: c59de965-bc89-4295-9a57-75d897e5221e\n    request-id: e98be122-ae09-473a-8072-0ccd234a0657\n    x-ms-request-id: e98be122-ae09-473a-8072-0ccd234a0657\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sun, 18 Jan 2015 22:06:40 GMT\n        \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Assets/@Element\",\n       \"Id\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"State\":0,\n       \"Created\":\"2015-01-18T22:06:40.6010903Z\",\n       \"LastModified\":\"2015-01-18T22:06:40.6010903Z\",\n       \"AlternateId\":null,\n       \"Name\":\"BigBuckBunny2.mp4\",\n       \"Options\":0,\n       \"Uri\":\"https://storagetestaccount001.blob.core.windows.net/asset-9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StorageAccountName\":\"storagetestaccount001\"\n    }\n    \n### Create an AssetFile\n\nThe [AssetFile](http://msdn.microsoft.com/library/azure/hh974275.aspx) entity represents a video or audio file that is stored in a blob container. An asset file is always associated with an asset, and an asset may contain one or many AssetFiles. The Media Services Encoder task fails if an asset file object is not associated with a digital file in a blob container.\n\nAfter you upload your digital media file into a blob container, you will use the **MERGE** HTTP request to update the AssetFile with information about your media file (as shown later in the topic). \n\n**HTTP Request**\n\n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/Files HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    Content-Length: 164\n    \n    {  \n       \"IsEncrypted\":\"false\",\n       \"IsPrimary\":\"false\",\n       \"MimeType\":\"video/mp4\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\"\n    }\n\n\n**HTTP Response**\n\n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 535\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Files('nb%3Acid%3AUUID%3Af13a0137-0a62-9d4c-b3b9-ca944b5142c5')\n    Server: Microsoft-IIS/8.5\n    request-id: 98a30e2d-f379-4495-988e-0b79edc9b80e\n    x-ms-request-id: 98a30e2d-f379-4495-988e-0b79edc9b80e\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 00:34:07 GMT\n    \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Files/@Element\",\n       \"Id\":\"nb:cid:UUID:f13a0137-0a62-9d4c-b3b9-ca944b5142c5\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ContentFileSize\":\"0\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"EncryptionVersion\":null,\n       \"EncryptionScheme\":null,\n       \"IsEncrypted\":false,\n       \"EncryptionKeyId\":null,\n       \"InitializationVector\":null,\n       \"IsPrimary\":false,\n       \"LastModified\":\"2015-01-19T00:34:08.1934137Z\",\n       \"Created\":\"2015-01-19T00:34:08.1934137Z\",\n       \"MimeType\":\"video/mp4\",\n       \"ContentChecksum\":null\n    }\n\n\n### Creating the AccessPolicy with write permission. \n\nBefore uploading any files into blob storage, set the access policy rights for writing to an asset. To do that, POST an HTTP request to the AccessPolicies entity set. Define a DurationInMinutes value upon creation or you will receive a 500 Internal Server error message back in response. For more information on AccessPolicies, see [AccessPolicy](http://msdn.microsoft.com/library/azure/hh974297.aspx).\n\nThe following example shows how to create an AccessPolicy:\n        \n**HTTP Request**\n\n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/AccessPolicies HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    Content-Length: 74\n    \n    {\"Name\":\"NewUploadPolicy\", \"DurationInMinutes\":\"440\", \"Permissions\":\"2\"} \n\n**HTTP Request**\n\n    If successful, the following response is returned:\n    \n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 312\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/AccessPolicies('nb%3Apid%3AUUID%3Abe0ac48d-af7d-4877-9d60-1805d68bffae')\n    Server: Microsoft-IIS/8.5\n    request-id: 74c74545-7e0a-4cd6-a440-c1c48074a970\n    x-ms-request-id: 74c74545-7e0a-4cd6-a440-c1c48074a970\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Sun, 18 Jan 2015 22:18:06 GMT\n\n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#AccessPolicies/@Element\",\n       \"Id\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"Created\":\"2015-01-18T22:18:06.6370575Z\",\n       \"LastModified\":\"2015-01-18T22:18:06.6370575Z\",\n       \"Name\":\"NewUploadPolicy\",\n       \"DurationInMinutes\":440.0,\n       \"Permissions\":2\n    }\n\n### Get the Upload URL\n\nTo receive the actual upload URL, create a SAS Locator. Locators define the start time and type of connection endpoint for clients that want to access Files in an Asset. You can create multiple Locator entities for a given AccessPolicy and Asset pair to handle different client requests and needs. Each of these Locators use the StartTime value plus the DurationInMinutes value of the AccessPolicy to determine the length of time a URL can be used. For more information, see [Locator](http://msdn.microsoft.com/library/azure/hh974308.aspx).\n\n\nA SAS URL has the following format:\n\n    {https://myaccount.blob.core.windows.net}/{asset name}/{video file name}?{SAS signature}\n\nSome considerations apply:\n\n- You cannot have more than five unique Locators associated with a given Asset at one time. For more information, see Locator.\n- If you need to upload your files immediately, you should set your StartTime value to five minutes before the current time. This is because there may be clock skew between your client machine and Media Services. Also, your StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").   \n- There may be a 30-40 second delay after a Locator is created to when it is available for use. This issue applies to both SAS URL and Origin Locators.\n\nThe following example shows how to create a SAS URL Locator, as defined by the Type property in the request body (\"1\" for a SAS locator and \"2\" for an On-Demand origin locator). The **Path** property returned contains the URL that you must use to upload your file.\n    \n**HTTP Request**\n    \n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/Locators HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=f7f09258-6753-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421640053&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=vlG%2fPYdFDMS1zKc36qcFVWnaNh07UCkhYj3B71%2fk1YA%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    Content-Length: 178\n    \n    {  \n       \"AccessPolicyId\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"AssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StartTime\":\"2015-02-18T16:45:53\",\n       \"Type\":1\n    }\n\n\n**HTTP Response**\n\nIf successful, the following response is returned:\n        \n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 949\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Locators('nb%3Alid%3AUUID%3Aaf57bdd8-6751-4e84-b403-f3c140444b54')\n    Server: Microsoft-IIS/8.5\n    request-id: 2adeb1f8-89c5-4cc8-aa4f-08cdfef33ae0\n    x-ms-request-id: 2adeb1f8-89c5-4cc8-aa4f-08cdfef33ae0\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 03:01:29 GMT\n    \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Locators/@Element\",\n       \"Id\":\"nb:lid:UUID:af57bdd8-6751-4e84-b403-f3c140444b54\",\n       \"ExpirationDateTime\":\"2015-02-19T00:05:53\",\n       \"Type\":1,\n       \"Path\":\"https://storagetestaccount001.blob.core.windows.net/asset-f438649c-313c-46e2-8d68-7d2550288247?sv=2012-02-12&sr=c&si=af57bdd8-6751-4e84-b403-f3c140444b54&sig=fE4btwEfZtVQFeC0Wh3Kwks2OFPQfzl5qTMW5YytiuY%3D&st=2015-02-18T16%3A45%3A53Z&se=2015-02-19T00%3A05%3A53Z\",\n       \"BaseUri\":\"https://storagetestaccount001.blob.core.windows.net/asset-f438649c-313c-46e2-8d68-7d2550288247\",\n       \"ContentAccessComponent\":\"?sv=2012-02-12&sr=c&si=af57bdd8-6751-4e84-b403-f3c140444b54&sig=fE4btwEfZtVQFeC0Wh3Kwks2OFPQfzl5qTMW5YytiuY%3D&st=2015-02-18T16%3A45%3A53Z&se=2015-02-19T00%3A05%3A53Z\",\n       \"AccessPolicyId\":\"nb:pid:UUID:be0ac48d-af7d-4877-9d60-1805d68bffae\",\n       \"AssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\",\n       \"StartTime\":\"2015-02-18T16:45:53\",\n       \"Name\":null\n    }\n\n### Upload a file into a blob storage container\n    \nOnce you have the AccessPolicy and Locator set, the actual file is uploaded to an Azure Blob Storage container using the Azure Storage REST APIs. You can either upload in page or block blobs. \n\n>[AZURE.NOTE] You must add the file name for the file you want to upload to the Locator **Path** value received in the previous section. For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4? . . . \n\nFor more information on working with Azure storage blobs, see [Blob Service REST API](http://msdn.microsoft.com/library/azure/dd135733.aspx).\n\n\n### Update the AssetFile \n\nNow that you've uploaded your file, update the FileAsset size (and other) information. For example:\n    \n    MERGE https://wamsbayclus001rest-hs.cloudapp.net/api/Files('nb%3Acid%3AUUID%3Af13a0137-0a62-9d4c-b3b9-ca944b5142c5') HTTP/1.1\n    Content-Type: application/json\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    \n    {  \n       \"ContentFileSize\":\"1186540\",\n       \"Id\":\"nb:cid:UUID:f13a0137-0a62-9d4c-b3b9-ca944b5142c5\",\n       \"MimeType\":\"video/mp4\",\n       \"Name\":\"BigBuckBunny.mp4\",\n       \"ParentAssetId\":\"nb:cid:UUID:9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1\"\n    }\n\n\n**HTTP Response**\n\nIf successful, the following is returned:\n    HTTP/1.1 204 No Content\n\n## Delete the Locator and AccessPolicy \n\n**HTTP Request**\n\n\n    DELETE https://wamsbayclus001rest-hs.cloudapp.net/api/Locators('nb%3Alid%3AUUID%3Aaf57bdd8-6751-4e84-b403-f3c140444b54') HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n\n    \n**HTTP Response**\n\nIf successful, the following is returned:\n\n    HTTP/1.1 204 No Content \n    ...\n\n**HTTP Request**\n\n    DELETE https://wamsbayclus001rest-hs.cloudapp.net/api/AccessPolicies('nb%3Apid%3AUUID%3Abe0ac48d-af7d-4877-9d60-1805d68bffae') HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421662918&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=utmoXXbm9Q7j4tW1yJuMVA3egRiQy5FPygwadkmPeaY%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n\n**HTTP Response**\n\nIf successful, the following is returned:\n\n    HTTP/1.1 204 No Content \n    ...\n\n \n## <a id=\"configure_streaming_units\"></a>Configure streaming units with REST API\n\nWhen working with Azure Media Services one of the most common scenarios is delivering adaptive bitrate streaming to your clients. With adaptive bitrate streaming, the client can switch to a higher or lower bitrate stream as the video is displayed based on the current network bandwidth, CPU utilization, and other factors. Media Services supports the following adaptive bitrate streaming technologies: HTTP Live Streaming (HLS), Smooth Streaming, MPEG DASH, and HDS (for Adobe PrimeTime/Access licensees only). \n\nMedia Services provides dynamic packaging which allows you to deliver your adaptive bitrate MP4 or Smooth Streaming encoded content in streaming formats supported by Media Services (MPEG DASH, HLS, Smooth Streaming, HDS) without you having to re-package into these streaming formats. \n\nTo take advantage of dynamic packaging, you need to do the following:\n\n- get at least one streaming unit for the **streaming endpoint **from which you plan to deliver your content (described in this section).\n- encode or transcode your mezzanine (source) file into a set of adaptive bitrate MP4 files or adaptive bitrate Smooth Streaming files (the encoding steps are demonstrated later in this tutorial),  \n\nWith dynamic packaging you only need to store and pay for the files in single storage format and Media Services will build and serve the appropriate response based on requests from a client. \n\n\n>[AZURE.NOTE] For information about pricing details, see [Media Services Pricing Details](http://go.microsoft.com/fwlink/?LinkId=275107).\n\nTo change the number of streaming reserved units, do the following:\n    \n### Get the streaming endpoint you want to update\n\nFor example, let's get the first streaming endpoint in your account (you can have up to 2 streaming endpoints in running state at the same time.)\n\n**HTTP Request**:\n\n    GET https://wamsbayclus001rest-hs.cloudapp.net/api/StreamingEndpoints()?$top=1 HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json;odata=verbose\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421466122&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=TiKGEOTporft4pFGU24sSZRZk5GRAWszFXldl5NXAhY%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n\n**HTTP Response**\n    \nIf successful, the following is returned:\n    \n    HTTP/1.1 200 OK\n    . . . \n    \n### Scale the streaming endpoint\n \n**HTTP Request**:\n\n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/StreamingEndpoints('nb:oid:UUID:cd57670d-cc1c-0f86-16d8-3ad478bf9486')/Scale HTTP/1.1\n    Content-Type: application/json;odata=verbose\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json;odata=verbose\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421466122&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=TiKGEOTporft4pFGU24sSZRZk5GRAWszFXldl5NXAhY%3d\n    x-ms-version: 2.11\n    x-ms-client-request-id: 39f96c93-a4b1-43ce-b97e-b2aaa44ee2dd\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    \n    {\"scaleUnits\":1}\n\n**HTTP Response**\n\n    HTTP/1.1 202 Accepted\n    Cache-Control: no-cache\n    Server: Microsoft-IIS/8.5\n    x-ms-client-request-id: 39f96c93-a4b1-43ce-b97e-b2aaa44ee2dd\n    request-id: 3c1ba1c7-281c-4b2d-a898-09cb70a3a424\n    x-ms-request-id: 3c1ba1c7-281c-4b2d-a898-09cb70a3a424\n    operation-id: nb:opid:UUID:1853bcbf-b71f-4ed5-a4c7-a581d4f45ae7\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 1.0;\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Fri, 16 Jan 2015 22:16:43 GMT\n    Content-Length: 0\n\n    \n### <a id=\"long_running_op_status\"></a> Check on the status of a long-running operation\n\nThe allocation of any new units takes around 20 minutes to complete. To check the status of the operation use the **Operations** method and specify the Id of the operation. The operation Id was returned in the response to the **Scale** request.\n\n    operation-id: nb:opid:UUID:1853bcbf-b71f-4ed5-a4c7-a581d4f45ae7\n \n**HTTP Request**:\n    \n    GET https://wamsbayclus001rest-hs.cloudapp.net/api/Operations('nb:opid:UUID:1853bcbf-b71f-4ed5-a4c7-a581d4f45ae7') HTTP/1.1\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json;odata=verbose\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421466122&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=TiKGEOTporft4pFGU24sSZRZk5GRAWszFXldl5NXAhY%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    \n**HTTP Response**\n    \n    HTTP/1.1 200 OK\n    Cache-Control: no-cache\n    Content-Length: 515\n    Content-Type: application/json;odata=verbose;charset=utf-8\n    Server: Microsoft-IIS/8.5\n    x-ms-client-request-id: 829e1a89-3ec2-4836-a04d-802b5aeff5e8\n    request-id: f7ae8a78-af8d-4881-b9ea-ca072cfe0b60\n    x-ms-request-id: f7ae8a78-af8d-4881-b9ea-ca072cfe0b60\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 1.0;\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Fri, 16 Jan 2015 22:57:39 GMT\n    \n    {  \n       \"d\":{  \n          \"__metadata\":{  \n             \"id\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Operations('nb%3Aopid%3AUUID%3Acc339c28-6bba-4f7d-bee5-91ea4a0a907e')\",\n             \"uri\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Operations('nb%3Aopid%3AUUID%3Acc339c28-6bba-4f7d-bee5-91ea4a0a907e')\",\n             \"type\":\"Microsoft.Cloud.Media.Vod.Rest.Data.Models.Operation\"\n          },\n          \"Id\":\"nb:opid:UUID:cc339c28-6bba-4f7d-bee5-91ea4a0a907e\",\n          \"State\":\"Succeeded\",\n          \"TargetEntityId\":\"nb:oid:UUID:cd57670d-cc1c-0f86-16d8-3ad478bf9486\",\n          \"ErrorCode\":null,\n          \"ErrorMessage\":null\n       }\n    }\n\n\n## <a id=\"encode\"></a>Encode the source file into a set of adaptive bitrate MP4 files\n\nAfter ingesting Assets into Media Services, media can be encoded, transmuxed, watermarked, and so on, before it is delivered to clients. These activities are scheduled and run against multiple background role instances to ensure high performance and availability. These activities are called Jobs and each [Job](http://msdn.microsoft.com/library/azure/hh974289.aspx) is comprised of atomic Tasks that do the actual work on the Asset file. \n\nAs was mentioned earlier, when working with Azure Media Services one of the most common scenarios is delivering adaptive bitrate streaming to your clients. Media Services can dynamically package a set of adaptive bitrate MP4 files into one of the following formats: HTTP Live Streaming (HLS), Smooth Streaming, MPEG DASH, and HDS (for Adobe PrimeTime/Access licensees only). \n\nTo take advantage of dynamic packaging, you need to do the following:\n\n- encode or transcode your mezzanine (source) file into a set of adaptive bitrate MP4 files or adaptive bitrate Smooth Streaming files,  \n- get at least one streaming unit for the streaming endpoint from which you plan to deliver your content. \n\nThe following section shows how to create a job that contains one encoding task. The task specifies to transcode the mezzanine file into a set of adaptive bitrate MP4s using **Azure Media Encoder**. The section also shows how to monitor the job processing progress. When the job is complete you you would be able to create locators that are needed to get access to your assets. \n\n### Get a media processor\n\nIn Media Services, a media processor is a component that handles a specific processing task, such as encoding, format conversion, encrypting, or decrypting media content. For the encoding task shown in this tutorial we are going to use the Azure Media Encoder.\n\nThe following code requests the encoder's id. \n\n**HTTP Request**\n\n    GET https://wamsbayclus001rest-hs.cloudapp.net/api/MediaProcessors()?$filter=Name%20eq%20'Azure%20Media%20Encoder' HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=f7f09258-6753-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421675491&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=9hUudHYnATpi5hN3cvTfgw%2bL4N3tL0fdsRnQnm6ZYIU%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    \n\n**HTTP Response**\n\n    HTTP/1.1 200 OK\n    Cache-Control: no-cache\n    Content-Length: 273\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Server: Microsoft-IIS/8.5\n    request-id: 6beb04b4-55a7-480d-8aa8-e5c5d59ffa1f\n    x-ms-request-id: 6beb04b4-55a7-480d-8aa8-e5c5d59ffa1f\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 07:54:09 GMT\n    \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#MediaProcessors\",\n       \"value\":[  \n          {  \n             \"Id\":\"nb:mpid:UUID:1b1da727-93ae-4e46-a8a1-268828765609\",\n             \"Description\":\"Azure Media Encoder\",\n             \"Name\":\"Azure Media Encoder\",\n             \"Sku\":\"\",\n             \"Vendor\":\"Microsoft\",\n             \"Version\":\"4.4\"\n          }\n       ]\n    }\n\n### Create a job\n\nEach Job can have one or more Tasks depending on the type of processing that you want to accomplish. Through the REST API, you can create Jobs and their related Tasks in one of two ways: Tasks can be defined inline through the Tasks navigation property on Job entities, or through OData batch processing. The Media Services SDK uses batch processing; however, for the readability of the code examples in this topic, tasks are defined inline. For information on batch processing, see [Open Data Protocol (OData) Batch Processing](http://www.odata.org/documentation/odata-version-3-0/batch-processing/).\n\nThe following example shows you how to create and post a Job with one Task set to encode a video at a specific resolution and quality. The following documentation section contains the list of all the [task presets](http://msdn.microsoft.com/library/azure/dn619392.aspx) supported by the Azure Media Processor.  \n\n**HTTP Request**\n    \n    POST https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Content-Type: application/json\n    Accept: application/json;odata=verbose\n    Accept-Charset: UTF-8\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421675491&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=9hUudHYnATpi5hN3cvTfgw%2bL4N3tL0fdsRnQnm6ZYIU%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    Content-Length: 482\n    \n    {  \n       \"Name\":\"NewTestJob\",\n       \"InputMediaAssets\":[  \n          {  \n             \"__metadata\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.net/api/Assets('nb%3Acid%3AUUID%3A9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1')\"\n             }\n          }\n       ],\n       \"Tasks\":[  \n          {  \n             \"Configuration\":\"H264 Adaptive Bitrate MP4 Set 720p\",\n             \"MediaProcessorId\":\"nb:mpid:UUID:1b1da727-93ae-4e46-a8a1-268828765609\",\n             \"TaskBody\":\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?><taskBody><inputAsset>JobInputAsset(0)</inputAsset>\n                <outputAsset>JobOutputAsset(0)</outputAsset></taskBody>\"\n          }\n       ]\n    }\n\n**HTTP Response**\n\nIf successful, the following response is returned:\n\n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 1215\n    Content-Type: application/json;odata=verbose;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')\n    Server: Microsoft-IIS/8.5\n    request-id: 532ac1ec-a475-4dce-b2d5-7c8ce94ac87c\n    x-ms-request-id: 532ac1ec-a475-4dce-b2d5-7c8ce94ac87c\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 08:04:35 GMT\n        \n    {  \n       \"d\":{  \n          \"__metadata\":{  \n             \"id\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')\",\n             \"uri\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')\",\n             \"type\":\"Microsoft.Cloud.Media.Vod.Rest.Data.Models.Job\"\n          },\n          \"Tasks\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')/Tasks\"\n             }\n          },\n          \"OutputMediaAssets\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')/OutputMediaAssets\"\n             }\n          },\n          \"InputMediaAssets\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A9bc8ff20-24fb-4fdb-9d7c-b04c7ee573a1')/InputMediaAssets\"\n             }\n          },\n          \"Id\":\"nb:jid:UUID:71d2dd33-efdf-ec43-8ea1-136a110bd42c\",\n          \"Name\":\"NewTestJob\",\n          \"Created\":\"2015-01-19T08:04:34.3287057Z\",\n          \"LastModified\":\"2015-01-19T08:04:34.3287057Z\",\n          \"EndTime\":null,\n          \"Priority\":0,\n          \"RunningDuration\":0,\n          \"StartTime\":null,\n          \"State\":0,\n          \"TemplateId\":null,\n          \"JobNotificationSubscriptions\":{  \n             \"__metadata\":{  \n                \"type\":\"Collection(Microsoft.Cloud.Media.Vod.Rest.Data.Models.JobNotificationSubscription)\"\n             },\n             \"results\":[  \n    \n             ]\n          }\n       }\n    }\n\n\nThere are a few important things to note in any Job request:\n\n- TaskBody properties MUST use literal XML to define the number of input, or output assets that will be used by the Task. The Task topic contains the XML Schema Definition for the XML.\n- In the TaskBody definition, each inner value for <inputAsset> and <outputAsset> must be set as JobInputAsset(value) or JobOutputAsset(value).\n- A task can have multiple output assets. One JobOutputAsset(x) can only be used once as an output of a task in a job.\n- You can specify JobInputAsset or JobOutputAsset as an input asset of a task.\n- Tasks must not form a cycle.\n- The value parameter that you pass to JobInputAsset or JobOutputAsset represents the index value for an Asset. The actual Assets are defined in the InputMediaAssets and OutputMediaAssets navigation properties on the Job entity definition. \n\n>[AZURE.NOTE] Because Media Services is built on OData v3, the individual assets in InputMediaAssets and OutputMediaAssets navigation property collections are referenced through a \"__metadata : uri\" name-value pair. \n\n- InputMediaAssets maps to one or more Assets you have created in Media Services. OutputMediaAssets are created by the system. They do not reference an existing asset.\n- OutputMediaAssets can be named using the assetName attribute. If this attribute is not present, then the name of the OutputMediaAsset will be whatever the inner text value of the <outputAsset> element is with a suffix of either the Job Name value, or the Job Id value (in the case where the Name property isn't defined). For example, if you set a value for assetName to \"Sample\", then the OutputMediaAsset Name property would be set to \"Sample\". However, if you did not set a value for assetName, but did set the job name to \"NewJob\", then the OutputMediaAsset Name would be \"JobOutputAsset(value)_NewJob\". \n\n    The following example shows how to set the assetName attribute:\n    \n        \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?><taskBody><inputAsset>JobInputAsset(0)</inputAsset><outputAsset assetName=\\\"CustomOutputAssetName\\\">JobOutputAsset(0)</outputAsset></taskBody>\"\n\n\n- To enable task chaining:\n\n    - A job must have at least 2 tasks\n    - There must be at least one task whose input is output of another task in the job.\n\nFor more information see, [Creating an Encoding Job with the Media Services REST API](http://msdn.microsoft.com/library/azure/jj129574.aspx).\n\n### Monitor Processing Progress\n\nYou can retrieve the Job status by using the State property, as shown in the following example. \n\n**HTTP Request**\n\n    GET https://wamsbayclus001rest-hs.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')/State HTTP/1.1\n    Content-Type: application/json;odata=verbose\n    Accept: application/json;odata=verbose\n    DataServiceVersion: 3.0\n    MaxDataServiceVersion: 3.0\n    x-ms-version: 2.11\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=youraccountname&urn%3aSubscriptionId=zf84471d-2233-4e75-aa09-010f0fc0cf5b&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1336908022&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=RYXOraO6Z%2f7l9whWZQN%2bypeijgHwIk8XyikA01Kx1%2bk%3d\n    Host: wamsbayclus001rest-hs.net\n    Content-Length: 0\n\n\n**HTTP Response**\n\nIf successful, the following response is returned:\n\n    HTTP/1.1 200 OK\n    Cache-Control: no-cache\n    Content-Length: 17\n    Content-Type: application/json;odata=verbose;charset=utf-8\n    Server: Microsoft-IIS/7.5\n    x-ms-request-id: 01324d81-18e2-4493-a3e5-c6186209f0c8\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 1.0;\n    X-AspNet-Version: 4.0.30319\n    X-Powered-By: ASP.NET\n    Date: Sun, 13 May 2012 05:16:53 GMT\n    \n    {\"d\":{\"State\":2}}\n\n\n### Cancel a job\n\nMedia Services allows you to cancel running jobs through the CancelJob function. This call will return a 400 error code if you try to cancel a Job when its state is canceled, canceling, error, or finished.\n\nThe following example shows how to call CancelJob.\n\n\n**HTTP Request**\n\n\n    GET https://wamsbayclus001rest-hs.net/API/CancelJob?jobid='nb%3ajid%3aUUID%3a71d2dd33-efdf-ec43-8ea1-136a110bd42c' HTTP/1.1\n    Content-Type: application/json;odata=verbose\n    Accept: application/json;odata=verbose\n    DataServiceVersion: 3.0\n    MaxDataServiceVersion: 3.0\n    x-ms-version: 2.2\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=youraccountname&urn%3aSubscriptionId=2f84471d-b1ae-4e75-aa09-010f0fc0cf5b&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1336908753&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=kolAgnFfbQIeRv4lWxKSFa4USyjWXRm15Kd%2bNd5g8eA%3d\n    Host: wamsbayclus001rest-hs.net\n\n\nIf successful, a 204 response code is returned with no message body.\n\n>[AZURE.NOTE] You must URL-encode the job id (normally nb:jid:UUID: somevalue) when passing it in as a parameter to CancelJob.\n\n\n### Get the output asset \n\nThe following code shows how to request the output asset Id. \n\n\n**HTTP Request**\n\n    GET https://wamsbayclus001rest-hs.cloudapp.net/api/Jobs('nb%3Ajid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')/OutputMediaAssets() HTTP/1.1\n    DataServiceVersion: 1.0;NetFx\n    MaxDataServiceVersion: 3.0;NetFx\n    Accept: application/json\n    Accept-Charset: UTF-8\n    User-Agent: Microsoft ADO.NET Data Services\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=amstestaccount001&urn%3aSubscriptionId=z7f09258-2233-4ca2-b1ae-193798e2c9d8&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1421675491&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=9hUudHYnATpi5hN3cvTfgw%2bL4N3tL0fdsRnQnm6ZYIU%3d\n    x-ms-version: 2.11\n    Host: wamsbayclus001rest-hs.cloudapp.net\n    \n\n**HTTP Response**\n\n    HTTP/1.1 200 OK\n    Cache-Control: no-cache\n    Content-Length: 445\n    Content-Type: application/json;odata=minimalmetadata;streaming=true;charset=utf-8\n    Server: Microsoft-IIS/8.5\n    request-id: 73cd605d-066a-46f1-8358-f4bd25a9220a\n    x-ms-request-id: 73cd605d-066a-46f1-8358-f4bd25a9220a\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 3.0;\n    X-Powered-By: ASP.NET\n    Strict-Transport-Security: max-age=31536000; includeSubDomains\n    Date: Mon, 19 Jan 2015 08:28:13 GMT\n        \n    {  \n       \"odata.metadata\":\"https://wamsbayclus001rest-hs.cloudapp.net/api/$metadata#Assets\",\n       \"value\":[  \n          {  \n             \"Id\":\"nb:cid:UUID:71d2dd33-efdf-ec43-8ea1-136a110bd42c\",\n             \"State\":0,\n             \"Created\":\"2015-01-19T07:52:15.603\",\n             \"LastModified\":\"2015-01-19T07:52:15.603\",\n             \"AlternateId\":null,\n             \"Name\":\"Multibitrate MP4s\",\n             \"Options\":0,\n             \"Uri\":\"https://storagetestaccount001.blob.core.windows.net/asset-71d2dd33-efdf-ec43-8ea1-136a110bd42c\",\n             \"StorageAccountName\":\"storagetestaccount001\"\n          }\n       ]\n    }\n\n\n\n## <a id=\"publish_get_urls\"></a>Publish the asset and get streaming and progressive download URLs with REST API\n\nTo stream or download an asset you first need to \"publish\" it by creating a locator. Locators provide access to files contained in the asset. Media Services supports two types of locators: OnDemandOrigin locators, used to stream media (for example, MPEG DASH, HLS, or Smooth Streaming) and Access Signature (SAS) locators, used to download media files.\n\nOnce you create the locators, you can build the URLs that are used to stream or download your files. \n\n\nA streaming URL for Smooth Streaming has the following format:\n\n    {streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest\n\nA streaming URL for HLS has the following format:\n\n    {streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=m3u8-aapl)\n\nA streaming URL for MPEG DASH has the following format:\n\n    {streaming endpoint name-media services account name}.streaming.mediaservices.windows.net/{locator ID}/{filename}.ism/Manifest(format=mpd-time-csf)\n\n\nA SAS URL used to download files has the following format:\n\n    {blob container name}/{asset name}/{file name}/{SAS signature}\n\nThis sections shows how to perform the following tasks necessary to \"publish\" your assets.  \n\n- Creating the AccessPolicy with read permission \n- Creating a SAS URL for downloading content \n- Creating an origin URL for streaming content \n\n###Creating the AccessPolicy with read permission\n\nBefore downloading or streaming any media content, first define an AccessPolicy with read permissions and create the appropriate Locator entity that specifies the type of delivery mechanism you want to enable for your clients. For more information on the properties available, see [AccessPolicy Entity Properties](https://msdn.microsoft.com/library/azure/hh974297.aspx#accesspolicy_properties).\n\nThe following example shows how to specify the AccessPolicy for read permissions for a given Asset.\n\n    POST https://wamsbayclus001rest-hs.net/API/AccessPolicies HTTP/1.1\n    Content-Type: application/json\n    Accept: application/json\n    DataServiceVersion: 3.0\n    MaxDataServiceVersion: 3.0\n    x-ms-version: 2.11\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=youraccountname&urn%3aSubscriptionId=2f84471d-b1ae-4e75-aa09-010f0fc0cf5b&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1337067658&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=dithjGvlXR9HlyAf5DE99N5OCYkPAxsHIcsTSjm9%2fVE%3d\n    Host: wamsbayclus001rest-hs.net\n    Content-Length: 74\n    Expect: 100-continue\n    \n    {\"Name\": \"DownloadPolicy\", \"DurationInMinutes\" : \"300\", \"Permissions\" : 1}\n\nIf successful, a 201 success code is returned describing the AccessPolicy entity that you created. You will then use the AccessPolicy Id along with the Asset Id of the asset that contains the file you want to deliver(such as an output asset) to create the Locator entity.\n\n>[AZURE.NOTE]\nThis basic workflow is the same as uploading a file when ingesting an Asset (as was discussed earlier in this topic). Also, like uploading files, if you (or your clients) need to access your files immediately, set your StartTime value to five minutes before the current time. This action is necessary because there may be clock skew between the client and Media Services. The StartTime value must be in the following DateTime format: YYYY-MM-DDTHH:mm:ssZ (for example, \"2014-05-23T17:53:50Z\").\n\n\n###Creating a SAS URL for downloading content \n\nThe following code shows how to get a URL that can be used to download a media file created and uploaded previously. The AccessPolicy has read permissions set and the Locator path refers to a SAS download URL.\n\n    POST https://wamsbayclus001rest-hs.net/API/Locators HTTP/1.1\n    Content-Type: application/json\n    Accept: application/json\n    DataServiceVersion: 3.0\n    MaxDataServiceVersion: 3.0\n    x-ms-version: 2.11\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=youraccountname&urn%3aSubscriptionId=zf84471d-b1ae-2233-aa09-010f0fc0cf5b&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1337067658&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=dithjGvlXR9HlyAf5DE99N5OCYkPAxsHIcsTSjm9%2fVE%3d\n    Host: wamsbayclus001rest-hs.net\n    Content-Length: 182\n    Expect: 100-continue\n    \n    {\"AccessPolicyId\": \"nb:pid:UUID:38c71dd0-44c5-4c5f-8418-08bb6fbf7bf8\", \"AssetId\" : \"nb:cid:UUID:71d2dd33-efdf-ec43-8ea1-136a110bd42c\", \"StartTime\" : \"2014-05-17T16:45:53\", \"Type\":1}\n\nIf successful, the following response is returned:\n\n    \n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 1150\n    Content-Type: application/json;odata=verbose;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A8e5a821d-2194-4d00-8884-adf979856874')\n    Server: Microsoft-IIS/7.5\n    x-ms-request-id: 8cfd8556-3064-416a-97f2-67d9e35f0911\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 1.0;\n    X-AspNet-Version: 4.0.30319\n    X-Powered-By: ASP.NET\n    Date: Mon, 14 May 2012 21:41:32 GMT\n        \n    {  \n       \"d\":{  \n          \"__metadata\":{  \n             \"id\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A8e5a821d-2194-4d00-8884-adf979856874')\",\n             \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A8e5a821d-2194-4d00-8884-adf979856874')\",\n             \"type\":\"Microsoft.Cloud.Media.Vod.Rest.Data.Models.Locator\"\n          },\n          \"AccessPolicy\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A8e5a821d-2194-4d00-8884-adf979856874')/AccessPolicy\"\n             }\n          },\n          \"Asset\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A71d2dd33-efdf-ec43-8ea1-136a110bd42c')/Asset\"\n             }\n          },\n          \"Id\":\"nb:lid:UUID:8e5a821d-2194-4d00-8884-adf979856874\",\n          \"ExpirationDateTime\":\"\\/Date(1337049393000)\\/\",\n          \"Type\":1,\n          \"Path\":\"https://storagetestaccount001.blob.core.windows.net/asset-71d2dd33-efdf-ec43-8ea1-136a110bd42c?st=2012-05-14T21%3A36%3A33Z&se=2012-05-15T02%3A36%3A33Z&sr=c&si=8e5a821d-2194-4d00-8884-adf979856874&sig=y75dViDpC5V8WutrXM%2B%2FGpR3uOtqmlISiNlHU1YUBOg%3D\",\n          \"AccessPolicyId\":\"nb:pid:UUID:38c71dd0-44c5-4c5f-8418-08bb6fbf7bf8\",\n          \"AssetId\":\"nb:cid:UUID:71d2dd33-efdf-ec43-8ea1-136a110bd42c\",\n          \"StartTime\":\"\\/Date(1337031393000)\\/\"\n       }\n    }\n\n\nThe returned **Path** property contains the SAS URL.\n\n>[AZURE.NOTE]\nIf you download storage encrypted content, you must manually decrypt it before rendering it, or use the Storage Decryption MediaProcessor in a processing task to output processed files in the clear to an OutputAsset and then download from that Asset. For more information on processing, see Creating an Encoding Job with the Media Services REST API. Also, SAS URL Locators cannot be updated after they have been created. For example, you cannot reuse the same Locator with an updated StartTime value. This is because of the way SAS URLs are created. If you want to access an asset for download after a Locator has expired, then you must create a new one with a new StartTime.\n\n###Download files\n\nOnce you have the AccessPolicy and Locator set, you can download files using the Azure Storage REST APIs.  \n\n>[AZURE.NOTE] You must add the file name for the file you want to download to the Locator **Path** value received in the previous section. For example, https://storagetestaccount001.blob.core.windows.net/asset-e7b02da4-5a69-40e7-a8db-e8f4f697aac0/BigBuckBunny.mp4? . . . \n\nFor more information on working with Azure storage blobs, see [Blob Service REST API](http://msdn.microsoft.com/library/azure/dd135733.aspx).\n\nAs a result of the encoding job that you performed earlier (encoding into Adaptive MP4 set), you have multiple MP4 files that you can progressively download. For example:    \n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_650kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_400kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_3400kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_2250kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_1500kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_H264_1000kbps_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_AAC_und_ch2_96kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n    \n    https://storagetestaccount001.blob.core.windows.net/asset-38058602-a4b8-4b33-b9f0-6880dc1490ea/BigBuckBunny_AAC_und_ch2_56kbps.mp4?sv=2012-02-12&sr=c&si=166d5154-b801-410b-a226-ee2f8eac1929&sig=P2iNZJAvAWpp%2Bj9yV6TQjoz5DIIaj7ve8ARynmEM6Xk%3D&se=2015-02-14T01:13:05Z\n\n\n###Creating an streaming URL for streaming content\n\n\nThe following code shows how to create a streaming URL Locator:\n\n    POST https://wamsbayclus001rest-hs/API/Locators HTTP/1.1\n    Content-Type: application/json\n    Accept: application/json\n    DataServiceVersion: 3.0\n    MaxDataServiceVersion: 3.0\n    x-ms-version: 2.11\n    Authorization: Bearer http%3a%2f%2fschemas.xmlsoap.org%2fws%2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=youraccountname&urn%3aSubscriptionId=2f84471d-b1ae-4e75-aa09-010f0fc0cf5b&http%3a%2f%2fschemas.microsoft.com%2faccesscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&Audience=urn%3aWindowsAzureMediaServices&ExpiresOn=1337067658&Issuer=https%3a%2f%2fwamsprodglobal001acs.accesscontrol.windows.net%2f&HMACSHA256=dithjGvlXR9HlyAf5DE99N5OCYkPAxsHIcsTSjm9%2fVE%3d\n    Host: wamsbayclus001rest-hs\n    Content-Length: 182\n    Expect: 100-continue\n    \n    {\"AccessPolicyId\": \"nb:pid:UUID:38c71dd0-44c5-4c5f-8418-08bb6fbf7bf8\", \"AssetId\" : \"nb:cid:UUID:eb5540a2-116e-4d36-b084-7e9958f7f3c3\", \"StartTime\" : \"2014-05-17T16:45:53\",, \"Type\":2}\n\nIf successful, the following response is returned:\n\n    HTTP/1.1 201 Created\n    Cache-Control: no-cache\n    Content-Length: 981\n    Content-Type: application/json;odata=verbose;charset=utf-8\n    Location: https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A52034bf6-dfae-4d83-aad3-3bd87dcb1a5d')\n    Server: Microsoft-IIS/7.5\n    x-ms-request-id: 2eac4158-fc78-4fa2-81ee-c9f582dc385f\n    X-Content-Type-Options: nosniff\n    DataServiceVersion: 1.0;\n    X-AspNet-Version: 4.0.30319\n    X-Powered-By: ASP.NET\n    Date: Mon, 14 May 2012 21:41:39 GMT\n        \n    {  \n       \"d\":{  \n          \"__metadata\":{  \n             \"id\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A52034bf6-dfae-4d83-aad3-3bd87dcb1a5d')\",\n             \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A52034bf6-dfae-4d83-aad3-3bd87dcb1a5d')\",\n             \"type\":\"Microsoft.Cloud.Media.Vod.Rest.Data.Models.Locator\"\n          },\n          \"AccessPolicy\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A52034bf6-dfae-4d83-aad3-3bd87dcb1a5d')/AccessPolicy\"\n             }\n          },\n          \"Asset\":{  \n             \"__deferred\":{  \n                \"uri\":\"https://wamsbayclus001rest-hs.net/api/Locators('nb%3Alid%3AUUID%3A52034bf6-dfae-4d83-aad3-3bd87dcb1a5d')/Asset\"\n             }\n          },\n          \"Id\":\"nb:lid:UUID:52034bf6-dfae-4d83-aad3-3bd87dcb1a5d\",\n          \"ExpirationDateTime\":\"\\/Date(1337049395000)\\/\",\n          \"Type\":2,\n          \"Path\":\"http://wamsbayclus001rest-hs.net/52034bf6-dfae-4d83-aad3-3bd87dcb1a5d/\",\n          \"AccessPolicyId\":\"nb:pid:UUID:38c71dd0-44c5-4c5f-8418-08bb6fbf7bf8\",\n          \"AssetId\":\"nb:cid:UUID:eb5540a2-116e-4d36-b084-7e9958f7f3c3\",\n          \"StartTime\":\"\\/Date(1337031395000)\\/\"\n       }\n    }\n\nTo stream a Smooth Streaming origin URL in a streaming media player, you must append the Path property with the name of the Smooth Streaming manifest file, followed by \"/manifest\".\n\n    http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest\n\nTo stream HLS, append (format=m3u8-aapl) after the \"/manifest\".\n\n    http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest(format=m3u8-aapl)\n\nTo stream MPEG DASH, append (format=mpd-time-csf) after the \"/manifest\".\n\n    http://amstestaccount001.streaming.mediaservices.windows.net/ebf733c4-3e2e-4a68-b67b-cc5159d1d7f2/BigBuckBunny.ism/manifest(format=mpd-time-csf)\n\n\n## <a id=\"play\"></a>Play your content  \n\nTo stream you video, use [Azure Media Services Player](http://amsplayer.azurewebsites.net/azuremediaplayer.html).\n\nTo test progressive download, paste a URL into a browser (for example, IE, Chrome, Safari).\n\n\n##Additional Resources\n- <a href=\"http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-101-Get-your-video-online-now-\">Azure Media Services 101 - Get your video online now!</a>\n- <a href=\"http://channel9.msdn.com/Shows/Azure-Friday/Azure-Media-Services-102-Dynamic-Packaging-and-Mobile-Devices\">Azure Media Services 102 - Dynamic Packaging and Mobile Devices</a>\n\n\n\n<!-- URLs. -->\n  [Management Portal]: http://manage.windowsazure.com/\n\n\n \n\ntest\n"
}